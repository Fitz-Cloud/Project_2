[0m18:28:31.008966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000272CE3803A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000272D03EEBB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000272D03EE9A0>]}


============================== 18:28:31.031438 | 5a461386-c51a-4c57-99a4-fbee37a26858 ==============================
[0m18:28:31.031438 [info ] [MainThread]: Running with dbt=1.9.0
[0m18:28:31.033334 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\fitzp\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m18:28:31.204354 [info ] [MainThread]: dbt version: 1.9.0
[0m18:28:31.204354 [info ] [MainThread]: python version: 3.9.21
[0m18:28:31.204354 [info ] [MainThread]: python path: C:\Users\fitzp\anaconda3\envs\bootcamp\python.exe
[0m18:28:31.207467 [info ] [MainThread]: os info: Windows-10-10.0.26100-SP0
[0m18:28:37.401037 [info ] [MainThread]: Using profiles dir at C:\Users\fitzp\.dbt
[0m18:28:37.401037 [info ] [MainThread]: Using profiles.yml file at C:\Users\fitzp\.dbt\profiles.yml
[0m18:28:37.401037 [info ] [MainThread]: Using dbt_project.yml file at c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\dbt_project.yml
[0m18:28:37.407472 [info ] [MainThread]: adapter type: snowflake
[0m18:28:37.407472 [info ] [MainThread]: adapter version: 1.9.0
[0m18:28:37.413101 [info ] [MainThread]: Configuration:
[0m18:28:37.413634 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m18:28:37.414837 [info ] [MainThread]:   dbt_project.yml file [[31mERROR not found[0m]
[0m18:28:37.416861 [info ] [MainThread]: Required dependencies:
[0m18:28:37.416861 [debug] [MainThread]: Executing "git --help"
[0m18:28:37.511018 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m18:28:37.511018 [debug] [MainThread]: STDERR: "b''"
[0m18:28:37.511018 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m18:28:37.511018 [info ] [MainThread]: Connection:
[0m18:28:37.511018 [info ] [MainThread]:   account: LBJYJAU-VHB74408.snowflakecomputing.com
[0m18:28:37.511018 [info ] [MainThread]:   user: FITZPATRICK80
[0m18:28:37.511018 [info ] [MainThread]:   database: MY_DATABASE
[0m18:28:37.519322 [info ] [MainThread]:   warehouse: COMPUTE_WH
[0m18:28:37.519322 [info ] [MainThread]:   role: ACCOUNTADMIN
[0m18:28:37.521934 [info ] [MainThread]:   schema: MY_SCHEMA
[0m18:28:37.523943 [info ] [MainThread]:   authenticator: None
[0m18:28:37.525953 [info ] [MainThread]:   oauth_client_id: None
[0m18:28:37.527666 [info ] [MainThread]:   query_tag: None
[0m18:28:37.528489 [info ] [MainThread]:   client_session_keep_alive: False
[0m18:28:37.530399 [info ] [MainThread]:   host: None
[0m18:28:37.531562 [info ] [MainThread]:   port: None
[0m18:28:37.532946 [info ] [MainThread]:   proxy_host: None
[0m18:28:37.534436 [info ] [MainThread]:   proxy_port: None
[0m18:28:37.535985 [info ] [MainThread]:   protocol: None
[0m18:28:37.537051 [info ] [MainThread]:   connect_retries: 1
[0m18:28:37.538171 [info ] [MainThread]:   connect_timeout: None
[0m18:28:37.539257 [info ] [MainThread]:   retry_on_database_errors: False
[0m18:28:37.540332 [info ] [MainThread]:   retry_all: False
[0m18:28:37.541391 [info ] [MainThread]:   insecure_mode: False
[0m18:28:37.542689 [info ] [MainThread]:   reuse_connections: True
[0m18:28:37.544300 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m18:28:38.161935 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m18:28:41.963969 [debug] [MainThread]: Using snowflake connection "debug"
[0m18:28:41.963969 [debug] [MainThread]: On debug: select 1 as id
[0m18:28:41.963969 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:28:47.324036 [debug] [MainThread]: Snowflake adapter: Error running SQL: select 1 as id
[0m18:28:47.328885 [debug] [MainThread]: Snowflake adapter: Rolling back transaction.
[0m18:28:47.331028 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m18:28:47.331028 [info ] [MainThread]: [31m2 checks failed:[0m
[0m18:28:47.331028 [info ] [MainThread]: Project loading failed for the following reason:
 project path <c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\dbt_project.yml> not found

[0m18:28:47.331028 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  250001: Could not connect to Snowflake backend after 2 attempt(s).Aborting
  Verify that the hostnames and port numbers in SYSTEM$ALLOWLIST are added to your firewall's allowed list.
  To further troubleshoot your connection you may reference the following article: https://docs.snowflake.com/en/user-guide/client-connectivity-troubleshooting/overview.

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m18:28:47.331028 [debug] [MainThread]: Command `dbt debug` failed at 18:28:47.331028 after 16.52 seconds
[0m18:28:47.337930 [debug] [MainThread]: Connection 'debug' was left open.
[0m18:28:47.337930 [debug] [MainThread]: On debug: No close available on handle
[0m18:28:47.337930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000272CE3803A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000272E8EFDC40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000272E8F3C8E0>]}
[0m18:28:47.339939 [debug] [MainThread]: Flushing usage events
[0m18:28:48.235073 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:57:22.221661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002263846F370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002263A4DFAC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002263A4DF910>]}


============================== 18:57:22.231409 | e4da468e-cf63-4ce1-aa43-b8f06bd81ad7 ==============================
[0m18:57:22.231409 [info ] [MainThread]: Running with dbt=1.9.0
[0m18:57:22.234170 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\fitzp\\.dbt', 'log_path': 'c:\\Users\\fitzp\\Documents\\Alpaca_Market\\zproject_2\\northwind_psql\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m18:57:22.289158 [info ] [MainThread]: dbt version: 1.9.0
[0m18:57:22.291300 [info ] [MainThread]: python version: 3.9.21
[0m18:57:22.293992 [info ] [MainThread]: python path: C:\Users\fitzp\anaconda3\envs\bootcamp\python.exe
[0m18:57:22.296151 [info ] [MainThread]: os info: Windows-10-10.0.26100-SP0
[0m18:57:22.303715 [info ] [MainThread]: Using profiles dir at C:\Users\fitzp\.dbt
[0m18:57:22.303715 [info ] [MainThread]: Using profiles.yml file at C:\Users\fitzp\.dbt\profiles.yml
[0m18:57:22.308590 [info ] [MainThread]: Using dbt_project.yml file at c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\dbt_project.yml
[0m18:57:22.538709 [info ] [MainThread]: Configuration:
[0m18:57:22.539358 [info ] [MainThread]:   profiles.yml file [[31mERROR invalid[0m]
[0m18:57:22.543228 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m18:57:22.544856 [info ] [MainThread]: Required dependencies:
[0m18:57:22.545950 [debug] [MainThread]: Executing "git --help"
[0m18:57:22.659554 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m18:57:22.659554 [debug] [MainThread]: STDERR: "b''"
[0m18:57:22.669343 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m18:57:22.669885 [info ] [MainThread]: Connection test skipped since no profile was found
[0m18:57:22.669885 [info ] [MainThread]: [31m1 check failed:[0m
[0m18:57:22.669885 [info ] [MainThread]: Profile loading failed for the following reason:
Runtime Error
  Could not find profile named 'northwind_profile'


[0m18:57:22.669885 [debug] [MainThread]: Command `dbt debug` failed at 18:57:22.669885 after 0.62 seconds
[0m18:57:22.676568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002263846F370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002263A4AC880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002263A5E3C40>]}
[0m18:57:22.678580 [debug] [MainThread]: Flushing usage events
[0m18:57:23.599799 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:14:16.972927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE0DBDF3D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE0FC5DA30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE0FC5D910>]}


============================== 19:14:16.985925 | 3bc5119f-16b4-402c-9070-05abe025370e ==============================
[0m19:14:16.985925 [info ] [MainThread]: Running with dbt=1.9.0
[0m19:14:16.985925 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'c:\\Users\\fitzp\\Documents\\Alpaca_Market\\zproject_2\\northwind_psql\\logs', 'profiles_dir': 'c:\\Users\\fitzp\\Documents\\Alpaca_Market\\zproject_2\\northwind_psql', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt debug', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:14:16.987412 [info ] [MainThread]: dbt version: 1.9.0
[0m19:14:17.003092 [info ] [MainThread]: python version: 3.9.21
[0m19:14:17.003092 [info ] [MainThread]: python path: C:\Users\fitzp\anaconda3\envs\bootcamp\python.exe
[0m19:14:17.005916 [info ] [MainThread]: os info: Windows-10-10.0.26100-SP0
[0m19:14:18.308223 [info ] [MainThread]: Using profiles dir at c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql
[0m19:14:18.308223 [info ] [MainThread]: Using profiles.yml file at c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\profiles.yml
[0m19:14:18.308223 [info ] [MainThread]: Using dbt_project.yml file at c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\dbt_project.yml
[0m19:14:18.324310 [info ] [MainThread]: adapter type: snowflake
[0m19:14:18.324310 [info ] [MainThread]: adapter version: 1.9.0
[0m19:14:18.462647 [info ] [MainThread]: Configuration:
[0m19:14:18.462647 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m19:14:18.462647 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m19:14:18.462647 [info ] [MainThread]: Required dependencies:
[0m19:14:18.462647 [debug] [MainThread]: Executing "git --help"
[0m19:14:18.561660 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m19:14:18.561660 [debug] [MainThread]: STDERR: "b''"
[0m19:14:18.561660 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m19:14:18.572965 [info ] [MainThread]: Connection:
[0m19:14:18.572965 [info ] [MainThread]:   account: LBJYJAU-VHB74408
[0m19:14:18.572965 [info ] [MainThread]:   user: FITZPATRICK80
[0m19:14:18.572965 [info ] [MainThread]:   database: Project_2
[0m19:14:18.572965 [info ] [MainThread]:   warehouse: COMPUTE_WH
[0m19:14:18.572965 [info ] [MainThread]:   role: ACCOUNTADMIN
[0m19:14:18.572965 [info ] [MainThread]:   schema: raw
[0m19:14:18.572965 [info ] [MainThread]:   authenticator: None
[0m19:14:18.572965 [info ] [MainThread]:   oauth_client_id: None
[0m19:14:18.572965 [info ] [MainThread]:   query_tag: None
[0m19:14:18.572965 [info ] [MainThread]:   client_session_keep_alive: False
[0m19:14:18.572965 [info ] [MainThread]:   host: None
[0m19:14:18.572965 [info ] [MainThread]:   port: None
[0m19:14:18.572965 [info ] [MainThread]:   proxy_host: None
[0m19:14:18.572965 [info ] [MainThread]:   proxy_port: None
[0m19:14:18.572965 [info ] [MainThread]:   protocol: None
[0m19:14:18.588516 [info ] [MainThread]:   connect_retries: 1
[0m19:14:18.589562 [info ] [MainThread]:   connect_timeout: None
[0m19:14:18.591613 [info ] [MainThread]:   retry_on_database_errors: False
[0m19:14:18.591613 [info ] [MainThread]:   retry_all: False
[0m19:14:18.591613 [info ] [MainThread]:   insecure_mode: False
[0m19:14:18.591613 [info ] [MainThread]:   reuse_connections: True
[0m19:14:18.591613 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m19:14:18.983895 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m19:14:19.052300 [debug] [MainThread]: Using snowflake connection "debug"
[0m19:14:19.052300 [debug] [MainThread]: On debug: select 1 as id
[0m19:14:19.052300 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:14:21.993194 [debug] [MainThread]: SQL status: SUCCESS 1 in 2.928 seconds
[0m19:14:21.996174 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m19:14:21.996174 [info ] [MainThread]: [32mAll checks passed![0m
[0m19:14:21.996174 [debug] [MainThread]: Command `dbt debug` succeeded at 19:14:21.996174 after 5.13 seconds
[0m19:14:21.996174 [debug] [MainThread]: Connection 'debug' was left open.
[0m19:14:21.996174 [debug] [MainThread]: On debug: Close
[0m19:14:22.165387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE0DBDF3D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE0FC5D850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE28D58E20>]}
[0m19:14:22.166451 [debug] [MainThread]: Flushing usage events
[0m19:14:23.455134 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:27:10.539308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F59F9EF310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5A1A5AA90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5A1A5A8E0>]}


============================== 19:27:10.539308 | 9450997f-ab6a-4a9f-835c-4bbbba14a302 ==============================
[0m19:27:10.539308 [info ] [MainThread]: Running with dbt=1.9.0
[0m19:27:10.539308 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'c:\\Users\\fitzp\\Documents\\Alpaca_Market\\zproject_2\\northwind_psql', 'debug': 'False', 'version_check': 'True', 'log_path': 'c:\\Users\\fitzp\\Documents\\Alpaca_Market\\zproject_2\\northwind_psql\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:27:10.563632 [info ] [MainThread]: dbt version: 1.9.0
[0m19:27:10.563632 [info ] [MainThread]: python version: 3.9.21
[0m19:27:10.563632 [info ] [MainThread]: python path: C:\Users\fitzp\anaconda3\envs\bootcamp\python.exe
[0m19:27:10.563632 [info ] [MainThread]: os info: Windows-10-10.0.26100-SP0
[0m19:27:11.851309 [info ] [MainThread]: Using profiles dir at c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql
[0m19:27:11.851309 [info ] [MainThread]: Using profiles.yml file at c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\profiles.yml
[0m19:27:11.851309 [info ] [MainThread]: Using dbt_project.yml file at c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\dbt_project.yml
[0m19:27:11.859579 [info ] [MainThread]: adapter type: snowflake
[0m19:27:11.860437 [info ] [MainThread]: adapter version: 1.9.0
[0m19:27:12.011277 [info ] [MainThread]: Configuration:
[0m19:27:12.013282 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m19:27:12.015288 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m19:27:12.015288 [info ] [MainThread]: Required dependencies:
[0m19:27:12.017292 [debug] [MainThread]: Executing "git --help"
[0m19:27:12.110705 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m19:27:12.111705 [debug] [MainThread]: STDERR: "b''"
[0m19:27:12.112705 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m19:27:12.113705 [info ] [MainThread]: Connection:
[0m19:27:12.115705 [info ] [MainThread]:   account: LBJYJAU-VHB74408
[0m19:27:12.116705 [info ] [MainThread]:   user: FITZPATRICK80
[0m19:27:12.117704 [info ] [MainThread]:   database: Project_2
[0m19:27:12.118707 [info ] [MainThread]:   warehouse: COMPUTE_WH
[0m19:27:12.120710 [info ] [MainThread]:   role: ACCOUNTADMIN
[0m19:27:12.122194 [info ] [MainThread]:   schema: raw
[0m19:27:12.123962 [info ] [MainThread]:   authenticator: None
[0m19:27:12.125906 [info ] [MainThread]:   oauth_client_id: None
[0m19:27:12.125906 [info ] [MainThread]:   query_tag: None
[0m19:27:12.125906 [info ] [MainThread]:   client_session_keep_alive: False
[0m19:27:12.125906 [info ] [MainThread]:   host: None
[0m19:27:12.125906 [info ] [MainThread]:   port: None
[0m19:27:12.125906 [info ] [MainThread]:   proxy_host: None
[0m19:27:12.125906 [info ] [MainThread]:   proxy_port: None
[0m19:27:12.125906 [info ] [MainThread]:   protocol: None
[0m19:27:12.125906 [info ] [MainThread]:   connect_retries: 1
[0m19:27:12.125906 [info ] [MainThread]:   connect_timeout: None
[0m19:27:12.137968 [info ] [MainThread]:   retry_on_database_errors: False
[0m19:27:12.137968 [info ] [MainThread]:   retry_all: False
[0m19:27:12.140624 [info ] [MainThread]:   insecure_mode: False
[0m19:27:12.143231 [info ] [MainThread]:   reuse_connections: True
[0m19:27:12.143231 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m19:27:12.512395 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m19:27:12.585391 [debug] [MainThread]: Using snowflake connection "debug"
[0m19:27:12.588154 [debug] [MainThread]: On debug: select 1 as id
[0m19:27:12.588154 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:27:13.662883 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.074 seconds
[0m19:27:13.665114 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m19:27:13.668308 [info ] [MainThread]: [32mAll checks passed![0m
[0m19:27:13.671117 [debug] [MainThread]: Command `dbt debug` succeeded at 19:27:13.670553 after 3.21 seconds
[0m19:27:13.671687 [debug] [MainThread]: Connection 'debug' was left open.
[0m19:27:13.672809 [debug] [MainThread]: On debug: Close
[0m19:27:13.844298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F59F9EF310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5A13E9C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5BAB52F40>]}
[0m19:27:13.845441 [debug] [MainThread]: Flushing usage events
[0m19:27:14.658180 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:27:34.872110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023BAA36F3A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023BAC3E3AF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023BAC3E3940>]}


============================== 19:27:34.872110 | db0f86e9-766a-4901-b20d-8175bb9d7cc3 ==============================
[0m19:27:34.872110 [info ] [MainThread]: Running with dbt=1.9.0
[0m19:27:34.872110 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'c:\\Users\\fitzp\\Documents\\Alpaca_Market\\zproject_2\\northwind_psql', 'log_path': 'c:\\Users\\fitzp\\Documents\\Alpaca_Market\\zproject_2\\northwind_psql\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:27:36.001809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'db0f86e9-766a-4901-b20d-8175bb9d7cc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023BC4E9E280>]}
[0m19:27:36.080563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'db0f86e9-766a-4901-b20d-8175bb9d7cc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023BC4EBF4F0>]}
[0m19:27:36.080563 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m19:27:36.562964 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m19:27:36.562964 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m19:27:36.562964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'db0f86e9-766a-4901-b20d-8175bb9d7cc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023BC4EB44C0>]}
[0m19:27:39.521043 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.northwind_dbt.dim_products' (models\marts\core\dim_products.sql) depends on a source named 'raw.suppliers' which was not found
[0m19:27:39.521043 [debug] [MainThread]: Command `dbt run` failed at 19:27:39.521043 after 4.74 seconds
[0m19:27:39.521043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023BAA36F3A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023BC5531490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023BC54EBCA0>]}
[0m19:27:39.521043 [debug] [MainThread]: Flushing usage events
[0m19:27:40.247110 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:32:45.828995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C38E6103D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C390683CA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C390683AF0>]}


============================== 19:32:45.836681 | 8970daa7-a48f-4ebb-9b62-f21fb0779f24 ==============================
[0m19:32:45.836681 [info ] [MainThread]: Running with dbt=1.9.0
[0m19:32:45.836681 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'c:\\Users\\fitzp\\Documents\\Alpaca_Market\\zproject_2\\northwind_psql', 'log_path': 'c:\\Users\\fitzp\\Documents\\Alpaca_Market\\zproject_2\\northwind_psql\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:32:46.723210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8970daa7-a48f-4ebb-9b62-f21fb0779f24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3A90F30A0>]}
[0m19:32:46.777590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8970daa7-a48f-4ebb-9b62-f21fb0779f24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3A913EE50>]}
[0m19:32:46.777590 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m19:32:47.103328 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m19:32:47.119078 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m19:32:47.119078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8970daa7-a48f-4ebb-9b62-f21fb0779f24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3A926FCD0>]}
[0m19:32:48.193727 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.northwind_dbt.dim_products' (models\marts\core\dim_products.sql) depends on a source named 'public.suppliers' which was not found
[0m19:32:48.193727 [debug] [MainThread]: Command `dbt run` failed at 19:32:48.193727 after 2.47 seconds
[0m19:32:48.201428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C38E6103D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3A97D1490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3A978BCD0>]}
[0m19:32:48.201428 [debug] [MainThread]: Flushing usage events
[0m19:32:49.049714 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:27:48.020044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1BCF2F400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1BEF9DB80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1BEF9D9D0>]}


============================== 22:27:48.020044 | e8c8b329-9165-4d8e-b9ab-2854075e3858 ==============================
[0m22:27:48.020044 [info ] [MainThread]: Running with dbt=1.9.0
[0m22:27:48.020044 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'c:\\Users\\fitzp\\Documents\\Alpaca_Market\\zproject_2\\northwind_psql\\logs', 'profiles_dir': 'c:\\Users\\fitzp\\Documents\\Alpaca_Market\\zproject_2\\northwind_psql', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m22:27:48.066889 [info ] [MainThread]: dbt version: 1.9.0
[0m22:27:48.067840 [info ] [MainThread]: python version: 3.9.21
[0m22:27:48.068871 [info ] [MainThread]: python path: C:\Users\fitzp\anaconda3\envs\bootcamp\python.exe
[0m22:27:48.069890 [info ] [MainThread]: os info: Windows-10-10.0.26100-SP0
[0m22:27:49.420245 [info ] [MainThread]: Using profiles dir at c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql
[0m22:27:49.421843 [info ] [MainThread]: Using profiles.yml file at c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\profiles.yml
[0m22:27:49.422374 [info ] [MainThread]: Using dbt_project.yml file at c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\dbt_project.yml
[0m22:27:49.424473 [info ] [MainThread]: adapter type: snowflake
[0m22:27:49.425017 [info ] [MainThread]: adapter version: 1.9.0
[0m22:27:49.513103 [info ] [MainThread]: Configuration:
[0m22:27:49.514020 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m22:27:49.515104 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m22:27:49.515104 [info ] [MainThread]: Required dependencies:
[0m22:27:49.516103 [debug] [MainThread]: Executing "git --help"
[0m22:27:49.591283 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m22:27:49.592375 [debug] [MainThread]: STDERR: "b''"
[0m22:27:49.592375 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m22:27:49.594375 [info ] [MainThread]: Connection:
[0m22:27:49.594375 [info ] [MainThread]:   account: LBJYJAU-VHB74408
[0m22:27:49.595376 [info ] [MainThread]:   user: FITZPATRICK80
[0m22:27:49.596377 [info ] [MainThread]:   database: Project_2
[0m22:27:49.597375 [info ] [MainThread]:   warehouse: COMPUTE_WH
[0m22:27:49.598378 [info ] [MainThread]:   role: ACCOUNTADMIN
[0m22:27:49.598865 [info ] [MainThread]:   schema: public
[0m22:27:49.599979 [info ] [MainThread]:   authenticator: None
[0m22:27:49.600977 [info ] [MainThread]:   oauth_client_id: None
[0m22:27:49.600977 [info ] [MainThread]:   query_tag: None
[0m22:27:49.601976 [info ] [MainThread]:   client_session_keep_alive: False
[0m22:27:49.602975 [info ] [MainThread]:   host: None
[0m22:27:49.602975 [info ] [MainThread]:   port: None
[0m22:27:49.603976 [info ] [MainThread]:   proxy_host: None
[0m22:27:49.604980 [info ] [MainThread]:   proxy_port: None
[0m22:27:49.604980 [info ] [MainThread]:   protocol: None
[0m22:27:49.605977 [info ] [MainThread]:   connect_retries: 1
[0m22:27:49.606976 [info ] [MainThread]:   connect_timeout: None
[0m22:27:49.607592 [info ] [MainThread]:   retry_on_database_errors: False
[0m22:27:49.608853 [info ] [MainThread]:   retry_all: False
[0m22:27:49.609850 [info ] [MainThread]:   insecure_mode: False
[0m22:27:49.610853 [info ] [MainThread]:   reuse_connections: True
[0m22:27:49.610853 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m22:27:49.908000 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m22:27:50.123099 [debug] [MainThread]: Using snowflake connection "debug"
[0m22:27:50.123099 [debug] [MainThread]: On debug: select 1 as id
[0m22:27:50.123099 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:27:51.049059 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.924 seconds
[0m22:27:51.052159 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m22:27:51.054931 [info ] [MainThread]: [32mAll checks passed![0m
[0m22:27:51.059652 [debug] [MainThread]: Command `dbt debug` succeeded at 22:27:51.058927 after 3.13 seconds
[0m22:27:51.060296 [debug] [MainThread]: Connection 'debug' was left open.
[0m22:27:51.062176 [debug] [MainThread]: On debug: Close
[0m22:27:51.236467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1BCF2F400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1D7B69D30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1D8081E20>]}
[0m22:27:51.237756 [debug] [MainThread]: Flushing usage events
[0m22:27:52.008320 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:27:59.974262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AA2C6F400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AA4CE3B80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AA4CE39D0>]}


============================== 22:27:59.978461 | c7e83fe0-e332-4c7a-af52-214acf22ac04 ==============================
[0m22:27:59.978461 [info ] [MainThread]: Running with dbt=1.9.0
[0m22:27:59.978461 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'c:\\Users\\fitzp\\Documents\\Alpaca_Market\\zproject_2\\northwind_psql', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'c:\\Users\\fitzp\\Documents\\Alpaca_Market\\zproject_2\\northwind_psql\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:28:01.889971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c7e83fe0-e332-4c7a-af52-214acf22ac04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AA1C579A0>]}
[0m22:28:01.978335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c7e83fe0-e332-4c7a-af52-214acf22ac04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021ABD7D17F0>]}
[0m22:28:01.981346 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m22:28:02.475280 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m22:28:02.477289 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:28:02.477289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c7e83fe0-e332-4c7a-af52-214acf22ac04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021ABD84A6A0>]}
[0m22:28:03.862961 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.northwind_dbt.marts.bi
[0m22:28:03.878779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c7e83fe0-e332-4c7a-af52-214acf22ac04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021ABDF07130>]}
[0m22:28:04.126280 [debug] [MainThread]: Wrote artifact WritableManifest to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\manifest.json
[0m22:28:04.156470 [debug] [MainThread]: Wrote artifact SemanticManifest to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\semantic_manifest.json
[0m22:28:04.237876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c7e83fe0-e332-4c7a-af52-214acf22ac04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021ABDFB61C0>]}
[0m22:28:04.237876 [info ] [MainThread]: Found 9 models, 8 sources, 472 macros
[0m22:28:04.237876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c7e83fe0-e332-4c7a-af52-214acf22ac04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021ABDFB15E0>]}
[0m22:28:04.251119 [info ] [MainThread]: 
[0m22:28:04.251119 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:28:04.252891 [info ] [MainThread]: 
[0m22:28:04.255670 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:28:04.258456 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_Project_2'
[0m22:28:04.345516 [debug] [ThreadPool]: Using snowflake connection "list_Project_2"
[0m22:28:04.345516 [debug] [ThreadPool]: On list_Project_2: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "connection_name": "list_Project_2"} */
show terse schemas in database Project_2
    limit 10000
[0m22:28:04.345516 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:28:04.961605 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.606 seconds
[0m22:28:04.962320 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_Project_2_public'
[0m22:28:04.973740 [debug] [ThreadPool]: Using snowflake connection "list_Project_2_public"
[0m22:28:04.977319 [debug] [ThreadPool]: On list_Project_2_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "connection_name": "list_Project_2_public"} */
show objects in Project_2.public limit 10000;
[0m22:28:04.978266 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:28:05.562546 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 0.584 seconds
[0m22:28:05.563900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c7e83fe0-e332-4c7a-af52-214acf22ac04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AA1B62850>]}
[0m22:28:05.563900 [debug] [Thread-1  ]: Began running node model.northwind_dbt.stg_customers
[0m22:28:05.563900 [debug] [Thread-2  ]: Began running node model.northwind_dbt.stg_employees
[0m22:28:05.563900 [debug] [Thread-3  ]: Began running node model.northwind_dbt.stg_order_details
[0m22:28:05.639118 [debug] [Thread-4  ]: Began running node model.northwind_dbt.stg_orders
[0m22:28:05.639118 [info ] [Thread-1  ]: 1 of 9 START sql view model public.stg_customers ............................... [RUN]
[0m22:28:05.639118 [info ] [Thread-2  ]: 2 of 9 START sql view model public.stg_employees ............................... [RUN]
[0m22:28:05.639118 [info ] [Thread-3  ]: 3 of 9 START sql view model public.stg_order_details ........................... [RUN]
[0m22:28:05.645331 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.northwind_dbt.stg_customers'
[0m22:28:05.644917 [info ] [Thread-4  ]: 4 of 9 START sql view model public.stg_orders .................................. [RUN]
[0m22:28:05.645331 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.northwind_dbt.stg_employees'
[0m22:28:05.645331 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.northwind_dbt.stg_order_details'
[0m22:28:05.645331 [debug] [Thread-1  ]: Began compiling node model.northwind_dbt.stg_customers
[0m22:28:05.645331 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.northwind_dbt.stg_orders'
[0m22:28:05.645331 [debug] [Thread-2  ]: Began compiling node model.northwind_dbt.stg_employees
[0m22:28:05.645331 [debug] [Thread-3  ]: Began compiling node model.northwind_dbt.stg_order_details
[0m22:28:05.656673 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind_dbt.stg_customers"
[0m22:28:05.656673 [debug] [Thread-4  ]: Began compiling node model.northwind_dbt.stg_orders
[0m22:28:05.661596 [debug] [Thread-2  ]: Writing injected SQL for node "model.northwind_dbt.stg_employees"
[0m22:28:05.663604 [debug] [Thread-3  ]: Writing injected SQL for node "model.northwind_dbt.stg_order_details"
[0m22:28:05.670710 [debug] [Thread-4  ]: Writing injected SQL for node "model.northwind_dbt.stg_orders"
[0m22:28:05.679309 [debug] [Thread-1  ]: Began executing node model.northwind_dbt.stg_customers
[0m22:28:05.680320 [debug] [Thread-4  ]: Began executing node model.northwind_dbt.stg_orders
[0m22:28:05.681318 [debug] [Thread-2  ]: Began executing node model.northwind_dbt.stg_employees
[0m22:28:05.681318 [debug] [Thread-3  ]: Began executing node model.northwind_dbt.stg_order_details
[0m22:28:05.697665 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind_dbt.stg_customers"
[0m22:28:05.710136 [debug] [Thread-4  ]: Writing runtime sql for node "model.northwind_dbt.stg_orders"
[0m22:28:05.713568 [debug] [Thread-2  ]: Writing runtime sql for node "model.northwind_dbt.stg_employees"
[0m22:28:05.713568 [debug] [Thread-3  ]: Writing runtime sql for node "model.northwind_dbt.stg_order_details"
[0m22:28:05.728940 [debug] [Thread-3  ]: Using snowflake connection "model.northwind_dbt.stg_order_details"
[0m22:28:05.731094 [debug] [Thread-1  ]: Using snowflake connection "model.northwind_dbt.stg_customers"
[0m22:28:05.731094 [debug] [Thread-4  ]: Using snowflake connection "model.northwind_dbt.stg_orders"
[0m22:28:05.731094 [debug] [Thread-2  ]: Using snowflake connection "model.northwind_dbt.stg_employees"
[0m22:28:05.731094 [debug] [Thread-3  ]: On model.northwind_dbt.stg_order_details: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.stg_order_details"} */
create or replace   view Project_2.public.stg_order_details
  
   as (
    select * from PROJECT_2.PUBLIC.order_details;
[0m22:28:05.731094 [debug] [Thread-1  ]: On model.northwind_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.stg_customers"} */
create or replace   view Project_2.public.stg_customers
  
   as (
    select * from PROJECT_2.PUBLIC.customers;
[0m22:28:05.731094 [debug] [Thread-4  ]: On model.northwind_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.stg_orders"} */
create or replace   view Project_2.public.stg_orders
  
   as (
    select * from PROJECT_2.PUBLIC.orders;
[0m22:28:05.731094 [debug] [Thread-2  ]: On model.northwind_dbt.stg_employees: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.stg_employees"} */
create or replace   view Project_2.public.stg_employees
  
   as (
    select * from PROJECT_2.PUBLIC.employees;
[0m22:28:05.731094 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m22:28:05.731094 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m22:28:05.731094 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m22:28:05.731094 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m22:28:06.227031 [debug] [Thread-3  ]: Snowflake adapter: Snowflake query id: 01bba6f4-020d-0183-000c-83e7000b3106
[0m22:28:06.227031 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01bba6f4-020d-0183-000c-83e7000b3102
[0m22:28:06.227031 [debug] [Thread-3  ]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 4 at position 48 unexpected ';'.
[0m22:28:06.227031 [debug] [Thread-2  ]: Snowflake adapter: Snowflake query id: 01bba6f4-020d-00ac-000c-83e7000b6046
[0m22:28:06.227031 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 4 at position 44 unexpected ';'.
[0m22:28:06.227031 [debug] [Thread-2  ]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 4 at position 44 unexpected ';'.
[0m22:28:06.235131 [debug] [Thread-3  ]: Database Error in model stg_order_details (models\staging\stg_order_details.sql)
  001003 (42000): SQL compilation error:
  syntax error line 4 at position 48 unexpected ';'.
  compiled code at target\run\northwind_dbt\models\staging\stg_order_details.sql
[0m22:28:06.235131 [debug] [Thread-1  ]: Database Error in model stg_customers (models\staging\stg_customers.sql)
  001003 (42000): SQL compilation error:
  syntax error line 4 at position 44 unexpected ';'.
  compiled code at target\run\northwind_dbt\models\staging\stg_customers.sql
[0m22:28:06.235131 [debug] [Thread-2  ]: Database Error in model stg_employees (models\staging\stg_employees.sql)
  001003 (42000): SQL compilation error:
  syntax error line 4 at position 44 unexpected ';'.
  compiled code at target\run\northwind_dbt\models\staging\stg_employees.sql
[0m22:28:06.251259 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7e83fe0-e332-4c7a-af52-214acf22ac04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AA407CD90>]}
[0m22:28:06.251822 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7e83fe0-e332-4c7a-af52-214acf22ac04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AA1C57A30>]}
[0m22:28:06.252206 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7e83fe0-e332-4c7a-af52-214acf22ac04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021ABDD1B4C0>]}
[0m22:28:06.252206 [error] [Thread-3  ]: 3 of 9 ERROR creating sql view model public.stg_order_details .................. [[31mERROR[0m in 0.59s]
[0m22:28:06.252206 [error] [Thread-1  ]: 1 of 9 ERROR creating sql view model public.stg_customers ...................... [[31mERROR[0m in 0.59s]
[0m22:28:06.252206 [debug] [Thread-4  ]: Snowflake adapter: Snowflake query id: 01bba6f4-020d-034d-000c-83e7000ae29a
[0m22:28:06.252206 [debug] [Thread-3  ]: Finished running node model.northwind_dbt.stg_order_details
[0m22:28:06.252206 [error] [Thread-2  ]: 2 of 9 ERROR creating sql view model public.stg_employees ...................... [[31mERROR[0m in 0.59s]
[0m22:28:06.252206 [debug] [Thread-1  ]: Finished running node model.northwind_dbt.stg_customers
[0m22:28:06.252206 [debug] [Thread-4  ]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 4 at position 41 unexpected ';'.
[0m22:28:06.252206 [debug] [Thread-3  ]: Began running node model.northwind_dbt.stg_products
[0m22:28:06.252206 [debug] [Thread-7  ]: Marking all children of 'model.northwind_dbt.stg_order_details' to be skipped because of status 'error'.  Reason: Database Error in model stg_order_details (models\staging\stg_order_details.sql)
  001003 (42000): SQL compilation error:
  syntax error line 4 at position 48 unexpected ';'.
  compiled code at target\run\northwind_dbt\models\staging\stg_order_details.sql.
[0m22:28:06.252206 [debug] [Thread-2  ]: Finished running node model.northwind_dbt.stg_employees
[0m22:28:06.252206 [info ] [Thread-3  ]: 5 of 9 START sql view model public.stg_products ................................ [RUN]
[0m22:28:06.252206 [debug] [Thread-7  ]: Marking all children of 'model.northwind_dbt.stg_customers' to be skipped because of status 'error'.  Reason: Database Error in model stg_customers (models\staging\stg_customers.sql)
  001003 (42000): SQL compilation error:
  syntax error line 4 at position 44 unexpected ';'.
  compiled code at target\run\northwind_dbt\models\staging\stg_customers.sql.
[0m22:28:06.252206 [debug] [Thread-4  ]: Database Error in model stg_orders (models\staging\stg_orders.sql)
  001003 (42000): SQL compilation error:
  syntax error line 4 at position 41 unexpected ';'.
  compiled code at target\run\northwind_dbt\models\staging\stg_orders.sql
[0m22:28:06.252206 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.northwind_dbt.stg_order_details, now model.northwind_dbt.stg_products)
[0m22:28:06.267852 [debug] [Thread-7  ]: Marking all children of 'model.northwind_dbt.stg_employees' to be skipped because of status 'error'.  Reason: Database Error in model stg_employees (models\staging\stg_employees.sql)
  001003 (42000): SQL compilation error:
  syntax error line 4 at position 44 unexpected ';'.
  compiled code at target\run\northwind_dbt\models\staging\stg_employees.sql.
[0m22:28:06.267852 [debug] [Thread-1  ]: Began running node model.northwind_dbt.dim_customers
[0m22:28:06.268858 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7e83fe0-e332-4c7a-af52-214acf22ac04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021ABE3F91C0>]}
[0m22:28:06.269856 [debug] [Thread-3  ]: Began compiling node model.northwind_dbt.stg_products
[0m22:28:06.270855 [debug] [Thread-2  ]: Began running node model.northwind_dbt.dim_employees
[0m22:28:06.271857 [info ] [Thread-1  ]: 6 of 9 SKIP relation public.dim_customers ...................................... [[33mSKIP[0m]
[0m22:28:06.272853 [error] [Thread-4  ]: 4 of 9 ERROR creating sql view model public.stg_orders ......................... [[31mERROR[0m in 0.62s]
[0m22:28:06.273852 [debug] [Thread-3  ]: Writing injected SQL for node "model.northwind_dbt.stg_products"
[0m22:28:06.273852 [debug] [Thread-1  ]: Finished running node model.northwind_dbt.dim_customers
[0m22:28:06.273852 [info ] [Thread-2  ]: 7 of 9 SKIP relation public.dim_employees ...................................... [[33mSKIP[0m]
[0m22:28:06.273852 [debug] [Thread-4  ]: Finished running node model.northwind_dbt.stg_orders
[0m22:28:06.273852 [debug] [Thread-2  ]: Finished running node model.northwind_dbt.dim_employees
[0m22:28:06.273852 [debug] [Thread-7  ]: Marking all children of 'model.northwind_dbt.stg_orders' to be skipped because of status 'error'.  Reason: Database Error in model stg_orders (models\staging\stg_orders.sql)
  001003 (42000): SQL compilation error:
  syntax error line 4 at position 41 unexpected ';'.
  compiled code at target\run\northwind_dbt\models\staging\stg_orders.sql.
[0m22:28:06.285614 [debug] [Thread-1  ]: Began running node model.northwind_dbt.fact_order_details
[0m22:28:06.286618 [debug] [Thread-3  ]: Began executing node model.northwind_dbt.stg_products
[0m22:28:06.285614 [info ] [Thread-1  ]: 8 of 9 SKIP relation public.fact_order_details ................................. [[33mSKIP[0m]
[0m22:28:06.290046 [debug] [Thread-3  ]: Writing runtime sql for node "model.northwind_dbt.stg_products"
[0m22:28:06.290046 [debug] [Thread-1  ]: Finished running node model.northwind_dbt.fact_order_details
[0m22:28:06.294670 [debug] [Thread-3  ]: Using snowflake connection "model.northwind_dbt.stg_products"
[0m22:28:06.294670 [debug] [Thread-3  ]: On model.northwind_dbt.stg_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.stg_products"} */
create or replace   view Project_2.public.stg_products
  
   as (
    select * from PROJECT_2.PUBLIC.products;
[0m22:28:06.416926 [debug] [Thread-3  ]: Snowflake adapter: Snowflake query id: 01bba6f4-020d-03e4-000c-83e7000b12a6
[0m22:28:06.418953 [debug] [Thread-3  ]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 4 at position 43 unexpected ';'.
[0m22:28:06.418953 [debug] [Thread-3  ]: Database Error in model stg_products (models\staging\stg_products.sql)
  001003 (42000): SQL compilation error:
  syntax error line 4 at position 43 unexpected ';'.
  compiled code at target\run\northwind_dbt\models\staging\stg_products.sql
[0m22:28:06.425275 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7e83fe0-e332-4c7a-af52-214acf22ac04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021ABDCE29A0>]}
[0m22:28:06.429821 [error] [Thread-3  ]: 5 of 9 ERROR creating sql view model public.stg_products ....................... [[31mERROR[0m in 0.17s]
[0m22:28:06.429821 [debug] [Thread-3  ]: Finished running node model.northwind_dbt.stg_products
[0m22:28:06.433701 [debug] [Thread-7  ]: Marking all children of 'model.northwind_dbt.stg_products' to be skipped because of status 'error'.  Reason: Database Error in model stg_products (models\staging\stg_products.sql)
  001003 (42000): SQL compilation error:
  syntax error line 4 at position 43 unexpected ';'.
  compiled code at target\run\northwind_dbt\models\staging\stg_products.sql.
[0m22:28:06.433701 [debug] [Thread-2  ]: Began running node model.northwind_dbt.dim_products
[0m22:28:06.433701 [info ] [Thread-2  ]: 9 of 9 SKIP relation public.dim_products ....................................... [[33mSKIP[0m]
[0m22:28:06.433701 [debug] [Thread-2  ]: Finished running node model.northwind_dbt.dim_products
[0m22:28:06.439951 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:28:06.439951 [debug] [MainThread]: Connection 'list_Project_2' was left open.
[0m22:28:06.443338 [debug] [MainThread]: On list_Project_2: Close
[0m22:28:06.571924 [debug] [MainThread]: Connection 'list_Project_2_public' was left open.
[0m22:28:06.571924 [debug] [MainThread]: On list_Project_2_public: Close
[0m22:28:06.678048 [debug] [MainThread]: Connection 'model.northwind_dbt.stg_customers' was left open.
[0m22:28:06.680056 [debug] [MainThread]: On model.northwind_dbt.stg_customers: Close
[0m22:28:06.803339 [debug] [MainThread]: Connection 'model.northwind_dbt.stg_employees' was left open.
[0m22:28:06.803339 [debug] [MainThread]: On model.northwind_dbt.stg_employees: Close
[0m22:28:06.916326 [debug] [MainThread]: Connection 'model.northwind_dbt.stg_products' was left open.
[0m22:28:06.917326 [debug] [MainThread]: On model.northwind_dbt.stg_products: Close
[0m22:28:07.029188 [debug] [MainThread]: Connection 'model.northwind_dbt.stg_orders' was left open.
[0m22:28:07.034637 [debug] [MainThread]: On model.northwind_dbt.stg_orders: Close
[0m22:28:07.151819 [info ] [MainThread]: 
[0m22:28:07.151819 [info ] [MainThread]: Finished running 2 incremental models, 2 table models, 5 view models in 0 hours 0 minutes and 2.90 seconds (2.90s).
[0m22:28:07.151819 [debug] [MainThread]: Command end result
[0m22:28:07.378906 [debug] [MainThread]: Wrote artifact WritableManifest to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\manifest.json
[0m22:28:07.378906 [debug] [MainThread]: Wrote artifact SemanticManifest to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\semantic_manifest.json
[0m22:28:07.401326 [debug] [MainThread]: Wrote artifact RunExecutionResult to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\run_results.json
[0m22:28:07.402462 [info ] [MainThread]: 
[0m22:28:07.403691 [info ] [MainThread]: [31mCompleted with 5 errors, 0 partial successes, and 0 warnings:[0m
[0m22:28:07.404901 [info ] [MainThread]: 
[0m22:28:07.405496 [error] [MainThread]:   Database Error in model stg_order_details (models\staging\stg_order_details.sql)
  001003 (42000): SQL compilation error:
  syntax error line 4 at position 48 unexpected ';'.
  compiled code at target\run\northwind_dbt\models\staging\stg_order_details.sql
[0m22:28:07.406708 [info ] [MainThread]: 
[0m22:28:07.407302 [error] [MainThread]:   Database Error in model stg_customers (models\staging\stg_customers.sql)
  001003 (42000): SQL compilation error:
  syntax error line 4 at position 44 unexpected ';'.
  compiled code at target\run\northwind_dbt\models\staging\stg_customers.sql
[0m22:28:07.407892 [info ] [MainThread]: 
[0m22:28:07.410872 [error] [MainThread]:   Database Error in model stg_employees (models\staging\stg_employees.sql)
  001003 (42000): SQL compilation error:
  syntax error line 4 at position 44 unexpected ';'.
  compiled code at target\run\northwind_dbt\models\staging\stg_employees.sql
[0m22:28:07.412868 [info ] [MainThread]: 
[0m22:28:07.414866 [error] [MainThread]:   Database Error in model stg_orders (models\staging\stg_orders.sql)
  001003 (42000): SQL compilation error:
  syntax error line 4 at position 41 unexpected ';'.
  compiled code at target\run\northwind_dbt\models\staging\stg_orders.sql
[0m22:28:07.418101 [info ] [MainThread]: 
[0m22:28:07.418430 [error] [MainThread]:   Database Error in model stg_products (models\staging\stg_products.sql)
  001003 (42000): SQL compilation error:
  syntax error line 4 at position 43 unexpected ';'.
  compiled code at target\run\northwind_dbt\models\staging\stg_products.sql
[0m22:28:07.418430 [info ] [MainThread]: 
[0m22:28:07.418430 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=5 SKIP=4 TOTAL=9
[0m22:28:07.418430 [debug] [MainThread]: Command `dbt run` failed at 22:28:07.418430 after 7.53 seconds
[0m22:28:07.418430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AA2C6F400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AA3FA0850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021ABF696D90>]}
[0m22:28:07.418430 [debug] [MainThread]: Flushing usage events
[0m22:28:08.135512 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:30:58.244661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0A9FEF340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0AC063C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0AC063A60>]}


============================== 22:30:58.244661 | 429af7e1-623e-4b09-874b-53e3c75b1561 ==============================
[0m22:30:58.244661 [info ] [MainThread]: Running with dbt=1.9.0
[0m22:30:58.244661 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'c:\\Users\\fitzp\\Documents\\Alpaca_Market\\zproject_2\\northwind_psql', 'log_path': 'c:\\Users\\fitzp\\Documents\\Alpaca_Market\\zproject_2\\northwind_psql\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:30:59.115156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '429af7e1-623e-4b09-874b-53e3c75b1561', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0C4BA91F0>]}
[0m22:30:59.170008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '429af7e1-623e-4b09-874b-53e3c75b1561', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0ABEB8190>]}
[0m22:30:59.172098 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m22:30:59.529965 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m22:30:59.791724 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 8 files changed.
[0m22:30:59.791724 [debug] [MainThread]: Partial parsing: updated file: northwind_dbt://models\staging\stg_products.sql
[0m22:30:59.791724 [debug] [MainThread]: Partial parsing: updated file: northwind_dbt://models\marts\core\dim_customers.sql
[0m22:30:59.791724 [debug] [MainThread]: Partial parsing: updated file: northwind_dbt://models\marts\core\fact_order_details.sql
[0m22:30:59.791724 [debug] [MainThread]: Partial parsing: updated file: northwind_dbt://models\staging\stg_order_details.sql
[0m22:30:59.791724 [debug] [MainThread]: Partial parsing: updated file: northwind_dbt://models\staging\stg_customers.sql
[0m22:30:59.791724 [debug] [MainThread]: Partial parsing: updated file: northwind_dbt://models\staging\stg_employees.sql
[0m22:30:59.791724 [debug] [MainThread]: Partial parsing: updated file: northwind_dbt://models\marts\core\dim_products.sql
[0m22:30:59.791724 [debug] [MainThread]: Partial parsing: updated file: northwind_dbt://models\staging\stg_orders.sql
[0m22:31:00.126192 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.northwind_dbt.marts.bi
[0m22:31:00.145076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '429af7e1-623e-4b09-874b-53e3c75b1561', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0C51A6130>]}
[0m22:31:00.366745 [debug] [MainThread]: Wrote artifact WritableManifest to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\manifest.json
[0m22:31:00.373571 [debug] [MainThread]: Wrote artifact SemanticManifest to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\semantic_manifest.json
[0m22:31:00.455206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '429af7e1-623e-4b09-874b-53e3c75b1561', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0C5062370>]}
[0m22:31:00.457618 [info ] [MainThread]: Found 9 models, 8 sources, 472 macros
[0m22:31:00.460032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '429af7e1-623e-4b09-874b-53e3c75b1561', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0C4BD3EB0>]}
[0m22:31:00.462783 [info ] [MainThread]: 
[0m22:31:00.464488 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:31:00.466715 [info ] [MainThread]: 
[0m22:31:00.468704 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:31:00.493833 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_Project_2'
[0m22:31:00.668135 [debug] [ThreadPool]: Using snowflake connection "list_Project_2"
[0m22:31:00.669196 [debug] [ThreadPool]: On list_Project_2: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "connection_name": "list_Project_2"} */
show terse schemas in database Project_2
    limit 10000
[0m22:31:00.669731 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:31:01.454945 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.784 seconds
[0m22:31:01.465156 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_Project_2_public'
[0m22:31:01.490447 [debug] [ThreadPool]: Using snowflake connection "list_Project_2_public"
[0m22:31:01.492180 [debug] [ThreadPool]: On list_Project_2_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "connection_name": "list_Project_2_public"} */
show objects in Project_2.public limit 10000;
[0m22:31:01.493832 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:31:02.022599 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 0.541 seconds
[0m22:31:02.037505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '429af7e1-623e-4b09-874b-53e3c75b1561', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0C4ADCA90>]}
[0m22:31:02.037505 [debug] [Thread-1  ]: Began running node model.northwind_dbt.stg_customers
[0m22:31:02.037505 [debug] [Thread-2  ]: Began running node model.northwind_dbt.stg_employees
[0m22:31:02.037505 [debug] [Thread-3  ]: Began running node model.northwind_dbt.stg_order_details
[0m22:31:02.037505 [debug] [Thread-4  ]: Began running node model.northwind_dbt.stg_orders
[0m22:31:02.046101 [info ] [Thread-1  ]: 1 of 9 START sql view model public.stg_customers ............................... [RUN]
[0m22:31:02.050038 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.northwind_dbt.stg_customers'
[0m22:31:02.050038 [debug] [Thread-1  ]: Began compiling node model.northwind_dbt.stg_customers
[0m22:31:02.055458 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind_dbt.stg_customers"
[0m22:31:02.046101 [info ] [Thread-2  ]: 2 of 9 START sql view model public.stg_employees ............................... [RUN]
[0m22:31:02.047991 [info ] [Thread-3  ]: 3 of 9 START sql view model public.stg_order_details ........................... [RUN]
[0m22:31:02.049005 [info ] [Thread-4  ]: 4 of 9 START sql view model public.stg_orders .................................. [RUN]
[0m22:31:02.061707 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.northwind_dbt.stg_employees'
[0m22:31:02.061707 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.northwind_dbt.stg_order_details'
[0m22:31:02.065137 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.northwind_dbt.stg_orders'
[0m22:31:02.065137 [debug] [Thread-2  ]: Began compiling node model.northwind_dbt.stg_employees
[0m22:31:02.065137 [debug] [Thread-3  ]: Began compiling node model.northwind_dbt.stg_order_details
[0m22:31:02.065137 [debug] [Thread-4  ]: Began compiling node model.northwind_dbt.stg_orders
[0m22:31:02.065137 [debug] [Thread-2  ]: Writing injected SQL for node "model.northwind_dbt.stg_employees"
[0m22:31:02.065137 [debug] [Thread-3  ]: Writing injected SQL for node "model.northwind_dbt.stg_order_details"
[0m22:31:02.078986 [debug] [Thread-4  ]: Writing injected SQL for node "model.northwind_dbt.stg_orders"
[0m22:31:02.112968 [debug] [Thread-2  ]: Began executing node model.northwind_dbt.stg_employees
[0m22:31:02.112968 [debug] [Thread-4  ]: Began executing node model.northwind_dbt.stg_orders
[0m22:31:02.112968 [debug] [Thread-1  ]: Began executing node model.northwind_dbt.stg_customers
[0m22:31:02.112968 [debug] [Thread-3  ]: Began executing node model.northwind_dbt.stg_order_details
[0m22:31:02.149256 [debug] [Thread-2  ]: Writing runtime sql for node "model.northwind_dbt.stg_employees"
[0m22:31:02.153250 [debug] [Thread-4  ]: Writing runtime sql for node "model.northwind_dbt.stg_orders"
[0m22:31:02.157254 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind_dbt.stg_customers"
[0m22:31:02.161895 [debug] [Thread-3  ]: Writing runtime sql for node "model.northwind_dbt.stg_order_details"
[0m22:31:02.193885 [debug] [Thread-2  ]: Using snowflake connection "model.northwind_dbt.stg_employees"
[0m22:31:02.193885 [debug] [Thread-1  ]: Using snowflake connection "model.northwind_dbt.stg_customers"
[0m22:31:02.193885 [debug] [Thread-4  ]: Using snowflake connection "model.northwind_dbt.stg_orders"
[0m22:31:02.193885 [debug] [Thread-3  ]: Using snowflake connection "model.northwind_dbt.stg_order_details"
[0m22:31:02.193885 [debug] [Thread-2  ]: On model.northwind_dbt.stg_employees: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.stg_employees"} */
create or replace   view Project_2.public.stg_employees
  
   as (
    select * from PROJECT_2.PUBLIC.employees
  );
[0m22:31:02.193885 [debug] [Thread-1  ]: On model.northwind_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.stg_customers"} */
create or replace   view Project_2.public.stg_customers
  
   as (
    select * from PROJECT_2.PUBLIC.customers
  );
[0m22:31:02.193885 [debug] [Thread-4  ]: On model.northwind_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.stg_orders"} */
create or replace   view Project_2.public.stg_orders
  
   as (
    select * from PROJECT_2.PUBLIC.orders
  );
[0m22:31:02.193885 [debug] [Thread-3  ]: On model.northwind_dbt.stg_order_details: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.stg_order_details"} */
create or replace   view Project_2.public.stg_order_details
  
   as (
    select * from PROJECT_2.PUBLIC.order_details
  );
[0m22:31:02.193885 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m22:31:02.193885 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m22:31:02.193885 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m22:31:02.193885 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m22:31:03.029204 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.822 seconds
[0m22:31:03.047327 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '429af7e1-623e-4b09-874b-53e3c75b1561', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0C4B768E0>]}
[0m22:31:03.047327 [info ] [Thread-1  ]: 1 of 9 OK created sql view model public.stg_customers .......................... [[32mSUCCESS 1[0m in 0.99s]
[0m22:31:03.047327 [debug] [Thread-1  ]: Finished running node model.northwind_dbt.stg_customers
[0m22:31:03.047327 [debug] [Thread-1  ]: Began running node model.northwind_dbt.stg_products
[0m22:31:03.050822 [info ] [Thread-1  ]: 5 of 9 START sql view model public.stg_products ................................ [RUN]
[0m22:31:03.050822 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.northwind_dbt.stg_customers, now model.northwind_dbt.stg_products)
[0m22:31:03.050822 [debug] [Thread-1  ]: Began compiling node model.northwind_dbt.stg_products
[0m22:31:03.050822 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind_dbt.stg_products"
[0m22:31:03.067493 [debug] [Thread-1  ]: Began executing node model.northwind_dbt.stg_products
[0m22:31:03.073566 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind_dbt.stg_products"
[0m22:31:03.080329 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.879 seconds
[0m22:31:03.088780 [debug] [Thread-1  ]: Using snowflake connection "model.northwind_dbt.stg_products"
[0m22:31:03.093737 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '429af7e1-623e-4b09-874b-53e3c75b1561', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0C4BF48E0>]}
[0m22:31:03.093737 [debug] [Thread-1  ]: On model.northwind_dbt.stg_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.stg_products"} */
create or replace   view Project_2.public.stg_products
  
   as (
    select * from PROJECT_2.PUBLIC.products
  );
[0m22:31:03.093737 [info ] [Thread-4  ]: 4 of 9 OK created sql view model public.stg_orders ............................. [[32mSUCCESS 1[0m in 1.03s]
[0m22:31:03.093737 [debug] [Thread-4  ]: Finished running node model.northwind_dbt.stg_orders
[0m22:31:03.093737 [debug] [Thread-4  ]: Began running node model.northwind_dbt.dim_customers
[0m22:31:03.093737 [info ] [Thread-4  ]: 6 of 9 START sql table model public.dim_customers .............................. [RUN]
[0m22:31:03.093737 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.northwind_dbt.stg_orders, now model.northwind_dbt.dim_customers)
[0m22:31:03.093737 [debug] [Thread-4  ]: Began compiling node model.northwind_dbt.dim_customers
[0m22:31:03.109762 [debug] [Thread-4  ]: Writing injected SQL for node "model.northwind_dbt.dim_customers"
[0m22:31:03.117441 [debug] [Thread-4  ]: Began executing node model.northwind_dbt.dim_customers
[0m22:31:03.125277 [debug] [Thread-4  ]: Writing runtime sql for node "model.northwind_dbt.dim_customers"
[0m22:31:03.147377 [debug] [Thread-4  ]: Using snowflake connection "model.northwind_dbt.dim_customers"
[0m22:31:03.147377 [debug] [Thread-4  ]: On model.northwind_dbt.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.dim_customers"} */
create or replace transient table Project_2.public.dim_customers
         as
        (select * from Project_2.public.stg_customers
        );
[0m22:31:03.147377 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.946 seconds
[0m22:31:03.147377 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '429af7e1-623e-4b09-874b-53e3c75b1561', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0C5970D90>]}
[0m22:31:03.157069 [info ] [Thread-3  ]: 3 of 9 OK created sql view model public.stg_order_details ...................... [[32mSUCCESS 1[0m in 1.09s]
[0m22:31:03.158198 [debug] [Thread-3  ]: Finished running node model.northwind_dbt.stg_order_details
[0m22:31:03.159718 [debug] [Thread-3  ]: Began running node model.northwind_dbt.fact_order_details
[0m22:31:03.159718 [info ] [Thread-3  ]: 7 of 9 START sql incremental model public.fact_order_details ................... [RUN]
[0m22:31:03.159718 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.northwind_dbt.stg_order_details, now model.northwind_dbt.fact_order_details)
[0m22:31:03.159718 [debug] [Thread-3  ]: Began compiling node model.northwind_dbt.fact_order_details
[0m22:31:03.159718 [debug] [Thread-3  ]: Writing injected SQL for node "model.northwind_dbt.fact_order_details"
[0m22:31:03.173821 [debug] [Thread-3  ]: Began executing node model.northwind_dbt.fact_order_details
[0m22:31:03.213349 [debug] [Thread-3  ]: Writing runtime sql for node "model.northwind_dbt.fact_order_details"
[0m22:31:03.227028 [debug] [Thread-3  ]: Using snowflake connection "model.northwind_dbt.fact_order_details"
[0m22:31:03.228134 [debug] [Thread-3  ]: On model.northwind_dbt.fact_order_details: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.fact_order_details"} */
create or replace transient table Project_2.public.fact_order_details
         as
        (

with base as (
    select 
        od.order_id,
        od.product_id,
        o.customer_id,
        o.employee_id,
        o.ship_via as shipper_id,
        o.order_date,
        od.unit_price,
        od.quantity,
        od.discount,
        od.unit_price * od.quantity * (1 - od.discount) as revenue
    from Project_2.public.stg_order_details od
    join Project_2.public.stg_orders o on od.order_id = o.order_id
    
),
aggregated as (
    select 
        order_id,
        customer_id,
        employee_id,
        shipper_id,
        cast(order_date as date) as order_date,
        sum(revenue) as total_revenue,
        avg(revenue) as avg_revenue,
        max(revenue) as max_revenue,
        min(revenue) as min_revenue,
        count(*) as line_count,
        rank() over (partition by customer_id order by sum(revenue) desc) as revenue_rank
    from base
    group by order_id, customer_id, employee_id, shipper_id, order_date
)
select * from aggregated
        );
[0m22:31:03.347513 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.144 seconds
[0m22:31:03.354055 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '429af7e1-623e-4b09-874b-53e3c75b1561', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0C5952D30>]}
[0m22:31:03.354055 [info ] [Thread-2  ]: 2 of 9 OK created sql view model public.stg_employees .......................... [[32mSUCCESS 1[0m in 1.29s]
[0m22:31:03.358688 [debug] [Thread-2  ]: Finished running node model.northwind_dbt.stg_employees
[0m22:31:03.360703 [debug] [Thread-2  ]: Began running node model.northwind_dbt.dim_employees
[0m22:31:03.360703 [info ] [Thread-2  ]: 8 of 9 START sql incremental model public.dim_employees ........................ [RUN]
[0m22:31:03.360703 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.northwind_dbt.stg_employees, now model.northwind_dbt.dim_employees)
[0m22:31:03.365205 [debug] [Thread-2  ]: Began compiling node model.northwind_dbt.dim_employees
[0m22:31:03.417282 [debug] [Thread-2  ]: Compilation Error in model dim_employees (models\marts\core\dim_employees.sql)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m22:31:03.417282 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '429af7e1-623e-4b09-874b-53e3c75b1561', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0C69B7F70>]}
[0m22:31:03.421459 [error] [Thread-2  ]: 8 of 9 ERROR creating sql incremental model public.dim_employees ............... [[31mERROR[0m in 0.06s]
[0m22:31:03.423466 [debug] [Thread-2  ]: Finished running node model.northwind_dbt.dim_employees
[0m22:31:03.424761 [debug] [Thread-7  ]: Marking all children of 'model.northwind_dbt.dim_employees' to be skipped because of status 'error'.  Reason: Compilation Error in model dim_employees (models\marts\core\dim_employees.sql)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m22:31:03.457566 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.363 seconds
[0m22:31:03.457566 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '429af7e1-623e-4b09-874b-53e3c75b1561', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0C58B29D0>]}
[0m22:31:03.457566 [info ] [Thread-1  ]: 5 of 9 OK created sql view model public.stg_products ........................... [[32mSUCCESS 1[0m in 0.41s]
[0m22:31:03.468311 [debug] [Thread-1  ]: Finished running node model.northwind_dbt.stg_products
[0m22:31:03.468311 [debug] [Thread-2  ]: Began running node model.northwind_dbt.dim_products
[0m22:31:03.468311 [info ] [Thread-2  ]: 9 of 9 START sql table model public.dim_products ............................... [RUN]
[0m22:31:03.468311 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.northwind_dbt.dim_employees, now model.northwind_dbt.dim_products)
[0m22:31:03.468311 [debug] [Thread-2  ]: Began compiling node model.northwind_dbt.dim_products
[0m22:31:03.475078 [debug] [Thread-2  ]: Writing injected SQL for node "model.northwind_dbt.dim_products"
[0m22:31:03.481549 [debug] [Thread-2  ]: Began executing node model.northwind_dbt.dim_products
[0m22:31:03.485549 [debug] [Thread-2  ]: Writing runtime sql for node "model.northwind_dbt.dim_products"
[0m22:31:03.490193 [debug] [Thread-2  ]: Using snowflake connection "model.northwind_dbt.dim_products"
[0m22:31:03.491734 [debug] [Thread-2  ]: On model.northwind_dbt.dim_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.dim_products"} */
create or replace transient table Project_2.public.dim_products
         as
        (select 
    p.product_id,
    p.product_name,
    p.supplier_id,
    s.company_name as supplier_name,
    p.category_id,
    c.category_name,
    p.quantity_per_unit,
    p.unit_price,
    p.units_in_stock,
    p.units_on_order,
    p.reorder_level,
    p.discontinued
from Project_2.public.stg_products p
left join PROJECT_2.PUBLIC.suppliers s on p.supplier_id = s.supplier_id
left join PROJECT_2.PUBLIC.categories c on p.category_id = c.category_id
        );
[0m22:31:04.569006 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1.421 seconds
[0m22:31:04.573365 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '429af7e1-623e-4b09-874b-53e3c75b1561', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0C58B2E20>]}
[0m22:31:04.574641 [info ] [Thread-4  ]: 6 of 9 OK created sql table model public.dim_customers ......................... [[32mSUCCESS 1[0m in 1.48s]
[0m22:31:04.576343 [debug] [Thread-4  ]: Finished running node model.northwind_dbt.dim_customers
[0m22:31:04.993619 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1.768 seconds
[0m22:31:05.003809 [debug] [Thread-3  ]: Applying DROP to: Project_2.public.fact_order_details__dbt_tmp
[0m22:31:05.011963 [debug] [Thread-3  ]: Using snowflake connection "model.northwind_dbt.fact_order_details"
[0m22:31:05.011963 [debug] [Thread-3  ]: On model.northwind_dbt.fact_order_details: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.fact_order_details"} */
drop table if exists Project_2.public.fact_order_details__dbt_tmp cascade
[0m22:31:05.028094 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.542 seconds
[0m22:31:05.028094 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '429af7e1-623e-4b09-874b-53e3c75b1561', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0C59140D0>]}
[0m22:31:05.028094 [info ] [Thread-2  ]: 9 of 9 OK created sql table model public.dim_products .......................... [[32mSUCCESS 1[0m in 1.56s]
[0m22:31:05.028094 [debug] [Thread-2  ]: Finished running node model.northwind_dbt.dim_products
[0m22:31:05.407072 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.395 seconds
[0m22:31:05.409088 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '429af7e1-623e-4b09-874b-53e3c75b1561', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0C5970D90>]}
[0m22:31:05.409088 [info ] [Thread-3  ]: 7 of 9 OK created sql incremental model public.fact_order_details .............. [[32mSUCCESS 1[0m in 2.25s]
[0m22:31:05.409088 [debug] [Thread-3  ]: Finished running node model.northwind_dbt.fact_order_details
[0m22:31:05.409088 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:31:05.409088 [debug] [MainThread]: Connection 'list_Project_2' was left open.
[0m22:31:05.409088 [debug] [MainThread]: On list_Project_2: Close
[0m22:31:05.551828 [debug] [MainThread]: Connection 'list_Project_2_public' was left open.
[0m22:31:05.551828 [debug] [MainThread]: On list_Project_2_public: Close
[0m22:31:05.674063 [debug] [MainThread]: Connection 'model.northwind_dbt.stg_products' was left open.
[0m22:31:05.674063 [debug] [MainThread]: On model.northwind_dbt.stg_products: Close
[0m22:31:05.776619 [debug] [MainThread]: Connection 'model.northwind_dbt.dim_products' was left open.
[0m22:31:05.776619 [debug] [MainThread]: On model.northwind_dbt.dim_products: Close
[0m22:31:05.906418 [debug] [MainThread]: Connection 'model.northwind_dbt.fact_order_details' was left open.
[0m22:31:05.906418 [debug] [MainThread]: On model.northwind_dbt.fact_order_details: Close
[0m22:31:06.014481 [debug] [MainThread]: Connection 'model.northwind_dbt.dim_customers' was left open.
[0m22:31:06.014481 [debug] [MainThread]: On model.northwind_dbt.dim_customers: Close
[0m22:31:06.155322 [info ] [MainThread]: 
[0m22:31:06.157185 [info ] [MainThread]: Finished running 2 incremental models, 2 table models, 5 view models in 0 hours 0 minutes and 5.68 seconds (5.68s).
[0m22:31:06.160428 [debug] [MainThread]: Command end result
[0m22:31:06.336028 [debug] [MainThread]: Wrote artifact WritableManifest to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\manifest.json
[0m22:31:06.336028 [debug] [MainThread]: Wrote artifact SemanticManifest to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\semantic_manifest.json
[0m22:31:06.366789 [debug] [MainThread]: Wrote artifact RunExecutionResult to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\run_results.json
[0m22:31:06.366789 [info ] [MainThread]: 
[0m22:31:06.366789 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m22:31:06.366789 [info ] [MainThread]: 
[0m22:31:06.366789 [error] [MainThread]:   Compilation Error in model dim_employees (models\marts\core\dim_employees.sql)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m22:31:06.366789 [info ] [MainThread]: 
[0m22:31:06.366789 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=1 SKIP=0 TOTAL=9
[0m22:31:06.378810 [debug] [MainThread]: Command `dbt run` failed at 22:31:06.378810 after 8.23 seconds
[0m22:31:06.378810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0A9FEF340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0ABEB8190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0C5062BE0>]}
[0m22:31:06.378810 [debug] [MainThread]: Flushing usage events
[0m22:31:07.267240 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:36:33.918098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255CCC4F3D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255CECBEB80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255CECBE970>]}


============================== 22:36:33.921968 | b2ab7581-3c60-4640-b9a4-bf71a80b03cb ==============================
[0m22:36:33.921968 [info ] [MainThread]: Running with dbt=1.9.0
[0m22:36:33.922653 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'c:\\Users\\fitzp\\Documents\\Alpaca_Market\\zproject_2\\northwind_psql\\logs', 'fail_fast': 'False', 'profiles_dir': 'c:\\Users\\fitzp\\Documents\\Alpaca_Market\\zproject_2\\northwind_psql', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:36:34.064560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b2ab7581-3c60-4640-b9a4-bf71a80b03cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255CECBEA30>]}
[0m22:36:34.139702 [debug] [MainThread]: Set downloads directory='C:\Users\fitzp\AppData\Local\Temp\dbt-downloads-9q2o2lbx'
[0m22:36:34.140701 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:36:34.956699 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:36:34.956699 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:36:35.455086 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:36:35.473875 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json
[0m22:36:35.960457 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json 200
[0m22:36:35.960457 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `calogica/dbt_date` package is deprecated in favor of
`godatadriven/dbt_date`. Please update your `packages.yml` configuration to use
`godatadriven/dbt_date` instead.
[0m22:36:35.960457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b2ab7581-3c60-4640-b9a4-bf71a80b03cb', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255CEE4F8B0>]}
[0m22:36:35.964720 [info ] [MainThread]: Updating lock file in file path: C:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql/package-lock.yml
[0m22:36:35.981606 [debug] [MainThread]: Set downloads directory='C:\Users\fitzp\AppData\Local\Temp\dbt-downloads-pj7ae1pz'
[0m22:36:35.985419 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:36:38.911969 [info ] [MainThread]: Installed from version 1.1.1
[0m22:36:38.911969 [info ] [MainThread]: Updated version available: 1.3.0
[0m22:36:38.911969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'b2ab7581-3c60-4640-b9a4-bf71a80b03cb', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255CEE37760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255CEE37DF0>]}
[0m22:36:38.911969 [info ] [MainThread]: Installing calogica/dbt_date
[0m22:36:40.183834 [info ] [MainThread]: Installed from version 0.9.2
[0m22:36:40.184946 [info ] [MainThread]: Updated version available: 0.10.1
[0m22:36:40.185962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'b2ab7581-3c60-4640-b9a4-bf71a80b03cb', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255CED51AC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255CEC54D00>]}
[0m22:36:40.187478 [info ] [MainThread]: 
[0m22:36:40.188490 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils', 'calogica/dbt_date']                 
Update your versions in packages.yml, then run dbt deps
[0m22:36:40.207854 [debug] [MainThread]: Command `dbt deps` succeeded at 22:36:40.207854 after 6.38 seconds
[0m22:36:40.207854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255CCC4F3D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255CECBEA30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255CEC54D00>]}
[0m22:36:40.207854 [debug] [MainThread]: Flushing usage events
[0m22:36:41.228816 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:37:02.964133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1C56003D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1C7673CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1C7673AC0>]}


============================== 22:37:02.966194 | 523f8657-7bdc-48c9-bfef-881b88c784ab ==============================
[0m22:37:02.966194 [info ] [MainThread]: Running with dbt=1.9.0
[0m22:37:02.966194 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'c:\\Users\\fitzp\\Documents\\Alpaca_Market\\zproject_2\\northwind_psql\\logs', 'profiles_dir': 'c:\\Users\\fitzp\\Documents\\Alpaca_Market\\zproject_2\\northwind_psql', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m22:37:03.834038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '523f8657-7bdc-48c9-bfef-881b88c784ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1C45E7F40>]}
[0m22:37:03.892057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '523f8657-7bdc-48c9-bfef-881b88c784ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1E0112820>]}
[0m22:37:03.892057 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m22:37:04.265655 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m22:37:04.349108 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m22:37:04.349108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '523f8657-7bdc-48c9-bfef-881b88c784ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1C6FC7790>]}
[0m22:37:05.911596 [error] [MainThread]: Encountered an error:
Compilation Error in model dim_employees (models\marts\core\dim_employees.sql)
  
  Warning: `dbt_utils.surrogate_key` has been replaced by `dbt_utils.generate_surrogate_key`. The new macro treats null values differently to empty strings. To restore the behaviour of the original macro, add a global variable in dbt_project.yml called `surrogate_key_treat_nulls_as_empty_strings` to your dbt_project.yml file with a value of True. The northwind_dbt.dim_employees model triggered this warning. 
  
  > in macro default__surrogate_key (macros\sql\surrogate_key.sql)
  > called by macro surrogate_key (macros\sql\surrogate_key.sql)
  > called by model dim_employees (models\marts\core\dim_employees.sql)
[0m22:37:05.911596 [debug] [MainThread]: Command `dbt run` failed at 22:37:05.911596 after 3.05 seconds
[0m22:37:05.911596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1C56003D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1E04BADF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1E07B1850>]}
[0m22:37:05.911596 [debug] [MainThread]: Flushing usage events
[0m22:37:06.530369 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:43:45.940044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D7950F340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D7B583C40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D7B583A30>]}


============================== 22:43:45.944084 | c32a81ce-37c7-429f-9639-b0a24baf0e0c ==============================
[0m22:43:45.944084 [info ] [MainThread]: Running with dbt=1.9.0
[0m22:43:45.944084 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'c:\\Users\\fitzp\\Documents\\Alpaca_Market\\zproject_2\\northwind_psql', 'version_check': 'True', 'debug': 'False', 'log_path': 'c:\\Users\\fitzp\\Documents\\Alpaca_Market\\zproject_2\\northwind_psql\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m22:43:46.722535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c32a81ce-37c7-429f-9639-b0a24baf0e0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D784F7850>]}
[0m22:43:46.772823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c32a81ce-37c7-429f-9639-b0a24baf0e0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D140710A0>]}
[0m22:43:46.772823 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m22:43:47.099262 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m22:43:47.189444 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m22:43:47.189444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c32a81ce-37c7-429f-9639-b0a24baf0e0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D7A8A1100>]}
[0m22:43:48.796886 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.northwind_dbt.marts.bi
[0m22:43:48.805776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c32a81ce-37c7-429f-9639-b0a24baf0e0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D14847B20>]}
[0m22:43:49.042341 [debug] [MainThread]: Wrote artifact WritableManifest to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\manifest.json
[0m22:43:49.051197 [debug] [MainThread]: Wrote artifact SemanticManifest to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\semantic_manifest.json
[0m22:43:49.118906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c32a81ce-37c7-429f-9639-b0a24baf0e0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D14813130>]}
[0m22:43:49.118906 [info ] [MainThread]: Found 9 models, 8 sources, 706 macros
[0m22:43:49.118906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c32a81ce-37c7-429f-9639-b0a24baf0e0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D14847100>]}
[0m22:43:49.118906 [info ] [MainThread]: 
[0m22:43:49.118906 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:43:49.118906 [info ] [MainThread]: 
[0m22:43:49.118906 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:43:49.136948 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_Project_2'
[0m22:43:49.217125 [debug] [ThreadPool]: Using snowflake connection "list_Project_2"
[0m22:43:49.217125 [debug] [ThreadPool]: On list_Project_2: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "connection_name": "list_Project_2"} */
show terse schemas in database Project_2
    limit 10000
[0m22:43:49.217125 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:43:49.954811 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.734 seconds
[0m22:43:49.961240 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_Project_2_public'
[0m22:43:49.970818 [debug] [ThreadPool]: Using snowflake connection "list_Project_2_public"
[0m22:43:49.970818 [debug] [ThreadPool]: On list_Project_2_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "connection_name": "list_Project_2_public"} */
show objects in Project_2.public limit 10000;
[0m22:43:49.970818 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:43:50.485127 [debug] [ThreadPool]: SQL status: SUCCESS 22 in 0.512 seconds
[0m22:43:50.492277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c32a81ce-37c7-429f-9639-b0a24baf0e0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D14813E50>]}
[0m22:43:50.496209 [debug] [Thread-1  ]: Began running node model.northwind_dbt.stg_customers
[0m22:43:50.496209 [debug] [Thread-2  ]: Began running node model.northwind_dbt.stg_employees
[0m22:43:50.499073 [debug] [Thread-3  ]: Began running node model.northwind_dbt.stg_order_details
[0m22:43:50.499073 [debug] [Thread-4  ]: Began running node model.northwind_dbt.stg_orders
[0m22:43:50.500152 [info ] [Thread-1  ]: 1 of 9 START sql view model public.stg_customers ............................... [RUN]
[0m22:43:50.500659 [info ] [Thread-2  ]: 2 of 9 START sql view model public.stg_employees ............................... [RUN]
[0m22:43:50.500659 [info ] [Thread-3  ]: 3 of 9 START sql view model public.stg_order_details ........................... [RUN]
[0m22:43:50.502677 [info ] [Thread-4  ]: 4 of 9 START sql view model public.stg_orders .................................. [RUN]
[0m22:43:50.502677 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.northwind_dbt.stg_customers'
[0m22:43:50.506876 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.northwind_dbt.stg_employees'
[0m22:43:50.508613 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.northwind_dbt.stg_order_details'
[0m22:43:50.509177 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.northwind_dbt.stg_orders'
[0m22:43:50.510229 [debug] [Thread-1  ]: Began compiling node model.northwind_dbt.stg_customers
[0m22:43:50.510854 [debug] [Thread-2  ]: Began compiling node model.northwind_dbt.stg_employees
[0m22:43:50.511383 [debug] [Thread-3  ]: Began compiling node model.northwind_dbt.stg_order_details
[0m22:43:50.511969 [debug] [Thread-4  ]: Began compiling node model.northwind_dbt.stg_orders
[0m22:43:50.519120 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind_dbt.stg_customers"
[0m22:43:50.519120 [debug] [Thread-2  ]: Writing injected SQL for node "model.northwind_dbt.stg_employees"
[0m22:43:50.519120 [debug] [Thread-3  ]: Writing injected SQL for node "model.northwind_dbt.stg_order_details"
[0m22:43:50.530514 [debug] [Thread-4  ]: Writing injected SQL for node "model.northwind_dbt.stg_orders"
[0m22:43:50.558901 [debug] [Thread-4  ]: Began executing node model.northwind_dbt.stg_orders
[0m22:43:50.558901 [debug] [Thread-2  ]: Began executing node model.northwind_dbt.stg_employees
[0m22:43:50.558901 [debug] [Thread-1  ]: Began executing node model.northwind_dbt.stg_customers
[0m22:43:50.558901 [debug] [Thread-3  ]: Began executing node model.northwind_dbt.stg_order_details
[0m22:43:50.584806 [debug] [Thread-4  ]: Writing runtime sql for node "model.northwind_dbt.stg_orders"
[0m22:43:50.588830 [debug] [Thread-2  ]: Writing runtime sql for node "model.northwind_dbt.stg_employees"
[0m22:43:50.591832 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind_dbt.stg_customers"
[0m22:43:50.595601 [debug] [Thread-3  ]: Writing runtime sql for node "model.northwind_dbt.stg_order_details"
[0m22:43:50.614993 [debug] [Thread-3  ]: Using snowflake connection "model.northwind_dbt.stg_order_details"
[0m22:43:50.614993 [debug] [Thread-1  ]: Using snowflake connection "model.northwind_dbt.stg_customers"
[0m22:43:50.614993 [debug] [Thread-2  ]: Using snowflake connection "model.northwind_dbt.stg_employees"
[0m22:43:50.614993 [debug] [Thread-3  ]: On model.northwind_dbt.stg_order_details: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.stg_order_details"} */
create or replace   view Project_2.public.stg_order_details
  
   as (
    select * from PROJECT_2.PUBLIC.order_details
  );
[0m22:43:50.614993 [debug] [Thread-1  ]: On model.northwind_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.stg_customers"} */
create or replace   view Project_2.public.stg_customers
  
   as (
    select * from PROJECT_2.PUBLIC.customers
  );
[0m22:43:50.630001 [debug] [Thread-4  ]: Using snowflake connection "model.northwind_dbt.stg_orders"
[0m22:43:50.630783 [debug] [Thread-2  ]: On model.northwind_dbt.stg_employees: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.stg_employees"} */
create or replace   view Project_2.public.stg_employees
  
   as (
    select * from PROJECT_2.PUBLIC.employees
  );
[0m22:43:50.631490 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m22:43:50.631490 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m22:43:50.631490 [debug] [Thread-4  ]: On model.northwind_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.stg_orders"} */
create or replace   view Project_2.public.stg_orders
  
   as (
    select * from PROJECT_2.PUBLIC.orders
  );
[0m22:43:50.631490 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m22:43:50.636179 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m22:43:51.340337 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.708 seconds
[0m22:43:51.378916 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.746 seconds
[0m22:43:51.383347 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c32a81ce-37c7-429f-9639-b0a24baf0e0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D14E220D0>]}
[0m22:43:51.384491 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c32a81ce-37c7-429f-9639-b0a24baf0e0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D14E8BC10>]}
[0m22:43:51.386728 [info ] [Thread-3  ]: 3 of 9 OK created sql view model public.stg_order_details ...................... [[32mSUCCESS 1[0m in 0.87s]
[0m22:43:51.388970 [info ] [Thread-1  ]: 1 of 9 OK created sql view model public.stg_customers .......................... [[32mSUCCESS 1[0m in 0.88s]
[0m22:43:51.391184 [debug] [Thread-3  ]: Finished running node model.northwind_dbt.stg_order_details
[0m22:43:51.392826 [debug] [Thread-1  ]: Finished running node model.northwind_dbt.stg_customers
[0m22:43:51.393987 [debug] [Thread-3  ]: Began running node model.northwind_dbt.stg_products
[0m22:43:51.396234 [debug] [Thread-1  ]: Began running node model.northwind_dbt.dim_customers
[0m22:43:51.397941 [info ] [Thread-3  ]: 5 of 9 START sql view model public.stg_products ................................ [RUN]
[0m22:43:51.400153 [info ] [Thread-1  ]: 6 of 9 START sql table model public.dim_customers .............................. [RUN]
[0m22:43:51.402188 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.northwind_dbt.stg_order_details, now model.northwind_dbt.stg_products)
[0m22:43:51.404558 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.northwind_dbt.stg_customers, now model.northwind_dbt.dim_customers)
[0m22:43:51.406423 [debug] [Thread-3  ]: Began compiling node model.northwind_dbt.stg_products
[0m22:43:51.408125 [debug] [Thread-1  ]: Began compiling node model.northwind_dbt.dim_customers
[0m22:43:51.413924 [debug] [Thread-3  ]: Writing injected SQL for node "model.northwind_dbt.stg_products"
[0m22:43:51.422482 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind_dbt.dim_customers"
[0m22:43:51.439875 [debug] [Thread-3  ]: Began executing node model.northwind_dbt.stg_products
[0m22:43:51.441117 [debug] [Thread-1  ]: Began executing node model.northwind_dbt.dim_customers
[0m22:43:51.447892 [debug] [Thread-3  ]: Writing runtime sql for node "model.northwind_dbt.stg_products"
[0m22:43:51.450804 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.817 seconds
[0m22:43:51.502431 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind_dbt.dim_customers"
[0m22:43:51.507110 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.867 seconds
[0m22:43:51.515547 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c32a81ce-37c7-429f-9639-b0a24baf0e0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D14EA81C0>]}
[0m22:43:51.523712 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c32a81ce-37c7-429f-9639-b0a24baf0e0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D14E0C820>]}
[0m22:43:51.526801 [debug] [Thread-3  ]: Using snowflake connection "model.northwind_dbt.stg_products"
[0m22:43:51.528762 [info ] [Thread-2  ]: 2 of 9 OK created sql view model public.stg_employees .......................... [[32mSUCCESS 1[0m in 1.01s]
[0m22:43:51.530548 [info ] [Thread-4  ]: 4 of 9 OK created sql view model public.stg_orders ............................. [[32mSUCCESS 1[0m in 1.01s]
[0m22:43:51.535224 [debug] [Thread-3  ]: On model.northwind_dbt.stg_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.stg_products"} */
create or replace   view Project_2.public.stg_products
  
   as (
    select * from PROJECT_2.PUBLIC.products
  );
[0m22:43:51.537105 [debug] [Thread-1  ]: Using snowflake connection "model.northwind_dbt.dim_customers"
[0m22:43:51.540660 [debug] [Thread-2  ]: Finished running node model.northwind_dbt.stg_employees
[0m22:43:51.542724 [debug] [Thread-4  ]: Finished running node model.northwind_dbt.stg_orders
[0m22:43:51.547087 [debug] [Thread-1  ]: On model.northwind_dbt.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.dim_customers"} */
create or replace transient table Project_2.public.dim_customers
         as
        (select * from Project_2.public.stg_customers
        );
[0m22:43:51.550661 [debug] [Thread-2  ]: Began running node model.northwind_dbt.dim_employees
[0m22:43:51.554843 [debug] [Thread-4  ]: Began running node model.northwind_dbt.fact_order_details
[0m22:43:51.560017 [info ] [Thread-2  ]: 7 of 9 START sql incremental model public.dim_employees ........................ [RUN]
[0m22:43:51.564612 [info ] [Thread-4  ]: 8 of 9 START sql incremental model public.fact_order_details ................... [RUN]
[0m22:43:51.567399 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.northwind_dbt.stg_employees, now model.northwind_dbt.dim_employees)
[0m22:43:51.569929 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.northwind_dbt.stg_orders, now model.northwind_dbt.fact_order_details)
[0m22:43:51.571652 [debug] [Thread-2  ]: Began compiling node model.northwind_dbt.dim_employees
[0m22:43:51.572729 [debug] [Thread-4  ]: Began compiling node model.northwind_dbt.fact_order_details
[0m22:43:51.581620 [debug] [Thread-2  ]: Writing injected SQL for node "model.northwind_dbt.dim_employees"
[0m22:43:51.596122 [debug] [Thread-4  ]: Writing injected SQL for node "model.northwind_dbt.fact_order_details"
[0m22:43:51.616860 [debug] [Thread-2  ]: Began executing node model.northwind_dbt.dim_employees
[0m22:43:51.636187 [debug] [Thread-4  ]: Began executing node model.northwind_dbt.fact_order_details
[0m22:43:51.725314 [debug] [Thread-4  ]: Using snowflake connection "model.northwind_dbt.fact_order_details"
[0m22:43:51.725314 [debug] [Thread-2  ]: Writing runtime sql for node "model.northwind_dbt.dim_employees"
[0m22:43:51.730987 [debug] [Thread-4  ]: On model.northwind_dbt.fact_order_details: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.fact_order_details"} */
create or replace temporary table Project_2.public.fact_order_details__dbt_tmp
         as
        (

with base as (
    select 
        od.order_id,
        od.product_id,
        o.customer_id,
        o.employee_id,
        o.ship_via as shipper_id,
        o.order_date,
        od.unit_price,
        od.quantity,
        od.discount,
        od.unit_price * od.quantity * (1 - od.discount) as revenue
    from Project_2.public.stg_order_details od
    join Project_2.public.stg_orders o on od.order_id = o.order_id
    
        where o.order_date >= (select max(order_date) from Project_2.public.fact_order_details)
    
),
aggregated as (
    select 
        order_id,
        customer_id,
        employee_id,
        shipper_id,
        cast(order_date as date) as order_date,
        sum(revenue) as total_revenue,
        avg(revenue) as avg_revenue,
        max(revenue) as max_revenue,
        min(revenue) as min_revenue,
        count(*) as line_count,
        rank() over (partition by customer_id order by sum(revenue) desc) as revenue_rank
    from base
    group by order_id, customer_id, employee_id, shipper_id, order_date
)
select * from aggregated
        );
[0m22:43:51.741455 [debug] [Thread-2  ]: Using snowflake connection "model.northwind_dbt.dim_employees"
[0m22:43:51.743086 [debug] [Thread-2  ]: On model.northwind_dbt.dim_employees: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.dim_employees"} */
create or replace transient table Project_2.public.dim_employees
         as
        (

with source_data as (
    select * from Project_2.public.stg_employees
),
scd2 as (
    select 
        md5(cast(coalesce(cast(employee_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as employee_key,
        *,
        current_timestamp as dbt_updated_at
    from source_data
)
select * from scd2
        );
[0m22:43:52.182636 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.639 seconds
[0m22:43:52.189461 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c32a81ce-37c7-429f-9639-b0a24baf0e0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D14E86E50>]}
[0m22:43:52.191049 [info ] [Thread-3  ]: 5 of 9 OK created sql view model public.stg_products ........................... [[32mSUCCESS 1[0m in 0.79s]
[0m22:43:52.193283 [debug] [Thread-3  ]: Finished running node model.northwind_dbt.stg_products
[0m22:43:52.195412 [debug] [Thread-3  ]: Began running node model.northwind_dbt.dim_products
[0m22:43:52.197025 [info ] [Thread-3  ]: 9 of 9 START sql table model public.dim_products ............................... [RUN]
[0m22:43:52.198640 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.northwind_dbt.stg_products, now model.northwind_dbt.dim_products)
[0m22:43:52.200439 [debug] [Thread-3  ]: Began compiling node model.northwind_dbt.dim_products
[0m22:43:52.207636 [debug] [Thread-3  ]: Writing injected SQL for node "model.northwind_dbt.dim_products"
[0m22:43:52.220773 [debug] [Thread-3  ]: Began executing node model.northwind_dbt.dim_products
[0m22:43:52.226121 [debug] [Thread-3  ]: Writing runtime sql for node "model.northwind_dbt.dim_products"
[0m22:43:52.241057 [debug] [Thread-3  ]: Using snowflake connection "model.northwind_dbt.dim_products"
[0m22:43:52.242817 [debug] [Thread-3  ]: On model.northwind_dbt.dim_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.dim_products"} */
create or replace transient table Project_2.public.dim_products
         as
        (select 
    p.product_id,
    p.product_name,
    p.supplier_id,
    s.company_name as supplier_name,
    p.category_id,
    c.category_name,
    p.quantity_per_unit,
    p.unit_price,
    p.units_in_stock,
    p.units_on_order,
    p.reorder_level,
    p.discontinued
from Project_2.public.stg_products p
left join PROJECT_2.PUBLIC.suppliers s on p.supplier_id = s.supplier_id
left join PROJECT_2.PUBLIC.categories c on p.category_id = c.category_id
        );
[0m22:43:53.510042 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.766 seconds
[0m22:43:53.527349 [debug] [Thread-2  ]: Applying DROP to: Project_2.public.dim_employees__dbt_tmp
[0m22:43:53.530228 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.976 seconds
[0m22:43:53.540045 [debug] [Thread-2  ]: Using snowflake connection "model.northwind_dbt.dim_employees"
[0m22:43:53.543141 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c32a81ce-37c7-429f-9639-b0a24baf0e0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D15F0E040>]}
[0m22:43:53.544158 [debug] [Thread-2  ]: On model.northwind_dbt.dim_employees: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.dim_employees"} */
drop view if exists Project_2.public.dim_employees__dbt_tmp cascade
[0m22:43:53.545199 [info ] [Thread-1  ]: 6 of 9 OK created sql table model public.dim_customers ......................... [[32mSUCCESS 1[0m in 2.14s]
[0m22:43:53.547357 [debug] [Thread-1  ]: Finished running node model.northwind_dbt.dim_customers
[0m22:43:53.567259 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1.841 seconds
[0m22:43:53.582960 [debug] [Thread-4  ]: Using snowflake connection "model.northwind_dbt.fact_order_details"
[0m22:43:53.582960 [debug] [Thread-4  ]: On model.northwind_dbt.fact_order_details: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.fact_order_details"} */
describe table Project_2.public.fact_order_details__dbt_tmp
[0m22:43:53.637318 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.091 seconds
[0m22:43:53.638317 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c32a81ce-37c7-429f-9639-b0a24baf0e0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D15FCA880>]}
[0m22:43:53.638317 [info ] [Thread-2  ]: 7 of 9 OK created sql incremental model public.dim_employees ................... [[32mSUCCESS 1[0m in 2.07s]
[0m22:43:53.638317 [debug] [Thread-2  ]: Finished running node model.northwind_dbt.dim_employees
[0m22:43:53.679110 [debug] [Thread-4  ]: SQL status: SUCCESS 11 in 0.094 seconds
[0m22:43:53.685168 [debug] [Thread-4  ]: Using snowflake connection "model.northwind_dbt.fact_order_details"
[0m22:43:53.687431 [debug] [Thread-4  ]: On model.northwind_dbt.fact_order_details: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.fact_order_details"} */
describe table Project_2.public.fact_order_details
[0m22:43:53.707248 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1.463 seconds
[0m22:43:53.710778 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c32a81ce-37c7-429f-9639-b0a24baf0e0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D7A846370>]}
[0m22:43:53.711791 [info ] [Thread-3  ]: 9 of 9 OK created sql table model public.dim_products .......................... [[32mSUCCESS 1[0m in 1.51s]
[0m22:43:53.713304 [debug] [Thread-3  ]: Finished running node model.northwind_dbt.dim_products
[0m22:43:53.836103 [debug] [Thread-4  ]: SQL status: SUCCESS 11 in 0.147 seconds
[0m22:43:53.847622 [debug] [Thread-4  ]: Using snowflake connection "model.northwind_dbt.fact_order_details"
[0m22:43:53.847622 [debug] [Thread-4  ]: On model.northwind_dbt.fact_order_details: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.fact_order_details"} */
describe table "PROJECT_2"."PUBLIC"."FACT_ORDER_DETAILS"
[0m22:43:53.951682 [debug] [Thread-4  ]: SQL status: SUCCESS 11 in 0.103 seconds
[0m22:43:53.966645 [debug] [Thread-4  ]: Runtime Error in model fact_order_details (models\marts\core\fact_order_details.sql)
  The incremental strategy 'insert_overwrite' is not valid for this adapter
[0m22:43:53.967645 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c32a81ce-37c7-429f-9639-b0a24baf0e0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D16004250>]}
[0m22:43:53.968644 [error] [Thread-4  ]: 8 of 9 ERROR creating sql incremental model public.fact_order_details .......... [[31mERROR[0m in 2.40s]
[0m22:43:53.969596 [debug] [Thread-4  ]: Finished running node model.northwind_dbt.fact_order_details
[0m22:43:53.970599 [debug] [Thread-7  ]: Marking all children of 'model.northwind_dbt.fact_order_details' to be skipped because of status 'error'.  Reason: Runtime Error in model fact_order_details (models\marts\core\fact_order_details.sql)
  The incremental strategy 'insert_overwrite' is not valid for this adapter.
[0m22:43:53.974311 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:43:53.975317 [debug] [MainThread]: Connection 'list_Project_2' was left open.
[0m22:43:53.977264 [debug] [MainThread]: On list_Project_2: Close
[0m22:43:54.128219 [debug] [MainThread]: Connection 'list_Project_2_public' was left open.
[0m22:43:54.128219 [debug] [MainThread]: On list_Project_2_public: Close
[0m22:43:54.298126 [debug] [MainThread]: Connection 'model.northwind_dbt.dim_customers' was left open.
[0m22:43:54.298126 [debug] [MainThread]: On model.northwind_dbt.dim_customers: Close
[0m22:43:54.414773 [debug] [MainThread]: Connection 'model.northwind_dbt.dim_employees' was left open.
[0m22:43:54.414773 [debug] [MainThread]: On model.northwind_dbt.dim_employees: Close
[0m22:43:54.528311 [debug] [MainThread]: Connection 'model.northwind_dbt.dim_products' was left open.
[0m22:43:54.528311 [debug] [MainThread]: On model.northwind_dbt.dim_products: Close
[0m22:43:54.662968 [debug] [MainThread]: Connection 'model.northwind_dbt.fact_order_details' was left open.
[0m22:43:54.662968 [debug] [MainThread]: On model.northwind_dbt.fact_order_details: Close
[0m22:43:54.788184 [info ] [MainThread]: 
[0m22:43:54.788184 [info ] [MainThread]: Finished running 2 incremental models, 2 table models, 5 view models in 0 hours 0 minutes and 5.67 seconds (5.67s).
[0m22:43:54.788184 [debug] [MainThread]: Command end result
[0m22:43:54.987212 [debug] [MainThread]: Wrote artifact WritableManifest to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\manifest.json
[0m22:43:54.987212 [debug] [MainThread]: Wrote artifact SemanticManifest to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\semantic_manifest.json
[0m22:43:55.009347 [debug] [MainThread]: Wrote artifact RunExecutionResult to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\run_results.json
[0m22:43:55.009982 [info ] [MainThread]: 
[0m22:43:55.010516 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m22:43:55.011093 [info ] [MainThread]: 
[0m22:43:55.011694 [error] [MainThread]:   Runtime Error in model fact_order_details (models\marts\core\fact_order_details.sql)
  The incremental strategy 'insert_overwrite' is not valid for this adapter
[0m22:43:55.012858 [info ] [MainThread]: 
[0m22:43:55.013390 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=1 SKIP=0 TOTAL=9
[0m22:43:55.014482 [debug] [MainThread]: Command `dbt run` failed at 22:43:55.014482 after 9.16 seconds
[0m22:43:55.015026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D7950F340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D16009CA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D16009880>]}
[0m22:43:55.015568 [debug] [MainThread]: Flushing usage events
[0m22:43:55.768491 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:46:34.920083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B396D2F3A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B398DA1C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B398DA1A00>]}


============================== 22:46:34.926992 | 00defb4b-3132-44cf-a857-462eb0b2260c ==============================
[0m22:46:34.926992 [info ] [MainThread]: Running with dbt=1.9.0
[0m22:46:34.926992 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'c:\\Users\\fitzp\\Documents\\Alpaca_Market\\zproject_2\\northwind_psql', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'c:\\Users\\fitzp\\Documents\\Alpaca_Market\\zproject_2\\northwind_psql\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --select fact_order_details', 'send_anonymous_usage_stats': 'True'}
[0m22:46:35.727869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '00defb4b-3132-44cf-a857-462eb0b2260c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B398127C10>]}
[0m22:46:35.780317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '00defb4b-3132-44cf-a857-462eb0b2260c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3B1889880>]}
[0m22:46:35.780317 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m22:46:36.169904 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m22:46:36.576035 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:46:36.576035 [debug] [MainThread]: Partial parsing: updated file: northwind_dbt://models\marts\core\fact_order_details.sql
[0m22:46:36.848842 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.northwind_dbt.marts.bi
[0m22:46:36.869969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '00defb4b-3132-44cf-a857-462eb0b2260c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3B1F9CF10>]}
[0m22:46:37.107813 [debug] [MainThread]: Wrote artifact WritableManifest to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\manifest.json
[0m22:46:37.112799 [debug] [MainThread]: Wrote artifact SemanticManifest to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\semantic_manifest.json
[0m22:46:37.170611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '00defb4b-3132-44cf-a857-462eb0b2260c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3B1E538E0>]}
[0m22:46:37.170611 [info ] [MainThread]: Found 9 models, 8 sources, 706 macros
[0m22:46:37.170611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '00defb4b-3132-44cf-a857-462eb0b2260c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3B18BB9D0>]}
[0m22:46:37.170611 [info ] [MainThread]: 
[0m22:46:37.170611 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:46:37.186302 [info ] [MainThread]: 
[0m22:46:37.187900 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:46:37.189619 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_Project_2'
[0m22:46:37.275440 [debug] [ThreadPool]: Using snowflake connection "list_Project_2"
[0m22:46:37.276043 [debug] [ThreadPool]: On list_Project_2: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "connection_name": "list_Project_2"} */
show terse schemas in database Project_2
    limit 10000
[0m22:46:37.276750 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:46:37.992340 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.717 seconds
[0m22:46:38.002925 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_Project_2_public'
[0m22:46:38.011639 [debug] [ThreadPool]: Using snowflake connection "list_Project_2_public"
[0m22:46:38.013644 [debug] [ThreadPool]: On list_Project_2_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "connection_name": "list_Project_2_public"} */
show objects in Project_2.public limit 10000;
[0m22:46:38.013644 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:46:39.048230 [debug] [ThreadPool]: SQL status: SUCCESS 23 in 1.049 seconds
[0m22:46:39.066090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '00defb4b-3132-44cf-a857-462eb0b2260c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3B1E14940>]}
[0m22:46:39.066090 [debug] [Thread-1  ]: Began running node model.northwind_dbt.fact_order_details
[0m22:46:39.066090 [info ] [Thread-1  ]: 1 of 1 START sql incremental model public.fact_order_details ................... [RUN]
[0m22:46:39.066090 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.northwind_dbt.fact_order_details'
[0m22:46:39.066090 [debug] [Thread-1  ]: Began compiling node model.northwind_dbt.fact_order_details
[0m22:46:39.087744 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind_dbt.fact_order_details"
[0m22:46:39.099557 [debug] [Thread-1  ]: Began executing node model.northwind_dbt.fact_order_details
[0m22:46:39.154990 [debug] [Thread-1  ]: Using snowflake connection "model.northwind_dbt.fact_order_details"
[0m22:46:39.155990 [debug] [Thread-1  ]: On model.northwind_dbt.fact_order_details: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.fact_order_details"} */
create or replace  temporary view Project_2.public.fact_order_details__dbt_tmp
  
   as (
    

with base as (
    select 
        od.order_id,
        od.product_id,
        o.customer_id,
        o.employee_id,
        o.ship_via as shipper_id,
        o.order_date,
        od.unit_price,
        od.quantity,
        od.discount,
        od.unit_price * od.quantity * (1 - od.discount) as revenue
    from Project_2.public.stg_order_details od
    join Project_2.public.stg_orders o on od.order_id = o.order_id
    
        where o.order_date >= (select max(order_date) from Project_2.public.fact_order_details)
    
),
aggregated as (
    select 
        order_id,
        customer_id,
        employee_id,
        shipper_id,
        cast(order_date as date) as order_date,
        sum(revenue) as total_revenue,
        avg(revenue) as avg_revenue,
        max(revenue) as max_revenue,
        min(revenue) as min_revenue,
        count(*) as line_count,
        rank() over (partition by customer_id order by sum(revenue) desc) as revenue_rank
    from base
    group by order_id, customer_id, employee_id, shipper_id, order_date
)
select * from aggregated
  );
[0m22:46:39.156989 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m22:46:40.019982 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.866 seconds
[0m22:46:40.027839 [debug] [Thread-1  ]: Using snowflake connection "model.northwind_dbt.fact_order_details"
[0m22:46:40.027839 [debug] [Thread-1  ]: On model.northwind_dbt.fact_order_details: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.fact_order_details"} */
describe table Project_2.public.fact_order_details__dbt_tmp
[0m22:46:40.140953 [debug] [Thread-1  ]: SQL status: SUCCESS 11 in 0.108 seconds
[0m22:46:40.147544 [debug] [Thread-1  ]: Using snowflake connection "model.northwind_dbt.fact_order_details"
[0m22:46:40.147544 [debug] [Thread-1  ]: On model.northwind_dbt.fact_order_details: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.fact_order_details"} */
describe table Project_2.public.fact_order_details
[0m22:46:40.255317 [debug] [Thread-1  ]: SQL status: SUCCESS 11 in 0.105 seconds
[0m22:46:40.265363 [debug] [Thread-1  ]: Using snowflake connection "model.northwind_dbt.fact_order_details"
[0m22:46:40.265363 [debug] [Thread-1  ]: On model.northwind_dbt.fact_order_details: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.fact_order_details"} */
describe table "PROJECT_2"."PUBLIC"."FACT_ORDER_DETAILS"
[0m22:46:40.334486 [debug] [Thread-1  ]: SQL status: SUCCESS 11 in 0.073 seconds
[0m22:46:40.361513 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind_dbt.fact_order_details"
[0m22:46:40.361513 [debug] [Thread-1  ]: Using snowflake connection "model.northwind_dbt.fact_order_details"
[0m22:46:40.361513 [debug] [Thread-1  ]: On model.northwind_dbt.fact_order_details: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.fact_order_details"} */
-- back compat for old kwarg name
  
  begin;
[0m22:46:40.510124 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.138 seconds
[0m22:46:40.510124 [debug] [Thread-1  ]: Using snowflake connection "model.northwind_dbt.fact_order_details"
[0m22:46:40.510124 [debug] [Thread-1  ]: On model.northwind_dbt.fact_order_details: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.fact_order_details"} */
merge into Project_2.public.fact_order_details as DBT_INTERNAL_DEST
        using Project_2.public.fact_order_details__dbt_tmp as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.order_id = DBT_INTERNAL_DEST.order_id))

    
    when matched then update set
        "ORDER_ID" = DBT_INTERNAL_SOURCE."ORDER_ID","CUSTOMER_ID" = DBT_INTERNAL_SOURCE."CUSTOMER_ID","EMPLOYEE_ID" = DBT_INTERNAL_SOURCE."EMPLOYEE_ID","SHIPPER_ID" = DBT_INTERNAL_SOURCE."SHIPPER_ID","ORDER_DATE" = DBT_INTERNAL_SOURCE."ORDER_DATE","TOTAL_REVENUE" = DBT_INTERNAL_SOURCE."TOTAL_REVENUE","AVG_REVENUE" = DBT_INTERNAL_SOURCE."AVG_REVENUE","MAX_REVENUE" = DBT_INTERNAL_SOURCE."MAX_REVENUE","MIN_REVENUE" = DBT_INTERNAL_SOURCE."MIN_REVENUE","LINE_COUNT" = DBT_INTERNAL_SOURCE."LINE_COUNT","REVENUE_RANK" = DBT_INTERNAL_SOURCE."REVENUE_RANK"
    

    when not matched then insert
        ("ORDER_ID", "CUSTOMER_ID", "EMPLOYEE_ID", "SHIPPER_ID", "ORDER_DATE", "TOTAL_REVENUE", "AVG_REVENUE", "MAX_REVENUE", "MIN_REVENUE", "LINE_COUNT", "REVENUE_RANK")
    values
        ("ORDER_ID", "CUSTOMER_ID", "EMPLOYEE_ID", "SHIPPER_ID", "ORDER_DATE", "TOTAL_REVENUE", "AVG_REVENUE", "MAX_REVENUE", "MIN_REVENUE", "LINE_COUNT", "REVENUE_RANK")

;
[0m22:46:41.670789 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 1.153 seconds
[0m22:46:41.672958 [debug] [Thread-1  ]: Using snowflake connection "model.northwind_dbt.fact_order_details"
[0m22:46:41.675430 [debug] [Thread-1  ]: On model.northwind_dbt.fact_order_details: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.fact_order_details"} */
COMMIT
[0m22:46:41.982273 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.305 seconds
[0m22:46:41.991576 [debug] [Thread-1  ]: Applying DROP to: Project_2.public.fact_order_details__dbt_tmp
[0m22:46:41.999227 [debug] [Thread-1  ]: Using snowflake connection "model.northwind_dbt.fact_order_details"
[0m22:46:42.000357 [debug] [Thread-1  ]: On model.northwind_dbt.fact_order_details: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.fact_order_details"} */
drop view if exists Project_2.public.fact_order_details__dbt_tmp cascade
[0m22:46:42.116248 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.115 seconds
[0m22:46:42.152182 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00defb4b-3132-44cf-a857-462eb0b2260c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3B1850F40>]}
[0m22:46:42.154353 [info ] [Thread-1  ]: 1 of 1 OK created sql incremental model public.fact_order_details .............. [[32mSUCCESS 4[0m in 3.08s]
[0m22:46:42.156549 [debug] [Thread-1  ]: Finished running node model.northwind_dbt.fact_order_details
[0m22:46:42.159248 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:46:42.160872 [debug] [MainThread]: Connection 'list_Project_2' was left open.
[0m22:46:42.162474 [debug] [MainThread]: On list_Project_2: Close
[0m22:46:42.283789 [debug] [MainThread]: Connection 'list_Project_2_public' was left open.
[0m22:46:42.287470 [debug] [MainThread]: On list_Project_2_public: Close
[0m22:46:42.441672 [debug] [MainThread]: Connection 'model.northwind_dbt.fact_order_details' was left open.
[0m22:46:42.441672 [debug] [MainThread]: On model.northwind_dbt.fact_order_details: Close
[0m22:46:42.559038 [info ] [MainThread]: 
[0m22:46:42.561301 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 5.37 seconds (5.37s).
[0m22:46:42.570820 [debug] [MainThread]: Command end result
[0m22:46:42.838817 [debug] [MainThread]: Wrote artifact WritableManifest to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\manifest.json
[0m22:46:42.844327 [debug] [MainThread]: Wrote artifact SemanticManifest to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\semantic_manifest.json
[0m22:46:42.856084 [debug] [MainThread]: Wrote artifact RunExecutionResult to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\run_results.json
[0m22:46:42.856084 [info ] [MainThread]: 
[0m22:46:42.859372 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:46:42.859372 [info ] [MainThread]: 
[0m22:46:42.859372 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m22:46:42.861376 [debug] [MainThread]: Command `dbt run` succeeded at 22:46:42.861376 after 8.02 seconds
[0m22:46:42.861376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B396D2F3A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B396208A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3B3788C10>]}
[0m22:46:42.863380 [debug] [MainThread]: Flushing usage events
[0m22:46:43.538302 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:07:36.788226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B86FDF310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B89050AF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B890508E0>]}


============================== 23:07:36.795930 | d675e7f4-b3ec-4f33-b0a2-f3577c4694d4 ==============================
[0m23:07:36.795930 [info ] [MainThread]: Running with dbt=1.9.0
[0m23:07:36.795930 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'c:\\Users\\fitzp\\Documents\\Alpaca_Market\\zproject_2\\northwind_psql\\logs', 'profiles_dir': 'c:\\Users\\fitzp\\Documents\\Alpaca_Market\\zproject_2\\northwind_psql', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:07:38.271567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd675e7f4-b3ec-4f33-b0a2-f3577c4694d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B8901F760>]}
[0m23:07:38.319056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd675e7f4-b3ec-4f33-b0a2-f3577c4694d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BA1AEA5B0>]}
[0m23:07:38.333537 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m23:07:39.063540 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m23:07:39.524828 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m23:07:39.524828 [debug] [MainThread]: Partial parsing: added file: northwind_dbt://models\marts\core\obt_orders.sql
[0m23:07:39.758823 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.northwind_dbt.marts.bi
[0m23:07:39.762765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd675e7f4-b3ec-4f33-b0a2-f3577c4694d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BA227CEE0>]}
[0m23:07:40.010146 [debug] [MainThread]: Wrote artifact WritableManifest to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\manifest.json
[0m23:07:40.017566 [debug] [MainThread]: Wrote artifact SemanticManifest to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\semantic_manifest.json
[0m23:07:40.114126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd675e7f4-b3ec-4f33-b0a2-f3577c4694d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BA2100B80>]}
[0m23:07:40.114740 [info ] [MainThread]: Found 10 models, 8 sources, 706 macros
[0m23:07:40.115836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd675e7f4-b3ec-4f33-b0a2-f3577c4694d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BA1B6E220>]}
[0m23:07:40.118059 [info ] [MainThread]: 
[0m23:07:40.119720 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:07:40.119720 [info ] [MainThread]: 
[0m23:07:40.122448 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:07:40.127879 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_Project_2'
[0m23:07:40.233389 [debug] [ThreadPool]: Using snowflake connection "list_Project_2"
[0m23:07:40.234003 [debug] [ThreadPool]: On list_Project_2: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "connection_name": "list_Project_2"} */
show terse schemas in database Project_2
    limit 10000
[0m23:07:40.234600 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:07:40.957731 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.733 seconds
[0m23:07:40.957731 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_Project_2_public'
[0m23:07:40.972314 [debug] [ThreadPool]: Using snowflake connection "list_Project_2_public"
[0m23:07:40.972314 [debug] [ThreadPool]: On list_Project_2_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "connection_name": "list_Project_2_public"} */
show objects in Project_2.public limit 10000;
[0m23:07:40.972314 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:07:41.479028 [debug] [ThreadPool]: SQL status: SUCCESS 23 in 0.498 seconds
[0m23:07:41.492494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd675e7f4-b3ec-4f33-b0a2-f3577c4694d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BA1BCED00>]}
[0m23:07:41.492494 [debug] [Thread-1  ]: Began running node model.northwind_dbt.stg_customers
[0m23:07:41.492494 [debug] [Thread-2  ]: Began running node model.northwind_dbt.stg_employees
[0m23:07:41.492494 [debug] [Thread-3  ]: Began running node model.northwind_dbt.stg_order_details
[0m23:07:41.492494 [debug] [Thread-4  ]: Began running node model.northwind_dbt.stg_orders
[0m23:07:41.492494 [info ] [Thread-1  ]: 1 of 10 START sql view model public.stg_customers .............................. [RUN]
[0m23:07:41.492494 [info ] [Thread-2  ]: 2 of 10 START sql view model public.stg_employees .............................. [RUN]
[0m23:07:41.492494 [info ] [Thread-3  ]: 3 of 10 START sql view model public.stg_order_details .......................... [RUN]
[0m23:07:41.506730 [info ] [Thread-4  ]: 4 of 10 START sql view model public.stg_orders ................................. [RUN]
[0m23:07:41.506730 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.northwind_dbt.stg_customers'
[0m23:07:41.506730 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.northwind_dbt.stg_employees'
[0m23:07:41.506730 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.northwind_dbt.stg_order_details'
[0m23:07:41.506730 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.northwind_dbt.stg_orders'
[0m23:07:41.506730 [debug] [Thread-1  ]: Began compiling node model.northwind_dbt.stg_customers
[0m23:07:41.506730 [debug] [Thread-2  ]: Began compiling node model.northwind_dbt.stg_employees
[0m23:07:41.506730 [debug] [Thread-3  ]: Began compiling node model.northwind_dbt.stg_order_details
[0m23:07:41.506730 [debug] [Thread-4  ]: Began compiling node model.northwind_dbt.stg_orders
[0m23:07:41.506730 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind_dbt.stg_customers"
[0m23:07:41.525314 [debug] [Thread-2  ]: Writing injected SQL for node "model.northwind_dbt.stg_employees"
[0m23:07:41.525314 [debug] [Thread-3  ]: Writing injected SQL for node "model.northwind_dbt.stg_order_details"
[0m23:07:41.534001 [debug] [Thread-4  ]: Writing injected SQL for node "model.northwind_dbt.stg_orders"
[0m23:07:41.569576 [debug] [Thread-2  ]: Began executing node model.northwind_dbt.stg_employees
[0m23:07:41.569576 [debug] [Thread-3  ]: Began executing node model.northwind_dbt.stg_order_details
[0m23:07:41.569576 [debug] [Thread-1  ]: Began executing node model.northwind_dbt.stg_customers
[0m23:07:41.608365 [debug] [Thread-2  ]: Writing runtime sql for node "model.northwind_dbt.stg_employees"
[0m23:07:41.608869 [debug] [Thread-4  ]: Began executing node model.northwind_dbt.stg_orders
[0m23:07:41.612443 [debug] [Thread-3  ]: Writing runtime sql for node "model.northwind_dbt.stg_order_details"
[0m23:07:41.616550 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind_dbt.stg_customers"
[0m23:07:41.620014 [debug] [Thread-4  ]: Writing runtime sql for node "model.northwind_dbt.stg_orders"
[0m23:07:41.650311 [debug] [Thread-1  ]: Using snowflake connection "model.northwind_dbt.stg_customers"
[0m23:07:41.650311 [debug] [Thread-3  ]: Using snowflake connection "model.northwind_dbt.stg_order_details"
[0m23:07:41.650311 [debug] [Thread-2  ]: Using snowflake connection "model.northwind_dbt.stg_employees"
[0m23:07:41.650311 [debug] [Thread-4  ]: Using snowflake connection "model.northwind_dbt.stg_orders"
[0m23:07:41.650311 [debug] [Thread-1  ]: On model.northwind_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.stg_customers"} */
create or replace   view Project_2.public.stg_customers
  
   as (
    select * from PROJECT_2.PUBLIC.customers
  );
[0m23:07:41.650311 [debug] [Thread-3  ]: On model.northwind_dbt.stg_order_details: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.stg_order_details"} */
create or replace   view Project_2.public.stg_order_details
  
   as (
    select * from PROJECT_2.PUBLIC.order_details
  );
[0m23:07:41.650311 [debug] [Thread-2  ]: On model.northwind_dbt.stg_employees: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.stg_employees"} */
create or replace   view Project_2.public.stg_employees
  
   as (
    select * from PROJECT_2.PUBLIC.employees
  );
[0m23:07:41.650311 [debug] [Thread-4  ]: On model.northwind_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.stg_orders"} */
create or replace   view Project_2.public.stg_orders
  
   as (
    select * from PROJECT_2.PUBLIC.orders
  );
[0m23:07:41.650311 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m23:07:41.650311 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m23:07:41.650311 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m23:07:41.650311 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m23:07:42.443395 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.789 seconds
[0m23:07:42.467129 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd675e7f4-b3ec-4f33-b0a2-f3577c4694d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BA2972B80>]}
[0m23:07:42.469138 [info ] [Thread-4  ]: 4 of 10 OK created sql view model public.stg_orders ............................ [[32mSUCCESS 1[0m in 0.96s]
[0m23:07:42.469138 [debug] [Thread-4  ]: Finished running node model.northwind_dbt.stg_orders
[0m23:07:42.469138 [debug] [Thread-4  ]: Began running node model.northwind_dbt.stg_products
[0m23:07:42.469138 [info ] [Thread-4  ]: 5 of 10 START sql view model public.stg_products ............................... [RUN]
[0m23:07:42.473401 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.northwind_dbt.stg_orders, now model.northwind_dbt.stg_products)
[0m23:07:42.475133 [debug] [Thread-4  ]: Began compiling node model.northwind_dbt.stg_products
[0m23:07:42.480446 [debug] [Thread-4  ]: Writing injected SQL for node "model.northwind_dbt.stg_products"
[0m23:07:42.492562 [debug] [Thread-4  ]: Began executing node model.northwind_dbt.stg_products
[0m23:07:42.498673 [debug] [Thread-4  ]: Writing runtime sql for node "model.northwind_dbt.stg_products"
[0m23:07:42.511121 [debug] [Thread-4  ]: Using snowflake connection "model.northwind_dbt.stg_products"
[0m23:07:42.512258 [debug] [Thread-4  ]: On model.northwind_dbt.stg_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.stg_products"} */
create or replace   view Project_2.public.stg_products
  
   as (
    select * from PROJECT_2.PUBLIC.products
  );
[0m23:07:42.572950 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.915 seconds
[0m23:07:42.575936 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd675e7f4-b3ec-4f33-b0a2-f3577c4694d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BA2972F10>]}
[0m23:07:42.576935 [info ] [Thread-3  ]: 3 of 10 OK created sql view model public.stg_order_details ..................... [[32mSUCCESS 1[0m in 1.07s]
[0m23:07:42.579419 [debug] [Thread-3  ]: Finished running node model.northwind_dbt.stg_order_details
[0m23:07:42.580053 [debug] [Thread-3  ]: Began running node model.northwind_dbt.fact_order_details
[0m23:07:42.581055 [info ] [Thread-3  ]: 6 of 10 START sql incremental model public.fact_order_details .................. [RUN]
[0m23:07:42.582055 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.northwind_dbt.stg_order_details, now model.northwind_dbt.fact_order_details)
[0m23:07:42.584278 [debug] [Thread-3  ]: Began compiling node model.northwind_dbt.fact_order_details
[0m23:07:42.605924 [debug] [Thread-3  ]: Writing injected SQL for node "model.northwind_dbt.fact_order_details"
[0m23:07:42.617145 [debug] [Thread-3  ]: Began executing node model.northwind_dbt.fact_order_details
[0m23:07:42.648494 [debug] [Thread-3  ]: Using snowflake connection "model.northwind_dbt.fact_order_details"
[0m23:07:42.649780 [debug] [Thread-3  ]: On model.northwind_dbt.fact_order_details: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.fact_order_details"} */
create or replace  temporary view Project_2.public.fact_order_details__dbt_tmp
  
   as (
    

with base as (
    select 
        od.order_id,
        od.product_id,
        o.customer_id,
        o.employee_id,
        o.ship_via as shipper_id,
        o.order_date,
        od.unit_price,
        od.quantity,
        od.discount,
        od.unit_price * od.quantity * (1 - od.discount) as revenue
    from Project_2.public.stg_order_details od
    join Project_2.public.stg_orders o on od.order_id = o.order_id
    
        where o.order_date >= (select max(order_date) from Project_2.public.fact_order_details)
    
),
aggregated as (
    select 
        order_id,
        customer_id,
        employee_id,
        shipper_id,
        cast(order_date as date) as order_date,
        sum(revenue) as total_revenue,
        avg(revenue) as avg_revenue,
        max(revenue) as max_revenue,
        min(revenue) as min_revenue,
        count(*) as line_count,
        rank() over (partition by customer_id order by sum(revenue) desc) as revenue_rank
    from base
    group by order_id, customer_id, employee_id, shipper_id, order_date
)
select * from aggregated
  );
[0m23:07:42.737762 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.084 seconds
[0m23:07:42.816602 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd675e7f4-b3ec-4f33-b0a2-f3577c4694d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B8624C130>]}
[0m23:07:42.816602 [info ] [Thread-1  ]: 1 of 10 OK created sql view model public.stg_customers ......................... [[32mSUCCESS 1[0m in 1.31s]
[0m23:07:42.816602 [debug] [Thread-1  ]: Finished running node model.northwind_dbt.stg_customers
[0m23:07:42.816602 [debug] [Thread-1  ]: Began running node model.northwind_dbt.dim_customers
[0m23:07:42.816602 [info ] [Thread-1  ]: 7 of 10 START sql table model public.dim_customers ............................. [RUN]
[0m23:07:42.816602 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.northwind_dbt.stg_customers, now model.northwind_dbt.dim_customers)
[0m23:07:42.816602 [debug] [Thread-1  ]: Began compiling node model.northwind_dbt.dim_customers
[0m23:07:42.816602 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind_dbt.dim_customers"
[0m23:07:42.832212 [debug] [Thread-1  ]: Began executing node model.northwind_dbt.dim_customers
[0m23:07:42.860994 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind_dbt.dim_customers"
[0m23:07:42.875903 [debug] [Thread-1  ]: Using snowflake connection "model.northwind_dbt.dim_customers"
[0m23:07:42.875903 [debug] [Thread-1  ]: On model.northwind_dbt.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.dim_customers"} */
create or replace transient table Project_2.public.dim_customers
         as
        (select * from Project_2.public.stg_customers
        );
[0m23:07:42.951151 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.293 seconds
[0m23:07:42.953062 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd675e7f4-b3ec-4f33-b0a2-f3577c4694d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BA2A71A90>]}
[0m23:07:42.955224 [info ] [Thread-2  ]: 2 of 10 OK created sql view model public.stg_employees ......................... [[32mSUCCESS 1[0m in 1.45s]
[0m23:07:42.957239 [debug] [Thread-2  ]: Finished running node model.northwind_dbt.stg_employees
[0m23:07:42.958223 [debug] [Thread-2  ]: Began running node model.northwind_dbt.dim_employees
[0m23:07:42.959226 [info ] [Thread-2  ]: 8 of 10 START sql incremental model public.dim_employees ....................... [RUN]
[0m23:07:42.962594 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.northwind_dbt.stg_employees, now model.northwind_dbt.dim_employees)
[0m23:07:42.965286 [debug] [Thread-2  ]: Began compiling node model.northwind_dbt.dim_employees
[0m23:07:42.982907 [debug] [Thread-2  ]: Writing injected SQL for node "model.northwind_dbt.dim_employees"
[0m23:07:42.995847 [debug] [Thread-2  ]: Began executing node model.northwind_dbt.dim_employees
[0m23:07:43.002842 [debug] [Thread-2  ]: Using snowflake connection "model.northwind_dbt.dim_employees"
[0m23:07:43.002842 [debug] [Thread-2  ]: On model.northwind_dbt.dim_employees: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.dim_employees"} */
create or replace  temporary view Project_2.public.dim_employees__dbt_tmp
  
   as (
    

with source_data as (
    select * from Project_2.public.stg_employees
),
scd2 as (
    select 
        md5(cast(coalesce(cast(employee_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as employee_key,
        *,
        current_timestamp as dbt_updated_at
    from source_data
)
select * from scd2
  );
[0m23:07:43.002842 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.499 seconds
[0m23:07:43.014955 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd675e7f4-b3ec-4f33-b0a2-f3577c4694d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B86ED1A30>]}
[0m23:07:43.016194 [info ] [Thread-4  ]: 5 of 10 OK created sql view model public.stg_products .......................... [[32mSUCCESS 1[0m in 0.54s]
[0m23:07:43.016981 [debug] [Thread-4  ]: Finished running node model.northwind_dbt.stg_products
[0m23:07:43.016981 [debug] [Thread-4  ]: Began running node model.northwind_dbt.dim_products
[0m23:07:43.016981 [info ] [Thread-4  ]: 9 of 10 START sql table model public.dim_products .............................. [RUN]
[0m23:07:43.020017 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.northwind_dbt.stg_products, now model.northwind_dbt.dim_products)
[0m23:07:43.020017 [debug] [Thread-4  ]: Began compiling node model.northwind_dbt.dim_products
[0m23:07:43.024284 [debug] [Thread-4  ]: Writing injected SQL for node "model.northwind_dbt.dim_products"
[0m23:07:43.034798 [debug] [Thread-4  ]: Began executing node model.northwind_dbt.dim_products
[0m23:07:43.038795 [debug] [Thread-4  ]: Writing runtime sql for node "model.northwind_dbt.dim_products"
[0m23:07:43.049799 [debug] [Thread-4  ]: Using snowflake connection "model.northwind_dbt.dim_products"
[0m23:07:43.050801 [debug] [Thread-4  ]: On model.northwind_dbt.dim_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.dim_products"} */
create or replace transient table Project_2.public.dim_products
         as
        (select 
    p.product_id,
    p.product_name,
    p.supplier_id,
    s.company_name as supplier_name,
    p.category_id,
    c.category_name,
    p.quantity_per_unit,
    p.unit_price,
    p.units_in_stock,
    p.units_on_order,
    p.reorder_level,
    p.discontinued
from Project_2.public.stg_products p
left join PROJECT_2.PUBLIC.suppliers s on p.supplier_id = s.supplier_id
left join PROJECT_2.PUBLIC.categories c on p.category_id = c.category_id
        );
[0m23:07:43.157605 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.507 seconds
[0m23:07:43.176863 [debug] [Thread-3  ]: Using snowflake connection "model.northwind_dbt.fact_order_details"
[0m23:07:43.178298 [debug] [Thread-3  ]: On model.northwind_dbt.fact_order_details: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.fact_order_details"} */
describe table Project_2.public.fact_order_details__dbt_tmp
[0m23:07:43.270562 [debug] [Thread-3  ]: SQL status: SUCCESS 11 in 0.090 seconds
[0m23:07:43.274861 [debug] [Thread-3  ]: Using snowflake connection "model.northwind_dbt.fact_order_details"
[0m23:07:43.275935 [debug] [Thread-3  ]: On model.northwind_dbt.fact_order_details: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.fact_order_details"} */
describe table Project_2.public.fact_order_details
[0m23:07:43.393234 [debug] [Thread-3  ]: SQL status: SUCCESS 11 in 0.117 seconds
[0m23:07:43.405006 [debug] [Thread-3  ]: Using snowflake connection "model.northwind_dbt.fact_order_details"
[0m23:07:43.406108 [debug] [Thread-3  ]: On model.northwind_dbt.fact_order_details: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.fact_order_details"} */
describe table "PROJECT_2"."PUBLIC"."FACT_ORDER_DETAILS"
[0m23:07:43.505004 [debug] [Thread-3  ]: SQL status: SUCCESS 11 in 0.099 seconds
[0m23:07:43.551521 [debug] [Thread-3  ]: Writing runtime sql for node "model.northwind_dbt.fact_order_details"
[0m23:07:43.570619 [debug] [Thread-3  ]: Using snowflake connection "model.northwind_dbt.fact_order_details"
[0m23:07:43.572050 [debug] [Thread-3  ]: On model.northwind_dbt.fact_order_details: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.fact_order_details"} */
-- back compat for old kwarg name
  
  begin;
[0m23:07:43.718039 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.711 seconds
[0m23:07:43.719162 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.146 seconds
[0m23:07:43.723552 [debug] [Thread-2  ]: Using snowflake connection "model.northwind_dbt.dim_employees"
[0m23:07:43.725081 [debug] [Thread-3  ]: Using snowflake connection "model.northwind_dbt.fact_order_details"
[0m23:07:43.726203 [debug] [Thread-2  ]: On model.northwind_dbt.dim_employees: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.dim_employees"} */
describe table Project_2.public.dim_employees__dbt_tmp
[0m23:07:43.726759 [debug] [Thread-3  ]: On model.northwind_dbt.fact_order_details: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.fact_order_details"} */
merge into Project_2.public.fact_order_details as DBT_INTERNAL_DEST
        using Project_2.public.fact_order_details__dbt_tmp as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.order_id = DBT_INTERNAL_DEST.order_id))

    
    when matched then update set
        "ORDER_ID" = DBT_INTERNAL_SOURCE."ORDER_ID","CUSTOMER_ID" = DBT_INTERNAL_SOURCE."CUSTOMER_ID","EMPLOYEE_ID" = DBT_INTERNAL_SOURCE."EMPLOYEE_ID","SHIPPER_ID" = DBT_INTERNAL_SOURCE."SHIPPER_ID","ORDER_DATE" = DBT_INTERNAL_SOURCE."ORDER_DATE","TOTAL_REVENUE" = DBT_INTERNAL_SOURCE."TOTAL_REVENUE","AVG_REVENUE" = DBT_INTERNAL_SOURCE."AVG_REVENUE","MAX_REVENUE" = DBT_INTERNAL_SOURCE."MAX_REVENUE","MIN_REVENUE" = DBT_INTERNAL_SOURCE."MIN_REVENUE","LINE_COUNT" = DBT_INTERNAL_SOURCE."LINE_COUNT","REVENUE_RANK" = DBT_INTERNAL_SOURCE."REVENUE_RANK"
    

    when not matched then insert
        ("ORDER_ID", "CUSTOMER_ID", "EMPLOYEE_ID", "SHIPPER_ID", "ORDER_DATE", "TOTAL_REVENUE", "AVG_REVENUE", "MAX_REVENUE", "MIN_REVENUE", "LINE_COUNT", "REVENUE_RANK")
    values
        ("ORDER_ID", "CUSTOMER_ID", "EMPLOYEE_ID", "SHIPPER_ID", "ORDER_DATE", "TOTAL_REVENUE", "AVG_REVENUE", "MAX_REVENUE", "MIN_REVENUE", "LINE_COUNT", "REVENUE_RANK")

;
[0m23:07:43.841588 [debug] [Thread-2  ]: SQL status: SUCCESS 24 in 0.118 seconds
[0m23:07:43.850503 [debug] [Thread-2  ]: Using snowflake connection "model.northwind_dbt.dim_employees"
[0m23:07:43.851063 [debug] [Thread-2  ]: On model.northwind_dbt.dim_employees: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.dim_employees"} */
describe table Project_2.public.dim_employees
[0m23:07:43.932162 [debug] [Thread-2  ]: SQL status: SUCCESS 24 in 0.088 seconds
[0m23:07:43.942461 [debug] [Thread-2  ]: Using snowflake connection "model.northwind_dbt.dim_employees"
[0m23:07:43.944468 [debug] [Thread-2  ]: On model.northwind_dbt.dim_employees: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.dim_employees"} */
describe table "PROJECT_2"."PUBLIC"."DIM_EMPLOYEES"
[0m23:07:44.039794 [debug] [Thread-2  ]: SQL status: SUCCESS 24 in 0.095 seconds
[0m23:07:44.046796 [debug] [Thread-2  ]: Writing runtime sql for node "model.northwind_dbt.dim_employees"
[0m23:07:44.061794 [debug] [Thread-2  ]: Using snowflake connection "model.northwind_dbt.dim_employees"
[0m23:07:44.062795 [debug] [Thread-2  ]: On model.northwind_dbt.dim_employees: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.dim_employees"} */
-- back compat for old kwarg name
  
  begin;
[0m23:07:44.182647 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.126 seconds
[0m23:07:44.182647 [debug] [Thread-2  ]: Using snowflake connection "model.northwind_dbt.dim_employees"
[0m23:07:44.182647 [debug] [Thread-2  ]: On model.northwind_dbt.dim_employees: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.dim_employees"} */
merge into Project_2.public.dim_employees as DBT_INTERNAL_DEST
        using Project_2.public.dim_employees__dbt_tmp as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.employee_key = DBT_INTERNAL_DEST.employee_key))

    
    when matched then update set
        "EMPLOYEE_KEY" = DBT_INTERNAL_SOURCE."EMPLOYEE_KEY","_AIRBYTE_RAW_ID" = DBT_INTERNAL_SOURCE."_AIRBYTE_RAW_ID","_AIRBYTE_EXTRACTED_AT" = DBT_INTERNAL_SOURCE."_AIRBYTE_EXTRACTED_AT","_AIRBYTE_META" = DBT_INTERNAL_SOURCE."_AIRBYTE_META","_AIRBYTE_GENERATION_ID" = DBT_INTERNAL_SOURCE."_AIRBYTE_GENERATION_ID","CITY" = DBT_INTERNAL_SOURCE."CITY","NOTES" = DBT_INTERNAL_SOURCE."NOTES","PHOTO" = DBT_INTERNAL_SOURCE."PHOTO","TITLE" = DBT_INTERNAL_SOURCE."TITLE","REGION" = DBT_INTERNAL_SOURCE."REGION","ADDRESS" = DBT_INTERNAL_SOURCE."ADDRESS","COUNTRY" = DBT_INTERNAL_SOURCE."COUNTRY","EXTENSION" = DBT_INTERNAL_SOURCE."EXTENSION","HIRE_DATE" = DBT_INTERNAL_SOURCE."HIRE_DATE","LAST_NAME" = DBT_INTERNAL_SOURCE."LAST_NAME","BIRTH_DATE" = DBT_INTERNAL_SOURCE."BIRTH_DATE","FIRST_NAME" = DBT_INTERNAL_SOURCE."FIRST_NAME","HOME_PHONE" = DBT_INTERNAL_SOURCE."HOME_PHONE","PHOTO_PATH" = DBT_INTERNAL_SOURCE."PHOTO_PATH","REPORTS_TO" = DBT_INTERNAL_SOURCE."REPORTS_TO","EMPLOYEE_ID" = DBT_INTERNAL_SOURCE."EMPLOYEE_ID","POSTAL_CODE" = DBT_INTERNAL_SOURCE."POSTAL_CODE","TITLE_OF_COURTESY" = DBT_INTERNAL_SOURCE."TITLE_OF_COURTESY","DBT_UPDATED_AT" = DBT_INTERNAL_SOURCE."DBT_UPDATED_AT"
    

    when not matched then insert
        ("EMPLOYEE_KEY", "_AIRBYTE_RAW_ID", "_AIRBYTE_EXTRACTED_AT", "_AIRBYTE_META", "_AIRBYTE_GENERATION_ID", "CITY", "NOTES", "PHOTO", "TITLE", "REGION", "ADDRESS", "COUNTRY", "EXTENSION", "HIRE_DATE", "LAST_NAME", "BIRTH_DATE", "FIRST_NAME", "HOME_PHONE", "PHOTO_PATH", "REPORTS_TO", "EMPLOYEE_ID", "POSTAL_CODE", "TITLE_OF_COURTESY", "DBT_UPDATED_AT")
    values
        ("EMPLOYEE_KEY", "_AIRBYTE_RAW_ID", "_AIRBYTE_EXTRACTED_AT", "_AIRBYTE_META", "_AIRBYTE_GENERATION_ID", "CITY", "NOTES", "PHOTO", "TITLE", "REGION", "ADDRESS", "COUNTRY", "EXTENSION", "HIRE_DATE", "LAST_NAME", "BIRTH_DATE", "FIRST_NAME", "HOME_PHONE", "PHOTO_PATH", "REPORTS_TO", "EMPLOYEE_ID", "POSTAL_CODE", "TITLE_OF_COURTESY", "DBT_UPDATED_AT")

;
[0m23:07:44.250627 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.372 seconds
[0m23:07:44.255767 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd675e7f4-b3ec-4f33-b0a2-f3577c4694d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BA227CB80>]}
[0m23:07:44.257774 [info ] [Thread-1  ]: 7 of 10 OK created sql table model public.dim_customers ........................ [[32mSUCCESS 1[0m in 1.44s]
[0m23:07:44.257774 [debug] [Thread-1  ]: Finished running node model.northwind_dbt.dim_customers
[0m23:07:44.622571 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1.573 seconds
[0m23:07:44.626945 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd675e7f4-b3ec-4f33-b0a2-f3577c4694d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BA3AB6B50>]}
[0m23:07:44.626945 [info ] [Thread-4  ]: 9 of 10 OK created sql table model public.dim_products ......................... [[32mSUCCESS 1[0m in 1.61s]
[0m23:07:44.626945 [debug] [Thread-4  ]: Finished running node model.northwind_dbt.dim_products
[0m23:07:45.097262 [debug] [Thread-3  ]: SQL status: SUCCESS 4 in 1.370 seconds
[0m23:07:45.097262 [debug] [Thread-3  ]: Using snowflake connection "model.northwind_dbt.fact_order_details"
[0m23:07:45.097262 [debug] [Thread-3  ]: On model.northwind_dbt.fact_order_details: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.fact_order_details"} */
COMMIT
[0m23:07:45.154089 [debug] [Thread-2  ]: SQL status: SUCCESS 9 in 0.970 seconds
[0m23:07:45.154089 [debug] [Thread-2  ]: Using snowflake connection "model.northwind_dbt.dim_employees"
[0m23:07:45.154089 [debug] [Thread-2  ]: On model.northwind_dbt.dim_employees: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.dim_employees"} */
COMMIT
[0m23:07:45.402713 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.306 seconds
[0m23:07:45.413201 [debug] [Thread-3  ]: Applying DROP to: Project_2.public.fact_order_details__dbt_tmp
[0m23:07:45.424157 [debug] [Thread-3  ]: Using snowflake connection "model.northwind_dbt.fact_order_details"
[0m23:07:45.426167 [debug] [Thread-3  ]: On model.northwind_dbt.fact_order_details: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.fact_order_details"} */
drop view if exists Project_2.public.fact_order_details__dbt_tmp cascade
[0m23:07:45.593256 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.431 seconds
[0m23:07:45.595092 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.169 seconds
[0m23:07:45.601740 [debug] [Thread-2  ]: Applying DROP to: Project_2.public.dim_employees__dbt_tmp
[0m23:07:45.606170 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd675e7f4-b3ec-4f33-b0a2-f3577c4694d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BA3AFBCD0>]}
[0m23:07:45.606170 [debug] [Thread-2  ]: Using snowflake connection "model.northwind_dbt.dim_employees"
[0m23:07:45.606170 [debug] [Thread-2  ]: On model.northwind_dbt.dim_employees: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.dim_employees"} */
drop view if exists Project_2.public.dim_employees__dbt_tmp cascade
[0m23:07:45.606170 [info ] [Thread-3  ]: 6 of 10 OK created sql incremental model public.fact_order_details ............. [[32mSUCCESS 4[0m in 3.02s]
[0m23:07:45.606170 [debug] [Thread-3  ]: Finished running node model.northwind_dbt.fact_order_details
[0m23:07:45.757151 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.147 seconds
[0m23:07:45.761865 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd675e7f4-b3ec-4f33-b0a2-f3577c4694d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BA1FCEDC0>]}
[0m23:07:45.761865 [info ] [Thread-2  ]: 8 of 10 OK created sql incremental model public.dim_employees .................. [[32mSUCCESS 9[0m in 2.80s]
[0m23:07:45.763874 [debug] [Thread-2  ]: Finished running node model.northwind_dbt.dim_employees
[0m23:07:45.763874 [debug] [Thread-1  ]: Began running node model.northwind_dbt.obt_orders
[0m23:07:45.763874 [info ] [Thread-1  ]: 10 of 10 START sql table model public.obt_orders ............................... [RUN]
[0m23:07:45.763874 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.northwind_dbt.dim_customers, now model.northwind_dbt.obt_orders)
[0m23:07:45.763874 [debug] [Thread-1  ]: Began compiling node model.northwind_dbt.obt_orders
[0m23:07:45.775147 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind_dbt.obt_orders"
[0m23:07:45.782269 [debug] [Thread-1  ]: Began executing node model.northwind_dbt.obt_orders
[0m23:07:45.789198 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind_dbt.obt_orders"
[0m23:07:45.796534 [debug] [Thread-1  ]: Using snowflake connection "model.northwind_dbt.obt_orders"
[0m23:07:45.798045 [debug] [Thread-1  ]: On model.northwind_dbt.obt_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.obt_orders"} */
create or replace transient table Project_2.public.obt_orders
         as
        (

select 
    f.order_id,
    f.product_id,
    f.customer_id,
    f.employee_id,
    f.shipper_id,
    f.order_date,
    f.total_revenue,
    f.avg_revenue,
    f.max_revenue,
    f.min_revenue,
    f.line_count,
    f.revenue_rank,

    c.company_name as customer_name,
    p.product_name,
    p.category_name,
    p.supplier_name,
    e.first_name || ' ' || e.last_name as employee_name,
    s.company_name as shipper_name

from Project_2.public.fact_order_details f
left join Project_2.public.dim_customers c on f.customer_id = c.customer_id
left join Project_2.public.dim_products p on f.product_id = p.product_id
left join Project_2.public.dim_employees e on f.employee_id = e.employee_id
left join PROJECT_2.PUBLIC.shippers s on f.shipper_id = s.shipper_id
        );
[0m23:07:45.961922 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01bba71b-020d-03e4-000c-83e7000b131e
[0m23:07:45.961922 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 7 at position 4
invalid identifier 'F.PRODUCT_ID'
[0m23:07:45.977084 [debug] [Thread-1  ]: Database Error in model obt_orders (models\marts\core\obt_orders.sql)
  000904 (42000): SQL compilation error: error line 7 at position 4
  invalid identifier 'F.PRODUCT_ID'
  compiled code at target\run\northwind_dbt\models\marts\core\obt_orders.sql
[0m23:07:45.977084 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd675e7f4-b3ec-4f33-b0a2-f3577c4694d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BA2990BE0>]}
[0m23:07:45.977084 [error] [Thread-1  ]: 10 of 10 ERROR creating sql table model public.obt_orders ...................... [[31mERROR[0m in 0.21s]
[0m23:07:45.977084 [debug] [Thread-1  ]: Finished running node model.northwind_dbt.obt_orders
[0m23:07:45.977084 [debug] [Thread-7  ]: Marking all children of 'model.northwind_dbt.obt_orders' to be skipped because of status 'error'.  Reason: Database Error in model obt_orders (models\marts\core\obt_orders.sql)
  000904 (42000): SQL compilation error: error line 7 at position 4
  invalid identifier 'F.PRODUCT_ID'
  compiled code at target\run\northwind_dbt\models\marts\core\obt_orders.sql.
[0m23:07:45.977084 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:07:45.977084 [debug] [MainThread]: Connection 'list_Project_2' was left open.
[0m23:07:45.977084 [debug] [MainThread]: On list_Project_2: Close
[0m23:07:46.098472 [debug] [MainThread]: Connection 'list_Project_2_public' was left open.
[0m23:07:46.098472 [debug] [MainThread]: On list_Project_2_public: Close
[0m23:07:46.240416 [debug] [MainThread]: Connection 'model.northwind_dbt.obt_orders' was left open.
[0m23:07:46.242670 [debug] [MainThread]: On model.northwind_dbt.obt_orders: Close
[0m23:07:46.366051 [debug] [MainThread]: Connection 'model.northwind_dbt.dim_employees' was left open.
[0m23:07:46.366051 [debug] [MainThread]: On model.northwind_dbt.dim_employees: Close
[0m23:07:46.483982 [debug] [MainThread]: Connection 'model.northwind_dbt.fact_order_details' was left open.
[0m23:07:46.483982 [debug] [MainThread]: On model.northwind_dbt.fact_order_details: Close
[0m23:07:46.647821 [debug] [MainThread]: Connection 'model.northwind_dbt.dim_products' was left open.
[0m23:07:46.647821 [debug] [MainThread]: On model.northwind_dbt.dim_products: Close
[0m23:07:46.768797 [info ] [MainThread]: 
[0m23:07:46.768797 [info ] [MainThread]: Finished running 2 incremental models, 3 table models, 5 view models in 0 hours 0 minutes and 6.65 seconds (6.65s).
[0m23:07:46.777733 [debug] [MainThread]: Command end result
[0m23:07:47.005134 [debug] [MainThread]: Wrote artifact WritableManifest to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\manifest.json
[0m23:07:47.017747 [debug] [MainThread]: Wrote artifact SemanticManifest to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\semantic_manifest.json
[0m23:07:47.030265 [debug] [MainThread]: Wrote artifact RunExecutionResult to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\run_results.json
[0m23:07:47.039634 [info ] [MainThread]: 
[0m23:07:47.039634 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m23:07:47.039634 [info ] [MainThread]: 
[0m23:07:47.039634 [error] [MainThread]:   Database Error in model obt_orders (models\marts\core\obt_orders.sql)
  000904 (42000): SQL compilation error: error line 7 at position 4
  invalid identifier 'F.PRODUCT_ID'
  compiled code at target\run\northwind_dbt\models\marts\core\obt_orders.sql
[0m23:07:47.039634 [info ] [MainThread]: 
[0m23:07:47.039634 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=1 SKIP=0 TOTAL=10
[0m23:07:47.048397 [debug] [MainThread]: Command `dbt run` failed at 23:07:47.048397 after 10.36 seconds
[0m23:07:47.049388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B86FDF310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BA20F6E20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BA20F6BE0>]}
[0m23:07:47.050369 [debug] [MainThread]: Flushing usage events
[0m23:07:47.858825 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:10:02.875595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236DEB6F430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236E0BE3D00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236E0BE3AF0>]}


============================== 23:10:02.875595 | 6dd93be5-4faf-4883-903d-0d24d0769eaa ==============================
[0m23:10:02.875595 [info ] [MainThread]: Running with dbt=1.9.0
[0m23:10:02.880710 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'c:\\Users\\fitzp\\Documents\\Alpaca_Market\\zproject_2\\northwind_psql', 'log_path': 'c:\\Users\\fitzp\\Documents\\Alpaca_Market\\zproject_2\\northwind_psql\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:10:04.509208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6dd93be5-4faf-4883-903d-0d24d0769eaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236E0BC1BE0>]}
[0m23:10:04.580483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6dd93be5-4faf-4883-903d-0d24d0769eaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236E0A38100>]}
[0m23:10:04.583863 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m23:10:04.989669 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m23:10:05.360493 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:10:05.360493 [debug] [MainThread]: Partial parsing: updated file: northwind_dbt://models\marts\core\fact_order_details.sql
[0m23:10:05.597785 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.northwind_dbt.marts.bi
[0m23:10:05.608919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6dd93be5-4faf-4883-903d-0d24d0769eaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236F9DE6EE0>]}
[0m23:10:05.848331 [debug] [MainThread]: Wrote artifact WritableManifest to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\manifest.json
[0m23:10:05.855596 [debug] [MainThread]: Wrote artifact SemanticManifest to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\semantic_manifest.json
[0m23:10:05.930461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6dd93be5-4faf-4883-903d-0d24d0769eaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236F9C96370>]}
[0m23:10:05.930461 [info ] [MainThread]: Found 10 models, 8 sources, 706 macros
[0m23:10:05.930461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6dd93be5-4faf-4883-903d-0d24d0769eaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236F9722580>]}
[0m23:10:05.944502 [info ] [MainThread]: 
[0m23:10:05.947431 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:10:05.950038 [info ] [MainThread]: 
[0m23:10:05.950038 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:10:05.966982 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_Project_2'
[0m23:10:06.090736 [debug] [ThreadPool]: Using snowflake connection "list_Project_2"
[0m23:10:06.090736 [debug] [ThreadPool]: On list_Project_2: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "connection_name": "list_Project_2"} */
show terse schemas in database Project_2
    limit 10000
[0m23:10:06.090736 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:10:06.870119 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.792 seconds
[0m23:10:06.887449 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_Project_2_public'
[0m23:10:06.896183 [debug] [ThreadPool]: Using snowflake connection "list_Project_2_public"
[0m23:10:06.897300 [debug] [ThreadPool]: On list_Project_2_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "connection_name": "list_Project_2_public"} */
show objects in Project_2.public limit 10000;
[0m23:10:06.897850 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:10:07.416106 [debug] [ThreadPool]: SQL status: SUCCESS 23 in 0.523 seconds
[0m23:10:07.416106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6dd93be5-4faf-4883-903d-0d24d0769eaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236F9CDF0A0>]}
[0m23:10:07.432048 [debug] [Thread-1  ]: Began running node model.northwind_dbt.stg_customers
[0m23:10:07.432048 [debug] [Thread-2  ]: Began running node model.northwind_dbt.stg_employees
[0m23:10:07.432048 [debug] [Thread-3  ]: Began running node model.northwind_dbt.stg_order_details
[0m23:10:07.432048 [debug] [Thread-4  ]: Began running node model.northwind_dbt.stg_orders
[0m23:10:07.436204 [info ] [Thread-1  ]: 1 of 10 START sql view model public.stg_customers .............................. [RUN]
[0m23:10:07.436204 [info ] [Thread-2  ]: 2 of 10 START sql view model public.stg_employees .............................. [RUN]
[0m23:10:07.436204 [info ] [Thread-3  ]: 3 of 10 START sql view model public.stg_order_details .......................... [RUN]
[0m23:10:07.436204 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.northwind_dbt.stg_customers'
[0m23:10:07.436204 [info ] [Thread-4  ]: 4 of 10 START sql view model public.stg_orders ................................. [RUN]
[0m23:10:07.436204 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.northwind_dbt.stg_employees'
[0m23:10:07.436204 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.northwind_dbt.stg_order_details'
[0m23:10:07.436204 [debug] [Thread-1  ]: Began compiling node model.northwind_dbt.stg_customers
[0m23:10:07.444422 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.northwind_dbt.stg_orders'
[0m23:10:07.445473 [debug] [Thread-2  ]: Began compiling node model.northwind_dbt.stg_employees
[0m23:10:07.446290 [debug] [Thread-3  ]: Began compiling node model.northwind_dbt.stg_order_details
[0m23:10:07.455626 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind_dbt.stg_customers"
[0m23:10:07.455966 [debug] [Thread-4  ]: Began compiling node model.northwind_dbt.stg_orders
[0m23:10:07.455966 [debug] [Thread-2  ]: Writing injected SQL for node "model.northwind_dbt.stg_employees"
[0m23:10:07.455966 [debug] [Thread-3  ]: Writing injected SQL for node "model.northwind_dbt.stg_order_details"
[0m23:10:07.455966 [debug] [Thread-4  ]: Writing injected SQL for node "model.northwind_dbt.stg_orders"
[0m23:10:07.488397 [debug] [Thread-2  ]: Began executing node model.northwind_dbt.stg_employees
[0m23:10:07.490130 [debug] [Thread-1  ]: Began executing node model.northwind_dbt.stg_customers
[0m23:10:07.490130 [debug] [Thread-4  ]: Began executing node model.northwind_dbt.stg_orders
[0m23:10:07.490130 [debug] [Thread-3  ]: Began executing node model.northwind_dbt.stg_order_details
[0m23:10:07.517446 [debug] [Thread-2  ]: Writing runtime sql for node "model.northwind_dbt.stg_employees"
[0m23:10:07.521899 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind_dbt.stg_customers"
[0m23:10:07.526013 [debug] [Thread-4  ]: Writing runtime sql for node "model.northwind_dbt.stg_orders"
[0m23:10:07.530019 [debug] [Thread-3  ]: Writing runtime sql for node "model.northwind_dbt.stg_order_details"
[0m23:10:07.556178 [debug] [Thread-2  ]: Using snowflake connection "model.northwind_dbt.stg_employees"
[0m23:10:07.556178 [debug] [Thread-3  ]: Using snowflake connection "model.northwind_dbt.stg_order_details"
[0m23:10:07.556178 [debug] [Thread-4  ]: Using snowflake connection "model.northwind_dbt.stg_orders"
[0m23:10:07.556178 [debug] [Thread-1  ]: Using snowflake connection "model.northwind_dbt.stg_customers"
[0m23:10:07.556178 [debug] [Thread-2  ]: On model.northwind_dbt.stg_employees: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.stg_employees"} */
create or replace   view Project_2.public.stg_employees
  
   as (
    select * from PROJECT_2.PUBLIC.employees
  );
[0m23:10:07.556178 [debug] [Thread-3  ]: On model.northwind_dbt.stg_order_details: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.stg_order_details"} */
create or replace   view Project_2.public.stg_order_details
  
   as (
    select * from PROJECT_2.PUBLIC.order_details
  );
[0m23:10:07.556178 [debug] [Thread-4  ]: On model.northwind_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.stg_orders"} */
create or replace   view Project_2.public.stg_orders
  
   as (
    select * from PROJECT_2.PUBLIC.orders
  );
[0m23:10:07.556178 [debug] [Thread-1  ]: On model.northwind_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.stg_customers"} */
create or replace   view Project_2.public.stg_customers
  
   as (
    select * from PROJECT_2.PUBLIC.customers
  );
[0m23:10:07.556178 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m23:10:07.556178 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m23:10:07.556178 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m23:10:07.556178 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m23:10:08.250641 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.687 seconds
[0m23:10:08.273119 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6dd93be5-4faf-4883-903d-0d24d0769eaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236FA5284F0>]}
[0m23:10:08.273119 [info ] [Thread-1  ]: 1 of 10 OK created sql view model public.stg_customers ......................... [[32mSUCCESS 1[0m in 0.83s]
[0m23:10:08.275124 [debug] [Thread-1  ]: Finished running node model.northwind_dbt.stg_customers
[0m23:10:08.275124 [debug] [Thread-1  ]: Began running node model.northwind_dbt.stg_products
[0m23:10:08.275124 [info ] [Thread-1  ]: 5 of 10 START sql view model public.stg_products ............................... [RUN]
[0m23:10:08.275124 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.northwind_dbt.stg_customers, now model.northwind_dbt.stg_products)
[0m23:10:08.279898 [debug] [Thread-1  ]: Began compiling node model.northwind_dbt.stg_products
[0m23:10:08.282893 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind_dbt.stg_products"
[0m23:10:08.292195 [debug] [Thread-1  ]: Began executing node model.northwind_dbt.stg_products
[0m23:10:08.293826 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.731 seconds
[0m23:10:08.297204 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind_dbt.stg_products"
[0m23:10:08.299383 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6dd93be5-4faf-4883-903d-0d24d0769eaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236FA563D30>]}
[0m23:10:08.300053 [info ] [Thread-3  ]: 3 of 10 OK created sql view model public.stg_order_details ..................... [[32mSUCCESS 1[0m in 0.86s]
[0m23:10:08.300053 [debug] [Thread-3  ]: Finished running node model.northwind_dbt.stg_order_details
[0m23:10:08.300053 [debug] [Thread-3  ]: Began running node model.northwind_dbt.dim_customers
[0m23:10:08.300053 [info ] [Thread-3  ]: 6 of 10 START sql table model public.dim_customers ............................. [RUN]
[0m23:10:08.300053 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.northwind_dbt.stg_order_details, now model.northwind_dbt.dim_customers)
[0m23:10:08.300053 [debug] [Thread-3  ]: Began compiling node model.northwind_dbt.dim_customers
[0m23:10:08.307506 [debug] [Thread-3  ]: Writing injected SQL for node "model.northwind_dbt.dim_customers"
[0m23:10:08.307506 [debug] [Thread-1  ]: Using snowflake connection "model.northwind_dbt.stg_products"
[0m23:10:08.307506 [debug] [Thread-1  ]: On model.northwind_dbt.stg_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.stg_products"} */
create or replace   view Project_2.public.stg_products
  
   as (
    select * from PROJECT_2.PUBLIC.products
  );
[0m23:10:08.307506 [debug] [Thread-3  ]: Began executing node model.northwind_dbt.dim_customers
[0m23:10:08.409247 [debug] [Thread-3  ]: Writing runtime sql for node "model.northwind_dbt.dim_customers"
[0m23:10:08.418227 [debug] [Thread-3  ]: Using snowflake connection "model.northwind_dbt.dim_customers"
[0m23:10:08.418227 [debug] [Thread-3  ]: On model.northwind_dbt.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.dim_customers"} */
create or replace transient table Project_2.public.dim_customers
         as
        (select * from Project_2.public.stg_customers
        );
[0m23:10:08.493610 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.935 seconds
[0m23:10:08.493610 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6dd93be5-4faf-4883-903d-0d24d0769eaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236FA528160>]}
[0m23:10:08.493610 [info ] [Thread-2  ]: 2 of 10 OK created sql view model public.stg_employees ......................... [[32mSUCCESS 1[0m in 1.06s]
[0m23:10:08.493610 [debug] [Thread-2  ]: Finished running node model.northwind_dbt.stg_employees
[0m23:10:08.503806 [debug] [Thread-2  ]: Began running node model.northwind_dbt.dim_employees
[0m23:10:08.504344 [info ] [Thread-2  ]: 7 of 10 START sql incremental model public.dim_employees ....................... [RUN]
[0m23:10:08.504869 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.northwind_dbt.stg_employees, now model.northwind_dbt.dim_employees)
[0m23:10:08.504869 [debug] [Thread-2  ]: Began compiling node model.northwind_dbt.dim_employees
[0m23:10:08.508583 [debug] [Thread-2  ]: Writing injected SQL for node "model.northwind_dbt.dim_employees"
[0m23:10:08.519457 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.956 seconds
[0m23:10:08.522155 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6dd93be5-4faf-4883-903d-0d24d0769eaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236FA592520>]}
[0m23:10:08.522155 [info ] [Thread-4  ]: 4 of 10 OK created sql view model public.stg_orders ............................ [[32mSUCCESS 1[0m in 1.08s]
[0m23:10:08.522155 [debug] [Thread-4  ]: Finished running node model.northwind_dbt.stg_orders
[0m23:10:08.528099 [debug] [Thread-4  ]: Began running node model.northwind_dbt.fact_order_details
[0m23:10:08.528099 [debug] [Thread-2  ]: Began executing node model.northwind_dbt.dim_employees
[0m23:10:08.528099 [info ] [Thread-4  ]: 8 of 10 START sql incremental model public.fact_order_details .................. [RUN]
[0m23:10:08.565300 [debug] [Thread-2  ]: Using snowflake connection "model.northwind_dbt.dim_employees"
[0m23:10:08.566457 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.northwind_dbt.stg_orders, now model.northwind_dbt.fact_order_details)
[0m23:10:08.567615 [debug] [Thread-2  ]: On model.northwind_dbt.dim_employees: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.dim_employees"} */
create or replace  temporary view Project_2.public.dim_employees__dbt_tmp
  
   as (
    

with source_data as (
    select * from Project_2.public.stg_employees
),
scd2 as (
    select 
        md5(cast(coalesce(cast(employee_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as employee_key,
        *,
        current_timestamp as dbt_updated_at
    from source_data
)
select * from scd2
  );
[0m23:10:08.568699 [debug] [Thread-4  ]: Began compiling node model.northwind_dbt.fact_order_details
[0m23:10:08.577927 [debug] [Thread-4  ]: Writing injected SQL for node "model.northwind_dbt.fact_order_details"
[0m23:10:08.589164 [debug] [Thread-4  ]: Began executing node model.northwind_dbt.fact_order_details
[0m23:10:08.596946 [debug] [Thread-4  ]: Using snowflake connection "model.northwind_dbt.fact_order_details"
[0m23:10:08.598040 [debug] [Thread-4  ]: On model.northwind_dbt.fact_order_details: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.fact_order_details"} */
create or replace  temporary view Project_2.public.fact_order_details__dbt_tmp
  
   as (
    

with base as (
    select 
        od.order_id,
        od.product_id,
        o.customer_id,
        o.employee_id,
        o.ship_via as shipper_id,
        o.order_date,
        od.unit_price,
        od.quantity,
        od.discount,
        od.unit_price * od.quantity * (1 - od.discount) as revenue
    from Project_2.public.stg_order_details od
    join Project_2.public.stg_orders o on od.order_id = o.order_id
    
        where o.order_date >= (select max(order_date) from Project_2.public.fact_order_details)
    
),
aggregated as (
    select 
        order_id,
        customer_id,
        employee_id,
        shipper_id,
        cast(order_date as date) as order_date,
        sum(revenue) as total_revenue,
        avg(revenue) as avg_revenue,
        max(revenue) as max_revenue,
        min(revenue) as min_revenue,
        count(*) as line_count,
        rank() over (partition by customer_id order by sum(revenue) desc) as revenue_rank
    from base
    group by order_id, product_id, customer_id, employee_id, shipper_id, order_date
)
select * from aggregated
  );
[0m23:10:08.860058 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.549 seconds
[0m23:10:08.864383 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6dd93be5-4faf-4883-903d-0d24d0769eaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236DFED2C70>]}
[0m23:10:08.865780 [info ] [Thread-1  ]: 5 of 10 OK created sql view model public.stg_products .......................... [[32mSUCCESS 1[0m in 0.59s]
[0m23:10:08.867735 [debug] [Thread-1  ]: Finished running node model.northwind_dbt.stg_products
[0m23:10:08.868817 [debug] [Thread-1  ]: Began running node model.northwind_dbt.dim_products
[0m23:10:08.869928 [info ] [Thread-1  ]: 9 of 10 START sql table model public.dim_products .............................. [RUN]
[0m23:10:08.871593 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.northwind_dbt.stg_products, now model.northwind_dbt.dim_products)
[0m23:10:08.872570 [debug] [Thread-1  ]: Began compiling node model.northwind_dbt.dim_products
[0m23:10:08.878363 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind_dbt.dim_products"
[0m23:10:08.892169 [debug] [Thread-1  ]: Began executing node model.northwind_dbt.dim_products
[0m23:10:08.898477 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind_dbt.dim_products"
[0m23:10:08.913186 [debug] [Thread-1  ]: Using snowflake connection "model.northwind_dbt.dim_products"
[0m23:10:08.913186 [debug] [Thread-1  ]: On model.northwind_dbt.dim_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.dim_products"} */
create or replace transient table Project_2.public.dim_products
         as
        (select 
    p.product_id,
    p.product_name,
    p.supplier_id,
    s.company_name as supplier_name,
    p.category_id,
    c.category_name,
    p.quantity_per_unit,
    p.unit_price,
    p.units_in_stock,
    p.units_on_order,
    p.reorder_level,
    p.discontinued
from Project_2.public.stg_products p
left join PROJECT_2.PUBLIC.suppliers s on p.supplier_id = s.supplier_id
left join PROJECT_2.PUBLIC.categories c on p.category_id = c.category_id
        );
[0m23:10:09.057455 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.459 seconds
[0m23:10:09.057455 [debug] [Thread-4  ]: Using snowflake connection "model.northwind_dbt.fact_order_details"
[0m23:10:09.057455 [debug] [Thread-4  ]: On model.northwind_dbt.fact_order_details: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.fact_order_details"} */
describe table Project_2.public.fact_order_details__dbt_tmp
[0m23:10:09.183858 [debug] [Thread-4  ]: SQL status: SUCCESS 11 in 0.117 seconds
[0m23:10:09.190425 [debug] [Thread-4  ]: Using snowflake connection "model.northwind_dbt.fact_order_details"
[0m23:10:09.190425 [debug] [Thread-4  ]: On model.northwind_dbt.fact_order_details: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.fact_order_details"} */
describe table Project_2.public.fact_order_details
[0m23:10:09.271830 [debug] [Thread-4  ]: SQL status: SUCCESS 11 in 0.081 seconds
[0m23:10:09.278856 [debug] [Thread-4  ]: Using snowflake connection "model.northwind_dbt.fact_order_details"
[0m23:10:09.282094 [debug] [Thread-4  ]: On model.northwind_dbt.fact_order_details: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.fact_order_details"} */
describe table "PROJECT_2"."PUBLIC"."FACT_ORDER_DETAILS"
[0m23:10:09.326415 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.757 seconds
[0m23:10:09.328169 [debug] [Thread-2  ]: Using snowflake connection "model.northwind_dbt.dim_employees"
[0m23:10:09.328169 [debug] [Thread-2  ]: On model.northwind_dbt.dim_employees: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.dim_employees"} */
describe table Project_2.public.dim_employees__dbt_tmp
[0m23:10:09.374920 [debug] [Thread-4  ]: SQL status: SUCCESS 11 in 0.094 seconds
[0m23:10:09.397835 [debug] [Thread-4  ]: Writing runtime sql for node "model.northwind_dbt.fact_order_details"
[0m23:10:09.412896 [debug] [Thread-4  ]: Using snowflake connection "model.northwind_dbt.fact_order_details"
[0m23:10:09.412896 [debug] [Thread-2  ]: SQL status: SUCCESS 24 in 0.085 seconds
[0m23:10:09.412896 [debug] [Thread-4  ]: On model.northwind_dbt.fact_order_details: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.fact_order_details"} */
-- back compat for old kwarg name
  
  begin;
[0m23:10:09.421166 [debug] [Thread-2  ]: Using snowflake connection "model.northwind_dbt.dim_employees"
[0m23:10:09.421166 [debug] [Thread-2  ]: On model.northwind_dbt.dim_employees: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.dim_employees"} */
describe table Project_2.public.dim_employees
[0m23:10:09.549261 [debug] [Thread-2  ]: SQL status: SUCCESS 24 in 0.124 seconds
[0m23:10:09.555023 [debug] [Thread-2  ]: Using snowflake connection "model.northwind_dbt.dim_employees"
[0m23:10:09.556270 [debug] [Thread-2  ]: On model.northwind_dbt.dim_employees: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.dim_employees"} */
describe table "PROJECT_2"."PUBLIC"."DIM_EMPLOYEES"
[0m23:10:09.584131 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.164 seconds
[0m23:10:09.584131 [debug] [Thread-4  ]: Using snowflake connection "model.northwind_dbt.fact_order_details"
[0m23:10:09.584131 [debug] [Thread-4  ]: On model.northwind_dbt.fact_order_details: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.fact_order_details"} */
merge into Project_2.public.fact_order_details as DBT_INTERNAL_DEST
        using Project_2.public.fact_order_details__dbt_tmp as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.order_id = DBT_INTERNAL_DEST.order_id))

    
    when matched then update set
        "ORDER_ID" = DBT_INTERNAL_SOURCE."ORDER_ID","CUSTOMER_ID" = DBT_INTERNAL_SOURCE."CUSTOMER_ID","EMPLOYEE_ID" = DBT_INTERNAL_SOURCE."EMPLOYEE_ID","SHIPPER_ID" = DBT_INTERNAL_SOURCE."SHIPPER_ID","ORDER_DATE" = DBT_INTERNAL_SOURCE."ORDER_DATE","TOTAL_REVENUE" = DBT_INTERNAL_SOURCE."TOTAL_REVENUE","AVG_REVENUE" = DBT_INTERNAL_SOURCE."AVG_REVENUE","MAX_REVENUE" = DBT_INTERNAL_SOURCE."MAX_REVENUE","MIN_REVENUE" = DBT_INTERNAL_SOURCE."MIN_REVENUE","LINE_COUNT" = DBT_INTERNAL_SOURCE."LINE_COUNT","REVENUE_RANK" = DBT_INTERNAL_SOURCE."REVENUE_RANK"
    

    when not matched then insert
        ("ORDER_ID", "CUSTOMER_ID", "EMPLOYEE_ID", "SHIPPER_ID", "ORDER_DATE", "TOTAL_REVENUE", "AVG_REVENUE", "MAX_REVENUE", "MIN_REVENUE", "LINE_COUNT", "REVENUE_RANK")
    values
        ("ORDER_ID", "CUSTOMER_ID", "EMPLOYEE_ID", "SHIPPER_ID", "ORDER_DATE", "TOTAL_REVENUE", "AVG_REVENUE", "MAX_REVENUE", "MIN_REVENUE", "LINE_COUNT", "REVENUE_RANK")

;
[0m23:10:09.687298 [debug] [Thread-2  ]: SQL status: SUCCESS 24 in 0.130 seconds
[0m23:10:09.697390 [debug] [Thread-2  ]: Writing runtime sql for node "model.northwind_dbt.dim_employees"
[0m23:10:09.719140 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1.301 seconds
[0m23:10:09.724084 [debug] [Thread-2  ]: Using snowflake connection "model.northwind_dbt.dim_employees"
[0m23:10:09.726099 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6dd93be5-4faf-4883-903d-0d24d0769eaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236FA563D30>]}
[0m23:10:09.726099 [debug] [Thread-2  ]: On model.northwind_dbt.dim_employees: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.dim_employees"} */
-- back compat for old kwarg name
  
  begin;
[0m23:10:09.728109 [info ] [Thread-3  ]: 6 of 10 OK created sql table model public.dim_customers ........................ [[32mSUCCESS 1[0m in 1.43s]
[0m23:10:09.728109 [debug] [Thread-3  ]: Finished running node model.northwind_dbt.dim_customers
[0m23:10:09.897078 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.183 seconds
[0m23:10:09.913203 [debug] [Thread-2  ]: Using snowflake connection "model.northwind_dbt.dim_employees"
[0m23:10:09.915368 [debug] [Thread-2  ]: On model.northwind_dbt.dim_employees: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.dim_employees"} */
merge into Project_2.public.dim_employees as DBT_INTERNAL_DEST
        using Project_2.public.dim_employees__dbt_tmp as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.employee_key = DBT_INTERNAL_DEST.employee_key))

    
    when matched then update set
        "EMPLOYEE_KEY" = DBT_INTERNAL_SOURCE."EMPLOYEE_KEY","_AIRBYTE_RAW_ID" = DBT_INTERNAL_SOURCE."_AIRBYTE_RAW_ID","_AIRBYTE_EXTRACTED_AT" = DBT_INTERNAL_SOURCE."_AIRBYTE_EXTRACTED_AT","_AIRBYTE_META" = DBT_INTERNAL_SOURCE."_AIRBYTE_META","_AIRBYTE_GENERATION_ID" = DBT_INTERNAL_SOURCE."_AIRBYTE_GENERATION_ID","CITY" = DBT_INTERNAL_SOURCE."CITY","NOTES" = DBT_INTERNAL_SOURCE."NOTES","PHOTO" = DBT_INTERNAL_SOURCE."PHOTO","TITLE" = DBT_INTERNAL_SOURCE."TITLE","REGION" = DBT_INTERNAL_SOURCE."REGION","ADDRESS" = DBT_INTERNAL_SOURCE."ADDRESS","COUNTRY" = DBT_INTERNAL_SOURCE."COUNTRY","EXTENSION" = DBT_INTERNAL_SOURCE."EXTENSION","HIRE_DATE" = DBT_INTERNAL_SOURCE."HIRE_DATE","LAST_NAME" = DBT_INTERNAL_SOURCE."LAST_NAME","BIRTH_DATE" = DBT_INTERNAL_SOURCE."BIRTH_DATE","FIRST_NAME" = DBT_INTERNAL_SOURCE."FIRST_NAME","HOME_PHONE" = DBT_INTERNAL_SOURCE."HOME_PHONE","PHOTO_PATH" = DBT_INTERNAL_SOURCE."PHOTO_PATH","REPORTS_TO" = DBT_INTERNAL_SOURCE."REPORTS_TO","EMPLOYEE_ID" = DBT_INTERNAL_SOURCE."EMPLOYEE_ID","POSTAL_CODE" = DBT_INTERNAL_SOURCE."POSTAL_CODE","TITLE_OF_COURTESY" = DBT_INTERNAL_SOURCE."TITLE_OF_COURTESY","DBT_UPDATED_AT" = DBT_INTERNAL_SOURCE."DBT_UPDATED_AT"
    

    when not matched then insert
        ("EMPLOYEE_KEY", "_AIRBYTE_RAW_ID", "_AIRBYTE_EXTRACTED_AT", "_AIRBYTE_META", "_AIRBYTE_GENERATION_ID", "CITY", "NOTES", "PHOTO", "TITLE", "REGION", "ADDRESS", "COUNTRY", "EXTENSION", "HIRE_DATE", "LAST_NAME", "BIRTH_DATE", "FIRST_NAME", "HOME_PHONE", "PHOTO_PATH", "REPORTS_TO", "EMPLOYEE_ID", "POSTAL_CODE", "TITLE_OF_COURTESY", "DBT_UPDATED_AT")
    values
        ("EMPLOYEE_KEY", "_AIRBYTE_RAW_ID", "_AIRBYTE_EXTRACTED_AT", "_AIRBYTE_META", "_AIRBYTE_GENERATION_ID", "CITY", "NOTES", "PHOTO", "TITLE", "REGION", "ADDRESS", "COUNTRY", "EXTENSION", "HIRE_DATE", "LAST_NAME", "BIRTH_DATE", "FIRST_NAME", "HOME_PHONE", "PHOTO_PATH", "REPORTS_TO", "EMPLOYEE_ID", "POSTAL_CODE", "TITLE_OF_COURTESY", "DBT_UPDATED_AT")

;
[0m23:10:10.528814 [debug] [Thread-4  ]: Snowflake adapter: Snowflake query id: 01bba71e-020d-01f6-000c-83e7000ad2f6
[0m23:10:10.544540 [debug] [Thread-4  ]: Snowflake adapter: Snowflake error: 100090 (42P18): Duplicate row detected during DML action
Row Values: [redacted]
[0m23:10:10.544540 [debug] [Thread-4  ]: Database Error in model fact_order_details (models\marts\core\fact_order_details.sql)
  100090 (42P18): Duplicate row detected during DML action
  Row Values: [redacted]
  compiled code at target\run\northwind_dbt\models\marts\core\fact_order_details.sql
[0m23:10:10.548766 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6dd93be5-4faf-4883-903d-0d24d0769eaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236FB625190>]}
[0m23:10:10.548766 [error] [Thread-4  ]: 8 of 10 ERROR creating sql incremental model public.fact_order_details ......... [[31mERROR[0m in 1.98s]
[0m23:10:10.548766 [debug] [Thread-4  ]: Finished running node model.northwind_dbt.fact_order_details
[0m23:10:10.548766 [debug] [Thread-7  ]: Marking all children of 'model.northwind_dbt.fact_order_details' to be skipped because of status 'error'.  Reason: Database Error in model fact_order_details (models\marts\core\fact_order_details.sql)
  100090 (42P18): Duplicate row detected during DML action
  Row Values: [redacted]
  compiled code at target\run\northwind_dbt\models\marts\core\fact_order_details.sql.
[0m23:10:10.552137 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.642 seconds
[0m23:10:10.564286 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6dd93be5-4faf-4883-903d-0d24d0769eaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236FA528400>]}
[0m23:10:10.564927 [info ] [Thread-1  ]: 9 of 10 OK created sql table model public.dim_products ......................... [[32mSUCCESS 1[0m in 1.69s]
[0m23:10:10.564927 [debug] [Thread-1  ]: Finished running node model.northwind_dbt.dim_products
[0m23:10:11.099669 [debug] [Thread-2  ]: SQL status: SUCCESS 9 in 1.196 seconds
[0m23:10:11.099669 [debug] [Thread-2  ]: Using snowflake connection "model.northwind_dbt.dim_employees"
[0m23:10:11.115656 [debug] [Thread-2  ]: On model.northwind_dbt.dim_employees: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.dim_employees"} */
COMMIT
[0m23:10:11.541370 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.435 seconds
[0m23:10:11.565669 [debug] [Thread-2  ]: Applying DROP to: Project_2.public.dim_employees__dbt_tmp
[0m23:10:11.572539 [debug] [Thread-2  ]: Using snowflake connection "model.northwind_dbt.dim_employees"
[0m23:10:11.573432 [debug] [Thread-2  ]: On model.northwind_dbt.dim_employees: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.dim_employees"} */
drop view if exists Project_2.public.dim_employees__dbt_tmp cascade
[0m23:10:11.807219 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.244 seconds
[0m23:10:11.822922 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6dd93be5-4faf-4883-903d-0d24d0769eaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236F9AB2490>]}
[0m23:10:11.822922 [info ] [Thread-2  ]: 7 of 10 OK created sql incremental model public.dim_employees .................. [[32mSUCCESS 9[0m in 3.32s]
[0m23:10:11.822922 [debug] [Thread-2  ]: Finished running node model.northwind_dbt.dim_employees
[0m23:10:11.822922 [debug] [Thread-3  ]: Began running node model.northwind_dbt.obt_orders
[0m23:10:11.822922 [info ] [Thread-3  ]: 10 of 10 SKIP relation public.obt_orders ....................................... [[33mSKIP[0m]
[0m23:10:11.822922 [debug] [Thread-3  ]: Finished running node model.northwind_dbt.obt_orders
[0m23:10:11.822922 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:10:11.822922 [debug] [MainThread]: Connection 'list_Project_2' was left open.
[0m23:10:11.822922 [debug] [MainThread]: On list_Project_2: Close
[0m23:10:11.931926 [debug] [MainThread]: Connection 'list_Project_2_public' was left open.
[0m23:10:11.931926 [debug] [MainThread]: On list_Project_2_public: Close
[0m23:10:12.056592 [debug] [MainThread]: Connection 'model.northwind_dbt.dim_products' was left open.
[0m23:10:12.056592 [debug] [MainThread]: On model.northwind_dbt.dim_products: Close
[0m23:10:12.164351 [debug] [MainThread]: Connection 'model.northwind_dbt.dim_employees' was left open.
[0m23:10:12.164351 [debug] [MainThread]: On model.northwind_dbt.dim_employees: Close
[0m23:10:12.296213 [debug] [MainThread]: Connection 'model.northwind_dbt.dim_customers' was left open.
[0m23:10:12.296213 [debug] [MainThread]: On model.northwind_dbt.dim_customers: Close
[0m23:10:12.432374 [debug] [MainThread]: Connection 'model.northwind_dbt.fact_order_details' was left open.
[0m23:10:12.432374 [debug] [MainThread]: On model.northwind_dbt.fact_order_details: Close
[0m23:10:12.542720 [info ] [MainThread]: 
[0m23:10:12.542720 [info ] [MainThread]: Finished running 2 incremental models, 3 table models, 5 view models in 0 hours 0 minutes and 6.59 seconds (6.59s).
[0m23:10:12.547454 [debug] [MainThread]: Command end result
[0m23:10:12.745296 [debug] [MainThread]: Wrote artifact WritableManifest to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\manifest.json
[0m23:10:12.750966 [debug] [MainThread]: Wrote artifact SemanticManifest to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\semantic_manifest.json
[0m23:10:12.761002 [debug] [MainThread]: Wrote artifact RunExecutionResult to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\run_results.json
[0m23:10:12.761002 [info ] [MainThread]: 
[0m23:10:12.761002 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m23:10:12.761002 [info ] [MainThread]: 
[0m23:10:12.776704 [error] [MainThread]:   Database Error in model fact_order_details (models\marts\core\fact_order_details.sql)
  100090 (42P18): Duplicate row detected during DML action
  Row Values: [redacted]
  compiled code at target\run\northwind_dbt\models\marts\core\fact_order_details.sql
[0m23:10:12.776704 [info ] [MainThread]: 
[0m23:10:12.776704 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=1 SKIP=1 TOTAL=10
[0m23:10:12.776704 [debug] [MainThread]: Command `dbt run` failed at 23:10:12.776704 after 9.99 seconds
[0m23:10:12.782358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236DEB6F430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236E0A43610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236DEA1B3A0>]}
[0m23:10:12.787896 [debug] [MainThread]: Flushing usage events
[0m23:10:13.875820 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:12:13.100686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012C5535F370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012C573D3C70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012C573D3A60>]}


============================== 23:12:13.100686 | 0b365ad6-e71f-461f-a16d-2ed99086f160 ==============================
[0m23:12:13.100686 [info ] [MainThread]: Running with dbt=1.9.0
[0m23:12:13.100686 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'c:\\Users\\fitzp\\Documents\\Alpaca_Market\\zproject_2\\northwind_psql', 'version_check': 'True', 'debug': 'False', 'log_path': 'c:\\Users\\fitzp\\Documents\\Alpaca_Market\\zproject_2\\northwind_psql\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:12:14.704637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0b365ad6-e71f-461f-a16d-2ed99086f160', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012C573A4D30>]}
[0m23:12:14.780826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0b365ad6-e71f-461f-a16d-2ed99086f160', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012C6FEC1940>]}
[0m23:12:14.780826 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m23:12:15.216868 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m23:12:15.577465 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:12:15.578210 [debug] [MainThread]: Partial parsing: updated file: northwind_dbt://models\marts\core\fact_order_details.sql
[0m23:12:15.805486 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.northwind_dbt.marts.bi
[0m23:12:15.821518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0b365ad6-e71f-461f-a16d-2ed99086f160', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012C705D8EE0>]}
[0m23:12:16.071674 [debug] [MainThread]: Wrote artifact WritableManifest to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\manifest.json
[0m23:12:16.081519 [debug] [MainThread]: Wrote artifact SemanticManifest to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\semantic_manifest.json
[0m23:12:16.170986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0b365ad6-e71f-461f-a16d-2ed99086f160', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012C70483CD0>]}
[0m23:12:16.173005 [info ] [MainThread]: Found 10 models, 8 sources, 706 macros
[0m23:12:16.173005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b365ad6-e71f-461f-a16d-2ed99086f160', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012C6FEE08E0>]}
[0m23:12:16.173005 [info ] [MainThread]: 
[0m23:12:16.178358 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:12:16.180463 [info ] [MainThread]: 
[0m23:12:16.182081 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:12:16.183521 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_Project_2'
[0m23:12:16.284764 [debug] [ThreadPool]: Using snowflake connection "list_Project_2"
[0m23:12:16.284764 [debug] [ThreadPool]: On list_Project_2: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "connection_name": "list_Project_2"} */
show terse schemas in database Project_2
    limit 10000
[0m23:12:16.284764 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:12:16.956499 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.677 seconds
[0m23:12:16.971953 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_Project_2_public'
[0m23:12:16.992065 [debug] [ThreadPool]: Using snowflake connection "list_Project_2_public"
[0m23:12:16.994082 [debug] [ThreadPool]: On list_Project_2_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "connection_name": "list_Project_2_public"} */
show objects in Project_2.public limit 10000;
[0m23:12:16.994082 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:12:17.688341 [debug] [ThreadPool]: SQL status: SUCCESS 23 in 0.693 seconds
[0m23:12:17.688341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b365ad6-e71f-461f-a16d-2ed99086f160', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012C705354C0>]}
[0m23:12:17.701442 [debug] [Thread-1  ]: Began running node model.northwind_dbt.stg_customers
[0m23:12:17.709393 [debug] [Thread-2  ]: Began running node model.northwind_dbt.stg_employees
[0m23:12:17.709393 [debug] [Thread-3  ]: Began running node model.northwind_dbt.stg_order_details
[0m23:12:17.711415 [debug] [Thread-4  ]: Began running node model.northwind_dbt.stg_orders
[0m23:12:17.711415 [info ] [Thread-1  ]: 1 of 10 START sql view model public.stg_customers .............................. [RUN]
[0m23:12:17.711415 [info ] [Thread-2  ]: 2 of 10 START sql view model public.stg_employees .............................. [RUN]
[0m23:12:17.716510 [info ] [Thread-3  ]: 3 of 10 START sql view model public.stg_order_details .......................... [RUN]
[0m23:12:17.719036 [info ] [Thread-4  ]: 4 of 10 START sql view model public.stg_orders ................................. [RUN]
[0m23:12:17.723492 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.northwind_dbt.stg_customers'
[0m23:12:17.723492 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.northwind_dbt.stg_employees'
[0m23:12:17.723492 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.northwind_dbt.stg_order_details'
[0m23:12:17.723492 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.northwind_dbt.stg_orders'
[0m23:12:17.723492 [debug] [Thread-1  ]: Began compiling node model.northwind_dbt.stg_customers
[0m23:12:17.723492 [debug] [Thread-2  ]: Began compiling node model.northwind_dbt.stg_employees
[0m23:12:17.723492 [debug] [Thread-3  ]: Began compiling node model.northwind_dbt.stg_order_details
[0m23:12:17.723492 [debug] [Thread-4  ]: Began compiling node model.northwind_dbt.stg_orders
[0m23:12:17.745280 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind_dbt.stg_customers"
[0m23:12:17.747294 [debug] [Thread-2  ]: Writing injected SQL for node "model.northwind_dbt.stg_employees"
[0m23:12:17.751319 [debug] [Thread-3  ]: Writing injected SQL for node "model.northwind_dbt.stg_order_details"
[0m23:12:17.756265 [debug] [Thread-4  ]: Writing injected SQL for node "model.northwind_dbt.stg_orders"
[0m23:12:17.787155 [debug] [Thread-1  ]: Began executing node model.northwind_dbt.stg_customers
[0m23:12:17.788236 [debug] [Thread-4  ]: Began executing node model.northwind_dbt.stg_orders
[0m23:12:17.788236 [debug] [Thread-2  ]: Began executing node model.northwind_dbt.stg_employees
[0m23:12:17.789255 [debug] [Thread-3  ]: Began executing node model.northwind_dbt.stg_order_details
[0m23:12:17.812243 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind_dbt.stg_customers"
[0m23:12:17.816241 [debug] [Thread-4  ]: Writing runtime sql for node "model.northwind_dbt.stg_orders"
[0m23:12:17.820243 [debug] [Thread-2  ]: Writing runtime sql for node "model.northwind_dbt.stg_employees"
[0m23:12:17.821241 [debug] [Thread-3  ]: Writing runtime sql for node "model.northwind_dbt.stg_order_details"
[0m23:12:17.843947 [debug] [Thread-4  ]: Using snowflake connection "model.northwind_dbt.stg_orders"
[0m23:12:17.843947 [debug] [Thread-1  ]: Using snowflake connection "model.northwind_dbt.stg_customers"
[0m23:12:17.845964 [debug] [Thread-2  ]: Using snowflake connection "model.northwind_dbt.stg_employees"
[0m23:12:17.845964 [debug] [Thread-3  ]: Using snowflake connection "model.northwind_dbt.stg_order_details"
[0m23:12:17.847972 [debug] [Thread-4  ]: On model.northwind_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.stg_orders"} */
create or replace   view Project_2.public.stg_orders
  
   as (
    select * from PROJECT_2.PUBLIC.orders
  );
[0m23:12:17.847972 [debug] [Thread-1  ]: On model.northwind_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.stg_customers"} */
create or replace   view Project_2.public.stg_customers
  
   as (
    select * from PROJECT_2.PUBLIC.customers
  );
[0m23:12:17.849981 [debug] [Thread-2  ]: On model.northwind_dbt.stg_employees: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.stg_employees"} */
create or replace   view Project_2.public.stg_employees
  
   as (
    select * from PROJECT_2.PUBLIC.employees
  );
[0m23:12:17.849981 [debug] [Thread-3  ]: On model.northwind_dbt.stg_order_details: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.stg_order_details"} */
create or replace   view Project_2.public.stg_order_details
  
   as (
    select * from PROJECT_2.PUBLIC.order_details
  );
[0m23:12:17.849981 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m23:12:17.851991 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m23:12:17.852997 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m23:12:17.853883 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m23:12:18.732641 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.878 seconds
[0m23:12:18.767126 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b365ad6-e71f-461f-a16d-2ed99086f160', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012C70696130>]}
[0m23:12:18.768886 [info ] [Thread-3  ]: 3 of 10 OK created sql view model public.stg_order_details ..................... [[32mSUCCESS 1[0m in 1.04s]
[0m23:12:18.772346 [debug] [Thread-3  ]: Finished running node model.northwind_dbt.stg_order_details
[0m23:12:18.773938 [debug] [Thread-3  ]: Began running node model.northwind_dbt.stg_products
[0m23:12:18.775520 [info ] [Thread-3  ]: 5 of 10 START sql view model public.stg_products ............................... [RUN]
[0m23:12:18.779202 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.northwind_dbt.stg_order_details, now model.northwind_dbt.stg_products)
[0m23:12:18.782236 [debug] [Thread-3  ]: Began compiling node model.northwind_dbt.stg_products
[0m23:12:18.792383 [debug] [Thread-3  ]: Writing injected SQL for node "model.northwind_dbt.stg_products"
[0m23:12:18.795377 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.943 seconds
[0m23:12:18.804995 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b365ad6-e71f-461f-a16d-2ed99086f160', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012C70DBABE0>]}
[0m23:12:18.807006 [info ] [Thread-1  ]: 1 of 10 OK created sql view model public.stg_customers ......................... [[32mSUCCESS 1[0m in 1.08s]
[0m23:12:18.811915 [debug] [Thread-1  ]: Finished running node model.northwind_dbt.stg_customers
[0m23:12:18.818144 [debug] [Thread-1  ]: Began running node model.northwind_dbt.dim_customers
[0m23:12:18.822083 [debug] [Thread-3  ]: Began executing node model.northwind_dbt.stg_products
[0m23:12:18.821008 [info ] [Thread-1  ]: 6 of 10 START sql table model public.dim_customers ............................. [RUN]
[0m23:12:18.838092 [debug] [Thread-3  ]: Writing runtime sql for node "model.northwind_dbt.stg_products"
[0m23:12:18.839406 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.northwind_dbt.stg_customers, now model.northwind_dbt.dim_customers)
[0m23:12:18.843270 [debug] [Thread-1  ]: Began compiling node model.northwind_dbt.dim_customers
[0m23:12:18.855943 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind_dbt.dim_customers"
[0m23:12:18.882319 [debug] [Thread-3  ]: Using snowflake connection "model.northwind_dbt.stg_products"
[0m23:12:18.883963 [debug] [Thread-1  ]: Began executing node model.northwind_dbt.dim_customers
[0m23:12:18.885582 [debug] [Thread-3  ]: On model.northwind_dbt.stg_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.stg_products"} */
create or replace   view Project_2.public.stg_products
  
   as (
    select * from PROJECT_2.PUBLIC.products
  );
[0m23:12:19.026140 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1.174 seconds
[0m23:12:19.031602 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind_dbt.dim_customers"
[0m23:12:19.032717 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.179 seconds
[0m23:12:19.038877 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b365ad6-e71f-461f-a16d-2ed99086f160', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012C70DFC1C0>]}
[0m23:12:19.044867 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b365ad6-e71f-461f-a16d-2ed99086f160', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012C545B7400>]}
[0m23:12:19.044867 [info ] [Thread-4  ]: 4 of 10 OK created sql view model public.stg_orders ............................ [[32mSUCCESS 1[0m in 1.31s]
[0m23:12:19.050249 [info ] [Thread-2  ]: 2 of 10 OK created sql view model public.stg_employees ......................... [[32mSUCCESS 1[0m in 1.32s]
[0m23:12:19.052456 [debug] [Thread-1  ]: Using snowflake connection "model.northwind_dbt.dim_customers"
[0m23:12:19.052456 [debug] [Thread-4  ]: Finished running node model.northwind_dbt.stg_orders
[0m23:12:19.052456 [debug] [Thread-2  ]: Finished running node model.northwind_dbt.stg_employees
[0m23:12:19.052456 [debug] [Thread-1  ]: On model.northwind_dbt.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.dim_customers"} */
create or replace transient table Project_2.public.dim_customers
         as
        (select * from Project_2.public.stg_customers
        );
[0m23:12:19.057107 [debug] [Thread-4  ]: Began running node model.northwind_dbt.fact_order_details
[0m23:12:19.059398 [debug] [Thread-2  ]: Began running node model.northwind_dbt.dim_employees
[0m23:12:19.059964 [info ] [Thread-4  ]: 7 of 10 START sql incremental model public.fact_order_details .................. [RUN]
[0m23:12:19.066828 [info ] [Thread-2  ]: 8 of 10 START sql incremental model public.dim_employees ....................... [RUN]
[0m23:12:19.066828 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.northwind_dbt.stg_orders, now model.northwind_dbt.fact_order_details)
[0m23:12:19.066828 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.northwind_dbt.stg_employees, now model.northwind_dbt.dim_employees)
[0m23:12:19.066828 [debug] [Thread-4  ]: Began compiling node model.northwind_dbt.fact_order_details
[0m23:12:19.072770 [debug] [Thread-2  ]: Began compiling node model.northwind_dbt.dim_employees
[0m23:12:19.083406 [debug] [Thread-4  ]: Writing injected SQL for node "model.northwind_dbt.fact_order_details"
[0m23:12:19.104336 [debug] [Thread-2  ]: Writing injected SQL for node "model.northwind_dbt.dim_employees"
[0m23:12:19.131013 [debug] [Thread-2  ]: Began executing node model.northwind_dbt.dim_employees
[0m23:12:19.131683 [debug] [Thread-4  ]: Began executing node model.northwind_dbt.fact_order_details
[0m23:12:19.184050 [debug] [Thread-2  ]: Using snowflake connection "model.northwind_dbt.dim_employees"
[0m23:12:19.191133 [debug] [Thread-4  ]: Using snowflake connection "model.northwind_dbt.fact_order_details"
[0m23:12:19.196049 [debug] [Thread-2  ]: On model.northwind_dbt.dim_employees: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.dim_employees"} */
create or replace  temporary view Project_2.public.dim_employees__dbt_tmp
  
   as (
    

with source_data as (
    select * from Project_2.public.stg_employees
),
scd2 as (
    select 
        md5(cast(coalesce(cast(employee_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as employee_key,
        *,
        current_timestamp as dbt_updated_at
    from source_data
)
select * from scd2
  );
[0m23:12:19.196049 [debug] [Thread-4  ]: On model.northwind_dbt.fact_order_details: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.fact_order_details"} */
create or replace  temporary view Project_2.public.fact_order_details__dbt_tmp
  
   as (
    

with base as (
    select 
        od.order_id,
        od.product_id,
        o.customer_id,
        o.employee_id,
        o.ship_via as shipper_id,
        o.order_date,
        od.unit_price,
        od.quantity,
        od.discount,
        od.unit_price * od.quantity * (1 - od.discount) as revenue
    from Project_2.public.stg_order_details od
    join Project_2.public.stg_orders o on od.order_id = o.order_id
    
        where o.order_date >= (select max(order_date) from Project_2.public.fact_order_details)
    
),
aggregated as (
    select 
        order_id,
        customer_id,
        employee_id,
        shipper_id,
        cast(order_date as date) as order_date,
        sum(revenue) as total_revenue,
        avg(revenue) as avg_revenue,
        max(revenue) as max_revenue,
        min(revenue) as min_revenue,
        count(*) as line_count,
        rank() over (partition by customer_id order by sum(revenue) desc) as revenue_rank
    from base
    group by order_id, product_id, customer_id, employee_id, shipper_id, order_date
)
select * from aggregated
  );
[0m23:12:19.615844 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.418 seconds
[0m23:12:19.615844 [debug] [Thread-4  ]: Using snowflake connection "model.northwind_dbt.fact_order_details"
[0m23:12:19.615844 [debug] [Thread-4  ]: On model.northwind_dbt.fact_order_details: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.fact_order_details"} */
describe table Project_2.public.fact_order_details__dbt_tmp
[0m23:12:19.719079 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.520 seconds
[0m23:12:19.724975 [debug] [Thread-2  ]: Using snowflake connection "model.northwind_dbt.dim_employees"
[0m23:12:19.724975 [debug] [Thread-2  ]: On model.northwind_dbt.dim_employees: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.dim_employees"} */
describe table Project_2.public.dim_employees__dbt_tmp
[0m23:12:19.772203 [debug] [Thread-4  ]: SQL status: SUCCESS 11 in 0.144 seconds
[0m23:12:19.781025 [debug] [Thread-4  ]: Using snowflake connection "model.northwind_dbt.fact_order_details"
[0m23:12:19.781025 [debug] [Thread-4  ]: On model.northwind_dbt.fact_order_details: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.fact_order_details"} */
describe table Project_2.public.fact_order_details
[0m23:12:19.837830 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.805 seconds
[0m23:12:19.839845 [debug] [Thread-2  ]: SQL status: SUCCESS 24 in 0.111 seconds
[0m23:12:19.839845 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b365ad6-e71f-461f-a16d-2ed99086f160', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012C70696130>]}
[0m23:12:19.853476 [debug] [Thread-2  ]: Using snowflake connection "model.northwind_dbt.dim_employees"
[0m23:12:19.855475 [info ] [Thread-3  ]: 5 of 10 OK created sql view model public.stg_products .......................... [[32mSUCCESS 1[0m in 1.06s]
[0m23:12:19.858483 [debug] [Thread-2  ]: On model.northwind_dbt.dim_employees: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.dim_employees"} */
describe table Project_2.public.dim_employees
[0m23:12:19.860479 [debug] [Thread-3  ]: Finished running node model.northwind_dbt.stg_products
[0m23:12:19.862352 [debug] [Thread-3  ]: Began running node model.northwind_dbt.dim_products
[0m23:12:19.862352 [debug] [Thread-4  ]: SQL status: SUCCESS 11 in 0.087 seconds
[0m23:12:19.862352 [info ] [Thread-3  ]: 9 of 10 START sql table model public.dim_products .............................. [RUN]
[0m23:12:19.886714 [debug] [Thread-4  ]: Using snowflake connection "model.northwind_dbt.fact_order_details"
[0m23:12:19.886714 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.northwind_dbt.stg_products, now model.northwind_dbt.dim_products)
[0m23:12:19.886714 [debug] [Thread-4  ]: On model.northwind_dbt.fact_order_details: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.fact_order_details"} */
describe table "PROJECT_2"."PUBLIC"."FACT_ORDER_DETAILS"
[0m23:12:19.886714 [debug] [Thread-3  ]: Began compiling node model.northwind_dbt.dim_products
[0m23:12:19.891202 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.832 seconds
[0m23:12:19.897355 [debug] [Thread-3  ]: Writing injected SQL for node "model.northwind_dbt.dim_products"
[0m23:12:19.898699 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b365ad6-e71f-461f-a16d-2ed99086f160', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012C70D994F0>]}
[0m23:12:19.906191 [info ] [Thread-1  ]: 6 of 10 OK created sql table model public.dim_customers ........................ [[32mSUCCESS 1[0m in 1.06s]
[0m23:12:19.906191 [debug] [Thread-1  ]: Finished running node model.northwind_dbt.dim_customers
[0m23:12:19.918102 [debug] [Thread-3  ]: Began executing node model.northwind_dbt.dim_products
[0m23:12:19.918102 [debug] [Thread-3  ]: Writing runtime sql for node "model.northwind_dbt.dim_products"
[0m23:12:19.932299 [debug] [Thread-3  ]: Using snowflake connection "model.northwind_dbt.dim_products"
[0m23:12:19.932299 [debug] [Thread-3  ]: On model.northwind_dbt.dim_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.dim_products"} */
create or replace transient table Project_2.public.dim_products
         as
        (select 
    p.product_id,
    p.product_name,
    p.supplier_id,
    s.company_name as supplier_name,
    p.category_id,
    c.category_name,
    p.quantity_per_unit,
    p.unit_price,
    p.units_in_stock,
    p.units_on_order,
    p.reorder_level,
    p.discontinued
from Project_2.public.stg_products p
left join PROJECT_2.PUBLIC.suppliers s on p.supplier_id = s.supplier_id
left join PROJECT_2.PUBLIC.categories c on p.category_id = c.category_id
        );
[0m23:12:19.968914 [debug] [Thread-2  ]: SQL status: SUCCESS 24 in 0.106 seconds
[0m23:12:19.973972 [debug] [Thread-2  ]: Using snowflake connection "model.northwind_dbt.dim_employees"
[0m23:12:19.974981 [debug] [Thread-2  ]: On model.northwind_dbt.dim_employees: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.dim_employees"} */
describe table "PROJECT_2"."PUBLIC"."DIM_EMPLOYEES"
[0m23:12:20.089016 [debug] [Thread-4  ]: SQL status: SUCCESS 11 in 0.197 seconds
[0m23:12:20.110867 [debug] [Thread-4  ]: Writing runtime sql for node "model.northwind_dbt.fact_order_details"
[0m23:12:20.125513 [debug] [Thread-2  ]: SQL status: SUCCESS 24 in 0.151 seconds
[0m23:12:20.125513 [debug] [Thread-4  ]: Using snowflake connection "model.northwind_dbt.fact_order_details"
[0m23:12:20.125513 [debug] [Thread-2  ]: Writing runtime sql for node "model.northwind_dbt.dim_employees"
[0m23:12:20.138102 [debug] [Thread-4  ]: On model.northwind_dbt.fact_order_details: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.fact_order_details"} */
-- back compat for old kwarg name
  
  begin;
[0m23:12:20.139419 [debug] [Thread-2  ]: Using snowflake connection "model.northwind_dbt.dim_employees"
[0m23:12:20.139419 [debug] [Thread-2  ]: On model.northwind_dbt.dim_employees: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.dim_employees"} */
-- back compat for old kwarg name
  
  begin;
[0m23:12:20.248700 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.110 seconds
[0m23:12:20.248700 [debug] [Thread-4  ]: Using snowflake connection "model.northwind_dbt.fact_order_details"
[0m23:12:20.254921 [debug] [Thread-4  ]: On model.northwind_dbt.fact_order_details: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.fact_order_details"} */
merge into Project_2.public.fact_order_details as DBT_INTERNAL_DEST
        using Project_2.public.fact_order_details__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.order_id = DBT_INTERNAL_DEST.order_id
                ) and (
                    DBT_INTERNAL_SOURCE.product_id = DBT_INTERNAL_DEST.product_id
                )

    
    when matched then update set
        "ORDER_ID" = DBT_INTERNAL_SOURCE."ORDER_ID","CUSTOMER_ID" = DBT_INTERNAL_SOURCE."CUSTOMER_ID","EMPLOYEE_ID" = DBT_INTERNAL_SOURCE."EMPLOYEE_ID","SHIPPER_ID" = DBT_INTERNAL_SOURCE."SHIPPER_ID","ORDER_DATE" = DBT_INTERNAL_SOURCE."ORDER_DATE","TOTAL_REVENUE" = DBT_INTERNAL_SOURCE."TOTAL_REVENUE","AVG_REVENUE" = DBT_INTERNAL_SOURCE."AVG_REVENUE","MAX_REVENUE" = DBT_INTERNAL_SOURCE."MAX_REVENUE","MIN_REVENUE" = DBT_INTERNAL_SOURCE."MIN_REVENUE","LINE_COUNT" = DBT_INTERNAL_SOURCE."LINE_COUNT","REVENUE_RANK" = DBT_INTERNAL_SOURCE."REVENUE_RANK"
    

    when not matched then insert
        ("ORDER_ID", "CUSTOMER_ID", "EMPLOYEE_ID", "SHIPPER_ID", "ORDER_DATE", "TOTAL_REVENUE", "AVG_REVENUE", "MAX_REVENUE", "MIN_REVENUE", "LINE_COUNT", "REVENUE_RANK")
    values
        ("ORDER_ID", "CUSTOMER_ID", "EMPLOYEE_ID", "SHIPPER_ID", "ORDER_DATE", "TOTAL_REVENUE", "AVG_REVENUE", "MAX_REVENUE", "MIN_REVENUE", "LINE_COUNT", "REVENUE_RANK")

;
[0m23:12:20.364580 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.220 seconds
[0m23:12:20.371034 [debug] [Thread-2  ]: Using snowflake connection "model.northwind_dbt.dim_employees"
[0m23:12:20.371034 [debug] [Thread-2  ]: On model.northwind_dbt.dim_employees: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.dim_employees"} */
merge into Project_2.public.dim_employees as DBT_INTERNAL_DEST
        using Project_2.public.dim_employees__dbt_tmp as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.employee_key = DBT_INTERNAL_DEST.employee_key))

    
    when matched then update set
        "EMPLOYEE_KEY" = DBT_INTERNAL_SOURCE."EMPLOYEE_KEY","_AIRBYTE_RAW_ID" = DBT_INTERNAL_SOURCE."_AIRBYTE_RAW_ID","_AIRBYTE_EXTRACTED_AT" = DBT_INTERNAL_SOURCE."_AIRBYTE_EXTRACTED_AT","_AIRBYTE_META" = DBT_INTERNAL_SOURCE."_AIRBYTE_META","_AIRBYTE_GENERATION_ID" = DBT_INTERNAL_SOURCE."_AIRBYTE_GENERATION_ID","CITY" = DBT_INTERNAL_SOURCE."CITY","NOTES" = DBT_INTERNAL_SOURCE."NOTES","PHOTO" = DBT_INTERNAL_SOURCE."PHOTO","TITLE" = DBT_INTERNAL_SOURCE."TITLE","REGION" = DBT_INTERNAL_SOURCE."REGION","ADDRESS" = DBT_INTERNAL_SOURCE."ADDRESS","COUNTRY" = DBT_INTERNAL_SOURCE."COUNTRY","EXTENSION" = DBT_INTERNAL_SOURCE."EXTENSION","HIRE_DATE" = DBT_INTERNAL_SOURCE."HIRE_DATE","LAST_NAME" = DBT_INTERNAL_SOURCE."LAST_NAME","BIRTH_DATE" = DBT_INTERNAL_SOURCE."BIRTH_DATE","FIRST_NAME" = DBT_INTERNAL_SOURCE."FIRST_NAME","HOME_PHONE" = DBT_INTERNAL_SOURCE."HOME_PHONE","PHOTO_PATH" = DBT_INTERNAL_SOURCE."PHOTO_PATH","REPORTS_TO" = DBT_INTERNAL_SOURCE."REPORTS_TO","EMPLOYEE_ID" = DBT_INTERNAL_SOURCE."EMPLOYEE_ID","POSTAL_CODE" = DBT_INTERNAL_SOURCE."POSTAL_CODE","TITLE_OF_COURTESY" = DBT_INTERNAL_SOURCE."TITLE_OF_COURTESY","DBT_UPDATED_AT" = DBT_INTERNAL_SOURCE."DBT_UPDATED_AT"
    

    when not matched then insert
        ("EMPLOYEE_KEY", "_AIRBYTE_RAW_ID", "_AIRBYTE_EXTRACTED_AT", "_AIRBYTE_META", "_AIRBYTE_GENERATION_ID", "CITY", "NOTES", "PHOTO", "TITLE", "REGION", "ADDRESS", "COUNTRY", "EXTENSION", "HIRE_DATE", "LAST_NAME", "BIRTH_DATE", "FIRST_NAME", "HOME_PHONE", "PHOTO_PATH", "REPORTS_TO", "EMPLOYEE_ID", "POSTAL_CODE", "TITLE_OF_COURTESY", "DBT_UPDATED_AT")
    values
        ("EMPLOYEE_KEY", "_AIRBYTE_RAW_ID", "_AIRBYTE_EXTRACTED_AT", "_AIRBYTE_META", "_AIRBYTE_GENERATION_ID", "CITY", "NOTES", "PHOTO", "TITLE", "REGION", "ADDRESS", "COUNTRY", "EXTENSION", "HIRE_DATE", "LAST_NAME", "BIRTH_DATE", "FIRST_NAME", "HOME_PHONE", "PHOTO_PATH", "REPORTS_TO", "EMPLOYEE_ID", "POSTAL_CODE", "TITLE_OF_COURTESY", "DBT_UPDATED_AT")

;
[0m23:12:20.524787 [debug] [Thread-4  ]: Snowflake adapter: Snowflake query id: 01bba720-020d-034d-000c-83e7000ae2be
[0m23:12:20.526795 [debug] [Thread-4  ]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 6 at position 20
invalid identifier 'DBT_INTERNAL_SOURCE.PRODUCT_ID'
[0m23:12:20.529903 [debug] [Thread-4  ]: Database Error in model fact_order_details (models\marts\core\fact_order_details.sql)
  000904 (42000): SQL compilation error: error line 6 at position 20
  invalid identifier 'DBT_INTERNAL_SOURCE.PRODUCT_ID'
  compiled code at target\run\northwind_dbt\models\marts\core\fact_order_details.sql
[0m23:12:20.529903 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b365ad6-e71f-461f-a16d-2ed99086f160', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012C703B9CD0>]}
[0m23:12:20.529903 [error] [Thread-4  ]: 7 of 10 ERROR creating sql incremental model public.fact_order_details ......... [[31mERROR[0m in 1.46s]
[0m23:12:20.529903 [debug] [Thread-4  ]: Finished running node model.northwind_dbt.fact_order_details
[0m23:12:20.529903 [debug] [Thread-7  ]: Marking all children of 'model.northwind_dbt.fact_order_details' to be skipped because of status 'error'.  Reason: Database Error in model fact_order_details (models\marts\core\fact_order_details.sql)
  000904 (42000): SQL compilation error: error line 6 at position 20
  invalid identifier 'DBT_INTERNAL_SOURCE.PRODUCT_ID'
  compiled code at target\run\northwind_dbt\models\marts\core\fact_order_details.sql.
[0m23:12:20.710660 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.784 seconds
[0m23:12:20.710660 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b365ad6-e71f-461f-a16d-2ed99086f160', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012C7048C220>]}
[0m23:12:20.710660 [info ] [Thread-3  ]: 9 of 10 OK created sql table model public.dim_products ......................... [[32mSUCCESS 1[0m in 0.82s]
[0m23:12:20.727282 [debug] [Thread-3  ]: Finished running node model.northwind_dbt.dim_products
[0m23:12:21.143032 [debug] [Thread-2  ]: SQL status: SUCCESS 9 in 0.770 seconds
[0m23:12:21.145049 [debug] [Thread-2  ]: Using snowflake connection "model.northwind_dbt.dim_employees"
[0m23:12:21.145049 [debug] [Thread-2  ]: On model.northwind_dbt.dim_employees: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.dim_employees"} */
COMMIT
[0m23:12:21.479286 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.333 seconds
[0m23:12:21.485523 [debug] [Thread-2  ]: Applying DROP to: Project_2.public.dim_employees__dbt_tmp
[0m23:12:21.490933 [debug] [Thread-2  ]: Using snowflake connection "model.northwind_dbt.dim_employees"
[0m23:12:21.490933 [debug] [Thread-2  ]: On model.northwind_dbt.dim_employees: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.dim_employees"} */
drop view if exists Project_2.public.dim_employees__dbt_tmp cascade
[0m23:12:21.627369 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.134 seconds
[0m23:12:21.629383 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b365ad6-e71f-461f-a16d-2ed99086f160', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012C71E18A60>]}
[0m23:12:21.629383 [info ] [Thread-2  ]: 8 of 10 OK created sql incremental model public.dim_employees .................. [[32mSUCCESS 9[0m in 2.56s]
[0m23:12:21.629383 [debug] [Thread-2  ]: Finished running node model.northwind_dbt.dim_employees
[0m23:12:21.633406 [debug] [Thread-1  ]: Began running node model.northwind_dbt.obt_orders
[0m23:12:21.634120 [info ] [Thread-1  ]: 10 of 10 SKIP relation public.obt_orders ....................................... [[33mSKIP[0m]
[0m23:12:21.634120 [debug] [Thread-1  ]: Finished running node model.northwind_dbt.obt_orders
[0m23:12:21.637290 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:12:21.637290 [debug] [MainThread]: Connection 'list_Project_2' was left open.
[0m23:12:21.638763 [debug] [MainThread]: On list_Project_2: Close
[0m23:12:21.781489 [debug] [MainThread]: Connection 'list_Project_2_public' was left open.
[0m23:12:21.781489 [debug] [MainThread]: On list_Project_2_public: Close
[0m23:12:21.950688 [debug] [MainThread]: Connection 'model.northwind_dbt.dim_customers' was left open.
[0m23:12:21.950688 [debug] [MainThread]: On model.northwind_dbt.dim_customers: Close
[0m23:12:22.276415 [debug] [MainThread]: Connection 'model.northwind_dbt.dim_employees' was left open.
[0m23:12:22.281766 [debug] [MainThread]: On model.northwind_dbt.dim_employees: Close
[0m23:12:22.401205 [debug] [MainThread]: Connection 'model.northwind_dbt.dim_products' was left open.
[0m23:12:22.401205 [debug] [MainThread]: On model.northwind_dbt.dim_products: Close
[0m23:12:22.512869 [debug] [MainThread]: Connection 'model.northwind_dbt.fact_order_details' was left open.
[0m23:12:22.512869 [debug] [MainThread]: On model.northwind_dbt.fact_order_details: Close
[0m23:12:22.637494 [info ] [MainThread]: 
[0m23:12:22.637494 [info ] [MainThread]: Finished running 2 incremental models, 3 table models, 5 view models in 0 hours 0 minutes and 6.46 seconds (6.46s).
[0m23:12:22.637494 [debug] [MainThread]: Command end result
[0m23:12:22.868789 [debug] [MainThread]: Wrote artifact WritableManifest to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\manifest.json
[0m23:12:22.868789 [debug] [MainThread]: Wrote artifact SemanticManifest to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\semantic_manifest.json
[0m23:12:22.888181 [debug] [MainThread]: Wrote artifact RunExecutionResult to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\run_results.json
[0m23:12:22.888181 [info ] [MainThread]: 
[0m23:12:22.900888 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m23:12:22.904089 [info ] [MainThread]: 
[0m23:12:22.904089 [error] [MainThread]:   Database Error in model fact_order_details (models\marts\core\fact_order_details.sql)
  000904 (42000): SQL compilation error: error line 6 at position 20
  invalid identifier 'DBT_INTERNAL_SOURCE.PRODUCT_ID'
  compiled code at target\run\northwind_dbt\models\marts\core\fact_order_details.sql
[0m23:12:22.912705 [info ] [MainThread]: 
[0m23:12:22.914346 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=1 SKIP=1 TOTAL=10
[0m23:12:22.914346 [debug] [MainThread]: Command `dbt run` failed at 23:12:22.914346 after 9.90 seconds
[0m23:12:22.914346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012C5535F370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012C70483B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012C56D57460>]}
[0m23:12:22.914346 [debug] [MainThread]: Flushing usage events
[0m23:12:23.899343 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:14:25.366358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276D0BB0310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276D2C23AF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276D2C238E0>]}


============================== 23:14:25.378253 | d7e4045d-f96f-40a9-963f-244b2ff2806c ==============================
[0m23:14:25.378253 [info ] [MainThread]: Running with dbt=1.9.0
[0m23:14:25.378253 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'c:\\Users\\fitzp\\Documents\\Alpaca_Market\\zproject_2\\northwind_psql', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'c:\\Users\\fitzp\\Documents\\Alpaca_Market\\zproject_2\\northwind_psql\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:14:26.403147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd7e4045d-f96f-40a9-963f-244b2ff2806c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276D2BEE760>]}
[0m23:14:26.467061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd7e4045d-f96f-40a9-963f-244b2ff2806c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276EB6AA5B0>]}
[0m23:14:26.469496 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m23:14:27.178889 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m23:14:27.562366 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:14:27.562366 [debug] [MainThread]: Partial parsing: updated file: northwind_dbt://models\marts\core\fact_order_details.sql
[0m23:14:27.823240 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.northwind_dbt.marts.bi
[0m23:14:27.844196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd7e4045d-f96f-40a9-963f-244b2ff2806c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276EBE1AEE0>]}
[0m23:14:28.083547 [debug] [MainThread]: Wrote artifact WritableManifest to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\manifest.json
[0m23:14:28.087003 [debug] [MainThread]: Wrote artifact SemanticManifest to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\semantic_manifest.json
[0m23:14:28.150453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd7e4045d-f96f-40a9-963f-244b2ff2806c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276EBCC5190>]}
[0m23:14:28.166258 [info ] [MainThread]: Found 10 models, 8 sources, 706 macros
[0m23:14:28.166258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd7e4045d-f96f-40a9-963f-244b2ff2806c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276EB746A00>]}
[0m23:14:28.166258 [info ] [MainThread]: 
[0m23:14:28.169533 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:14:28.169533 [info ] [MainThread]: 
[0m23:14:28.169533 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:14:28.169533 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_Project_2'
[0m23:14:28.259882 [debug] [ThreadPool]: Using snowflake connection "list_Project_2"
[0m23:14:28.260882 [debug] [ThreadPool]: On list_Project_2: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "connection_name": "list_Project_2"} */
show terse schemas in database Project_2
    limit 10000
[0m23:14:28.260882 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:14:28.992466 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.731 seconds
[0m23:14:29.001368 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_Project_2_public'
[0m23:14:29.025517 [debug] [ThreadPool]: Using snowflake connection "list_Project_2_public"
[0m23:14:29.026627 [debug] [ThreadPool]: On list_Project_2_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "connection_name": "list_Project_2_public"} */
show objects in Project_2.public limit 10000;
[0m23:14:29.027149 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:14:29.476756 [debug] [ThreadPool]: SQL status: SUCCESS 23 in 0.459 seconds
[0m23:14:29.476756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd7e4045d-f96f-40a9-963f-244b2ff2806c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276EB6BEE50>]}
[0m23:14:29.496347 [debug] [Thread-1  ]: Began running node model.northwind_dbt.stg_customers
[0m23:14:29.498361 [debug] [Thread-2  ]: Began running node model.northwind_dbt.stg_employees
[0m23:14:29.498913 [debug] [Thread-3  ]: Began running node model.northwind_dbt.stg_order_details
[0m23:14:29.498913 [debug] [Thread-4  ]: Began running node model.northwind_dbt.stg_orders
[0m23:14:29.500074 [info ] [Thread-1  ]: 1 of 10 START sql view model public.stg_customers .............................. [RUN]
[0m23:14:29.500074 [info ] [Thread-2  ]: 2 of 10 START sql view model public.stg_employees .............................. [RUN]
[0m23:14:29.500074 [info ] [Thread-3  ]: 3 of 10 START sql view model public.stg_order_details .......................... [RUN]
[0m23:14:29.502916 [info ] [Thread-4  ]: 4 of 10 START sql view model public.stg_orders ................................. [RUN]
[0m23:14:29.502916 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.northwind_dbt.stg_customers'
[0m23:14:29.502916 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.northwind_dbt.stg_employees'
[0m23:14:29.502916 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.northwind_dbt.stg_order_details'
[0m23:14:29.507370 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.northwind_dbt.stg_orders'
[0m23:14:29.508879 [debug] [Thread-1  ]: Began compiling node model.northwind_dbt.stg_customers
[0m23:14:29.509393 [debug] [Thread-2  ]: Began compiling node model.northwind_dbt.stg_employees
[0m23:14:29.511417 [debug] [Thread-3  ]: Began compiling node model.northwind_dbt.stg_order_details
[0m23:14:29.511417 [debug] [Thread-4  ]: Began compiling node model.northwind_dbt.stg_orders
[0m23:14:29.515328 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind_dbt.stg_customers"
[0m23:14:29.515328 [debug] [Thread-2  ]: Writing injected SQL for node "model.northwind_dbt.stg_employees"
[0m23:14:29.527220 [debug] [Thread-3  ]: Writing injected SQL for node "model.northwind_dbt.stg_order_details"
[0m23:14:29.534947 [debug] [Thread-4  ]: Writing injected SQL for node "model.northwind_dbt.stg_orders"
[0m23:14:29.560496 [debug] [Thread-1  ]: Began executing node model.northwind_dbt.stg_customers
[0m23:14:29.560496 [debug] [Thread-4  ]: Began executing node model.northwind_dbt.stg_orders
[0m23:14:29.589478 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind_dbt.stg_customers"
[0m23:14:29.593475 [debug] [Thread-4  ]: Writing runtime sql for node "model.northwind_dbt.stg_orders"
[0m23:14:29.619170 [debug] [Thread-3  ]: Began executing node model.northwind_dbt.stg_order_details
[0m23:14:29.619170 [debug] [Thread-2  ]: Began executing node model.northwind_dbt.stg_employees
[0m23:14:29.619170 [debug] [Thread-1  ]: Using snowflake connection "model.northwind_dbt.stg_customers"
[0m23:14:29.619170 [debug] [Thread-4  ]: Using snowflake connection "model.northwind_dbt.stg_orders"
[0m23:14:29.627341 [debug] [Thread-3  ]: Writing runtime sql for node "model.northwind_dbt.stg_order_details"
[0m23:14:29.627341 [debug] [Thread-2  ]: Writing runtime sql for node "model.northwind_dbt.stg_employees"
[0m23:14:29.632108 [debug] [Thread-1  ]: On model.northwind_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.stg_customers"} */
create or replace   view Project_2.public.stg_customers
  
   as (
    select * from PROJECT_2.PUBLIC.customers
  );
[0m23:14:29.633253 [debug] [Thread-4  ]: On model.northwind_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.stg_orders"} */
create or replace   view Project_2.public.stg_orders
  
   as (
    select * from PROJECT_2.PUBLIC.orders
  );
[0m23:14:29.635271 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m23:14:29.636275 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m23:14:29.649852 [debug] [Thread-3  ]: Using snowflake connection "model.northwind_dbt.stg_order_details"
[0m23:14:29.649852 [debug] [Thread-2  ]: Using snowflake connection "model.northwind_dbt.stg_employees"
[0m23:14:29.649852 [debug] [Thread-3  ]: On model.northwind_dbt.stg_order_details: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.stg_order_details"} */
create or replace   view Project_2.public.stg_order_details
  
   as (
    select * from PROJECT_2.PUBLIC.order_details
  );
[0m23:14:29.649852 [debug] [Thread-2  ]: On model.northwind_dbt.stg_employees: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.stg_employees"} */
create or replace   view Project_2.public.stg_employees
  
   as (
    select * from PROJECT_2.PUBLIC.employees
  );
[0m23:14:29.649852 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m23:14:29.655186 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m23:14:30.357915 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.723 seconds
[0m23:14:30.380244 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.728 seconds
[0m23:14:30.384398 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7e4045d-f96f-40a9-963f-244b2ff2806c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276EC555C70>]}
[0m23:14:30.384398 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7e4045d-f96f-40a9-963f-244b2ff2806c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276EC5B8E80>]}
[0m23:14:30.386590 [info ] [Thread-1  ]: 1 of 10 OK created sql view model public.stg_customers ......................... [[32mSUCCESS 1[0m in 0.88s]
[0m23:14:30.386590 [debug] [Thread-1  ]: Finished running node model.northwind_dbt.stg_customers
[0m23:14:30.386590 [info ] [Thread-3  ]: 3 of 10 OK created sql view model public.stg_order_details ..................... [[32mSUCCESS 1[0m in 0.88s]
[0m23:14:30.386590 [debug] [Thread-1  ]: Began running node model.northwind_dbt.stg_products
[0m23:14:30.386590 [debug] [Thread-3  ]: Finished running node model.northwind_dbt.stg_order_details
[0m23:14:30.386590 [debug] [Thread-3  ]: Began running node model.northwind_dbt.dim_customers
[0m23:14:30.386590 [info ] [Thread-1  ]: 5 of 10 START sql view model public.stg_products ............................... [RUN]
[0m23:14:30.386590 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.northwind_dbt.stg_customers, now model.northwind_dbt.stg_products)
[0m23:14:30.386590 [info ] [Thread-3  ]: 6 of 10 START sql table model public.dim_customers ............................. [RUN]
[0m23:14:30.386590 [debug] [Thread-1  ]: Began compiling node model.northwind_dbt.stg_products
[0m23:14:30.395221 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.northwind_dbt.stg_order_details, now model.northwind_dbt.dim_customers)
[0m23:14:30.395559 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind_dbt.stg_products"
[0m23:14:30.395559 [debug] [Thread-3  ]: Began compiling node model.northwind_dbt.dim_customers
[0m23:14:30.404327 [debug] [Thread-3  ]: Writing injected SQL for node "model.northwind_dbt.dim_customers"
[0m23:14:30.407584 [debug] [Thread-1  ]: Began executing node model.northwind_dbt.stg_products
[0m23:14:30.407584 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.774 seconds
[0m23:14:30.410750 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind_dbt.stg_products"
[0m23:14:30.414699 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7e4045d-f96f-40a9-963f-244b2ff2806c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276EC498F40>]}
[0m23:14:30.414699 [debug] [Thread-3  ]: Began executing node model.northwind_dbt.dim_customers
[0m23:14:30.414699 [info ] [Thread-4  ]: 4 of 10 OK created sql view model public.stg_orders ............................ [[32mSUCCESS 1[0m in 0.91s]
[0m23:14:30.511122 [debug] [Thread-3  ]: Writing runtime sql for node "model.northwind_dbt.dim_customers"
[0m23:14:30.512122 [debug] [Thread-4  ]: Finished running node model.northwind_dbt.stg_orders
[0m23:14:30.514124 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.859 seconds
[0m23:14:30.515071 [debug] [Thread-4  ]: Began running node model.northwind_dbt.fact_order_details
[0m23:14:30.518339 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7e4045d-f96f-40a9-963f-244b2ff2806c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276EC610F70>]}
[0m23:14:30.519332 [debug] [Thread-1  ]: Using snowflake connection "model.northwind_dbt.stg_products"
[0m23:14:30.520329 [info ] [Thread-4  ]: 7 of 10 START sql incremental model public.fact_order_details .................. [RUN]
[0m23:14:30.521568 [info ] [Thread-2  ]: 2 of 10 OK created sql view model public.stg_employees ......................... [[32mSUCCESS 1[0m in 1.02s]
[0m23:14:30.522959 [debug] [Thread-1  ]: On model.northwind_dbt.stg_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.stg_products"} */
create or replace   view Project_2.public.stg_products
  
   as (
    select * from PROJECT_2.PUBLIC.products
  );
[0m23:14:30.522959 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.northwind_dbt.stg_orders, now model.northwind_dbt.fact_order_details)
[0m23:14:30.524347 [debug] [Thread-2  ]: Finished running node model.northwind_dbt.stg_employees
[0m23:14:30.524347 [debug] [Thread-3  ]: Using snowflake connection "model.northwind_dbt.dim_customers"
[0m23:14:30.524347 [debug] [Thread-4  ]: Began compiling node model.northwind_dbt.fact_order_details
[0m23:14:30.524347 [debug] [Thread-2  ]: Began running node model.northwind_dbt.dim_employees
[0m23:14:30.524347 [debug] [Thread-3  ]: On model.northwind_dbt.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.dim_customers"} */
create or replace transient table Project_2.public.dim_customers
         as
        (select * from Project_2.public.stg_customers
        );
[0m23:14:30.537052 [debug] [Thread-4  ]: Writing injected SQL for node "model.northwind_dbt.fact_order_details"
[0m23:14:30.537052 [info ] [Thread-2  ]: 8 of 10 START sql incremental model public.dim_employees ....................... [RUN]
[0m23:14:30.541356 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.northwind_dbt.stg_employees, now model.northwind_dbt.dim_employees)
[0m23:14:30.541356 [debug] [Thread-2  ]: Began compiling node model.northwind_dbt.dim_employees
[0m23:14:30.557521 [debug] [Thread-2  ]: Writing injected SQL for node "model.northwind_dbt.dim_employees"
[0m23:14:30.563862 [debug] [Thread-4  ]: Began executing node model.northwind_dbt.fact_order_details
[0m23:14:30.591247 [debug] [Thread-4  ]: Using snowflake connection "model.northwind_dbt.fact_order_details"
[0m23:14:30.591247 [debug] [Thread-4  ]: On model.northwind_dbt.fact_order_details: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.fact_order_details"} */
create or replace  temporary view Project_2.public.fact_order_details__dbt_tmp
  
   as (
    

with base as (
    select 
        od.order_id,
        od.product_id,
        o.customer_id,
        o.employee_id,
        o.ship_via as shipper_id,
        o.order_date,
        od.unit_price,
        od.quantity,
        od.discount,
        od.unit_price * od.quantity * (1 - od.discount) as revenue
    from Project_2.public.stg_order_details od
    join Project_2.public.stg_orders o on od.order_id = o.order_id
    
        and o.order_date >= (select max(order_date) from Project_2.public.fact_order_details)
    
),
aggregated as (
    select 
        order_id,
        product_id,
        customer_id,
        employee_id,
        shipper_id,
        cast(order_date as date) as order_date,
        sum(revenue) as total_revenue,
        avg(revenue) as avg_revenue,
        max(revenue) as max_revenue,
        min(revenue) as min_revenue,
        count(*) as line_count,
        rank() over (partition by customer_id order by sum(revenue) desc) as revenue_rank
    from base
    group by order_id, product_id, customer_id, employee_id, shipper_id, order_date
)
select * from aggregated
  );
[0m23:14:30.591247 [debug] [Thread-2  ]: Began executing node model.northwind_dbt.dim_employees
[0m23:14:30.605059 [debug] [Thread-2  ]: Using snowflake connection "model.northwind_dbt.dim_employees"
[0m23:14:30.605718 [debug] [Thread-2  ]: On model.northwind_dbt.dim_employees: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.dim_employees"} */
create or replace  temporary view Project_2.public.dim_employees__dbt_tmp
  
   as (
    

with source_data as (
    select * from Project_2.public.stg_employees
),
scd2 as (
    select 
        md5(cast(coalesce(cast(employee_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as employee_key,
        *,
        current_timestamp as dbt_updated_at
    from source_data
)
select * from scd2
  );
[0m23:14:30.995189 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.478 seconds
[0m23:14:31.006132 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7e4045d-f96f-40a9-963f-244b2ff2806c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276EB68CA60>]}
[0m23:14:31.006132 [info ] [Thread-1  ]: 5 of 10 OK created sql view model public.stg_products .......................... [[32mSUCCESS 1[0m in 0.62s]
[0m23:14:31.006132 [debug] [Thread-1  ]: Finished running node model.northwind_dbt.stg_products
[0m23:14:31.010185 [debug] [Thread-1  ]: Began running node model.northwind_dbt.dim_products
[0m23:14:31.010865 [info ] [Thread-1  ]: 9 of 10 START sql table model public.dim_products .............................. [RUN]
[0m23:14:31.010865 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.northwind_dbt.stg_products, now model.northwind_dbt.dim_products)
[0m23:14:31.010865 [debug] [Thread-1  ]: Began compiling node model.northwind_dbt.dim_products
[0m23:14:31.010865 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind_dbt.dim_products"
[0m23:14:31.025880 [debug] [Thread-1  ]: Began executing node model.northwind_dbt.dim_products
[0m23:14:31.030797 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind_dbt.dim_products"
[0m23:14:31.040221 [debug] [Thread-1  ]: Using snowflake connection "model.northwind_dbt.dim_products"
[0m23:14:31.040221 [debug] [Thread-1  ]: On model.northwind_dbt.dim_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.dim_products"} */
create or replace transient table Project_2.public.dim_products
         as
        (select 
    p.product_id,
    p.product_name,
    p.supplier_id,
    s.company_name as supplier_name,
    p.category_id,
    c.category_name,
    p.quantity_per_unit,
    p.unit_price,
    p.units_in_stock,
    p.units_on_order,
    p.reorder_level,
    p.discontinued
from Project_2.public.stg_products p
left join PROJECT_2.PUBLIC.suppliers s on p.supplier_id = s.supplier_id
left join PROJECT_2.PUBLIC.categories c on p.category_id = c.category_id
        );
[0m23:14:31.043830 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.449 seconds
[0m23:14:31.052562 [debug] [Thread-4  ]: Using snowflake connection "model.northwind_dbt.fact_order_details"
[0m23:14:31.052562 [debug] [Thread-4  ]: On model.northwind_dbt.fact_order_details: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.fact_order_details"} */
describe table Project_2.public.fact_order_details__dbt_tmp
[0m23:14:31.152530 [debug] [Thread-4  ]: SQL status: SUCCESS 12 in 0.102 seconds
[0m23:14:31.167910 [debug] [Thread-4  ]: Using snowflake connection "model.northwind_dbt.fact_order_details"
[0m23:14:31.167910 [debug] [Thread-4  ]: On model.northwind_dbt.fact_order_details: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.fact_order_details"} */
describe table Project_2.public.fact_order_details
[0m23:14:31.182782 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.586 seconds
[0m23:14:31.182782 [debug] [Thread-2  ]: Using snowflake connection "model.northwind_dbt.dim_employees"
[0m23:14:31.198713 [debug] [Thread-2  ]: On model.northwind_dbt.dim_employees: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.dim_employees"} */
describe table Project_2.public.dim_employees__dbt_tmp
[0m23:14:31.238248 [debug] [Thread-4  ]: SQL status: SUCCESS 11 in 0.067 seconds
[0m23:14:31.244785 [debug] [Thread-4  ]: Using snowflake connection "model.northwind_dbt.fact_order_details"
[0m23:14:31.244785 [debug] [Thread-4  ]: On model.northwind_dbt.fact_order_details: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.fact_order_details"} */
describe table "PROJECT_2"."PUBLIC"."FACT_ORDER_DETAILS"
[0m23:14:31.266820 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.732 seconds
[0m23:14:31.266820 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7e4045d-f96f-40a9-963f-244b2ff2806c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276EC5B8E80>]}
[0m23:14:31.274446 [info ] [Thread-3  ]: 6 of 10 OK created sql table model public.dim_customers ........................ [[32mSUCCESS 1[0m in 0.87s]
[0m23:14:31.274446 [debug] [Thread-3  ]: Finished running node model.northwind_dbt.dim_customers
[0m23:14:31.284979 [debug] [Thread-2  ]: SQL status: SUCCESS 24 in 0.086 seconds
[0m23:14:31.288695 [debug] [Thread-2  ]: Using snowflake connection "model.northwind_dbt.dim_employees"
[0m23:14:31.290702 [debug] [Thread-2  ]: On model.northwind_dbt.dim_employees: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.dim_employees"} */
describe table Project_2.public.dim_employees
[0m23:14:31.328551 [debug] [Thread-4  ]: SQL status: SUCCESS 11 in 0.080 seconds
[0m23:14:31.350578 [debug] [Thread-4  ]: Writing runtime sql for node "model.northwind_dbt.fact_order_details"
[0m23:14:31.351584 [debug] [Thread-2  ]: SQL status: SUCCESS 24 in 0.066 seconds
[0m23:14:31.361737 [debug] [Thread-2  ]: Using snowflake connection "model.northwind_dbt.dim_employees"
[0m23:14:31.361737 [debug] [Thread-2  ]: On model.northwind_dbt.dim_employees: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.dim_employees"} */
describe table "PROJECT_2"."PUBLIC"."DIM_EMPLOYEES"
[0m23:14:31.368277 [debug] [Thread-4  ]: Using snowflake connection "model.northwind_dbt.fact_order_details"
[0m23:14:31.369739 [debug] [Thread-4  ]: On model.northwind_dbt.fact_order_details: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.fact_order_details"} */
-- back compat for old kwarg name
  
  begin;
[0m23:14:31.467669 [debug] [Thread-2  ]: SQL status: SUCCESS 24 in 0.104 seconds
[0m23:14:31.477150 [debug] [Thread-2  ]: Writing runtime sql for node "model.northwind_dbt.dim_employees"
[0m23:14:31.477150 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.112 seconds
[0m23:14:31.477150 [debug] [Thread-4  ]: Using snowflake connection "model.northwind_dbt.fact_order_details"
[0m23:14:31.477150 [debug] [Thread-4  ]: On model.northwind_dbt.fact_order_details: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.fact_order_details"} */
merge into Project_2.public.fact_order_details as DBT_INTERNAL_DEST
        using Project_2.public.fact_order_details__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.order_id = DBT_INTERNAL_DEST.order_id
                ) and (
                    DBT_INTERNAL_SOURCE.product_id = DBT_INTERNAL_DEST.product_id
                )

    
    when matched then update set
        "ORDER_ID" = DBT_INTERNAL_SOURCE."ORDER_ID","CUSTOMER_ID" = DBT_INTERNAL_SOURCE."CUSTOMER_ID","EMPLOYEE_ID" = DBT_INTERNAL_SOURCE."EMPLOYEE_ID","SHIPPER_ID" = DBT_INTERNAL_SOURCE."SHIPPER_ID","ORDER_DATE" = DBT_INTERNAL_SOURCE."ORDER_DATE","TOTAL_REVENUE" = DBT_INTERNAL_SOURCE."TOTAL_REVENUE","AVG_REVENUE" = DBT_INTERNAL_SOURCE."AVG_REVENUE","MAX_REVENUE" = DBT_INTERNAL_SOURCE."MAX_REVENUE","MIN_REVENUE" = DBT_INTERNAL_SOURCE."MIN_REVENUE","LINE_COUNT" = DBT_INTERNAL_SOURCE."LINE_COUNT","REVENUE_RANK" = DBT_INTERNAL_SOURCE."REVENUE_RANK"
    

    when not matched then insert
        ("ORDER_ID", "CUSTOMER_ID", "EMPLOYEE_ID", "SHIPPER_ID", "ORDER_DATE", "TOTAL_REVENUE", "AVG_REVENUE", "MAX_REVENUE", "MIN_REVENUE", "LINE_COUNT", "REVENUE_RANK")
    values
        ("ORDER_ID", "CUSTOMER_ID", "EMPLOYEE_ID", "SHIPPER_ID", "ORDER_DATE", "TOTAL_REVENUE", "AVG_REVENUE", "MAX_REVENUE", "MIN_REVENUE", "LINE_COUNT", "REVENUE_RANK")

;
[0m23:14:31.477150 [debug] [Thread-2  ]: Using snowflake connection "model.northwind_dbt.dim_employees"
[0m23:14:31.477150 [debug] [Thread-2  ]: On model.northwind_dbt.dim_employees: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.dim_employees"} */
-- back compat for old kwarg name
  
  begin;
[0m23:14:31.575307 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.088 seconds
[0m23:14:31.575307 [debug] [Thread-2  ]: Using snowflake connection "model.northwind_dbt.dim_employees"
[0m23:14:31.575307 [debug] [Thread-2  ]: On model.northwind_dbt.dim_employees: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.dim_employees"} */
merge into Project_2.public.dim_employees as DBT_INTERNAL_DEST
        using Project_2.public.dim_employees__dbt_tmp as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.employee_key = DBT_INTERNAL_DEST.employee_key))

    
    when matched then update set
        "EMPLOYEE_KEY" = DBT_INTERNAL_SOURCE."EMPLOYEE_KEY","_AIRBYTE_RAW_ID" = DBT_INTERNAL_SOURCE."_AIRBYTE_RAW_ID","_AIRBYTE_EXTRACTED_AT" = DBT_INTERNAL_SOURCE."_AIRBYTE_EXTRACTED_AT","_AIRBYTE_META" = DBT_INTERNAL_SOURCE."_AIRBYTE_META","_AIRBYTE_GENERATION_ID" = DBT_INTERNAL_SOURCE."_AIRBYTE_GENERATION_ID","CITY" = DBT_INTERNAL_SOURCE."CITY","NOTES" = DBT_INTERNAL_SOURCE."NOTES","PHOTO" = DBT_INTERNAL_SOURCE."PHOTO","TITLE" = DBT_INTERNAL_SOURCE."TITLE","REGION" = DBT_INTERNAL_SOURCE."REGION","ADDRESS" = DBT_INTERNAL_SOURCE."ADDRESS","COUNTRY" = DBT_INTERNAL_SOURCE."COUNTRY","EXTENSION" = DBT_INTERNAL_SOURCE."EXTENSION","HIRE_DATE" = DBT_INTERNAL_SOURCE."HIRE_DATE","LAST_NAME" = DBT_INTERNAL_SOURCE."LAST_NAME","BIRTH_DATE" = DBT_INTERNAL_SOURCE."BIRTH_DATE","FIRST_NAME" = DBT_INTERNAL_SOURCE."FIRST_NAME","HOME_PHONE" = DBT_INTERNAL_SOURCE."HOME_PHONE","PHOTO_PATH" = DBT_INTERNAL_SOURCE."PHOTO_PATH","REPORTS_TO" = DBT_INTERNAL_SOURCE."REPORTS_TO","EMPLOYEE_ID" = DBT_INTERNAL_SOURCE."EMPLOYEE_ID","POSTAL_CODE" = DBT_INTERNAL_SOURCE."POSTAL_CODE","TITLE_OF_COURTESY" = DBT_INTERNAL_SOURCE."TITLE_OF_COURTESY","DBT_UPDATED_AT" = DBT_INTERNAL_SOURCE."DBT_UPDATED_AT"
    

    when not matched then insert
        ("EMPLOYEE_KEY", "_AIRBYTE_RAW_ID", "_AIRBYTE_EXTRACTED_AT", "_AIRBYTE_META", "_AIRBYTE_GENERATION_ID", "CITY", "NOTES", "PHOTO", "TITLE", "REGION", "ADDRESS", "COUNTRY", "EXTENSION", "HIRE_DATE", "LAST_NAME", "BIRTH_DATE", "FIRST_NAME", "HOME_PHONE", "PHOTO_PATH", "REPORTS_TO", "EMPLOYEE_ID", "POSTAL_CODE", "TITLE_OF_COURTESY", "DBT_UPDATED_AT")
    values
        ("EMPLOYEE_KEY", "_AIRBYTE_RAW_ID", "_AIRBYTE_EXTRACTED_AT", "_AIRBYTE_META", "_AIRBYTE_GENERATION_ID", "CITY", "NOTES", "PHOTO", "TITLE", "REGION", "ADDRESS", "COUNTRY", "EXTENSION", "HIRE_DATE", "LAST_NAME", "BIRTH_DATE", "FIRST_NAME", "HOME_PHONE", "PHOTO_PATH", "REPORTS_TO", "EMPLOYEE_ID", "POSTAL_CODE", "TITLE_OF_COURTESY", "DBT_UPDATED_AT")

;
[0m23:14:31.627975 [debug] [Thread-4  ]: Snowflake adapter: Snowflake query id: 01bba722-020d-01bb-000c-83e7000ac38a
[0m23:14:31.629088 [debug] [Thread-4  ]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 6 at position 53
invalid identifier 'DBT_INTERNAL_DEST.PRODUCT_ID'
[0m23:14:31.632435 [debug] [Thread-4  ]: Database Error in model fact_order_details (models\marts\core\fact_order_details.sql)
  000904 (42000): SQL compilation error: error line 6 at position 53
  invalid identifier 'DBT_INTERNAL_DEST.PRODUCT_ID'
  compiled code at target\run\northwind_dbt\models\marts\core\fact_order_details.sql
[0m23:14:31.633502 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7e4045d-f96f-40a9-963f-244b2ff2806c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276EB7B4BE0>]}
[0m23:14:31.634604 [error] [Thread-4  ]: 7 of 10 ERROR creating sql incremental model public.fact_order_details ......... [[31mERROR[0m in 1.11s]
[0m23:14:31.635718 [debug] [Thread-4  ]: Finished running node model.northwind_dbt.fact_order_details
[0m23:14:31.636912 [debug] [Thread-7  ]: Marking all children of 'model.northwind_dbt.fact_order_details' to be skipped because of status 'error'.  Reason: Database Error in model fact_order_details (models\marts\core\fact_order_details.sql)
  000904 (42000): SQL compilation error: error line 6 at position 53
  invalid identifier 'DBT_INTERNAL_DEST.PRODUCT_ID'
  compiled code at target\run\northwind_dbt\models\marts\core\fact_order_details.sql.
[0m23:14:32.131550 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.088 seconds
[0m23:14:32.135587 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7e4045d-f96f-40a9-963f-244b2ff2806c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276ED690F70>]}
[0m23:14:32.135587 [info ] [Thread-1  ]: 9 of 10 OK created sql table model public.dim_products ......................... [[32mSUCCESS 1[0m in 1.12s]
[0m23:14:32.135587 [debug] [Thread-1  ]: Finished running node model.northwind_dbt.dim_products
[0m23:14:32.390679 [debug] [Thread-2  ]: SQL status: SUCCESS 9 in 0.810 seconds
[0m23:14:32.392696 [debug] [Thread-2  ]: Using snowflake connection "model.northwind_dbt.dim_employees"
[0m23:14:32.392696 [debug] [Thread-2  ]: On model.northwind_dbt.dim_employees: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.dim_employees"} */
COMMIT
[0m23:14:32.768342 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.374 seconds
[0m23:14:32.786734 [debug] [Thread-2  ]: Applying DROP to: Project_2.public.dim_employees__dbt_tmp
[0m23:14:32.792763 [debug] [Thread-2  ]: Using snowflake connection "model.northwind_dbt.dim_employees"
[0m23:14:32.792763 [debug] [Thread-2  ]: On model.northwind_dbt.dim_employees: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.dim_employees"} */
drop view if exists Project_2.public.dim_employees__dbt_tmp cascade
[0m23:14:32.910655 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.117 seconds
[0m23:14:32.914671 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7e4045d-f96f-40a9-963f-244b2ff2806c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276EBD10070>]}
[0m23:14:32.916679 [info ] [Thread-2  ]: 8 of 10 OK created sql incremental model public.dim_employees .................. [[32mSUCCESS 9[0m in 2.37s]
[0m23:14:32.916679 [debug] [Thread-2  ]: Finished running node model.northwind_dbt.dim_employees
[0m23:14:32.916679 [debug] [Thread-3  ]: Began running node model.northwind_dbt.obt_orders
[0m23:14:32.916679 [info ] [Thread-3  ]: 10 of 10 SKIP relation public.obt_orders ....................................... [[33mSKIP[0m]
[0m23:14:32.920721 [debug] [Thread-3  ]: Finished running node model.northwind_dbt.obt_orders
[0m23:14:32.923158 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:14:32.923158 [debug] [MainThread]: Connection 'list_Project_2' was left open.
[0m23:14:32.925813 [debug] [MainThread]: On list_Project_2: Close
[0m23:14:33.052739 [debug] [MainThread]: Connection 'list_Project_2_public' was left open.
[0m23:14:33.061858 [debug] [MainThread]: On list_Project_2_public: Close
[0m23:14:33.161974 [debug] [MainThread]: Connection 'model.northwind_dbt.dim_products' was left open.
[0m23:14:33.163983 [debug] [MainThread]: On model.northwind_dbt.dim_products: Close
[0m23:14:33.325200 [debug] [MainThread]: Connection 'model.northwind_dbt.dim_employees' was left open.
[0m23:14:33.326400 [debug] [MainThread]: On model.northwind_dbt.dim_employees: Close
[0m23:14:33.426755 [debug] [MainThread]: Connection 'model.northwind_dbt.dim_customers' was left open.
[0m23:14:33.428945 [debug] [MainThread]: On model.northwind_dbt.dim_customers: Close
[0m23:14:33.562455 [debug] [MainThread]: Connection 'model.northwind_dbt.fact_order_details' was left open.
[0m23:14:33.565244 [debug] [MainThread]: On model.northwind_dbt.fact_order_details: Close
[0m23:14:33.675821 [info ] [MainThread]: 
[0m23:14:33.676923 [info ] [MainThread]: Finished running 2 incremental models, 3 table models, 5 view models in 0 hours 0 minutes and 5.51 seconds (5.51s).
[0m23:14:33.679059 [debug] [MainThread]: Command end result
[0m23:14:33.850718 [debug] [MainThread]: Wrote artifact WritableManifest to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\manifest.json
[0m23:14:33.858906 [debug] [MainThread]: Wrote artifact SemanticManifest to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\semantic_manifest.json
[0m23:14:33.885210 [debug] [MainThread]: Wrote artifact RunExecutionResult to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\run_results.json
[0m23:14:33.885210 [info ] [MainThread]: 
[0m23:14:33.885210 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m23:14:33.888486 [info ] [MainThread]: 
[0m23:14:33.890492 [error] [MainThread]:   Database Error in model fact_order_details (models\marts\core\fact_order_details.sql)
  000904 (42000): SQL compilation error: error line 6 at position 53
  invalid identifier 'DBT_INTERNAL_DEST.PRODUCT_ID'
  compiled code at target\run\northwind_dbt\models\marts\core\fact_order_details.sql
[0m23:14:33.893558 [info ] [MainThread]: 
[0m23:14:33.895476 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=1 SKIP=1 TOTAL=10
[0m23:14:33.899147 [debug] [MainThread]: Command `dbt run` failed at 23:14:33.898611 after 8.62 seconds
[0m23:14:33.900926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276D0BB0310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276CFB6D070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276EB6E2700>]}
[0m23:14:33.902645 [debug] [MainThread]: Flushing usage events
[0m23:14:35.079388 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:14:55.553512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002675CABF430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002675EB33D00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002675EB33AF0>]}


============================== 23:14:55.553512 | ee2f8281-4f6d-4d48-8270-0f056b42374f ==============================
[0m23:14:55.553512 [info ] [MainThread]: Running with dbt=1.9.0
[0m23:14:55.553512 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'c:\\Users\\fitzp\\Documents\\Alpaca_Market\\zproject_2\\northwind_psql', 'log_path': 'c:\\Users\\fitzp\\Documents\\Alpaca_Market\\zproject_2\\northwind_psql\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:14:56.428273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ee2f8281-4f6d-4d48-8270-0f056b42374f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002675EB11BE0>]}
[0m23:14:56.495112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ee2f8281-4f6d-4d48-8270-0f056b42374f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002675E988100>]}
[0m23:14:56.497121 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m23:14:56.829340 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m23:14:57.216702 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:14:57.216702 [debug] [MainThread]: Partial parsing: updated file: northwind_dbt://models\marts\core\fact_order_details.sql
[0m23:14:57.430182 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.northwind_dbt.marts.bi
[0m23:14:57.443817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ee2f8281-4f6d-4d48-8270-0f056b42374f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026777D35EE0>]}
[0m23:14:57.691530 [debug] [MainThread]: Wrote artifact WritableManifest to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\manifest.json
[0m23:14:57.691530 [debug] [MainThread]: Wrote artifact SemanticManifest to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\semantic_manifest.json
[0m23:14:57.769822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ee2f8281-4f6d-4d48-8270-0f056b42374f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026777BE6370>]}
[0m23:14:57.769822 [info ] [MainThread]: Found 10 models, 8 sources, 706 macros
[0m23:14:57.775632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ee2f8281-4f6d-4d48-8270-0f056b42374f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026777672580>]}
[0m23:14:57.777795 [info ] [MainThread]: 
[0m23:14:57.777795 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:14:57.777795 [info ] [MainThread]: 
[0m23:14:57.782921 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:14:57.790474 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_Project_2'
[0m23:14:57.873113 [debug] [ThreadPool]: Using snowflake connection "list_Project_2"
[0m23:14:57.874110 [debug] [ThreadPool]: On list_Project_2: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "connection_name": "list_Project_2"} */
show terse schemas in database Project_2
    limit 10000
[0m23:14:57.874110 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:14:58.571576 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.708 seconds
[0m23:14:58.571576 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_Project_2_public'
[0m23:14:58.586834 [debug] [ThreadPool]: Using snowflake connection "list_Project_2_public"
[0m23:14:58.586834 [debug] [ThreadPool]: On list_Project_2_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "connection_name": "list_Project_2_public"} */
show objects in Project_2.public limit 10000;
[0m23:14:58.586834 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:14:59.026263 [debug] [ThreadPool]: SQL status: SUCCESS 23 in 0.431 seconds
[0m23:14:59.033917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ee2f8281-4f6d-4d48-8270-0f056b42374f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026777C2F0A0>]}
[0m23:14:59.039386 [debug] [Thread-1  ]: Began running node model.northwind_dbt.stg_customers
[0m23:14:59.040468 [debug] [Thread-2  ]: Began running node model.northwind_dbt.stg_employees
[0m23:14:59.041902 [debug] [Thread-3  ]: Began running node model.northwind_dbt.stg_order_details
[0m23:14:59.042531 [debug] [Thread-4  ]: Began running node model.northwind_dbt.stg_orders
[0m23:14:59.043681 [info ] [Thread-1  ]: 1 of 10 START sql view model public.stg_customers .............................. [RUN]
[0m23:14:59.045323 [info ] [Thread-2  ]: 2 of 10 START sql view model public.stg_employees .............................. [RUN]
[0m23:14:59.046937 [info ] [Thread-3  ]: 3 of 10 START sql view model public.stg_order_details .......................... [RUN]
[0m23:14:59.048526 [info ] [Thread-4  ]: 4 of 10 START sql view model public.stg_orders ................................. [RUN]
[0m23:14:59.049618 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.northwind_dbt.stg_customers'
[0m23:14:59.051895 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.northwind_dbt.stg_employees'
[0m23:14:59.054035 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.northwind_dbt.stg_order_details'
[0m23:14:59.056832 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.northwind_dbt.stg_orders'
[0m23:14:59.060000 [debug] [Thread-1  ]: Began compiling node model.northwind_dbt.stg_customers
[0m23:14:59.062431 [debug] [Thread-2  ]: Began compiling node model.northwind_dbt.stg_employees
[0m23:14:59.064031 [debug] [Thread-3  ]: Began compiling node model.northwind_dbt.stg_order_details
[0m23:14:59.066362 [debug] [Thread-4  ]: Began compiling node model.northwind_dbt.stg_orders
[0m23:14:59.091720 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind_dbt.stg_customers"
[0m23:14:59.100990 [debug] [Thread-2  ]: Writing injected SQL for node "model.northwind_dbt.stg_employees"
[0m23:14:59.108942 [debug] [Thread-3  ]: Writing injected SQL for node "model.northwind_dbt.stg_order_details"
[0m23:14:59.114283 [debug] [Thread-4  ]: Writing injected SQL for node "model.northwind_dbt.stg_orders"
[0m23:14:59.142050 [debug] [Thread-2  ]: Began executing node model.northwind_dbt.stg_employees
[0m23:14:59.143052 [debug] [Thread-3  ]: Began executing node model.northwind_dbt.stg_order_details
[0m23:14:59.144054 [debug] [Thread-4  ]: Began executing node model.northwind_dbt.stg_orders
[0m23:14:59.145188 [debug] [Thread-1  ]: Began executing node model.northwind_dbt.stg_customers
[0m23:14:59.181640 [debug] [Thread-2  ]: Writing runtime sql for node "model.northwind_dbt.stg_employees"
[0m23:14:59.184972 [debug] [Thread-3  ]: Writing runtime sql for node "model.northwind_dbt.stg_order_details"
[0m23:14:59.190665 [debug] [Thread-4  ]: Writing runtime sql for node "model.northwind_dbt.stg_orders"
[0m23:14:59.195531 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind_dbt.stg_customers"
[0m23:14:59.223172 [debug] [Thread-4  ]: Using snowflake connection "model.northwind_dbt.stg_orders"
[0m23:14:59.226173 [debug] [Thread-3  ]: Using snowflake connection "model.northwind_dbt.stg_order_details"
[0m23:14:59.226173 [debug] [Thread-2  ]: Using snowflake connection "model.northwind_dbt.stg_employees"
[0m23:14:59.229099 [debug] [Thread-1  ]: Using snowflake connection "model.northwind_dbt.stg_customers"
[0m23:14:59.229099 [debug] [Thread-4  ]: On model.northwind_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.stg_orders"} */
create or replace   view Project_2.public.stg_orders
  
   as (
    select * from PROJECT_2.PUBLIC.orders
  );
[0m23:14:59.229099 [debug] [Thread-3  ]: On model.northwind_dbt.stg_order_details: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.stg_order_details"} */
create or replace   view Project_2.public.stg_order_details
  
   as (
    select * from PROJECT_2.PUBLIC.order_details
  );
[0m23:14:59.229099 [debug] [Thread-2  ]: On model.northwind_dbt.stg_employees: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.stg_employees"} */
create or replace   view Project_2.public.stg_employees
  
   as (
    select * from PROJECT_2.PUBLIC.employees
  );
[0m23:14:59.229099 [debug] [Thread-1  ]: On model.northwind_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.stg_customers"} */
create or replace   view Project_2.public.stg_customers
  
   as (
    select * from PROJECT_2.PUBLIC.customers
  );
[0m23:14:59.229099 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m23:14:59.229099 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m23:14:59.229099 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m23:14:59.229099 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m23:14:59.786992 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.558 seconds
[0m23:14:59.816351 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee2f8281-4f6d-4d48-8270-0f056b42374f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002677842F8E0>]}
[0m23:14:59.818784 [info ] [Thread-3  ]: 3 of 10 OK created sql view model public.stg_order_details ..................... [[32mSUCCESS 1[0m in 0.76s]
[0m23:14:59.818784 [debug] [Thread-3  ]: Finished running node model.northwind_dbt.stg_order_details
[0m23:14:59.818784 [debug] [Thread-3  ]: Began running node model.northwind_dbt.stg_products
[0m23:14:59.818784 [info ] [Thread-3  ]: 5 of 10 START sql view model public.stg_products ............................... [RUN]
[0m23:14:59.818784 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.northwind_dbt.stg_order_details, now model.northwind_dbt.stg_products)
[0m23:14:59.818784 [debug] [Thread-3  ]: Began compiling node model.northwind_dbt.stg_products
[0m23:14:59.818784 [debug] [Thread-3  ]: Writing injected SQL for node "model.northwind_dbt.stg_products"
[0m23:14:59.845839 [debug] [Thread-3  ]: Began executing node model.northwind_dbt.stg_products
[0m23:14:59.846848 [debug] [Thread-3  ]: Writing runtime sql for node "model.northwind_dbt.stg_products"
[0m23:14:59.846848 [debug] [Thread-3  ]: Using snowflake connection "model.northwind_dbt.stg_products"
[0m23:14:59.846848 [debug] [Thread-3  ]: On model.northwind_dbt.stg_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.stg_products"} */
create or replace   view Project_2.public.stg_products
  
   as (
    select * from PROJECT_2.PUBLIC.products
  );
[0m23:15:00.045419 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.809 seconds
[0m23:15:00.049455 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee2f8281-4f6d-4d48-8270-0f056b42374f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267784B22B0>]}
[0m23:15:00.051463 [info ] [Thread-1  ]: 1 of 10 OK created sql view model public.stg_customers ......................... [[32mSUCCESS 1[0m in 1.00s]
[0m23:15:00.051463 [debug] [Thread-1  ]: Finished running node model.northwind_dbt.stg_customers
[0m23:15:00.051463 [debug] [Thread-1  ]: Began running node model.northwind_dbt.dim_customers
[0m23:15:00.051463 [info ] [Thread-1  ]: 6 of 10 START sql table model public.dim_customers ............................. [RUN]
[0m23:15:00.051463 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.northwind_dbt.stg_customers, now model.northwind_dbt.dim_customers)
[0m23:15:00.051463 [debug] [Thread-1  ]: Began compiling node model.northwind_dbt.dim_customers
[0m23:15:00.058939 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind_dbt.dim_customers"
[0m23:15:00.067909 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.834 seconds
[0m23:15:00.069680 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee2f8281-4f6d-4d48-8270-0f056b42374f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002677842F7C0>]}
[0m23:15:00.069680 [debug] [Thread-1  ]: Began executing node model.northwind_dbt.dim_customers
[0m23:15:00.069680 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.840 seconds
[0m23:15:00.069680 [info ] [Thread-4  ]: 4 of 10 OK created sql view model public.stg_orders ............................ [[32mSUCCESS 1[0m in 1.01s]
[0m23:15:00.166467 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind_dbt.dim_customers"
[0m23:15:00.169169 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee2f8281-4f6d-4d48-8270-0f056b42374f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026778519CA0>]}
[0m23:15:00.170169 [debug] [Thread-4  ]: Finished running node model.northwind_dbt.stg_orders
[0m23:15:00.171169 [info ] [Thread-2  ]: 2 of 10 OK created sql view model public.stg_employees ......................... [[32mSUCCESS 1[0m in 1.12s]
[0m23:15:00.172168 [debug] [Thread-4  ]: Began running node model.northwind_dbt.fact_order_details
[0m23:15:00.173169 [debug] [Thread-2  ]: Finished running node model.northwind_dbt.stg_employees
[0m23:15:00.174434 [info ] [Thread-4  ]: 7 of 10 START sql merge model public.fact_order_details ........................ [RUN]
[0m23:15:00.175320 [debug] [Thread-2  ]: Began running node model.northwind_dbt.dim_employees
[0m23:15:00.176409 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.northwind_dbt.stg_orders, now model.northwind_dbt.fact_order_details)
[0m23:15:00.177531 [debug] [Thread-4  ]: Began compiling node model.northwind_dbt.fact_order_details
[0m23:15:00.177003 [info ] [Thread-2  ]: 8 of 10 START sql incremental model public.dim_employees ....................... [RUN]
[0m23:15:00.182432 [debug] [Thread-4  ]: Writing injected SQL for node "model.northwind_dbt.fact_order_details"
[0m23:15:00.183584 [debug] [Thread-1  ]: Using snowflake connection "model.northwind_dbt.dim_customers"
[0m23:15:00.184469 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.northwind_dbt.stg_employees, now model.northwind_dbt.dim_employees)
[0m23:15:00.185725 [debug] [Thread-1  ]: On model.northwind_dbt.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.dim_customers"} */
create or replace transient table Project_2.public.dim_customers
         as
        (select * from Project_2.public.stg_customers
        );
[0m23:15:00.185725 [debug] [Thread-2  ]: Began compiling node model.northwind_dbt.dim_employees
[0m23:15:00.202707 [debug] [Thread-2  ]: Writing injected SQL for node "model.northwind_dbt.dim_employees"
[0m23:15:00.202707 [debug] [Thread-4  ]: Began executing node model.northwind_dbt.fact_order_details
[0m23:15:00.211767 [debug] [Thread-4  ]: Compilation Error in model fact_order_details (models\marts\core\fact_order_details.sql)
  No materialization 'merge' was found for adapter snowflake! (searched types 'default' and 'snowflake')
[0m23:15:00.211767 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee2f8281-4f6d-4d48-8270-0f056b42374f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026777D1B7F0>]}
[0m23:15:00.211767 [debug] [Thread-2  ]: Began executing node model.northwind_dbt.dim_employees
[0m23:15:00.211767 [error] [Thread-4  ]: 7 of 10 ERROR creating sql merge model public.fact_order_details ............... [[31mERROR[0m in 0.04s]
[0m23:15:00.236250 [debug] [Thread-2  ]: Using snowflake connection "model.northwind_dbt.dim_employees"
[0m23:15:00.252253 [debug] [Thread-4  ]: Finished running node model.northwind_dbt.fact_order_details
[0m23:15:00.253262 [debug] [Thread-2  ]: On model.northwind_dbt.dim_employees: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.dim_employees"} */
create or replace  temporary view Project_2.public.dim_employees__dbt_tmp
  
   as (
    

with source_data as (
    select * from Project_2.public.stg_employees
),
scd2 as (
    select 
        md5(cast(coalesce(cast(employee_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as employee_key,
        *,
        current_timestamp as dbt_updated_at
    from source_data
)
select * from scd2
  );
[0m23:15:00.253262 [debug] [Thread-7  ]: Marking all children of 'model.northwind_dbt.fact_order_details' to be skipped because of status 'error'.  Reason: Compilation Error in model fact_order_details (models\marts\core\fact_order_details.sql)
  No materialization 'merge' was found for adapter snowflake! (searched types 'default' and 'snowflake').
[0m23:15:00.269399 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.411 seconds
[0m23:15:00.269399 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee2f8281-4f6d-4d48-8270-0f056b42374f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002675DE22C70>]}
[0m23:15:00.269399 [info ] [Thread-3  ]: 5 of 10 OK created sql view model public.stg_products .......................... [[32mSUCCESS 1[0m in 0.45s]
[0m23:15:00.269399 [debug] [Thread-3  ]: Finished running node model.northwind_dbt.stg_products
[0m23:15:00.269399 [debug] [Thread-4  ]: Began running node model.northwind_dbt.dim_products
[0m23:15:00.278080 [info ] [Thread-4  ]: 9 of 10 START sql table model public.dim_products .............................. [RUN]
[0m23:15:00.278080 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.northwind_dbt.fact_order_details, now model.northwind_dbt.dim_products)
[0m23:15:00.278080 [debug] [Thread-4  ]: Began compiling node model.northwind_dbt.dim_products
[0m23:15:00.281912 [debug] [Thread-4  ]: Writing injected SQL for node "model.northwind_dbt.dim_products"
[0m23:15:00.286346 [debug] [Thread-4  ]: Began executing node model.northwind_dbt.dim_products
[0m23:15:00.286346 [debug] [Thread-4  ]: Writing runtime sql for node "model.northwind_dbt.dim_products"
[0m23:15:00.308219 [debug] [Thread-4  ]: Using snowflake connection "model.northwind_dbt.dim_products"
[0m23:15:00.308845 [debug] [Thread-4  ]: On model.northwind_dbt.dim_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.dim_products"} */
create or replace transient table Project_2.public.dim_products
         as
        (select 
    p.product_id,
    p.product_name,
    p.supplier_id,
    s.company_name as supplier_name,
    p.category_id,
    c.category_name,
    p.quantity_per_unit,
    p.unit_price,
    p.units_in_stock,
    p.units_on_order,
    p.reorder_level,
    p.discontinued
from Project_2.public.stg_products p
left join PROJECT_2.PUBLIC.suppliers s on p.supplier_id = s.supplier_id
left join PROJECT_2.PUBLIC.categories c on p.category_id = c.category_id
        );
[0m23:15:00.813184 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.560 seconds
[0m23:15:00.813184 [debug] [Thread-2  ]: Using snowflake connection "model.northwind_dbt.dim_employees"
[0m23:15:00.813184 [debug] [Thread-2  ]: On model.northwind_dbt.dim_employees: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.dim_employees"} */
describe table Project_2.public.dim_employees__dbt_tmp
[0m23:15:00.922881 [debug] [Thread-2  ]: SQL status: SUCCESS 24 in 0.096 seconds
[0m23:15:00.932383 [debug] [Thread-2  ]: Using snowflake connection "model.northwind_dbt.dim_employees"
[0m23:15:00.933499 [debug] [Thread-2  ]: On model.northwind_dbt.dim_employees: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.dim_employees"} */
describe table Project_2.public.dim_employees
[0m23:15:01.033794 [debug] [Thread-2  ]: SQL status: SUCCESS 24 in 0.102 seconds
[0m23:15:01.033794 [debug] [Thread-2  ]: Using snowflake connection "model.northwind_dbt.dim_employees"
[0m23:15:01.033794 [debug] [Thread-2  ]: On model.northwind_dbt.dim_employees: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.dim_employees"} */
describe table "PROJECT_2"."PUBLIC"."DIM_EMPLOYEES"
[0m23:15:01.080408 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.892 seconds
[0m23:15:01.083146 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee2f8281-4f6d-4d48-8270-0f056b42374f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267784B0070>]}
[0m23:15:01.085164 [info ] [Thread-1  ]: 6 of 10 OK created sql table model public.dim_customers ........................ [[32mSUCCESS 1[0m in 1.03s]
[0m23:15:01.085164 [debug] [Thread-1  ]: Finished running node model.northwind_dbt.dim_customers
[0m23:15:01.132370 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.823 seconds
[0m23:15:01.132370 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee2f8281-4f6d-4d48-8270-0f056b42374f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026777C15A00>]}
[0m23:15:01.137942 [info ] [Thread-4  ]: 9 of 10 OK created sql table model public.dim_products ......................... [[32mSUCCESS 1[0m in 0.85s]
[0m23:15:01.137942 [debug] [Thread-4  ]: Finished running node model.northwind_dbt.dim_products
[0m23:15:01.301065 [debug] [Thread-2  ]: SQL status: SUCCESS 24 in 0.255 seconds
[0m23:15:01.329962 [debug] [Thread-2  ]: Writing runtime sql for node "model.northwind_dbt.dim_employees"
[0m23:15:01.341401 [debug] [Thread-2  ]: Using snowflake connection "model.northwind_dbt.dim_employees"
[0m23:15:01.341401 [debug] [Thread-2  ]: On model.northwind_dbt.dim_employees: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.dim_employees"} */
-- back compat for old kwarg name
  
  begin;
[0m23:15:01.575183 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.230 seconds
[0m23:15:01.575183 [debug] [Thread-2  ]: Using snowflake connection "model.northwind_dbt.dim_employees"
[0m23:15:01.577195 [debug] [Thread-2  ]: On model.northwind_dbt.dim_employees: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.dim_employees"} */
merge into Project_2.public.dim_employees as DBT_INTERNAL_DEST
        using Project_2.public.dim_employees__dbt_tmp as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.employee_key = DBT_INTERNAL_DEST.employee_key))

    
    when matched then update set
        "EMPLOYEE_KEY" = DBT_INTERNAL_SOURCE."EMPLOYEE_KEY","_AIRBYTE_RAW_ID" = DBT_INTERNAL_SOURCE."_AIRBYTE_RAW_ID","_AIRBYTE_EXTRACTED_AT" = DBT_INTERNAL_SOURCE."_AIRBYTE_EXTRACTED_AT","_AIRBYTE_META" = DBT_INTERNAL_SOURCE."_AIRBYTE_META","_AIRBYTE_GENERATION_ID" = DBT_INTERNAL_SOURCE."_AIRBYTE_GENERATION_ID","CITY" = DBT_INTERNAL_SOURCE."CITY","NOTES" = DBT_INTERNAL_SOURCE."NOTES","PHOTO" = DBT_INTERNAL_SOURCE."PHOTO","TITLE" = DBT_INTERNAL_SOURCE."TITLE","REGION" = DBT_INTERNAL_SOURCE."REGION","ADDRESS" = DBT_INTERNAL_SOURCE."ADDRESS","COUNTRY" = DBT_INTERNAL_SOURCE."COUNTRY","EXTENSION" = DBT_INTERNAL_SOURCE."EXTENSION","HIRE_DATE" = DBT_INTERNAL_SOURCE."HIRE_DATE","LAST_NAME" = DBT_INTERNAL_SOURCE."LAST_NAME","BIRTH_DATE" = DBT_INTERNAL_SOURCE."BIRTH_DATE","FIRST_NAME" = DBT_INTERNAL_SOURCE."FIRST_NAME","HOME_PHONE" = DBT_INTERNAL_SOURCE."HOME_PHONE","PHOTO_PATH" = DBT_INTERNAL_SOURCE."PHOTO_PATH","REPORTS_TO" = DBT_INTERNAL_SOURCE."REPORTS_TO","EMPLOYEE_ID" = DBT_INTERNAL_SOURCE."EMPLOYEE_ID","POSTAL_CODE" = DBT_INTERNAL_SOURCE."POSTAL_CODE","TITLE_OF_COURTESY" = DBT_INTERNAL_SOURCE."TITLE_OF_COURTESY","DBT_UPDATED_AT" = DBT_INTERNAL_SOURCE."DBT_UPDATED_AT"
    

    when not matched then insert
        ("EMPLOYEE_KEY", "_AIRBYTE_RAW_ID", "_AIRBYTE_EXTRACTED_AT", "_AIRBYTE_META", "_AIRBYTE_GENERATION_ID", "CITY", "NOTES", "PHOTO", "TITLE", "REGION", "ADDRESS", "COUNTRY", "EXTENSION", "HIRE_DATE", "LAST_NAME", "BIRTH_DATE", "FIRST_NAME", "HOME_PHONE", "PHOTO_PATH", "REPORTS_TO", "EMPLOYEE_ID", "POSTAL_CODE", "TITLE_OF_COURTESY", "DBT_UPDATED_AT")
    values
        ("EMPLOYEE_KEY", "_AIRBYTE_RAW_ID", "_AIRBYTE_EXTRACTED_AT", "_AIRBYTE_META", "_AIRBYTE_GENERATION_ID", "CITY", "NOTES", "PHOTO", "TITLE", "REGION", "ADDRESS", "COUNTRY", "EXTENSION", "HIRE_DATE", "LAST_NAME", "BIRTH_DATE", "FIRST_NAME", "HOME_PHONE", "PHOTO_PATH", "REPORTS_TO", "EMPLOYEE_ID", "POSTAL_CODE", "TITLE_OF_COURTESY", "DBT_UPDATED_AT")

;
[0m23:15:02.350583 [debug] [Thread-2  ]: SQL status: SUCCESS 9 in 0.773 seconds
[0m23:15:02.351470 [debug] [Thread-2  ]: Using snowflake connection "model.northwind_dbt.dim_employees"
[0m23:15:02.352287 [debug] [Thread-2  ]: On model.northwind_dbt.dim_employees: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.dim_employees"} */
COMMIT
[0m23:15:02.661258 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.313 seconds
[0m23:15:02.661258 [debug] [Thread-2  ]: Applying DROP to: Project_2.public.dim_employees__dbt_tmp
[0m23:15:02.680302 [debug] [Thread-2  ]: Using snowflake connection "model.northwind_dbt.dim_employees"
[0m23:15:02.680993 [debug] [Thread-2  ]: On model.northwind_dbt.dim_employees: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.dim_employees"} */
drop view if exists Project_2.public.dim_employees__dbt_tmp cascade
[0m23:15:02.802905 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.130 seconds
[0m23:15:02.815117 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee2f8281-4f6d-4d48-8270-0f056b42374f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026777D6B640>]}
[0m23:15:02.816791 [info ] [Thread-2  ]: 8 of 10 OK created sql incremental model public.dim_employees .................. [[32mSUCCESS 9[0m in 2.63s]
[0m23:15:02.819760 [debug] [Thread-2  ]: Finished running node model.northwind_dbt.dim_employees
[0m23:15:02.821445 [debug] [Thread-3  ]: Began running node model.northwind_dbt.obt_orders
[0m23:15:02.823163 [info ] [Thread-3  ]: 10 of 10 SKIP relation public.obt_orders ....................................... [[33mSKIP[0m]
[0m23:15:02.824592 [debug] [Thread-3  ]: Finished running node model.northwind_dbt.obt_orders
[0m23:15:02.827398 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:15:02.829561 [debug] [MainThread]: Connection 'list_Project_2' was left open.
[0m23:15:02.831055 [debug] [MainThread]: On list_Project_2: Close
[0m23:15:03.042067 [debug] [MainThread]: Connection 'list_Project_2_public' was left open.
[0m23:15:03.042067 [debug] [MainThread]: On list_Project_2_public: Close
[0m23:15:03.173580 [debug] [MainThread]: Connection 'model.northwind_dbt.dim_customers' was left open.
[0m23:15:03.174136 [debug] [MainThread]: On model.northwind_dbt.dim_customers: Close
[0m23:15:03.283076 [debug] [MainThread]: Connection 'model.northwind_dbt.dim_employees' was left open.
[0m23:15:03.285096 [debug] [MainThread]: On model.northwind_dbt.dim_employees: Close
[0m23:15:03.397629 [debug] [MainThread]: Connection 'model.northwind_dbt.stg_products' was left open.
[0m23:15:03.399247 [debug] [MainThread]: On model.northwind_dbt.stg_products: Close
[0m23:15:03.530113 [debug] [MainThread]: Connection 'model.northwind_dbt.dim_products' was left open.
[0m23:15:03.531226 [debug] [MainThread]: On model.northwind_dbt.dim_products: Close
[0m23:15:03.644678 [info ] [MainThread]: 
[0m23:15:03.646825 [info ] [MainThread]: Finished running 1 incremental model, 1 merge model, 3 table models, 5 view models in 0 hours 0 minutes and 5.86 seconds (5.86s).
[0m23:15:03.650650 [debug] [MainThread]: Command end result
[0m23:15:03.846688 [debug] [MainThread]: Wrote artifact WritableManifest to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\manifest.json
[0m23:15:03.850207 [debug] [MainThread]: Wrote artifact SemanticManifest to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\semantic_manifest.json
[0m23:15:03.873658 [debug] [MainThread]: Wrote artifact RunExecutionResult to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\run_results.json
[0m23:15:03.875306 [info ] [MainThread]: 
[0m23:15:03.877462 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m23:15:03.878589 [info ] [MainThread]: 
[0m23:15:03.880779 [error] [MainThread]:   Compilation Error in model fact_order_details (models\marts\core\fact_order_details.sql)
  No materialization 'merge' was found for adapter snowflake! (searched types 'default' and 'snowflake')
[0m23:15:03.883092 [info ] [MainThread]: 
[0m23:15:03.885532 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=1 SKIP=1 TOTAL=10
[0m23:15:03.889129 [debug] [MainThread]: Command `dbt run` failed at 23:15:03.889129 after 8.41 seconds
[0m23:15:03.890744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002675CABF430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002675E992700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002677956DDC0>]}
[0m23:15:03.891889 [debug] [MainThread]: Flushing usage events
[0m23:15:04.834475 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:15:25.935163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2B675F3D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2B87D3CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2B87D3AC0>]}


============================== 23:15:25.940759 | 93849312-179d-4f0d-af6b-cf0a42551486 ==============================
[0m23:15:25.940759 [info ] [MainThread]: Running with dbt=1.9.0
[0m23:15:25.942942 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'c:\\Users\\fitzp\\Documents\\Alpaca_Market\\zproject_2\\northwind_psql', 'log_path': 'c:\\Users\\fitzp\\Documents\\Alpaca_Market\\zproject_2\\northwind_psql\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:15:27.255355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '93849312-179d-4f0d-af6b-cf0a42551486', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2B5747F40>]}
[0m23:15:27.359534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '93849312-179d-4f0d-af6b-cf0a42551486', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2D1272820>]}
[0m23:15:27.361540 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m23:15:27.800511 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m23:15:28.245913 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:15:28.245913 [debug] [MainThread]: Partial parsing: updated file: northwind_dbt://models\marts\core\fact_order_details.sql
[0m23:15:28.513349 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.northwind_dbt.marts.bi
[0m23:15:28.535862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '93849312-179d-4f0d-af6b-cf0a42551486', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2D19D5EE0>]}
[0m23:15:28.776988 [debug] [MainThread]: Wrote artifact WritableManifest to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\manifest.json
[0m23:15:28.783130 [debug] [MainThread]: Wrote artifact SemanticManifest to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\semantic_manifest.json
[0m23:15:28.858257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '93849312-179d-4f0d-af6b-cf0a42551486', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2D12C97F0>]}
[0m23:15:28.859348 [info ] [MainThread]: Found 10 models, 8 sources, 706 macros
[0m23:15:28.860958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '93849312-179d-4f0d-af6b-cf0a42551486', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2D13BBDC0>]}
[0m23:15:28.864363 [info ] [MainThread]: 
[0m23:15:28.866075 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:15:28.867897 [info ] [MainThread]: 
[0m23:15:28.869232 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:15:28.879096 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_Project_2'
[0m23:15:29.080936 [debug] [ThreadPool]: Using snowflake connection "list_Project_2"
[0m23:15:29.082056 [debug] [ThreadPool]: On list_Project_2: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "connection_name": "list_Project_2"} */
show terse schemas in database Project_2
    limit 10000
[0m23:15:29.082611 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:15:29.644920 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.565 seconds
[0m23:15:29.644920 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_Project_2_public'
[0m23:15:29.660717 [debug] [ThreadPool]: Using snowflake connection "list_Project_2_public"
[0m23:15:29.660717 [debug] [ThreadPool]: On list_Project_2_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "connection_name": "list_Project_2_public"} */
show objects in Project_2.public limit 10000;
[0m23:15:29.660717 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:15:30.202388 [debug] [ThreadPool]: SQL status: SUCCESS 23 in 0.543 seconds
[0m23:15:30.202388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '93849312-179d-4f0d-af6b-cf0a42551486', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2B7B54A00>]}
[0m23:15:30.216024 [debug] [Thread-1  ]: Began running node model.northwind_dbt.stg_customers
[0m23:15:30.216780 [debug] [Thread-2  ]: Began running node model.northwind_dbt.stg_employees
[0m23:15:30.216780 [debug] [Thread-3  ]: Began running node model.northwind_dbt.stg_order_details
[0m23:15:30.216780 [debug] [Thread-4  ]: Began running node model.northwind_dbt.stg_orders
[0m23:15:30.216780 [info ] [Thread-1  ]: 1 of 10 START sql view model public.stg_customers .............................. [RUN]
[0m23:15:30.216780 [info ] [Thread-2  ]: 2 of 10 START sql view model public.stg_employees .............................. [RUN]
[0m23:15:30.216780 [info ] [Thread-3  ]: 3 of 10 START sql view model public.stg_order_details .......................... [RUN]
[0m23:15:30.216780 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.northwind_dbt.stg_customers'
[0m23:15:30.216780 [info ] [Thread-4  ]: 4 of 10 START sql view model public.stg_orders ................................. [RUN]
[0m23:15:30.216780 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.northwind_dbt.stg_employees'
[0m23:15:30.216780 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.northwind_dbt.stg_order_details'
[0m23:15:30.216780 [debug] [Thread-1  ]: Began compiling node model.northwind_dbt.stg_customers
[0m23:15:30.216780 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.northwind_dbt.stg_orders'
[0m23:15:30.216780 [debug] [Thread-2  ]: Began compiling node model.northwind_dbt.stg_employees
[0m23:15:30.216780 [debug] [Thread-3  ]: Began compiling node model.northwind_dbt.stg_order_details
[0m23:15:30.216780 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind_dbt.stg_customers"
[0m23:15:30.231676 [debug] [Thread-4  ]: Began compiling node model.northwind_dbt.stg_orders
[0m23:15:30.234874 [debug] [Thread-2  ]: Writing injected SQL for node "model.northwind_dbt.stg_employees"
[0m23:15:30.234874 [debug] [Thread-3  ]: Writing injected SQL for node "model.northwind_dbt.stg_order_details"
[0m23:15:30.244330 [debug] [Thread-4  ]: Writing injected SQL for node "model.northwind_dbt.stg_orders"
[0m23:15:30.266012 [debug] [Thread-3  ]: Began executing node model.northwind_dbt.stg_order_details
[0m23:15:30.266012 [debug] [Thread-1  ]: Began executing node model.northwind_dbt.stg_customers
[0m23:15:30.280965 [debug] [Thread-4  ]: Began executing node model.northwind_dbt.stg_orders
[0m23:15:30.290977 [debug] [Thread-3  ]: Writing runtime sql for node "model.northwind_dbt.stg_order_details"
[0m23:15:30.291977 [debug] [Thread-2  ]: Began executing node model.northwind_dbt.stg_employees
[0m23:15:30.294977 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind_dbt.stg_customers"
[0m23:15:30.299127 [debug] [Thread-4  ]: Writing runtime sql for node "model.northwind_dbt.stg_orders"
[0m23:15:30.303069 [debug] [Thread-2  ]: Writing runtime sql for node "model.northwind_dbt.stg_employees"
[0m23:15:30.314041 [debug] [Thread-3  ]: Using snowflake connection "model.northwind_dbt.stg_order_details"
[0m23:15:30.315040 [debug] [Thread-3  ]: On model.northwind_dbt.stg_order_details: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.stg_order_details"} */
create or replace   view Project_2.public.stg_order_details
  
   as (
    select * from PROJECT_2.PUBLIC.order_details
  );
[0m23:15:30.315040 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m23:15:30.323615 [debug] [Thread-1  ]: Using snowflake connection "model.northwind_dbt.stg_customers"
[0m23:15:30.323615 [debug] [Thread-2  ]: Using snowflake connection "model.northwind_dbt.stg_employees"
[0m23:15:30.323615 [debug] [Thread-4  ]: Using snowflake connection "model.northwind_dbt.stg_orders"
[0m23:15:30.323615 [debug] [Thread-1  ]: On model.northwind_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.stg_customers"} */
create or replace   view Project_2.public.stg_customers
  
   as (
    select * from PROJECT_2.PUBLIC.customers
  );
[0m23:15:30.323615 [debug] [Thread-2  ]: On model.northwind_dbt.stg_employees: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.stg_employees"} */
create or replace   view Project_2.public.stg_employees
  
   as (
    select * from PROJECT_2.PUBLIC.employees
  );
[0m23:15:30.323615 [debug] [Thread-4  ]: On model.northwind_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.stg_orders"} */
create or replace   view Project_2.public.stg_orders
  
   as (
    select * from PROJECT_2.PUBLIC.orders
  );
[0m23:15:30.323615 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m23:15:30.323615 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m23:15:30.331100 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m23:15:30.970104 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.654 seconds
[0m23:15:30.992413 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93849312-179d-4f0d-af6b-cf0a42551486', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2D2117160>]}
[0m23:15:30.993511 [info ] [Thread-3  ]: 3 of 10 OK created sql view model public.stg_order_details ..................... [[32mSUCCESS 1[0m in 0.77s]
[0m23:15:30.995162 [debug] [Thread-3  ]: Finished running node model.northwind_dbt.stg_order_details
[0m23:15:30.995696 [debug] [Thread-3  ]: Began running node model.northwind_dbt.stg_products
[0m23:15:30.996215 [info ] [Thread-3  ]: 5 of 10 START sql view model public.stg_products ............................... [RUN]
[0m23:15:30.997319 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.northwind_dbt.stg_order_details, now model.northwind_dbt.stg_products)
[0m23:15:30.997876 [debug] [Thread-3  ]: Began compiling node model.northwind_dbt.stg_products
[0m23:15:31.001195 [debug] [Thread-3  ]: Writing injected SQL for node "model.northwind_dbt.stg_products"
[0m23:15:31.009176 [debug] [Thread-3  ]: Began executing node model.northwind_dbt.stg_products
[0m23:15:31.015192 [debug] [Thread-3  ]: Writing runtime sql for node "model.northwind_dbt.stg_products"
[0m23:15:31.025846 [debug] [Thread-3  ]: Using snowflake connection "model.northwind_dbt.stg_products"
[0m23:15:31.027862 [debug] [Thread-3  ]: On model.northwind_dbt.stg_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.stg_products"} */
create or replace   view Project_2.public.stg_products
  
   as (
    select * from PROJECT_2.PUBLIC.products
  );
[0m23:15:31.108926 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.779 seconds
[0m23:15:31.111929 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93849312-179d-4f0d-af6b-cf0a42551486', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2D21173D0>]}
[0m23:15:31.111929 [info ] [Thread-1  ]: 1 of 10 OK created sql view model public.stg_customers ......................... [[32mSUCCESS 1[0m in 0.90s]
[0m23:15:31.111929 [debug] [Thread-1  ]: Finished running node model.northwind_dbt.stg_customers
[0m23:15:31.111929 [debug] [Thread-1  ]: Began running node model.northwind_dbt.dim_customers
[0m23:15:31.111929 [info ] [Thread-1  ]: 6 of 10 START sql table model public.dim_customers ............................. [RUN]
[0m23:15:31.117350 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.northwind_dbt.stg_customers, now model.northwind_dbt.dim_customers)
[0m23:15:31.117350 [debug] [Thread-1  ]: Began compiling node model.northwind_dbt.dim_customers
[0m23:15:31.117350 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind_dbt.dim_customers"
[0m23:15:31.130601 [debug] [Thread-1  ]: Began executing node model.northwind_dbt.dim_customers
[0m23:15:31.212236 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind_dbt.dim_customers"
[0m23:15:31.212236 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.894 seconds
[0m23:15:31.212236 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93849312-179d-4f0d-af6b-cf0a42551486', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2D21D0BE0>]}
[0m23:15:31.228341 [info ] [Thread-2  ]: 2 of 10 OK created sql view model public.stg_employees ......................... [[32mSUCCESS 1[0m in 1.00s]
[0m23:15:31.228341 [debug] [Thread-2  ]: Finished running node model.northwind_dbt.stg_employees
[0m23:15:31.228341 [debug] [Thread-2  ]: Began running node model.northwind_dbt.dim_employees
[0m23:15:31.228341 [info ] [Thread-2  ]: 7 of 10 START sql incremental model public.dim_employees ....................... [RUN]
[0m23:15:31.228341 [debug] [Thread-1  ]: Using snowflake connection "model.northwind_dbt.dim_customers"
[0m23:15:31.228341 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.northwind_dbt.stg_employees, now model.northwind_dbt.dim_employees)
[0m23:15:31.228341 [debug] [Thread-1  ]: On model.northwind_dbt.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.dim_customers"} */
create or replace transient table Project_2.public.dim_customers
         as
        (select * from Project_2.public.stg_customers
        );
[0m23:15:31.228341 [debug] [Thread-2  ]: Began compiling node model.northwind_dbt.dim_employees
[0m23:15:31.247081 [debug] [Thread-2  ]: Writing injected SQL for node "model.northwind_dbt.dim_employees"
[0m23:15:31.260657 [debug] [Thread-2  ]: Began executing node model.northwind_dbt.dim_employees
[0m23:15:31.279791 [debug] [Thread-2  ]: Using snowflake connection "model.northwind_dbt.dim_employees"
[0m23:15:31.279791 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.962 seconds
[0m23:15:31.293934 [debug] [Thread-2  ]: On model.northwind_dbt.dim_employees: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.dim_employees"} */
create or replace  temporary view Project_2.public.dim_employees__dbt_tmp
  
   as (
    

with source_data as (
    select * from Project_2.public.stg_employees
),
scd2 as (
    select 
        md5(cast(coalesce(cast(employee_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as employee_key,
        *,
        current_timestamp as dbt_updated_at
    from source_data
)
select * from scd2
  );
[0m23:15:31.297234 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93849312-179d-4f0d-af6b-cf0a42551486', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2D31E9700>]}
[0m23:15:31.299133 [info ] [Thread-4  ]: 4 of 10 OK created sql view model public.stg_orders ............................ [[32mSUCCESS 1[0m in 1.08s]
[0m23:15:31.301209 [debug] [Thread-4  ]: Finished running node model.northwind_dbt.stg_orders
[0m23:15:31.302136 [debug] [Thread-4  ]: Began running node model.northwind_dbt.fact_order_details
[0m23:15:31.303154 [info ] [Thread-4  ]: 8 of 10 START sql incremental model public.fact_order_details .................. [RUN]
[0m23:15:31.304284 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.northwind_dbt.stg_orders, now model.northwind_dbt.fact_order_details)
[0m23:15:31.305392 [debug] [Thread-4  ]: Began compiling node model.northwind_dbt.fact_order_details
[0m23:15:31.310296 [debug] [Thread-4  ]: Writing injected SQL for node "model.northwind_dbt.fact_order_details"
[0m23:15:31.318515 [debug] [Thread-4  ]: Began executing node model.northwind_dbt.fact_order_details
[0m23:15:31.331753 [debug] [Thread-4  ]: Using snowflake connection "model.northwind_dbt.fact_order_details"
[0m23:15:31.332968 [debug] [Thread-4  ]: On model.northwind_dbt.fact_order_details: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.fact_order_details"} */
create or replace  temporary view Project_2.public.fact_order_details__dbt_tmp
  
   as (
    

with base as (
    select 
        od.order_id,
        od.product_id,
        o.customer_id,
        o.employee_id,
        o.ship_via as shipper_id,
        o.order_date,
        od.unit_price,
        od.quantity,
        od.discount,
        od.unit_price * od.quantity * (1 - od.discount) as revenue
    from Project_2.public.stg_order_details od
    join Project_2.public.stg_orders o on od.order_id = o.order_id
    
        and o.order_date >= (select max(order_date) from Project_2.public.fact_order_details)
    
),
aggregated as (
    select 
        order_id,
        product_id,
        customer_id,
        employee_id,
        shipper_id,
        cast(order_date as date) as order_date,
        sum(revenue) as total_revenue,
        avg(revenue) as avg_revenue,
        max(revenue) as max_revenue,
        min(revenue) as min_revenue,
        count(*) as line_count,
        rank() over (partition by customer_id order by sum(revenue) desc) as revenue_rank
    from base
    group by order_id, product_id, customer_id, employee_id, shipper_id, order_date
)
select * from aggregated
  );
[0m23:15:31.427948 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.407 seconds
[0m23:15:31.438392 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93849312-179d-4f0d-af6b-cf0a42551486', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2D127FF10>]}
[0m23:15:31.438392 [info ] [Thread-3  ]: 5 of 10 OK created sql view model public.stg_products .......................... [[32mSUCCESS 1[0m in 0.44s]
[0m23:15:31.438392 [debug] [Thread-3  ]: Finished running node model.northwind_dbt.stg_products
[0m23:15:31.438392 [debug] [Thread-3  ]: Began running node model.northwind_dbt.dim_products
[0m23:15:31.438392 [info ] [Thread-3  ]: 9 of 10 START sql table model public.dim_products .............................. [RUN]
[0m23:15:31.443948 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.northwind_dbt.stg_products, now model.northwind_dbt.dim_products)
[0m23:15:31.447850 [debug] [Thread-3  ]: Began compiling node model.northwind_dbt.dim_products
[0m23:15:31.447850 [debug] [Thread-3  ]: Writing injected SQL for node "model.northwind_dbt.dim_products"
[0m23:15:31.462299 [debug] [Thread-3  ]: Began executing node model.northwind_dbt.dim_products
[0m23:15:31.462720 [debug] [Thread-3  ]: Writing runtime sql for node "model.northwind_dbt.dim_products"
[0m23:15:31.477304 [debug] [Thread-3  ]: Using snowflake connection "model.northwind_dbt.dim_products"
[0m23:15:31.479327 [debug] [Thread-3  ]: On model.northwind_dbt.dim_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.dim_products"} */
create or replace transient table Project_2.public.dim_products
         as
        (select 
    p.product_id,
    p.product_name,
    p.supplier_id,
    s.company_name as supplier_name,
    p.category_id,
    c.category_name,
    p.quantity_per_unit,
    p.unit_price,
    p.units_in_stock,
    p.units_on_order,
    p.reorder_level,
    p.discontinued
from Project_2.public.stg_products p
left join PROJECT_2.PUBLIC.suppliers s on p.supplier_id = s.supplier_id
left join PROJECT_2.PUBLIC.categories c on p.category_id = c.category_id
        );
[0m23:15:31.705725 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.382 seconds
[0m23:15:31.719726 [debug] [Thread-4  ]: Using snowflake connection "model.northwind_dbt.fact_order_details"
[0m23:15:31.719726 [debug] [Thread-4  ]: On model.northwind_dbt.fact_order_details: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.fact_order_details"} */
describe table Project_2.public.fact_order_details__dbt_tmp
[0m23:15:31.815061 [debug] [Thread-4  ]: SQL status: SUCCESS 12 in 0.092 seconds
[0m23:15:31.815061 [debug] [Thread-4  ]: Using snowflake connection "model.northwind_dbt.fact_order_details"
[0m23:15:31.815061 [debug] [Thread-4  ]: On model.northwind_dbt.fact_order_details: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.fact_order_details"} */
describe table Project_2.public.fact_order_details
[0m23:15:31.861315 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.571 seconds
[0m23:15:31.861315 [debug] [Thread-2  ]: Using snowflake connection "model.northwind_dbt.dim_employees"
[0m23:15:31.861315 [debug] [Thread-2  ]: On model.northwind_dbt.dim_employees: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.dim_employees"} */
describe table Project_2.public.dim_employees__dbt_tmp
[0m23:15:31.893886 [debug] [Thread-4  ]: SQL status: SUCCESS 11 in 0.078 seconds
[0m23:15:31.909199 [debug] [Thread-4  ]: Using snowflake connection "model.northwind_dbt.fact_order_details"
[0m23:15:31.909199 [debug] [Thread-4  ]: On model.northwind_dbt.fact_order_details: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.fact_order_details"} */
describe table "PROJECT_2"."PUBLIC"."FACT_ORDER_DETAILS"
[0m23:15:31.956627 [debug] [Thread-2  ]: SQL status: SUCCESS 24 in 0.084 seconds
[0m23:15:31.961246 [debug] [Thread-2  ]: Using snowflake connection "model.northwind_dbt.dim_employees"
[0m23:15:31.961246 [debug] [Thread-2  ]: On model.northwind_dbt.dim_employees: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.dim_employees"} */
describe table Project_2.public.dim_employees
[0m23:15:31.988428 [debug] [Thread-4  ]: SQL status: SUCCESS 11 in 0.085 seconds
[0m23:15:32.022588 [debug] [Thread-4  ]: Writing runtime sql for node "model.northwind_dbt.fact_order_details"
[0m23:15:32.035455 [debug] [Thread-4  ]: Using snowflake connection "model.northwind_dbt.fact_order_details"
[0m23:15:32.035455 [debug] [Thread-4  ]: On model.northwind_dbt.fact_order_details: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.fact_order_details"} */
-- back compat for old kwarg name
  
  begin;
[0m23:15:32.053447 [debug] [Thread-2  ]: SQL status: SUCCESS 24 in 0.088 seconds
[0m23:15:32.063156 [debug] [Thread-2  ]: Using snowflake connection "model.northwind_dbt.dim_employees"
[0m23:15:32.065165 [debug] [Thread-2  ]: On model.northwind_dbt.dim_employees: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.dim_employees"} */
describe table "PROJECT_2"."PUBLIC"."DIM_EMPLOYEES"
[0m23:15:32.134972 [debug] [Thread-2  ]: SQL status: SUCCESS 24 in 0.070 seconds
[0m23:15:32.137998 [debug] [Thread-2  ]: Writing runtime sql for node "model.northwind_dbt.dim_employees"
[0m23:15:32.137998 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.914 seconds
[0m23:15:32.152630 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93849312-179d-4f0d-af6b-cf0a42551486', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2D327DE80>]}
[0m23:15:32.153638 [info ] [Thread-1  ]: 6 of 10 OK created sql table model public.dim_customers ........................ [[32mSUCCESS 1[0m in 1.02s]
[0m23:15:32.153638 [debug] [Thread-1  ]: Finished running node model.northwind_dbt.dim_customers
[0m23:15:32.153638 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.122 seconds
[0m23:15:32.153638 [debug] [Thread-2  ]: Using snowflake connection "model.northwind_dbt.dim_employees"
[0m23:15:32.153638 [debug] [Thread-4  ]: Using snowflake connection "model.northwind_dbt.fact_order_details"
[0m23:15:32.161717 [debug] [Thread-2  ]: On model.northwind_dbt.dim_employees: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.dim_employees"} */
-- back compat for old kwarg name
  
  begin;
[0m23:15:32.161717 [debug] [Thread-4  ]: On model.northwind_dbt.fact_order_details: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.fact_order_details"} */
merge into Project_2.public.fact_order_details as DBT_INTERNAL_DEST
        using Project_2.public.fact_order_details__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.order_id = DBT_INTERNAL_DEST.order_id
                ) and (
                    DBT_INTERNAL_SOURCE.product_id = DBT_INTERNAL_DEST.product_id
                )

    
    when matched then update set
        "ORDER_ID" = DBT_INTERNAL_SOURCE."ORDER_ID","CUSTOMER_ID" = DBT_INTERNAL_SOURCE."CUSTOMER_ID","EMPLOYEE_ID" = DBT_INTERNAL_SOURCE."EMPLOYEE_ID","SHIPPER_ID" = DBT_INTERNAL_SOURCE."SHIPPER_ID","ORDER_DATE" = DBT_INTERNAL_SOURCE."ORDER_DATE","TOTAL_REVENUE" = DBT_INTERNAL_SOURCE."TOTAL_REVENUE","AVG_REVENUE" = DBT_INTERNAL_SOURCE."AVG_REVENUE","MAX_REVENUE" = DBT_INTERNAL_SOURCE."MAX_REVENUE","MIN_REVENUE" = DBT_INTERNAL_SOURCE."MIN_REVENUE","LINE_COUNT" = DBT_INTERNAL_SOURCE."LINE_COUNT","REVENUE_RANK" = DBT_INTERNAL_SOURCE."REVENUE_RANK"
    

    when not matched then insert
        ("ORDER_ID", "CUSTOMER_ID", "EMPLOYEE_ID", "SHIPPER_ID", "ORDER_DATE", "TOTAL_REVENUE", "AVG_REVENUE", "MAX_REVENUE", "MIN_REVENUE", "LINE_COUNT", "REVENUE_RANK")
    values
        ("ORDER_ID", "CUSTOMER_ID", "EMPLOYEE_ID", "SHIPPER_ID", "ORDER_DATE", "TOTAL_REVENUE", "AVG_REVENUE", "MAX_REVENUE", "MIN_REVENUE", "LINE_COUNT", "REVENUE_RANK")

;
[0m23:15:32.243712 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.081 seconds
[0m23:15:32.245728 [debug] [Thread-2  ]: Using snowflake connection "model.northwind_dbt.dim_employees"
[0m23:15:32.247739 [debug] [Thread-2  ]: On model.northwind_dbt.dim_employees: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.dim_employees"} */
merge into Project_2.public.dim_employees as DBT_INTERNAL_DEST
        using Project_2.public.dim_employees__dbt_tmp as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.employee_key = DBT_INTERNAL_DEST.employee_key))

    
    when matched then update set
        "EMPLOYEE_KEY" = DBT_INTERNAL_SOURCE."EMPLOYEE_KEY","_AIRBYTE_RAW_ID" = DBT_INTERNAL_SOURCE."_AIRBYTE_RAW_ID","_AIRBYTE_EXTRACTED_AT" = DBT_INTERNAL_SOURCE."_AIRBYTE_EXTRACTED_AT","_AIRBYTE_META" = DBT_INTERNAL_SOURCE."_AIRBYTE_META","_AIRBYTE_GENERATION_ID" = DBT_INTERNAL_SOURCE."_AIRBYTE_GENERATION_ID","CITY" = DBT_INTERNAL_SOURCE."CITY","NOTES" = DBT_INTERNAL_SOURCE."NOTES","PHOTO" = DBT_INTERNAL_SOURCE."PHOTO","TITLE" = DBT_INTERNAL_SOURCE."TITLE","REGION" = DBT_INTERNAL_SOURCE."REGION","ADDRESS" = DBT_INTERNAL_SOURCE."ADDRESS","COUNTRY" = DBT_INTERNAL_SOURCE."COUNTRY","EXTENSION" = DBT_INTERNAL_SOURCE."EXTENSION","HIRE_DATE" = DBT_INTERNAL_SOURCE."HIRE_DATE","LAST_NAME" = DBT_INTERNAL_SOURCE."LAST_NAME","BIRTH_DATE" = DBT_INTERNAL_SOURCE."BIRTH_DATE","FIRST_NAME" = DBT_INTERNAL_SOURCE."FIRST_NAME","HOME_PHONE" = DBT_INTERNAL_SOURCE."HOME_PHONE","PHOTO_PATH" = DBT_INTERNAL_SOURCE."PHOTO_PATH","REPORTS_TO" = DBT_INTERNAL_SOURCE."REPORTS_TO","EMPLOYEE_ID" = DBT_INTERNAL_SOURCE."EMPLOYEE_ID","POSTAL_CODE" = DBT_INTERNAL_SOURCE."POSTAL_CODE","TITLE_OF_COURTESY" = DBT_INTERNAL_SOURCE."TITLE_OF_COURTESY","DBT_UPDATED_AT" = DBT_INTERNAL_SOURCE."DBT_UPDATED_AT"
    

    when not matched then insert
        ("EMPLOYEE_KEY", "_AIRBYTE_RAW_ID", "_AIRBYTE_EXTRACTED_AT", "_AIRBYTE_META", "_AIRBYTE_GENERATION_ID", "CITY", "NOTES", "PHOTO", "TITLE", "REGION", "ADDRESS", "COUNTRY", "EXTENSION", "HIRE_DATE", "LAST_NAME", "BIRTH_DATE", "FIRST_NAME", "HOME_PHONE", "PHOTO_PATH", "REPORTS_TO", "EMPLOYEE_ID", "POSTAL_CODE", "TITLE_OF_COURTESY", "DBT_UPDATED_AT")
    values
        ("EMPLOYEE_KEY", "_AIRBYTE_RAW_ID", "_AIRBYTE_EXTRACTED_AT", "_AIRBYTE_META", "_AIRBYTE_GENERATION_ID", "CITY", "NOTES", "PHOTO", "TITLE", "REGION", "ADDRESS", "COUNTRY", "EXTENSION", "HIRE_DATE", "LAST_NAME", "BIRTH_DATE", "FIRST_NAME", "HOME_PHONE", "PHOTO_PATH", "REPORTS_TO", "EMPLOYEE_ID", "POSTAL_CODE", "TITLE_OF_COURTESY", "DBT_UPDATED_AT")

;
[0m23:15:32.255668 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.781 seconds
[0m23:15:32.264029 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93849312-179d-4f0d-af6b-cf0a42551486', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2D172B3A0>]}
[0m23:15:32.264029 [info ] [Thread-3  ]: 9 of 10 OK created sql table model public.dim_products ......................... [[32mSUCCESS 1[0m in 0.82s]
[0m23:15:32.264029 [debug] [Thread-3  ]: Finished running node model.northwind_dbt.dim_products
[0m23:15:32.361842 [debug] [Thread-4  ]: Snowflake adapter: Snowflake query id: 01bba723-020d-0183-000c-83e7000b31f6
[0m23:15:32.361842 [debug] [Thread-4  ]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 6 at position 53
invalid identifier 'DBT_INTERNAL_DEST.PRODUCT_ID'
[0m23:15:32.361842 [debug] [Thread-4  ]: Database Error in model fact_order_details (models\marts\core\fact_order_details.sql)
  000904 (42000): SQL compilation error: error line 6 at position 53
  invalid identifier 'DBT_INTERNAL_DEST.PRODUCT_ID'
  compiled code at target\run\northwind_dbt\models\marts\core\fact_order_details.sql
[0m23:15:32.372541 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93849312-179d-4f0d-af6b-cf0a42551486', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2D133CDC0>]}
[0m23:15:32.373311 [error] [Thread-4  ]: 8 of 10 ERROR creating sql incremental model public.fact_order_details ......... [[31mERROR[0m in 1.07s]
[0m23:15:32.373311 [debug] [Thread-4  ]: Finished running node model.northwind_dbt.fact_order_details
[0m23:15:32.373311 [debug] [Thread-7  ]: Marking all children of 'model.northwind_dbt.fact_order_details' to be skipped because of status 'error'.  Reason: Database Error in model fact_order_details (models\marts\core\fact_order_details.sql)
  000904 (42000): SQL compilation error: error line 6 at position 53
  invalid identifier 'DBT_INTERNAL_DEST.PRODUCT_ID'
  compiled code at target\run\northwind_dbt\models\marts\core\fact_order_details.sql.
[0m23:15:33.127736 [debug] [Thread-2  ]: SQL status: SUCCESS 9 in 0.879 seconds
[0m23:15:33.129753 [debug] [Thread-2  ]: Using snowflake connection "model.northwind_dbt.dim_employees"
[0m23:15:33.130761 [debug] [Thread-2  ]: On model.northwind_dbt.dim_employees: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.dim_employees"} */
COMMIT
[0m23:15:33.421547 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.290 seconds
[0m23:15:33.432213 [debug] [Thread-2  ]: Applying DROP to: Project_2.public.dim_employees__dbt_tmp
[0m23:15:33.439214 [debug] [Thread-2  ]: Using snowflake connection "model.northwind_dbt.dim_employees"
[0m23:15:33.440279 [debug] [Thread-2  ]: On model.northwind_dbt.dim_employees: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.dim_employees"} */
drop view if exists Project_2.public.dim_employees__dbt_tmp cascade
[0m23:15:33.614729 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.173 seconds
[0m23:15:33.617900 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93849312-179d-4f0d-af6b-cf0a42551486', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2B8751B50>]}
[0m23:15:33.618966 [info ] [Thread-2  ]: 7 of 10 OK created sql incremental model public.dim_employees .................. [[32mSUCCESS 9[0m in 2.39s]
[0m23:15:33.621148 [debug] [Thread-2  ]: Finished running node model.northwind_dbt.dim_employees
[0m23:15:33.622778 [debug] [Thread-1  ]: Began running node model.northwind_dbt.obt_orders
[0m23:15:33.623828 [info ] [Thread-1  ]: 10 of 10 SKIP relation public.obt_orders ....................................... [[33mSKIP[0m]
[0m23:15:33.627254 [debug] [Thread-1  ]: Finished running node model.northwind_dbt.obt_orders
[0m23:15:33.630415 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:15:33.632411 [debug] [MainThread]: Connection 'list_Project_2' was left open.
[0m23:15:33.633462 [debug] [MainThread]: On list_Project_2: Close
[0m23:15:34.194733 [debug] [MainThread]: Connection 'list_Project_2_public' was left open.
[0m23:15:34.196327 [debug] [MainThread]: On list_Project_2_public: Close
[0m23:15:34.325693 [debug] [MainThread]: Connection 'model.northwind_dbt.dim_customers' was left open.
[0m23:15:34.326801 [debug] [MainThread]: On model.northwind_dbt.dim_customers: Close
[0m23:15:34.439187 [debug] [MainThread]: Connection 'model.northwind_dbt.dim_employees' was left open.
[0m23:15:34.439187 [debug] [MainThread]: On model.northwind_dbt.dim_employees: Close
[0m23:15:34.546020 [debug] [MainThread]: Connection 'model.northwind_dbt.dim_products' was left open.
[0m23:15:34.551226 [debug] [MainThread]: On model.northwind_dbt.dim_products: Close
[0m23:15:34.698139 [debug] [MainThread]: Connection 'model.northwind_dbt.fact_order_details' was left open.
[0m23:15:34.698139 [debug] [MainThread]: On model.northwind_dbt.fact_order_details: Close
[0m23:15:34.816045 [info ] [MainThread]: 
[0m23:15:34.821588 [info ] [MainThread]: Finished running 2 incremental models, 3 table models, 5 view models in 0 hours 0 minutes and 5.95 seconds (5.95s).
[0m23:15:34.826405 [debug] [MainThread]: Command end result
[0m23:15:35.004900 [debug] [MainThread]: Wrote artifact WritableManifest to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\manifest.json
[0m23:15:35.015812 [debug] [MainThread]: Wrote artifact SemanticManifest to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\semantic_manifest.json
[0m23:15:35.036526 [debug] [MainThread]: Wrote artifact RunExecutionResult to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\run_results.json
[0m23:15:35.036526 [info ] [MainThread]: 
[0m23:15:35.036526 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m23:15:35.036526 [info ] [MainThread]: 
[0m23:15:35.036526 [error] [MainThread]:   Database Error in model fact_order_details (models\marts\core\fact_order_details.sql)
  000904 (42000): SQL compilation error: error line 6 at position 53
  invalid identifier 'DBT_INTERNAL_DEST.PRODUCT_ID'
  compiled code at target\run\northwind_dbt\models\marts\core\fact_order_details.sql
[0m23:15:35.036526 [info ] [MainThread]: 
[0m23:15:35.036526 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=1 SKIP=1 TOTAL=10
[0m23:15:35.036526 [debug] [MainThread]: Command `dbt run` failed at 23:15:35.036526 after 9.27 seconds
[0m23:15:35.036526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2B675F3D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2D127FF10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2D2142250>]}
[0m23:15:35.036526 [debug] [MainThread]: Flushing usage events
[0m23:15:35.810946 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:16:31.966136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025270DEF3D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025272E62D00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025272E62AF0>]}


============================== 23:16:31.966136 | 2998886a-190b-4b66-b711-ff4b3885e307 ==============================
[0m23:16:31.966136 [info ] [MainThread]: Running with dbt=1.9.0
[0m23:16:31.966136 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'c:\\Users\\fitzp\\Documents\\Alpaca_Market\\zproject_2\\northwind_psql', 'debug': 'False', 'warn_error': 'None', 'log_path': 'c:\\Users\\fitzp\\Documents\\Alpaca_Market\\zproject_2\\northwind_psql\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select fact_order_details --full-refresh', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:16:32.794090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2998886a-190b-4b66-b711-ff4b3885e307', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252721CDA90>]}
[0m23:16:32.841095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2998886a-190b-4b66-b711-ff4b3885e307', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252727D0D30>]}
[0m23:16:32.841095 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m23:16:33.220092 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m23:16:33.748222 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:16:33.749352 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:16:33.757232 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.northwind_dbt.marts.bi
[0m23:16:33.796459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2998886a-190b-4b66-b711-ff4b3885e307', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002520BF2AFA0>]}
[0m23:16:34.067525 [debug] [MainThread]: Wrote artifact WritableManifest to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\manifest.json
[0m23:16:34.074575 [debug] [MainThread]: Wrote artifact SemanticManifest to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\semantic_manifest.json
[0m23:16:34.180055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2998886a-190b-4b66-b711-ff4b3885e307', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002520BF187C0>]}
[0m23:16:34.181168 [info ] [MainThread]: Found 10 models, 8 sources, 706 macros
[0m23:16:34.181168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2998886a-190b-4b66-b711-ff4b3885e307', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002520BF360D0>]}
[0m23:16:34.181168 [info ] [MainThread]: 
[0m23:16:34.181168 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:16:34.181168 [info ] [MainThread]: 
[0m23:16:34.188562 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:16:34.192401 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_Project_2'
[0m23:16:34.326960 [debug] [ThreadPool]: Using snowflake connection "list_Project_2"
[0m23:16:34.326960 [debug] [ThreadPool]: On list_Project_2: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "connection_name": "list_Project_2"} */
show terse schemas in database Project_2
    limit 10000
[0m23:16:34.326960 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:16:34.914959 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.586 seconds
[0m23:16:34.919894 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_Project_2_public'
[0m23:16:34.923410 [debug] [ThreadPool]: Using snowflake connection "list_Project_2_public"
[0m23:16:34.923410 [debug] [ThreadPool]: On list_Project_2_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "connection_name": "list_Project_2_public"} */
show objects in Project_2.public limit 10000;
[0m23:16:34.923410 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:16:35.346725 [debug] [ThreadPool]: SQL status: SUCCESS 23 in 0.416 seconds
[0m23:16:35.356354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2998886a-190b-4b66-b711-ff4b3885e307', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002520BF176D0>]}
[0m23:16:35.360483 [debug] [Thread-1  ]: Began running node model.northwind_dbt.fact_order_details
[0m23:16:35.360483 [info ] [Thread-1  ]: 1 of 1 START sql incremental model public.fact_order_details ................... [RUN]
[0m23:16:35.363480 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.northwind_dbt.fact_order_details'
[0m23:16:35.363480 [debug] [Thread-1  ]: Began compiling node model.northwind_dbt.fact_order_details
[0m23:16:35.374515 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind_dbt.fact_order_details"
[0m23:16:35.396355 [debug] [Thread-1  ]: Began executing node model.northwind_dbt.fact_order_details
[0m23:16:35.456748 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind_dbt.fact_order_details"
[0m23:16:35.472909 [debug] [Thread-1  ]: Using snowflake connection "model.northwind_dbt.fact_order_details"
[0m23:16:35.472909 [debug] [Thread-1  ]: On model.northwind_dbt.fact_order_details: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.fact_order_details"} */
create or replace transient table Project_2.public.fact_order_details
         as
        (

with base as (
    select 
        od.order_id,
        od.product_id,
        o.customer_id,
        o.employee_id,
        o.ship_via as shipper_id,
        o.order_date,
        od.unit_price,
        od.quantity,
        od.discount,
        od.unit_price * od.quantity * (1 - od.discount) as revenue
    from Project_2.public.stg_order_details od
    join Project_2.public.stg_orders o on od.order_id = o.order_id
    
),
aggregated as (
    select 
        order_id,
        product_id,
        customer_id,
        employee_id,
        shipper_id,
        cast(order_date as date) as order_date,
        sum(revenue) as total_revenue,
        avg(revenue) as avg_revenue,
        max(revenue) as max_revenue,
        min(revenue) as min_revenue,
        count(*) as line_count,
        rank() over (partition by customer_id order by sum(revenue) desc) as revenue_rank
    from base
    group by order_id, product_id, customer_id, employee_id, shipper_id, order_date
)
select * from aggregated
        );
[0m23:16:35.472909 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m23:16:36.891635 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.416 seconds
[0m23:16:36.899043 [debug] [Thread-1  ]: Applying DROP to: Project_2.public.fact_order_details__dbt_tmp
[0m23:16:36.904316 [debug] [Thread-1  ]: Using snowflake connection "model.northwind_dbt.fact_order_details"
[0m23:16:36.905263 [debug] [Thread-1  ]: On model.northwind_dbt.fact_order_details: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.fact_order_details"} */
drop view if exists Project_2.public.fact_order_details__dbt_tmp cascade
[0m23:16:36.988823 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.097 seconds
[0m23:16:37.024558 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2998886a-190b-4b66-b711-ff4b3885e307', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002520BF176D0>]}
[0m23:16:37.024558 [info ] [Thread-1  ]: 1 of 1 OK created sql incremental model public.fact_order_details .............. [[32mSUCCESS 1[0m in 1.66s]
[0m23:16:37.024558 [debug] [Thread-1  ]: Finished running node model.northwind_dbt.fact_order_details
[0m23:16:37.024558 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:16:37.024558 [debug] [MainThread]: Connection 'list_Project_2' was left open.
[0m23:16:37.024558 [debug] [MainThread]: On list_Project_2: Close
[0m23:16:37.181259 [debug] [MainThread]: Connection 'list_Project_2_public' was left open.
[0m23:16:37.183153 [debug] [MainThread]: On list_Project_2_public: Close
[0m23:16:37.388426 [debug] [MainThread]: Connection 'model.northwind_dbt.fact_order_details' was left open.
[0m23:16:37.388989 [debug] [MainThread]: On model.northwind_dbt.fact_order_details: Close
[0m23:16:37.513164 [info ] [MainThread]: 
[0m23:16:37.513164 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 3.32 seconds (3.32s).
[0m23:16:37.513164 [debug] [MainThread]: Command end result
[0m23:16:37.699177 [debug] [MainThread]: Wrote artifact WritableManifest to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\manifest.json
[0m23:16:37.708625 [debug] [MainThread]: Wrote artifact SemanticManifest to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\semantic_manifest.json
[0m23:16:37.722372 [debug] [MainThread]: Wrote artifact RunExecutionResult to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\run_results.json
[0m23:16:37.722372 [info ] [MainThread]: 
[0m23:16:37.722372 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:16:37.722372 [info ] [MainThread]: 
[0m23:16:37.730779 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m23:16:37.740532 [debug] [MainThread]: Command `dbt run` succeeded at 23:16:37.739434 after 5.85 seconds
[0m23:16:37.740532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025270DEF3D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252727D0D30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002520BA66070>]}
[0m23:16:37.742156 [debug] [MainThread]: Flushing usage events
[0m23:16:38.502386 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:16:49.532746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD8CD6F2E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD8EDE3BE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD8EDE39D0>]}


============================== 23:16:49.537857 | 9928edc0-53f2-4b1f-a064-92a79be073a7 ==============================
[0m23:16:49.537857 [info ] [MainThread]: Running with dbt=1.9.0
[0m23:16:49.537857 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'c:\\Users\\fitzp\\Documents\\Alpaca_Market\\zproject_2\\northwind_psql', 'debug': 'False', 'warn_error': 'None', 'log_path': 'c:\\Users\\fitzp\\Documents\\Alpaca_Market\\zproject_2\\northwind_psql\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m23:16:50.373949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9928edc0-53f2-4b1f-a064-92a79be073a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDA7894A90>]}
[0m23:16:50.427391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9928edc0-53f2-4b1f-a064-92a79be073a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDA792E3A0>]}
[0m23:16:50.428946 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m23:16:50.795938 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m23:16:51.181254 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:16:51.181254 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:16:51.181254 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.northwind_dbt.marts.bi
[0m23:16:51.220479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9928edc0-53f2-4b1f-a064-92a79be073a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDA7EA8130>]}
[0m23:16:51.478672 [debug] [MainThread]: Wrote artifact WritableManifest to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\manifest.json
[0m23:16:51.481397 [debug] [MainThread]: Wrote artifact SemanticManifest to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\semantic_manifest.json
[0m23:16:51.566569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9928edc0-53f2-4b1f-a064-92a79be073a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDA7E95F40>]}
[0m23:16:51.567790 [info ] [MainThread]: Found 10 models, 8 sources, 706 macros
[0m23:16:51.570055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9928edc0-53f2-4b1f-a064-92a79be073a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDA7EB7220>]}
[0m23:16:51.578000 [info ] [MainThread]: 
[0m23:16:51.583732 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:16:51.588271 [info ] [MainThread]: 
[0m23:16:51.593065 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:16:51.593065 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_Project_2'
[0m23:16:51.685209 [debug] [ThreadPool]: Using snowflake connection "list_Project_2"
[0m23:16:51.686208 [debug] [ThreadPool]: On list_Project_2: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "connection_name": "list_Project_2"} */
show terse schemas in database Project_2
    limit 10000
[0m23:16:51.687211 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:16:52.427528 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.749 seconds
[0m23:16:52.439018 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_Project_2_public'
[0m23:16:52.446998 [debug] [ThreadPool]: Using snowflake connection "list_Project_2_public"
[0m23:16:52.449005 [debug] [ThreadPool]: On list_Project_2_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "connection_name": "list_Project_2_public"} */
show objects in Project_2.public limit 10000;
[0m23:16:52.449005 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:16:52.896139 [debug] [ThreadPool]: SQL status: SUCCESS 23 in 0.455 seconds
[0m23:16:52.911903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9928edc0-53f2-4b1f-a064-92a79be073a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD8CBED0A0>]}
[0m23:16:52.911903 [debug] [Thread-1  ]: Began running node model.northwind_dbt.stg_customers
[0m23:16:52.911903 [debug] [Thread-2  ]: Began running node model.northwind_dbt.stg_employees
[0m23:16:52.911903 [debug] [Thread-3  ]: Began running node model.northwind_dbt.stg_order_details
[0m23:16:52.911903 [debug] [Thread-4  ]: Began running node model.northwind_dbt.stg_orders
[0m23:16:52.911903 [info ] [Thread-1  ]: 1 of 10 START sql view model public.stg_customers .............................. [RUN]
[0m23:16:52.911903 [info ] [Thread-2  ]: 2 of 10 START sql view model public.stg_employees .............................. [RUN]
[0m23:16:52.911903 [info ] [Thread-3  ]: 3 of 10 START sql view model public.stg_order_details .......................... [RUN]
[0m23:16:52.911903 [info ] [Thread-4  ]: 4 of 10 START sql view model public.stg_orders ................................. [RUN]
[0m23:16:52.911903 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.northwind_dbt.stg_customers'
[0m23:16:52.911903 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.northwind_dbt.stg_employees'
[0m23:16:52.911903 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.northwind_dbt.stg_order_details'
[0m23:16:52.911903 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.northwind_dbt.stg_orders'
[0m23:16:52.911903 [debug] [Thread-1  ]: Began compiling node model.northwind_dbt.stg_customers
[0m23:16:52.911903 [debug] [Thread-2  ]: Began compiling node model.northwind_dbt.stg_employees
[0m23:16:52.911903 [debug] [Thread-3  ]: Began compiling node model.northwind_dbt.stg_order_details
[0m23:16:52.911903 [debug] [Thread-4  ]: Began compiling node model.northwind_dbt.stg_orders
[0m23:16:52.930571 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind_dbt.stg_customers"
[0m23:16:52.939249 [debug] [Thread-2  ]: Writing injected SQL for node "model.northwind_dbt.stg_employees"
[0m23:16:52.939249 [debug] [Thread-3  ]: Writing injected SQL for node "model.northwind_dbt.stg_order_details"
[0m23:16:52.939249 [debug] [Thread-4  ]: Writing injected SQL for node "model.northwind_dbt.stg_orders"
[0m23:16:52.966048 [debug] [Thread-2  ]: Began executing node model.northwind_dbt.stg_employees
[0m23:16:52.966048 [debug] [Thread-4  ]: Began executing node model.northwind_dbt.stg_orders
[0m23:16:52.966048 [debug] [Thread-3  ]: Began executing node model.northwind_dbt.stg_order_details
[0m23:16:52.966048 [debug] [Thread-1  ]: Began executing node model.northwind_dbt.stg_customers
[0m23:16:52.993664 [debug] [Thread-2  ]: Writing runtime sql for node "model.northwind_dbt.stg_employees"
[0m23:16:52.997797 [debug] [Thread-4  ]: Writing runtime sql for node "model.northwind_dbt.stg_orders"
[0m23:16:53.002362 [debug] [Thread-3  ]: Writing runtime sql for node "model.northwind_dbt.stg_order_details"
[0m23:16:53.007902 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind_dbt.stg_customers"
[0m23:16:53.031401 [debug] [Thread-3  ]: Using snowflake connection "model.northwind_dbt.stg_order_details"
[0m23:16:53.031401 [debug] [Thread-2  ]: Using snowflake connection "model.northwind_dbt.stg_employees"
[0m23:16:53.036469 [debug] [Thread-4  ]: Using snowflake connection "model.northwind_dbt.stg_orders"
[0m23:16:53.036469 [debug] [Thread-1  ]: Using snowflake connection "model.northwind_dbt.stg_customers"
[0m23:16:53.036469 [debug] [Thread-3  ]: On model.northwind_dbt.stg_order_details: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.stg_order_details"} */
create or replace   view Project_2.public.stg_order_details
  
   as (
    select * from PROJECT_2.PUBLIC.order_details
  );
[0m23:16:53.036469 [debug] [Thread-2  ]: On model.northwind_dbt.stg_employees: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.stg_employees"} */
create or replace   view Project_2.public.stg_employees
  
   as (
    select * from PROJECT_2.PUBLIC.employees
  );
[0m23:16:53.036469 [debug] [Thread-4  ]: On model.northwind_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.stg_orders"} */
create or replace   view Project_2.public.stg_orders
  
   as (
    select * from PROJECT_2.PUBLIC.orders
  );
[0m23:16:53.036469 [debug] [Thread-1  ]: On model.northwind_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.stg_customers"} */
create or replace   view Project_2.public.stg_customers
  
   as (
    select * from PROJECT_2.PUBLIC.customers
  );
[0m23:16:53.036469 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m23:16:53.036469 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m23:16:53.036469 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m23:16:53.036469 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m23:16:53.737644 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.697 seconds
[0m23:16:53.774481 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9928edc0-53f2-4b1f-a064-92a79be073a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDA85544F0>]}
[0m23:16:53.775633 [info ] [Thread-3  ]: 3 of 10 OK created sql view model public.stg_order_details ..................... [[32mSUCCESS 1[0m in 0.86s]
[0m23:16:53.778334 [debug] [Thread-3  ]: Finished running node model.northwind_dbt.stg_order_details
[0m23:16:53.778864 [debug] [Thread-3  ]: Began running node model.northwind_dbt.stg_products
[0m23:16:53.781395 [info ] [Thread-3  ]: 5 of 10 START sql view model public.stg_products ............................... [RUN]
[0m23:16:53.783146 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.northwind_dbt.stg_order_details, now model.northwind_dbt.stg_products)
[0m23:16:53.784579 [debug] [Thread-3  ]: Began compiling node model.northwind_dbt.stg_products
[0m23:16:53.790947 [debug] [Thread-3  ]: Writing injected SQL for node "model.northwind_dbt.stg_products"
[0m23:16:53.803055 [debug] [Thread-3  ]: Began executing node model.northwind_dbt.stg_products
[0m23:16:53.808223 [debug] [Thread-3  ]: Writing runtime sql for node "model.northwind_dbt.stg_products"
[0m23:16:53.823443 [debug] [Thread-3  ]: Using snowflake connection "model.northwind_dbt.stg_products"
[0m23:16:53.823443 [debug] [Thread-3  ]: On model.northwind_dbt.stg_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.stg_products"} */
create or replace   view Project_2.public.stg_products
  
   as (
    select * from PROJECT_2.PUBLIC.products
  );
[0m23:16:54.260390 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.434 seconds
[0m23:16:54.265883 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9928edc0-53f2-4b1f-a064-92a79be073a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDA8590040>]}
[0m23:16:54.267017 [info ] [Thread-3  ]: 5 of 10 OK created sql view model public.stg_products .......................... [[32mSUCCESS 1[0m in 0.48s]
[0m23:16:54.270407 [debug] [Thread-3  ]: Finished running node model.northwind_dbt.stg_products
[0m23:16:54.272608 [debug] [Thread-3  ]: Began running node model.northwind_dbt.dim_products
[0m23:16:54.273166 [info ] [Thread-3  ]: 6 of 10 START sql table model public.dim_products .............................. [RUN]
[0m23:16:54.277305 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.234 seconds
[0m23:16:54.278914 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.northwind_dbt.stg_products, now model.northwind_dbt.dim_products)
[0m23:16:54.285217 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9928edc0-53f2-4b1f-a064-92a79be073a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDA8575550>]}
[0m23:16:54.285217 [debug] [Thread-3  ]: Began compiling node model.northwind_dbt.dim_products
[0m23:16:54.285217 [info ] [Thread-1  ]: 1 of 10 OK created sql view model public.stg_customers ......................... [[32mSUCCESS 1[0m in 1.37s]
[0m23:16:54.297678 [debug] [Thread-3  ]: Writing injected SQL for node "model.northwind_dbt.dim_products"
[0m23:16:54.300468 [debug] [Thread-1  ]: Finished running node model.northwind_dbt.stg_customers
[0m23:16:54.303268 [debug] [Thread-1  ]: Began running node model.northwind_dbt.dim_customers
[0m23:16:54.304964 [info ] [Thread-1  ]: 7 of 10 START sql table model public.dim_customers ............................. [RUN]
[0m23:16:54.307243 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.northwind_dbt.stg_customers, now model.northwind_dbt.dim_customers)
[0m23:16:54.308362 [debug] [Thread-1  ]: Began compiling node model.northwind_dbt.dim_customers
[0m23:16:54.320913 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind_dbt.dim_customers"
[0m23:16:54.323771 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1.281 seconds
[0m23:16:54.326014 [debug] [Thread-3  ]: Began executing node model.northwind_dbt.dim_products
[0m23:16:54.330932 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9928edc0-53f2-4b1f-a064-92a79be073a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDA860A6D0>]}
[0m23:16:54.354950 [debug] [Thread-1  ]: Began executing node model.northwind_dbt.dim_customers
[0m23:16:54.368191 [debug] [Thread-3  ]: Writing runtime sql for node "model.northwind_dbt.dim_products"
[0m23:16:54.376617 [info ] [Thread-4  ]: 4 of 10 OK created sql view model public.stg_orders ............................ [[32mSUCCESS 1[0m in 1.42s]
[0m23:16:54.384372 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind_dbt.dim_customers"
[0m23:16:54.388167 [debug] [Thread-4  ]: Finished running node model.northwind_dbt.stg_orders
[0m23:16:54.390724 [debug] [Thread-4  ]: Began running node model.northwind_dbt.fact_order_details
[0m23:16:54.392377 [info ] [Thread-4  ]: 8 of 10 START sql incremental model public.fact_order_details .................. [RUN]
[0m23:16:54.395050 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.northwind_dbt.stg_orders, now model.northwind_dbt.fact_order_details)
[0m23:16:54.396750 [debug] [Thread-4  ]: Began compiling node model.northwind_dbt.fact_order_details
[0m23:16:54.412934 [debug] [Thread-4  ]: Writing injected SQL for node "model.northwind_dbt.fact_order_details"
[0m23:16:54.414572 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.375 seconds
[0m23:16:54.419126 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9928edc0-53f2-4b1f-a064-92a79be073a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDA85F6FD0>]}
[0m23:16:54.419126 [debug] [Thread-1  ]: Using snowflake connection "model.northwind_dbt.dim_customers"
[0m23:16:54.422878 [debug] [Thread-3  ]: Using snowflake connection "model.northwind_dbt.dim_products"
[0m23:16:54.424048 [info ] [Thread-2  ]: 2 of 10 OK created sql view model public.stg_employees ......................... [[32mSUCCESS 1[0m in 1.51s]
[0m23:16:54.426670 [debug] [Thread-1  ]: On model.northwind_dbt.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.dim_customers"} */
create or replace transient table Project_2.public.dim_customers
         as
        (select * from Project_2.public.stg_customers
        );
[0m23:16:54.428685 [debug] [Thread-4  ]: Began executing node model.northwind_dbt.fact_order_details
[0m23:16:54.429689 [debug] [Thread-3  ]: On model.northwind_dbt.dim_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.dim_products"} */
create or replace transient table Project_2.public.dim_products
         as
        (select 
    p.product_id,
    p.product_name,
    p.supplier_id,
    s.company_name as supplier_name,
    p.category_id,
    c.category_name,
    p.quantity_per_unit,
    p.unit_price,
    p.units_in_stock,
    p.units_on_order,
    p.reorder_level,
    p.discontinued
from Project_2.public.stg_products p
left join PROJECT_2.PUBLIC.suppliers s on p.supplier_id = s.supplier_id
left join PROJECT_2.PUBLIC.categories c on p.category_id = c.category_id
        );
[0m23:16:54.429689 [debug] [Thread-2  ]: Finished running node model.northwind_dbt.stg_employees
[0m23:16:54.485880 [debug] [Thread-4  ]: Using snowflake connection "model.northwind_dbt.fact_order_details"
[0m23:16:54.485880 [debug] [Thread-2  ]: Began running node model.northwind_dbt.dim_employees
[0m23:16:54.485880 [debug] [Thread-4  ]: On model.northwind_dbt.fact_order_details: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.fact_order_details"} */
create or replace  temporary view Project_2.public.fact_order_details__dbt_tmp
  
   as (
    

with base as (
    select 
        od.order_id,
        od.product_id,
        o.customer_id,
        o.employee_id,
        o.ship_via as shipper_id,
        o.order_date,
        od.unit_price,
        od.quantity,
        od.discount,
        od.unit_price * od.quantity * (1 - od.discount) as revenue
    from Project_2.public.stg_order_details od
    join Project_2.public.stg_orders o on od.order_id = o.order_id
    
        and o.order_date >= (select max(order_date) from Project_2.public.fact_order_details)
    
),
aggregated as (
    select 
        order_id,
        product_id,
        customer_id,
        employee_id,
        shipper_id,
        cast(order_date as date) as order_date,
        sum(revenue) as total_revenue,
        avg(revenue) as avg_revenue,
        max(revenue) as max_revenue,
        min(revenue) as min_revenue,
        count(*) as line_count,
        rank() over (partition by customer_id order by sum(revenue) desc) as revenue_rank
    from base
    group by order_id, product_id, customer_id, employee_id, shipper_id, order_date
)
select * from aggregated
  );
[0m23:16:54.495495 [info ] [Thread-2  ]: 9 of 10 START sql incremental model public.dim_employees ....................... [RUN]
[0m23:16:54.501499 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.northwind_dbt.stg_employees, now model.northwind_dbt.dim_employees)
[0m23:16:54.503494 [debug] [Thread-2  ]: Began compiling node model.northwind_dbt.dim_employees
[0m23:16:54.524749 [debug] [Thread-2  ]: Writing injected SQL for node "model.northwind_dbt.dim_employees"
[0m23:16:54.542396 [debug] [Thread-2  ]: Began executing node model.northwind_dbt.dim_employees
[0m23:16:54.550364 [debug] [Thread-2  ]: Using snowflake connection "model.northwind_dbt.dim_employees"
[0m23:16:54.550988 [debug] [Thread-2  ]: On model.northwind_dbt.dim_employees: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.dim_employees"} */
create or replace  temporary view Project_2.public.dim_employees__dbt_tmp
  
   as (
    

with source_data as (
    select * from Project_2.public.stg_employees
),
scd2 as (
    select 
        md5(cast(coalesce(cast(employee_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as employee_key,
        *,
        current_timestamp as dbt_updated_at
    from source_data
)
select * from scd2
  );
[0m23:16:54.895909 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.396 seconds
[0m23:16:54.895909 [debug] [Thread-4  ]: Using snowflake connection "model.northwind_dbt.fact_order_details"
[0m23:16:54.895909 [debug] [Thread-4  ]: On model.northwind_dbt.fact_order_details: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.fact_order_details"} */
describe table Project_2.public.fact_order_details__dbt_tmp
[0m23:16:54.990391 [debug] [Thread-4  ]: SQL status: SUCCESS 12 in 0.098 seconds
[0m23:16:55.006146 [debug] [Thread-4  ]: Using snowflake connection "model.northwind_dbt.fact_order_details"
[0m23:16:55.006146 [debug] [Thread-4  ]: On model.northwind_dbt.fact_order_details: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.fact_order_details"} */
describe table Project_2.public.fact_order_details
[0m23:16:55.069572 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.525 seconds
[0m23:16:55.069572 [debug] [Thread-2  ]: Using snowflake connection "model.northwind_dbt.dim_employees"
[0m23:16:55.069572 [debug] [Thread-2  ]: On model.northwind_dbt.dim_employees: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.dim_employees"} */
describe table Project_2.public.dim_employees__dbt_tmp
[0m23:16:55.141052 [debug] [Thread-4  ]: SQL status: SUCCESS 12 in 0.140 seconds
[0m23:16:55.141052 [debug] [Thread-4  ]: Using snowflake connection "model.northwind_dbt.fact_order_details"
[0m23:16:55.141052 [debug] [Thread-4  ]: On model.northwind_dbt.fact_order_details: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.fact_order_details"} */
describe table "PROJECT_2"."PUBLIC"."FACT_ORDER_DETAILS"
[0m23:16:55.204397 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.778 seconds
[0m23:16:55.204397 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9928edc0-53f2-4b1f-a064-92a79be073a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDA96B7C40>]}
[0m23:16:55.204397 [info ] [Thread-1  ]: 7 of 10 OK created sql table model public.dim_customers ........................ [[32mSUCCESS 1[0m in 0.90s]
[0m23:16:55.204397 [debug] [Thread-1  ]: Finished running node model.northwind_dbt.dim_customers
[0m23:16:55.237922 [debug] [Thread-4  ]: SQL status: SUCCESS 12 in 0.081 seconds
[0m23:16:55.267827 [debug] [Thread-4  ]: Writing runtime sql for node "model.northwind_dbt.fact_order_details"
[0m23:16:55.268827 [debug] [Thread-2  ]: SQL status: SUCCESS 24 in 0.186 seconds
[0m23:16:55.274837 [debug] [Thread-2  ]: Using snowflake connection "model.northwind_dbt.dim_employees"
[0m23:16:55.275670 [debug] [Thread-2  ]: On model.northwind_dbt.dim_employees: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.dim_employees"} */
describe table Project_2.public.dim_employees
[0m23:16:55.281110 [debug] [Thread-4  ]: Using snowflake connection "model.northwind_dbt.fact_order_details"
[0m23:16:55.281701 [debug] [Thread-4  ]: On model.northwind_dbt.fact_order_details: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.fact_order_details"} */
-- back compat for old kwarg name
  
  begin;
[0m23:16:55.340344 [debug] [Thread-2  ]: SQL status: SUCCESS 24 in 0.075 seconds
[0m23:16:55.355328 [debug] [Thread-2  ]: Using snowflake connection "model.northwind_dbt.dim_employees"
[0m23:16:55.355328 [debug] [Thread-2  ]: On model.northwind_dbt.dim_employees: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.dim_employees"} */
describe table "PROJECT_2"."PUBLIC"."DIM_EMPLOYEES"
[0m23:16:55.372537 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.091 seconds
[0m23:16:55.372537 [debug] [Thread-4  ]: Using snowflake connection "model.northwind_dbt.fact_order_details"
[0m23:16:55.372537 [debug] [Thread-4  ]: On model.northwind_dbt.fact_order_details: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.fact_order_details"} */
merge into Project_2.public.fact_order_details as DBT_INTERNAL_DEST
        using Project_2.public.fact_order_details__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.order_id = DBT_INTERNAL_DEST.order_id
                ) and (
                    DBT_INTERNAL_SOURCE.product_id = DBT_INTERNAL_DEST.product_id
                )

    
    when matched then update set
        "ORDER_ID" = DBT_INTERNAL_SOURCE."ORDER_ID","PRODUCT_ID" = DBT_INTERNAL_SOURCE."PRODUCT_ID","CUSTOMER_ID" = DBT_INTERNAL_SOURCE."CUSTOMER_ID","EMPLOYEE_ID" = DBT_INTERNAL_SOURCE."EMPLOYEE_ID","SHIPPER_ID" = DBT_INTERNAL_SOURCE."SHIPPER_ID","ORDER_DATE" = DBT_INTERNAL_SOURCE."ORDER_DATE","TOTAL_REVENUE" = DBT_INTERNAL_SOURCE."TOTAL_REVENUE","AVG_REVENUE" = DBT_INTERNAL_SOURCE."AVG_REVENUE","MAX_REVENUE" = DBT_INTERNAL_SOURCE."MAX_REVENUE","MIN_REVENUE" = DBT_INTERNAL_SOURCE."MIN_REVENUE","LINE_COUNT" = DBT_INTERNAL_SOURCE."LINE_COUNT","REVENUE_RANK" = DBT_INTERNAL_SOURCE."REVENUE_RANK"
    

    when not matched then insert
        ("ORDER_ID", "PRODUCT_ID", "CUSTOMER_ID", "EMPLOYEE_ID", "SHIPPER_ID", "ORDER_DATE", "TOTAL_REVENUE", "AVG_REVENUE", "MAX_REVENUE", "MIN_REVENUE", "LINE_COUNT", "REVENUE_RANK")
    values
        ("ORDER_ID", "PRODUCT_ID", "CUSTOMER_ID", "EMPLOYEE_ID", "SHIPPER_ID", "ORDER_DATE", "TOTAL_REVENUE", "AVG_REVENUE", "MAX_REVENUE", "MIN_REVENUE", "LINE_COUNT", "REVENUE_RANK")

;
[0m23:16:55.421391 [debug] [Thread-2  ]: SQL status: SUCCESS 24 in 0.070 seconds
[0m23:16:55.436340 [debug] [Thread-2  ]: Writing runtime sql for node "model.northwind_dbt.dim_employees"
[0m23:16:55.436340 [debug] [Thread-2  ]: Using snowflake connection "model.northwind_dbt.dim_employees"
[0m23:16:55.436340 [debug] [Thread-2  ]: On model.northwind_dbt.dim_employees: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.dim_employees"} */
-- back compat for old kwarg name
  
  begin;
[0m23:16:55.617721 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.168 seconds
[0m23:16:55.618296 [debug] [Thread-2  ]: Using snowflake connection "model.northwind_dbt.dim_employees"
[0m23:16:55.619435 [debug] [Thread-2  ]: On model.northwind_dbt.dim_employees: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.dim_employees"} */
merge into Project_2.public.dim_employees as DBT_INTERNAL_DEST
        using Project_2.public.dim_employees__dbt_tmp as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.employee_key = DBT_INTERNAL_DEST.employee_key))

    
    when matched then update set
        "EMPLOYEE_KEY" = DBT_INTERNAL_SOURCE."EMPLOYEE_KEY","_AIRBYTE_RAW_ID" = DBT_INTERNAL_SOURCE."_AIRBYTE_RAW_ID","_AIRBYTE_EXTRACTED_AT" = DBT_INTERNAL_SOURCE."_AIRBYTE_EXTRACTED_AT","_AIRBYTE_META" = DBT_INTERNAL_SOURCE."_AIRBYTE_META","_AIRBYTE_GENERATION_ID" = DBT_INTERNAL_SOURCE."_AIRBYTE_GENERATION_ID","CITY" = DBT_INTERNAL_SOURCE."CITY","NOTES" = DBT_INTERNAL_SOURCE."NOTES","PHOTO" = DBT_INTERNAL_SOURCE."PHOTO","TITLE" = DBT_INTERNAL_SOURCE."TITLE","REGION" = DBT_INTERNAL_SOURCE."REGION","ADDRESS" = DBT_INTERNAL_SOURCE."ADDRESS","COUNTRY" = DBT_INTERNAL_SOURCE."COUNTRY","EXTENSION" = DBT_INTERNAL_SOURCE."EXTENSION","HIRE_DATE" = DBT_INTERNAL_SOURCE."HIRE_DATE","LAST_NAME" = DBT_INTERNAL_SOURCE."LAST_NAME","BIRTH_DATE" = DBT_INTERNAL_SOURCE."BIRTH_DATE","FIRST_NAME" = DBT_INTERNAL_SOURCE."FIRST_NAME","HOME_PHONE" = DBT_INTERNAL_SOURCE."HOME_PHONE","PHOTO_PATH" = DBT_INTERNAL_SOURCE."PHOTO_PATH","REPORTS_TO" = DBT_INTERNAL_SOURCE."REPORTS_TO","EMPLOYEE_ID" = DBT_INTERNAL_SOURCE."EMPLOYEE_ID","POSTAL_CODE" = DBT_INTERNAL_SOURCE."POSTAL_CODE","TITLE_OF_COURTESY" = DBT_INTERNAL_SOURCE."TITLE_OF_COURTESY","DBT_UPDATED_AT" = DBT_INTERNAL_SOURCE."DBT_UPDATED_AT"
    

    when not matched then insert
        ("EMPLOYEE_KEY", "_AIRBYTE_RAW_ID", "_AIRBYTE_EXTRACTED_AT", "_AIRBYTE_META", "_AIRBYTE_GENERATION_ID", "CITY", "NOTES", "PHOTO", "TITLE", "REGION", "ADDRESS", "COUNTRY", "EXTENSION", "HIRE_DATE", "LAST_NAME", "BIRTH_DATE", "FIRST_NAME", "HOME_PHONE", "PHOTO_PATH", "REPORTS_TO", "EMPLOYEE_ID", "POSTAL_CODE", "TITLE_OF_COURTESY", "DBT_UPDATED_AT")
    values
        ("EMPLOYEE_KEY", "_AIRBYTE_RAW_ID", "_AIRBYTE_EXTRACTED_AT", "_AIRBYTE_META", "_AIRBYTE_GENERATION_ID", "CITY", "NOTES", "PHOTO", "TITLE", "REGION", "ADDRESS", "COUNTRY", "EXTENSION", "HIRE_DATE", "LAST_NAME", "BIRTH_DATE", "FIRST_NAME", "HOME_PHONE", "PHOTO_PATH", "REPORTS_TO", "EMPLOYEE_ID", "POSTAL_CODE", "TITLE_OF_COURTESY", "DBT_UPDATED_AT")

;
[0m23:16:55.860196 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1.386 seconds
[0m23:16:55.860196 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9928edc0-53f2-4b1f-a064-92a79be073a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD8CC616D0>]}
[0m23:16:55.860196 [info ] [Thread-3  ]: 6 of 10 OK created sql table model public.dim_products ......................... [[32mSUCCESS 1[0m in 1.58s]
[0m23:16:55.860196 [debug] [Thread-3  ]: Finished running node model.northwind_dbt.dim_products
[0m23:16:56.184327 [debug] [Thread-4  ]: SQL status: SUCCESS 32 in 0.810 seconds
[0m23:16:56.186353 [debug] [Thread-4  ]: Using snowflake connection "model.northwind_dbt.fact_order_details"
[0m23:16:56.188874 [debug] [Thread-4  ]: On model.northwind_dbt.fact_order_details: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.fact_order_details"} */
COMMIT
[0m23:16:56.510858 [debug] [Thread-2  ]: SQL status: SUCCESS 9 in 0.895 seconds
[0m23:16:56.510858 [debug] [Thread-2  ]: Using snowflake connection "model.northwind_dbt.dim_employees"
[0m23:16:56.510858 [debug] [Thread-2  ]: On model.northwind_dbt.dim_employees: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.dim_employees"} */
COMMIT
[0m23:16:56.542719 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.360 seconds
[0m23:16:56.567505 [debug] [Thread-4  ]: Applying DROP to: Project_2.public.fact_order_details__dbt_tmp
[0m23:16:56.573040 [debug] [Thread-4  ]: Using snowflake connection "model.northwind_dbt.fact_order_details"
[0m23:16:56.573040 [debug] [Thread-4  ]: On model.northwind_dbt.fact_order_details: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.fact_order_details"} */
drop view if exists Project_2.public.fact_order_details__dbt_tmp cascade
[0m23:16:56.715803 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.146 seconds
[0m23:16:56.715803 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9928edc0-53f2-4b1f-a064-92a79be073a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDA8675C40>]}
[0m23:16:56.715803 [info ] [Thread-4  ]: 8 of 10 OK created sql incremental model public.fact_order_details ............. [[32mSUCCESS 32[0m in 2.32s]
[0m23:16:56.715803 [debug] [Thread-4  ]: Finished running node model.northwind_dbt.fact_order_details
[0m23:16:56.816280 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.300 seconds
[0m23:16:56.824594 [debug] [Thread-2  ]: Applying DROP to: Project_2.public.dim_employees__dbt_tmp
[0m23:16:56.824594 [debug] [Thread-2  ]: Using snowflake connection "model.northwind_dbt.dim_employees"
[0m23:16:56.824594 [debug] [Thread-2  ]: On model.northwind_dbt.dim_employees: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.dim_employees"} */
drop view if exists Project_2.public.dim_employees__dbt_tmp cascade
[0m23:16:56.976919 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.155 seconds
[0m23:16:56.976919 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9928edc0-53f2-4b1f-a064-92a79be073a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDA9732220>]}
[0m23:16:56.976919 [info ] [Thread-2  ]: 9 of 10 OK created sql incremental model public.dim_employees .................. [[32mSUCCESS 9[0m in 2.48s]
[0m23:16:56.976919 [debug] [Thread-2  ]: Finished running node model.northwind_dbt.dim_employees
[0m23:16:56.976919 [debug] [Thread-1  ]: Began running node model.northwind_dbt.obt_orders
[0m23:16:56.976919 [info ] [Thread-1  ]: 10 of 10 START sql table model public.obt_orders ............................... [RUN]
[0m23:16:56.991475 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.northwind_dbt.dim_customers, now model.northwind_dbt.obt_orders)
[0m23:16:56.991475 [debug] [Thread-1  ]: Began compiling node model.northwind_dbt.obt_orders
[0m23:16:56.996308 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind_dbt.obt_orders"
[0m23:16:57.000478 [debug] [Thread-1  ]: Began executing node model.northwind_dbt.obt_orders
[0m23:16:57.000478 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind_dbt.obt_orders"
[0m23:16:57.025129 [debug] [Thread-1  ]: Using snowflake connection "model.northwind_dbt.obt_orders"
[0m23:16:57.025129 [debug] [Thread-1  ]: On model.northwind_dbt.obt_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.obt_orders"} */
create or replace transient table Project_2.public.obt_orders
         as
        (

select 
    f.order_id,
    f.product_id,
    f.customer_id,
    f.employee_id,
    f.shipper_id,
    f.order_date,
    f.total_revenue,
    f.avg_revenue,
    f.max_revenue,
    f.min_revenue,
    f.line_count,
    f.revenue_rank,

    c.company_name as customer_name,
    p.product_name,
    p.category_name,
    p.supplier_name,
    e.first_name || ' ' || e.last_name as employee_name,
    s.company_name as shipper_name

from Project_2.public.fact_order_details f
left join Project_2.public.dim_customers c on f.customer_id = c.customer_id
left join Project_2.public.dim_products p on f.product_id = p.product_id
left join Project_2.public.dim_employees e on f.employee_id = e.employee_id
left join PROJECT_2.PUBLIC.shippers s on f.shipper_id = s.shipper_id
        );
[0m23:16:58.367644 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.345 seconds
[0m23:16:58.375222 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9928edc0-53f2-4b1f-a064-92a79be073a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDA979DB50>]}
[0m23:16:58.375222 [info ] [Thread-1  ]: 10 of 10 OK created sql table model public.obt_orders .......................... [[32mSUCCESS 1[0m in 1.38s]
[0m23:16:58.375222 [debug] [Thread-1  ]: Finished running node model.northwind_dbt.obt_orders
[0m23:16:58.375222 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:16:58.375222 [debug] [MainThread]: Connection 'list_Project_2' was left open.
[0m23:16:58.375222 [debug] [MainThread]: On list_Project_2: Close
[0m23:16:58.514878 [debug] [MainThread]: Connection 'list_Project_2_public' was left open.
[0m23:16:58.515877 [debug] [MainThread]: On list_Project_2_public: Close
[0m23:16:58.635897 [debug] [MainThread]: Connection 'model.northwind_dbt.obt_orders' was left open.
[0m23:16:58.636934 [debug] [MainThread]: On model.northwind_dbt.obt_orders: Close
[0m23:16:58.749620 [debug] [MainThread]: Connection 'model.northwind_dbt.dim_employees' was left open.
[0m23:16:58.749620 [debug] [MainThread]: On model.northwind_dbt.dim_employees: Close
[0m23:16:58.874237 [debug] [MainThread]: Connection 'model.northwind_dbt.dim_products' was left open.
[0m23:16:58.876744 [debug] [MainThread]: On model.northwind_dbt.dim_products: Close
[0m23:16:59.009784 [debug] [MainThread]: Connection 'model.northwind_dbt.fact_order_details' was left open.
[0m23:16:59.011828 [debug] [MainThread]: On model.northwind_dbt.fact_order_details: Close
[0m23:16:59.140130 [info ] [MainThread]: 
[0m23:16:59.141742 [info ] [MainThread]: Finished running 2 incremental models, 3 table models, 5 view models in 0 hours 0 minutes and 7.55 seconds (7.55s).
[0m23:16:59.145180 [debug] [MainThread]: Command end result
[0m23:16:59.388519 [debug] [MainThread]: Wrote artifact WritableManifest to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\manifest.json
[0m23:16:59.395147 [debug] [MainThread]: Wrote artifact SemanticManifest to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\semantic_manifest.json
[0m23:16:59.413606 [debug] [MainThread]: Wrote artifact RunExecutionResult to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\run_results.json
[0m23:16:59.415285 [info ] [MainThread]: 
[0m23:16:59.416848 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:16:59.418854 [info ] [MainThread]: 
[0m23:16:59.420485 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m23:16:59.424014 [debug] [MainThread]: Command `dbt run` succeeded at 23:16:59.424014 after 9.99 seconds
[0m23:16:59.425514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD8CD6F2E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDA7F48A60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDA7F48A00>]}
[0m23:16:59.427175 [debug] [MainThread]: Flushing usage events
[0m23:17:00.314147 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:19:48.053875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002239027F370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223922D1550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223922D1370>]}


============================== 23:19:48.060786 | 0735a1ca-7bce-4a0b-99fe-277a30cde624 ==============================
[0m23:19:48.060786 [info ] [MainThread]: Running with dbt=1.9.0
[0m23:19:48.063147 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'c:\\Users\\fitzp\\Documents\\Alpaca_Market\\zproject_2\\northwind_psql', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'c:\\Users\\fitzp\\Documents\\Alpaca_Market\\zproject_2\\northwind_psql\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt docs generate', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:19:49.394565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0735a1ca-7bce-4a0b-99fe-277a30cde624', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223915B02E0>]}
[0m23:19:49.524045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0735a1ca-7bce-4a0b-99fe-277a30cde624', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223AADAFFD0>]}
[0m23:19:49.526245 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m23:19:50.021572 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m23:19:50.425723 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:19:50.436938 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:19:50.442444 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.northwind_dbt.marts.bi
[0m23:19:50.470988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0735a1ca-7bce-4a0b-99fe-277a30cde624', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223AB3B1FA0>]}
[0m23:19:50.556528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0735a1ca-7bce-4a0b-99fe-277a30cde624', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223AADEA550>]}
[0m23:19:50.557411 [info ] [MainThread]: Found 10 models, 8 sources, 706 macros
[0m23:19:50.558406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0735a1ca-7bce-4a0b-99fe-277a30cde624', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223AADEAD30>]}
[0m23:19:50.560406 [info ] [MainThread]: 
[0m23:19:50.561390 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:19:50.562392 [info ] [MainThread]: 
[0m23:19:50.562392 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:19:50.566093 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_Project_2_public'
[0m23:19:50.662717 [debug] [ThreadPool]: Using snowflake connection "list_Project_2_public"
[0m23:19:50.662717 [debug] [ThreadPool]: On list_Project_2_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "connection_name": "list_Project_2_public"} */
show objects in Project_2.public limit 10000;
[0m23:19:50.662717 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:19:51.319988 [debug] [ThreadPool]: SQL status: SUCCESS 24 in 0.655 seconds
[0m23:19:51.326263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0735a1ca-7bce-4a0b-99fe-277a30cde624', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223AAD9AFA0>]}
[0m23:19:51.332377 [debug] [Thread-1  ]: Began running node model.northwind_dbt.stg_customers
[0m23:19:51.332377 [debug] [Thread-2  ]: Began running node model.northwind_dbt.stg_employees
[0m23:19:51.332377 [debug] [Thread-3  ]: Began running node model.northwind_dbt.stg_order_details
[0m23:19:51.332377 [debug] [Thread-4  ]: Began running node model.northwind_dbt.stg_orders
[0m23:19:51.332377 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.northwind_dbt.stg_customers'
[0m23:19:51.332377 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.northwind_dbt.stg_employees'
[0m23:19:51.332377 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.northwind_dbt.stg_order_details'
[0m23:19:51.332377 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.northwind_dbt.stg_orders'
[0m23:19:51.332377 [debug] [Thread-1  ]: Began compiling node model.northwind_dbt.stg_customers
[0m23:19:51.338123 [debug] [Thread-2  ]: Began compiling node model.northwind_dbt.stg_employees
[0m23:19:51.338123 [debug] [Thread-3  ]: Began compiling node model.northwind_dbt.stg_order_details
[0m23:19:51.338123 [debug] [Thread-4  ]: Began compiling node model.northwind_dbt.stg_orders
[0m23:19:51.338123 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind_dbt.stg_customers"
[0m23:19:51.349295 [debug] [Thread-2  ]: Writing injected SQL for node "model.northwind_dbt.stg_employees"
[0m23:19:51.353319 [debug] [Thread-3  ]: Writing injected SQL for node "model.northwind_dbt.stg_order_details"
[0m23:19:51.357349 [debug] [Thread-4  ]: Writing injected SQL for node "model.northwind_dbt.stg_orders"
[0m23:19:51.380876 [debug] [Thread-4  ]: Began executing node model.northwind_dbt.stg_orders
[0m23:19:51.380876 [debug] [Thread-2  ]: Began executing node model.northwind_dbt.stg_employees
[0m23:19:51.380876 [debug] [Thread-1  ]: Began executing node model.northwind_dbt.stg_customers
[0m23:19:51.380876 [debug] [Thread-4  ]: Finished running node model.northwind_dbt.stg_orders
[0m23:19:51.380876 [debug] [Thread-2  ]: Finished running node model.northwind_dbt.stg_employees
[0m23:19:51.380876 [debug] [Thread-1  ]: Finished running node model.northwind_dbt.stg_customers
[0m23:19:51.380876 [debug] [Thread-4  ]: Began running node model.northwind_dbt.stg_products
[0m23:19:51.380876 [debug] [Thread-3  ]: Began executing node model.northwind_dbt.stg_order_details
[0m23:19:51.380876 [debug] [Thread-2  ]: Began running node model.northwind_dbt.dim_employees
[0m23:19:51.380876 [debug] [Thread-1  ]: Began running node model.northwind_dbt.dim_customers
[0m23:19:51.380876 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.northwind_dbt.stg_orders, now model.northwind_dbt.stg_products)
[0m23:19:51.392574 [debug] [Thread-3  ]: Finished running node model.northwind_dbt.stg_order_details
[0m23:19:51.392574 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.northwind_dbt.stg_employees, now model.northwind_dbt.dim_employees)
[0m23:19:51.392574 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.northwind_dbt.stg_customers, now model.northwind_dbt.dim_customers)
[0m23:19:51.392574 [debug] [Thread-4  ]: Began compiling node model.northwind_dbt.stg_products
[0m23:19:51.392574 [debug] [Thread-3  ]: Began running node model.northwind_dbt.fact_order_details
[0m23:19:51.392574 [debug] [Thread-2  ]: Began compiling node model.northwind_dbt.dim_employees
[0m23:19:51.392574 [debug] [Thread-1  ]: Began compiling node model.northwind_dbt.dim_customers
[0m23:19:51.392574 [debug] [Thread-4  ]: Writing injected SQL for node "model.northwind_dbt.stg_products"
[0m23:19:51.392574 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.northwind_dbt.stg_order_details, now model.northwind_dbt.fact_order_details)
[0m23:19:51.408504 [debug] [Thread-2  ]: Writing injected SQL for node "model.northwind_dbt.dim_employees"
[0m23:19:51.408504 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind_dbt.dim_customers"
[0m23:19:51.422759 [debug] [Thread-3  ]: Began compiling node model.northwind_dbt.fact_order_details
[0m23:19:51.434504 [debug] [Thread-3  ]: Writing injected SQL for node "model.northwind_dbt.fact_order_details"
[0m23:19:51.442301 [debug] [Thread-1  ]: Began executing node model.northwind_dbt.dim_customers
[0m23:19:51.442816 [debug] [Thread-4  ]: Began executing node model.northwind_dbt.stg_products
[0m23:19:51.442816 [debug] [Thread-2  ]: Began executing node model.northwind_dbt.dim_employees
[0m23:19:51.442816 [debug] [Thread-3  ]: Began executing node model.northwind_dbt.fact_order_details
[0m23:19:51.442816 [debug] [Thread-1  ]: Finished running node model.northwind_dbt.dim_customers
[0m23:19:51.442816 [debug] [Thread-4  ]: Finished running node model.northwind_dbt.stg_products
[0m23:19:51.442816 [debug] [Thread-2  ]: Finished running node model.northwind_dbt.dim_employees
[0m23:19:51.442816 [debug] [Thread-3  ]: Finished running node model.northwind_dbt.fact_order_details
[0m23:19:51.442816 [debug] [Thread-1  ]: Began running node model.northwind_dbt.dim_products
[0m23:19:51.442816 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.northwind_dbt.dim_customers, now model.northwind_dbt.dim_products)
[0m23:19:51.442816 [debug] [Thread-1  ]: Began compiling node model.northwind_dbt.dim_products
[0m23:19:51.453098 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind_dbt.dim_products"
[0m23:19:51.462743 [debug] [Thread-1  ]: Began executing node model.northwind_dbt.dim_products
[0m23:19:51.462743 [debug] [Thread-1  ]: Finished running node model.northwind_dbt.dim_products
[0m23:19:51.462743 [debug] [Thread-4  ]: Began running node model.northwind_dbt.obt_orders
[0m23:19:51.462743 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.northwind_dbt.stg_products, now model.northwind_dbt.obt_orders)
[0m23:19:51.462743 [debug] [Thread-4  ]: Began compiling node model.northwind_dbt.obt_orders
[0m23:19:51.462743 [debug] [Thread-4  ]: Writing injected SQL for node "model.northwind_dbt.obt_orders"
[0m23:19:51.482620 [debug] [Thread-4  ]: Began executing node model.northwind_dbt.obt_orders
[0m23:19:51.484634 [debug] [Thread-4  ]: Finished running node model.northwind_dbt.obt_orders
[0m23:19:51.484634 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:19:51.486646 [debug] [MainThread]: Connection 'list_Project_2_public' was left open.
[0m23:19:51.486646 [debug] [MainThread]: On list_Project_2_public: Close
[0m23:19:51.605899 [debug] [MainThread]: Connection 'model.northwind_dbt.dim_products' was properly closed.
[0m23:19:51.605899 [debug] [MainThread]: Connection 'model.northwind_dbt.dim_employees' was properly closed.
[0m23:19:51.605899 [debug] [MainThread]: Connection 'model.northwind_dbt.fact_order_details' was properly closed.
[0m23:19:51.605899 [debug] [MainThread]: Connection 'model.northwind_dbt.obt_orders' was properly closed.
[0m23:19:51.605899 [debug] [MainThread]: Command end result
[0m23:19:51.879537 [debug] [MainThread]: Wrote artifact WritableManifest to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\manifest.json
[0m23:19:51.881422 [debug] [MainThread]: Wrote artifact SemanticManifest to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\semantic_manifest.json
[0m23:19:51.895358 [debug] [MainThread]: Wrote artifact RunExecutionResult to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\run_results.json
[0m23:19:53.411491 [debug] [MainThread]: Acquiring new snowflake connection 'generate_catalog'
[0m23:19:53.411491 [info ] [MainThread]: Building catalog
[0m23:19:53.425532 [debug] [ThreadPool]: Acquiring new snowflake connection 'PROJECT_2.information_schema'
[0m23:19:53.440253 [debug] [ThreadPool]: Acquiring new snowflake connection 'Project_2.information_schema'
[0m23:19:53.443535 [debug] [ThreadPool]: Using snowflake connection "PROJECT_2.information_schema"
[0m23:19:53.444536 [debug] [ThreadPool]: Using snowflake connection "Project_2.information_schema"
[0m23:19:53.444536 [debug] [ThreadPool]: On PROJECT_2.information_schema: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "connection_name": "PROJECT_2.information_schema"} */
with tables as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",
        case
            when is_dynamic = 'YES' and table_type = 'BASE TABLE' THEN 'DYNAMIC TABLE'
            else table_type
        end as "table_type",
        comment as "table_comment",

        -- note: this is the _role_ that owns the table
        table_owner as "table_owner",

        'Clustering Key' as "stats:clustering_key:label",
        clustering_key as "stats:clustering_key:value",
        'The key used to cluster this table' as "stats:clustering_key:description",
        (clustering_key is not null) as "stats:clustering_key:include",

        'Row Count' as "stats:row_count:label",
        row_count as "stats:row_count:value",
        'An approximate count of rows in this table' as "stats:row_count:description",
        (row_count is not null) as "stats:row_count:include",

        'Approximate Size' as "stats:bytes:label",
        bytes as "stats:bytes:value",
        'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
        (bytes is not null) as "stats:bytes:include",

        'Last Modified' as "stats:last_modified:label",
        to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
        'The timestamp for last update/change' as "stats:last_modified:description",
        (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"
    from PROJECT_2.INFORMATION_SCHEMA.tables
            where (
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'orders' and upper("table_name") = upper('orders')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'categories' and upper("table_name") = upper('categories')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'customers' and upper("table_name") = upper('customers')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'shippers' and upper("table_name") = upper('shippers')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'order_details' and upper("table_name") = upper('order_details')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'employees' and upper("table_name") = upper('employees')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'suppliers' and upper("table_name") = upper('suppliers')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'products' and upper("table_name") = upper('products')

                )
            )
        ),
        columns as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",

        column_name as "column_name",
        ordinal_position as "column_index",
        data_type as "column_type",
        comment as "column_comment"
    from PROJECT_2.INFORMATION_SCHEMA.columns
            where (
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'orders' and upper("table_name") = upper('orders')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'categories' and upper("table_name") = upper('categories')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'customers' and upper("table_name") = upper('customers')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'shippers' and upper("table_name") = upper('shippers')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'order_details' and upper("table_name") = upper('order_details')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'employees' and upper("table_name") = upper('employees')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'suppliers' and upper("table_name") = upper('suppliers')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'products' and upper("table_name") = upper('products')

                )
            )
        )
        select *
    from tables
    join columns using ("table_database", "table_schema", "table_name")
    order by "column_index"
[0m23:19:53.444536 [debug] [ThreadPool]: On Project_2.information_schema: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "connection_name": "Project_2.information_schema"} */
with tables as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",
        case
            when is_dynamic = 'YES' and table_type = 'BASE TABLE' THEN 'DYNAMIC TABLE'
            else table_type
        end as "table_type",
        comment as "table_comment",

        -- note: this is the _role_ that owns the table
        table_owner as "table_owner",

        'Clustering Key' as "stats:clustering_key:label",
        clustering_key as "stats:clustering_key:value",
        'The key used to cluster this table' as "stats:clustering_key:description",
        (clustering_key is not null) as "stats:clustering_key:include",

        'Row Count' as "stats:row_count:label",
        row_count as "stats:row_count:value",
        'An approximate count of rows in this table' as "stats:row_count:description",
        (row_count is not null) as "stats:row_count:include",

        'Approximate Size' as "stats:bytes:label",
        bytes as "stats:bytes:value",
        'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
        (bytes is not null) as "stats:bytes:include",

        'Last Modified' as "stats:last_modified:label",
        to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
        'The timestamp for last update/change' as "stats:last_modified:description",
        (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"
    from Project_2.INFORMATION_SCHEMA.tables
            where (
                (
                    
    "table_schema" ilike 'public' and upper("table_schema") = upper('public')

                    and 
    "table_name" ilike 'dim_products' and upper("table_name") = upper('dim_products')

                )
             or 
                (
                    
    "table_schema" ilike 'public' and upper("table_schema") = upper('public')

                    and 
    "table_name" ilike 'stg_employees' and upper("table_name") = upper('stg_employees')

                )
             or 
                (
                    
    "table_schema" ilike 'public' and upper("table_schema") = upper('public')

                    and 
    "table_name" ilike 'stg_orders' and upper("table_name") = upper('stg_orders')

                )
             or 
                (
                    
    "table_schema" ilike 'public' and upper("table_schema") = upper('public')

                    and 
    "table_name" ilike 'stg_customers' and upper("table_name") = upper('stg_customers')

                )
             or 
                (
                    
    "table_schema" ilike 'public' and upper("table_schema") = upper('public')

                    and 
    "table_name" ilike 'stg_order_details' and upper("table_name") = upper('stg_order_details')

                )
             or 
                (
                    
    "table_schema" ilike 'public' and upper("table_schema") = upper('public')

                    and 
    "table_name" ilike 'dim_customers' and upper("table_name") = upper('dim_customers')

                )
             or 
                (
                    
    "table_schema" ilike 'public' and upper("table_schema") = upper('public')

                    and 
    "table_name" ilike 'fact_order_details' and upper("table_name") = upper('fact_order_details')

                )
             or 
                (
                    
    "table_schema" ilike 'public' and upper("table_schema") = upper('public')

                    and 
    "table_name" ilike 'dim_employees' and upper("table_name") = upper('dim_employees')

                )
             or 
                (
                    
    "table_schema" ilike 'public' and upper("table_schema") = upper('public')

                    and 
    "table_name" ilike 'obt_orders' and upper("table_name") = upper('obt_orders')

                )
             or 
                (
                    
    "table_schema" ilike 'public' and upper("table_schema") = upper('public')

                    and 
    "table_name" ilike 'stg_products' and upper("table_name") = upper('stg_products')

                )
            )
        ),
        columns as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",

        column_name as "column_name",
        ordinal_position as "column_index",
        data_type as "column_type",
        comment as "column_comment"
    from Project_2.INFORMATION_SCHEMA.columns
            where (
                (
                    
    "table_schema" ilike 'public' and upper("table_schema") = upper('public')

                    and 
    "table_name" ilike 'dim_products' and upper("table_name") = upper('dim_products')

                )
             or 
                (
                    
    "table_schema" ilike 'public' and upper("table_schema") = upper('public')

                    and 
    "table_name" ilike 'stg_employees' and upper("table_name") = upper('stg_employees')

                )
             or 
                (
                    
    "table_schema" ilike 'public' and upper("table_schema") = upper('public')

                    and 
    "table_name" ilike 'stg_orders' and upper("table_name") = upper('stg_orders')

                )
             or 
                (
                    
    "table_schema" ilike 'public' and upper("table_schema") = upper('public')

                    and 
    "table_name" ilike 'stg_customers' and upper("table_name") = upper('stg_customers')

                )
             or 
                (
                    
    "table_schema" ilike 'public' and upper("table_schema") = upper('public')

                    and 
    "table_name" ilike 'stg_order_details' and upper("table_name") = upper('stg_order_details')

                )
             or 
                (
                    
    "table_schema" ilike 'public' and upper("table_schema") = upper('public')

                    and 
    "table_name" ilike 'dim_customers' and upper("table_name") = upper('dim_customers')

                )
             or 
                (
                    
    "table_schema" ilike 'public' and upper("table_schema") = upper('public')

                    and 
    "table_name" ilike 'fact_order_details' and upper("table_name") = upper('fact_order_details')

                )
             or 
                (
                    
    "table_schema" ilike 'public' and upper("table_schema") = upper('public')

                    and 
    "table_name" ilike 'dim_employees' and upper("table_name") = upper('dim_employees')

                )
             or 
                (
                    
    "table_schema" ilike 'public' and upper("table_schema") = upper('public')

                    and 
    "table_name" ilike 'obt_orders' and upper("table_name") = upper('obt_orders')

                )
             or 
                (
                    
    "table_schema" ilike 'public' and upper("table_schema") = upper('public')

                    and 
    "table_name" ilike 'stg_products' and upper("table_name") = upper('stg_products')

                )
            )
        )
        select *
    from tables
    join columns using ("table_database", "table_schema", "table_name")
    order by "column_index"
[0m23:19:53.444536 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:19:53.444536 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:19:56.844532 [debug] [ThreadPool]: SQL status: SUCCESS 109 in 3.396 seconds
[0m23:19:57.080997 [debug] [ThreadPool]: SQL status: SUCCESS 159 in 3.627 seconds
[0m23:19:57.181484 [debug] [MainThread]: Wrote artifact CatalogArtifact to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\catalog.json
[0m23:19:57.367842 [debug] [MainThread]: Wrote artifact WritableManifest to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\manifest.json
[0m23:19:57.383640 [debug] [MainThread]: Wrote artifact SemanticManifest to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\semantic_manifest.json
[0m23:19:57.383640 [info ] [MainThread]: Catalog written to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\catalog.json
[0m23:19:57.383640 [debug] [MainThread]: Command `dbt docs generate` succeeded at 23:19:57.383640 after 9.46 seconds
[0m23:19:57.389176 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m23:19:57.389176 [debug] [MainThread]: Connection 'PROJECT_2.information_schema' was left open.
[0m23:19:57.389176 [debug] [MainThread]: On PROJECT_2.information_schema: Close
[0m23:19:57.517955 [debug] [MainThread]: Connection 'Project_2.information_schema' was left open.
[0m23:19:57.517955 [debug] [MainThread]: On Project_2.information_schema: Close
[0m23:19:57.694049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002239027F370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223AAE521F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002238F4ECA00>]}
[0m23:19:57.698104 [debug] [MainThread]: Flushing usage events
[0m23:19:58.459973 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:20:09.998895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE44A5F370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE46ADDBB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE46ADD9A0>]}


============================== 23:20:10.002346 | 6f767c19-3e28-4130-8e51-c3f76deacb16 ==============================
[0m23:20:10.002346 [info ] [MainThread]: Running with dbt=1.9.0
[0m23:20:10.002346 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'c:\\Users\\fitzp\\Documents\\Alpaca_Market\\zproject_2\\northwind_psql\\logs', 'version_check': 'True', 'profiles_dir': 'c:\\Users\\fitzp\\Documents\\Alpaca_Market\\zproject_2\\northwind_psql', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs serve', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:20:10.906510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6f767c19-3e28-4130-8e51-c3f76deacb16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE43247550>]}
[0m23:20:10.967560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6f767c19-3e28-4130-8e51-c3f76deacb16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE469384F0>]}
[0m23:36:22.558094 [error] [MainThread]: Encountered an error:

[0m23:36:22.594879 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\fitzp\anaconda3\envs\bootcamp\lib\site-packages\dbt\cli\requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
  File "C:\Users\fitzp\anaconda3\envs\bootcamp\lib\site-packages\dbt\cli\requires.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\fitzp\anaconda3\envs\bootcamp\lib\site-packages\dbt\cli\requires.py", line 235, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\fitzp\anaconda3\envs\bootcamp\lib\site-packages\dbt\cli\requires.py", line 264, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\fitzp\anaconda3\envs\bootcamp\lib\site-packages\dbt\cli\requires.py", line 311, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\fitzp\anaconda3\envs\bootcamp\lib\site-packages\dbt\cli\main.py", line 301, in docs_serve
    results = task.run()
  File "C:\Users\fitzp\anaconda3\envs\bootcamp\lib\site-packages\dbt\task\docs\serve.py", line 29, in run
    httpd.serve_forever()
  File "C:\Users\fitzp\anaconda3\envs\bootcamp\lib\socketserver.py", line 232, in serve_forever
    ready = selector.select(poll_interval)
  File "C:\Users\fitzp\anaconda3\envs\bootcamp\lib\selectors.py", line 324, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
  File "C:\Users\fitzp\anaconda3\envs\bootcamp\lib\selectors.py", line 315, in _select
    r, w, x = select.select(r, w, w, timeout)
KeyboardInterrupt

[0m23:36:22.602949 [debug] [MainThread]: Command `dbt docs serve` failed at 23:36:22.602949 after 972.70 seconds
[0m23:36:22.602949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE44A5F370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE5F774A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE5F774AC0>]}
[0m23:36:22.602949 [debug] [MainThread]: Flushing usage events
[0m23:36:23.557660 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:36:32.224027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E702F5F3A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E704FA7BE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E704FA7700>]}


============================== 23:36:32.224027 | 634e8dc3-d232-4b97-8194-99240dbd455f ==============================
[0m23:36:32.224027 [info ] [MainThread]: Running with dbt=1.9.0
[0m23:36:32.224027 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'c:\\Users\\fitzp\\Documents\\Alpaca_Market\\zproject_2\\northwind_psql', 'log_path': 'c:\\Users\\fitzp\\Documents\\Alpaca_Market\\zproject_2\\northwind_psql\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt test', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:36:33.420836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '634e8dc3-d232-4b97-8194-99240dbd455f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E704FBA280>]}
[0m23:36:33.500361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '634e8dc3-d232-4b97-8194-99240dbd455f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7048F9370>]}
[0m23:36:33.500361 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m23:36:33.969310 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m23:36:34.577268 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 5 files changed.
[0m23:36:34.578334 [debug] [MainThread]: Partial parsing: updated file: northwind_dbt://models\marts\core\obt_orders.sql
[0m23:36:34.578889 [debug] [MainThread]: Partial parsing: updated file: northwind_dbt://models\marts\core\dim_customers.sql
[0m23:36:34.579446 [debug] [MainThread]: Partial parsing: updated file: northwind_dbt://models\marts\core\dim_employees.sql
[0m23:36:34.579446 [debug] [MainThread]: Partial parsing: updated file: northwind_dbt://snapshots\employees_snapshot.sql
[0m23:36:34.579446 [debug] [MainThread]: Partial parsing: updated file: northwind_dbt://models\marts\core\dim_products.sql
[0m23:36:35.225697 [error] [MainThread]: Encountered an error:
can not serialize 'Undefined' object
[0m23:36:35.233099 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\fitzp\anaconda3\envs\bootcamp\lib\site-packages\dbt\cli\requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
  File "C:\Users\fitzp\anaconda3\envs\bootcamp\lib\site-packages\dbt\cli\requires.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\fitzp\anaconda3\envs\bootcamp\lib\site-packages\dbt\cli\requires.py", line 235, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\fitzp\anaconda3\envs\bootcamp\lib\site-packages\dbt\cli\requires.py", line 264, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\fitzp\anaconda3\envs\bootcamp\lib\site-packages\dbt\cli\requires.py", line 311, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\fitzp\anaconda3\envs\bootcamp\lib\site-packages\dbt\cli\requires.py", line 327, in wrapper
    setup_manifest(ctx, write=write, write_perf_info=write_perf_info)
  File "C:\Users\fitzp\anaconda3\envs\bootcamp\lib\site-packages\dbt\cli\requires.py", line 351, in setup_manifest
    ctx.obj["manifest"] = parse_manifest(
  File "C:\Users\fitzp\anaconda3\envs\bootcamp\lib\site-packages\dbt\parser\manifest.py", line 2037, in parse_manifest
    manifest = ManifestLoader.get_full_manifest(
  File "C:\Users\fitzp\anaconda3\envs\bootcamp\lib\site-packages\dbt\parser\manifest.py", line 310, in get_full_manifest
    manifest = loader.load()
  File "C:\Users\fitzp\anaconda3\envs\bootcamp\lib\site-packages\dbt\parser\manifest.py", line 508, in load
    self.write_manifest_for_partial_parse()
  File "C:\Users\fitzp\anaconda3\envs\bootcamp\lib\site-packages\dbt\parser\manifest.py", line 814, in write_manifest_for_partial_parse
    manifest_msgpack = self.manifest.to_msgpack(extended_mashumaro_encoder)
  File "<string>", line 3, in __mashumaro_to_msgpack__
  File "<string>", line 91, in __mashumaro_to_msgpack__
  File "C:\Users\fitzp\anaconda3\envs\bootcamp\lib\site-packages\dbt\parser\manifest.py", line 131, in extended_mashumaro_encoder
    return msgpack.packb(data, default=extended_msgpack_encoder, use_bin_type=True)
  File "C:\Users\fitzp\anaconda3\envs\bootcamp\lib\site-packages\msgpack\__init__.py", line 36, in packb
    return Packer(**kwargs).pack(o)
  File "msgpack\\_packer.pyx", line 279, in msgpack._cmsgpack.Packer.pack
  File "msgpack\\_packer.pyx", line 276, in msgpack._cmsgpack.Packer.pack
  File "msgpack\\_packer.pyx", line 265, in msgpack._cmsgpack.Packer._pack
  File "msgpack\\_packer.pyx", line 213, in msgpack._cmsgpack.Packer._pack_inner
  File "msgpack\\_packer.pyx", line 265, in msgpack._cmsgpack.Packer._pack
  File "msgpack\\_packer.pyx", line 213, in msgpack._cmsgpack.Packer._pack_inner
  File "msgpack\\_packer.pyx", line 265, in msgpack._cmsgpack.Packer._pack
  File "msgpack\\_packer.pyx", line 213, in msgpack._cmsgpack.Packer._pack_inner
  File "msgpack\\_packer.pyx", line 265, in msgpack._cmsgpack.Packer._pack
  File "msgpack\\_packer.pyx", line 213, in msgpack._cmsgpack.Packer._pack_inner
  File "msgpack\\_packer.pyx", line 265, in msgpack._cmsgpack.Packer._pack
  File "msgpack\\_packer.pyx", line 232, in msgpack._cmsgpack.Packer._pack_inner
  File "msgpack\\_packer.pyx", line 265, in msgpack._cmsgpack.Packer._pack
  File "msgpack\\_packer.pyx", line 212, in msgpack._cmsgpack.Packer._pack_inner
  File "msgpack\\_packer.pyx", line 270, in msgpack._cmsgpack.Packer._pack
  File "msgpack\\_packer.pyx", line 257, in msgpack._cmsgpack.Packer._pack_inner
TypeError: can not serialize 'Undefined' object

[0m23:36:35.237491 [debug] [MainThread]: Command `dbt test` failed at 23:36:35.237491 after 3.09 seconds
[0m23:36:35.239156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E702F5F3A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E71DB02DC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E71E331F10>]}
[0m23:36:35.240237 [debug] [MainThread]: Flushing usage events
[0m23:36:35.916047 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:45:22.380590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026B996EF430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026B9B763D00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026B9B763AF0>]}


============================== 23:45:22.383299 | 0a76b22e-fd9f-4d8e-a721-2bfa8fb1eb73 ==============================
[0m23:45:22.383299 [info ] [MainThread]: Running with dbt=1.9.0
[0m23:45:22.383299 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'c:\\Users\\fitzp\\Documents\\Alpaca_Market\\zproject_2\\northwind_psql', 'log_path': 'c:\\Users\\fitzp\\Documents\\Alpaca_Market\\zproject_2\\northwind_psql\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:45:23.165344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0a76b22e-fd9f-4d8e-a721-2bfa8fb1eb73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026B9B741BE0>]}
[0m23:45:23.211969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0a76b22e-fd9f-4d8e-a721-2bfa8fb1eb73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026B9B5B8100>]}
[0m23:45:23.213976 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m23:45:23.586171 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m23:45:23.992999 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 3 files changed.
[0m23:45:23.995007 [debug] [MainThread]: Partial parsing: added file: northwind_dbt://models\marts\core\schema.yml
[0m23:45:23.995007 [debug] [MainThread]: Partial parsing: updated file: northwind_dbt://models\marts\core\dim_employees.sql
[0m23:45:23.996516 [debug] [MainThread]: Partial parsing: updated file: northwind_dbt://models\marts\core\obt_orders.sql
[0m23:45:23.997160 [debug] [MainThread]: Partial parsing: updated file: northwind_dbt://snapshots\employees_snapshot.sql
[0m23:45:24.760037 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.northwind_dbt.marts.bi
[0m23:45:24.801263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0a76b22e-fd9f-4d8e-a721-2bfa8fb1eb73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026BB4CC4130>]}
[0m23:45:25.164192 [debug] [MainThread]: Wrote artifact WritableManifest to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\manifest.json
[0m23:45:25.169276 [debug] [MainThread]: Wrote artifact SemanticManifest to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\semantic_manifest.json
[0m23:45:25.229862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0a76b22e-fd9f-4d8e-a721-2bfa8fb1eb73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026BB459AC10>]}
[0m23:45:25.230534 [info ] [MainThread]: Found 10 models, 1 snapshot, 13 data tests, 8 sources, 706 macros
[0m23:45:25.232548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0a76b22e-fd9f-4d8e-a721-2bfa8fb1eb73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026BB4251B50>]}
[0m23:45:25.237072 [info ] [MainThread]: 
[0m23:45:25.238962 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:45:25.238962 [info ] [MainThread]: 
[0m23:45:25.238962 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:45:25.251856 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_Project_2'
[0m23:45:25.626614 [debug] [ThreadPool]: Using snowflake connection "list_Project_2"
[0m23:45:25.630548 [debug] [ThreadPool]: On list_Project_2: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "connection_name": "list_Project_2"} */
show terse schemas in database Project_2
    limit 10000
[0m23:45:25.632177 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:45:26.920480 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.291 seconds
[0m23:45:26.925589 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_Project_2_snapshots'
[0m23:45:26.925589 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_Project_2_public'
[0m23:45:26.941784 [debug] [ThreadPool]: Using snowflake connection "list_Project_2_snapshots"
[0m23:45:26.941784 [debug] [ThreadPool]: Using snowflake connection "list_Project_2_public"
[0m23:45:26.949951 [debug] [ThreadPool]: On list_Project_2_snapshots: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "connection_name": "list_Project_2_snapshots"} */
show objects in Project_2.snapshots limit 10000;
[0m23:45:26.949951 [debug] [ThreadPool]: On list_Project_2_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "connection_name": "list_Project_2_public"} */
show objects in Project_2.public limit 10000;
[0m23:45:26.949951 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:45:26.949951 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:45:27.647973 [debug] [ThreadPool]: SQL status: SUCCESS 24 in 0.709 seconds
[0m23:45:27.663755 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bba741-020d-01f6-000c-83e7000ad326
[0m23:45:27.663755 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m23:45:27.663755 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m23:45:27.663755 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m23:45:27.663755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0a76b22e-fd9f-4d8e-a721-2bfa8fb1eb73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026B985E6340>]}
[0m23:45:27.679493 [debug] [Thread-1  ]: Began running node model.northwind_dbt.stg_customers
[0m23:45:27.679493 [debug] [Thread-2  ]: Began running node model.northwind_dbt.stg_employees
[0m23:45:27.679493 [debug] [Thread-3  ]: Began running node model.northwind_dbt.stg_order_details
[0m23:45:27.679493 [debug] [Thread-4  ]: Began running node model.northwind_dbt.stg_orders
[0m23:45:27.679493 [info ] [Thread-1  ]: 1 of 10 START sql view model public.stg_customers .............................. [RUN]
[0m23:45:27.679493 [info ] [Thread-2  ]: 2 of 10 START sql view model public.stg_employees .............................. [RUN]
[0m23:45:27.679493 [info ] [Thread-3  ]: 3 of 10 START sql view model public.stg_order_details .......................... [RUN]
[0m23:45:27.679493 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.northwind_dbt.stg_customers'
[0m23:45:27.679493 [info ] [Thread-4  ]: 4 of 10 START sql view model public.stg_orders ................................. [RUN]
[0m23:45:27.679493 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.northwind_dbt.stg_employees'
[0m23:45:27.679493 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.northwind_dbt.stg_order_details'
[0m23:45:27.695220 [debug] [Thread-1  ]: Began compiling node model.northwind_dbt.stg_customers
[0m23:45:27.697062 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.northwind_dbt.stg_orders'
[0m23:45:27.697543 [debug] [Thread-2  ]: Began compiling node model.northwind_dbt.stg_employees
[0m23:45:27.697543 [debug] [Thread-3  ]: Began compiling node model.northwind_dbt.stg_order_details
[0m23:45:27.711362 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind_dbt.stg_customers"
[0m23:45:27.711362 [debug] [Thread-4  ]: Began compiling node model.northwind_dbt.stg_orders
[0m23:45:27.711362 [debug] [Thread-2  ]: Writing injected SQL for node "model.northwind_dbt.stg_employees"
[0m23:45:27.723527 [debug] [Thread-3  ]: Writing injected SQL for node "model.northwind_dbt.stg_order_details"
[0m23:45:27.729329 [debug] [Thread-4  ]: Writing injected SQL for node "model.northwind_dbt.stg_orders"
[0m23:45:27.731344 [debug] [Thread-1  ]: Began executing node model.northwind_dbt.stg_customers
[0m23:45:27.769212 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind_dbt.stg_customers"
[0m23:45:27.774812 [debug] [Thread-3  ]: Began executing node model.northwind_dbt.stg_order_details
[0m23:45:27.775808 [debug] [Thread-2  ]: Began executing node model.northwind_dbt.stg_employees
[0m23:45:27.781817 [debug] [Thread-3  ]: Writing runtime sql for node "model.northwind_dbt.stg_order_details"
[0m23:45:27.782814 [debug] [Thread-4  ]: Began executing node model.northwind_dbt.stg_orders
[0m23:45:27.787814 [debug] [Thread-2  ]: Writing runtime sql for node "model.northwind_dbt.stg_employees"
[0m23:45:27.788813 [debug] [Thread-1  ]: Using snowflake connection "model.northwind_dbt.stg_customers"
[0m23:45:27.793732 [debug] [Thread-4  ]: Writing runtime sql for node "model.northwind_dbt.stg_orders"
[0m23:45:27.793732 [debug] [Thread-1  ]: On model.northwind_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.stg_customers"} */
create or replace   view Project_2.public.stg_customers
  
   as (
    select * from PROJECT_2.PUBLIC.customers
  );
[0m23:45:27.793732 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m23:45:27.806337 [debug] [Thread-3  ]: Using snowflake connection "model.northwind_dbt.stg_order_details"
[0m23:45:27.806337 [debug] [Thread-3  ]: On model.northwind_dbt.stg_order_details: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.stg_order_details"} */
create or replace   view Project_2.public.stg_order_details
  
   as (
    select * from PROJECT_2.PUBLIC.order_details
  );
[0m23:45:27.806337 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m23:45:27.822168 [debug] [Thread-2  ]: Using snowflake connection "model.northwind_dbt.stg_employees"
[0m23:45:27.822168 [debug] [Thread-2  ]: On model.northwind_dbt.stg_employees: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.stg_employees"} */
create or replace   view Project_2.public.stg_employees
  
   as (
    select * from PROJECT_2.PUBLIC.employees
  );
[0m23:45:27.822168 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m23:45:27.822168 [debug] [Thread-4  ]: Using snowflake connection "model.northwind_dbt.stg_orders"
[0m23:45:27.822168 [debug] [Thread-4  ]: On model.northwind_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.stg_orders"} */
create or replace   view Project_2.public.stg_orders
  
   as (
    select * from PROJECT_2.PUBLIC.orders
  );
[0m23:45:27.822168 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m23:45:28.641504 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.827 seconds
[0m23:45:28.657549 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a76b22e-fd9f-4d8e-a721-2bfa8fb1eb73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026BB4883550>]}
[0m23:45:28.657549 [info ] [Thread-3  ]: 3 of 10 OK created sql view model public.stg_order_details ..................... [[32mSUCCESS 1[0m in 0.98s]
[0m23:45:28.657549 [debug] [Thread-3  ]: Finished running node model.northwind_dbt.stg_order_details
[0m23:45:28.657549 [debug] [Thread-3  ]: Began running node model.northwind_dbt.stg_products
[0m23:45:28.657549 [info ] [Thread-3  ]: 5 of 10 START sql view model public.stg_products ............................... [RUN]
[0m23:45:28.657549 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.northwind_dbt.stg_order_details, now model.northwind_dbt.stg_products)
[0m23:45:28.657549 [debug] [Thread-3  ]: Began compiling node model.northwind_dbt.stg_products
[0m23:45:28.657549 [debug] [Thread-3  ]: Writing injected SQL for node "model.northwind_dbt.stg_products"
[0m23:45:28.686769 [debug] [Thread-3  ]: Began executing node model.northwind_dbt.stg_products
[0m23:45:28.687283 [debug] [Thread-3  ]: Writing runtime sql for node "model.northwind_dbt.stg_products"
[0m23:45:28.702182 [debug] [Thread-3  ]: Using snowflake connection "model.northwind_dbt.stg_products"
[0m23:45:28.702966 [debug] [Thread-3  ]: On model.northwind_dbt.stg_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.stg_products"} */
create or replace   view Project_2.public.stg_products
  
   as (
    select * from PROJECT_2.PUBLIC.products
  );
[0m23:45:28.714291 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.916 seconds
[0m23:45:28.718662 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a76b22e-fd9f-4d8e-a721-2bfa8fb1eb73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026BB492C0D0>]}
[0m23:45:28.719464 [info ] [Thread-1  ]: 1 of 10 OK created sql view model public.stg_customers ......................... [[32mSUCCESS 1[0m in 1.04s]
[0m23:45:28.719464 [debug] [Thread-1  ]: Finished running node model.northwind_dbt.stg_customers
[0m23:45:28.723334 [debug] [Thread-1  ]: Began running node model.northwind_dbt.dim_customers
[0m23:45:28.723334 [info ] [Thread-1  ]: 6 of 10 START sql table model public.dim_customers ............................. [RUN]
[0m23:45:28.723334 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.northwind_dbt.stg_customers, now model.northwind_dbt.dim_customers)
[0m23:45:28.723334 [debug] [Thread-1  ]: Began compiling node model.northwind_dbt.dim_customers
[0m23:45:28.723334 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind_dbt.dim_customers"
[0m23:45:28.741876 [debug] [Thread-1  ]: Began executing node model.northwind_dbt.dim_customers
[0m23:45:28.753418 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind_dbt.dim_customers"
[0m23:45:28.773373 [debug] [Thread-1  ]: Using snowflake connection "model.northwind_dbt.dim_customers"
[0m23:45:28.775475 [debug] [Thread-1  ]: On model.northwind_dbt.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.dim_customers"} */
create or replace transient table Project_2.public.dim_customers
         as
        (select * from Project_2.public.stg_customers
        );
[0m23:45:28.826797 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1.004 seconds
[0m23:45:28.837672 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a76b22e-fd9f-4d8e-a721-2bfa8fb1eb73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026B985E6340>]}
[0m23:45:28.841861 [info ] [Thread-4  ]: 4 of 10 OK created sql view model public.stg_orders ............................ [[32mSUCCESS 1[0m in 1.14s]
[0m23:45:28.841861 [debug] [Thread-4  ]: Finished running node model.northwind_dbt.stg_orders
[0m23:45:28.841861 [debug] [Thread-4  ]: Began running node model.northwind_dbt.fact_order_details
[0m23:45:28.841861 [info ] [Thread-4  ]: 7 of 10 START sql incremental model public.fact_order_details .................. [RUN]
[0m23:45:28.847566 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.northwind_dbt.stg_orders, now model.northwind_dbt.fact_order_details)
[0m23:45:28.847566 [debug] [Thread-4  ]: Began compiling node model.northwind_dbt.fact_order_details
[0m23:45:28.853235 [debug] [Thread-4  ]: Writing injected SQL for node "model.northwind_dbt.fact_order_details"
[0m23:45:28.877363 [debug] [Thread-4  ]: Began executing node model.northwind_dbt.fact_order_details
[0m23:45:28.909954 [debug] [Thread-4  ]: Using snowflake connection "model.northwind_dbt.fact_order_details"
[0m23:45:28.909954 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.088 seconds
[0m23:45:28.909954 [debug] [Thread-4  ]: On model.northwind_dbt.fact_order_details: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.fact_order_details"} */
create or replace  temporary view Project_2.public.fact_order_details__dbt_tmp
  
   as (
    

with base as (
    select 
        od.order_id,
        od.product_id,
        o.customer_id,
        o.employee_id,
        o.ship_via as shipper_id,
        o.order_date,
        od.unit_price,
        od.quantity,
        od.discount,
        od.unit_price * od.quantity * (1 - od.discount) as revenue
    from Project_2.public.stg_order_details od
    join Project_2.public.stg_orders o on od.order_id = o.order_id
    
        and o.order_date >= (select max(order_date) from Project_2.public.fact_order_details)
    
),
aggregated as (
    select 
        order_id,
        product_id,
        customer_id,
        employee_id,
        shipper_id,
        cast(order_date as date) as order_date,
        sum(revenue) as total_revenue,
        avg(revenue) as avg_revenue,
        max(revenue) as max_revenue,
        min(revenue) as min_revenue,
        count(*) as line_count,
        rank() over (partition by customer_id order by sum(revenue) desc) as revenue_rank
    from base
    group by order_id, product_id, customer_id, employee_id, shipper_id, order_date
)
select * from aggregated
  );
[0m23:45:28.918668 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a76b22e-fd9f-4d8e-a721-2bfa8fb1eb73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026BB43441F0>]}
[0m23:45:28.920636 [info ] [Thread-2  ]: 2 of 10 OK created sql view model public.stg_employees ......................... [[32mSUCCESS 1[0m in 1.24s]
[0m23:45:28.924063 [debug] [Thread-2  ]: Finished running node model.northwind_dbt.stg_employees
[0m23:45:28.925536 [debug] [Thread-2  ]: Began running node model.northwind_dbt.dim_employees
[0m23:45:28.926743 [info ] [Thread-2  ]: 8 of 10 START sql table model public.dim_employees ............................. [RUN]
[0m23:45:28.927877 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.northwind_dbt.stg_employees, now model.northwind_dbt.dim_employees)
[0m23:45:28.928889 [debug] [Thread-2  ]: Began compiling node model.northwind_dbt.dim_employees
[0m23:45:28.934196 [debug] [Thread-2  ]: Writing injected SQL for node "model.northwind_dbt.dim_employees"
[0m23:45:28.941984 [debug] [Thread-2  ]: Began executing node model.northwind_dbt.dim_employees
[0m23:45:28.941984 [debug] [Thread-2  ]: Writing runtime sql for node "model.northwind_dbt.dim_employees"
[0m23:45:28.953906 [debug] [Thread-2  ]: Using snowflake connection "model.northwind_dbt.dim_employees"
[0m23:45:28.953906 [debug] [Thread-2  ]: On model.northwind_dbt.dim_employees: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.dim_employees"} */
create or replace transient table Project_2.public.dim_employees
         as
        (with source_data as (
    select * from Project_2.public.stg_employees
),
scd2 as (
    select 
        md5(cast(coalesce(cast(employee_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as employee_key,
        *,
        current_timestamp as dbt_updated_at
    from source_data
)
select * from scd2
        );
[0m23:45:29.281650 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.577 seconds
[0m23:45:29.281650 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a76b22e-fd9f-4d8e-a721-2bfa8fb1eb73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026BB4883550>]}
[0m23:45:29.288549 [info ] [Thread-3  ]: 5 of 10 OK created sql view model public.stg_products .......................... [[32mSUCCESS 1[0m in 0.62s]
[0m23:45:29.288549 [debug] [Thread-3  ]: Finished running node model.northwind_dbt.stg_products
[0m23:45:29.288549 [debug] [Thread-3  ]: Began running node model.northwind_dbt.dim_products
[0m23:45:29.288549 [info ] [Thread-3  ]: 9 of 10 START sql table model public.dim_products .............................. [RUN]
[0m23:45:29.288549 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.northwind_dbt.stg_products, now model.northwind_dbt.dim_products)
[0m23:45:29.293696 [debug] [Thread-3  ]: Began compiling node model.northwind_dbt.dim_products
[0m23:45:29.297865 [debug] [Thread-3  ]: Writing injected SQL for node "model.northwind_dbt.dim_products"
[0m23:45:29.310529 [debug] [Thread-3  ]: Began executing node model.northwind_dbt.dim_products
[0m23:45:29.313018 [debug] [Thread-3  ]: Writing runtime sql for node "model.northwind_dbt.dim_products"
[0m23:45:29.325771 [debug] [Thread-3  ]: Using snowflake connection "model.northwind_dbt.dim_products"
[0m23:45:29.325771 [debug] [Thread-3  ]: On model.northwind_dbt.dim_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.dim_products"} */
create or replace transient table Project_2.public.dim_products
         as
        (select 
    p.product_id,
    p.product_name,
    p.supplier_id,
    s.company_name as supplier_name,
    p.category_id,
    c.category_name,
    p.quantity_per_unit,
    p.unit_price,
    p.units_in_stock,
    p.units_on_order,
    p.reorder_level,
    p.discontinued
from Project_2.public.stg_products p
left join PROJECT_2.PUBLIC.suppliers s on p.supplier_id = s.supplier_id
left join PROJECT_2.PUBLIC.categories c on p.category_id = c.category_id
        );
[0m23:45:29.449710 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.531 seconds
[0m23:45:29.451091 [debug] [Thread-4  ]: Using snowflake connection "model.northwind_dbt.fact_order_details"
[0m23:45:29.451091 [debug] [Thread-4  ]: On model.northwind_dbt.fact_order_details: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.fact_order_details"} */
describe table Project_2.public.fact_order_details__dbt_tmp
[0m23:45:29.562253 [debug] [Thread-4  ]: SQL status: SUCCESS 12 in 0.110 seconds
[0m23:45:29.562253 [debug] [Thread-4  ]: Using snowflake connection "model.northwind_dbt.fact_order_details"
[0m23:45:29.562253 [debug] [Thread-4  ]: On model.northwind_dbt.fact_order_details: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.fact_order_details"} */
describe table Project_2.public.fact_order_details
[0m23:45:29.665461 [debug] [Thread-4  ]: SQL status: SUCCESS 12 in 0.089 seconds
[0m23:45:29.673255 [debug] [Thread-4  ]: Using snowflake connection "model.northwind_dbt.fact_order_details"
[0m23:45:29.675270 [debug] [Thread-4  ]: On model.northwind_dbt.fact_order_details: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.fact_order_details"} */
describe table "PROJECT_2"."PUBLIC"."FACT_ORDER_DETAILS"
[0m23:45:29.830628 [debug] [Thread-4  ]: SQL status: SUCCESS 12 in 0.154 seconds
[0m23:45:29.862462 [debug] [Thread-4  ]: Writing runtime sql for node "model.northwind_dbt.fact_order_details"
[0m23:45:29.888499 [debug] [Thread-4  ]: Using snowflake connection "model.northwind_dbt.fact_order_details"
[0m23:45:29.888499 [debug] [Thread-4  ]: On model.northwind_dbt.fact_order_details: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.fact_order_details"} */
-- back compat for old kwarg name
  
  begin;
[0m23:45:30.071710 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.180 seconds
[0m23:45:30.073925 [debug] [Thread-4  ]: Using snowflake connection "model.northwind_dbt.fact_order_details"
[0m23:45:30.075071 [debug] [Thread-4  ]: On model.northwind_dbt.fact_order_details: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.fact_order_details"} */
merge into Project_2.public.fact_order_details as DBT_INTERNAL_DEST
        using Project_2.public.fact_order_details__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.order_id = DBT_INTERNAL_DEST.order_id
                ) and (
                    DBT_INTERNAL_SOURCE.product_id = DBT_INTERNAL_DEST.product_id
                )

    
    when matched then update set
        "ORDER_ID" = DBT_INTERNAL_SOURCE."ORDER_ID","PRODUCT_ID" = DBT_INTERNAL_SOURCE."PRODUCT_ID","CUSTOMER_ID" = DBT_INTERNAL_SOURCE."CUSTOMER_ID","EMPLOYEE_ID" = DBT_INTERNAL_SOURCE."EMPLOYEE_ID","SHIPPER_ID" = DBT_INTERNAL_SOURCE."SHIPPER_ID","ORDER_DATE" = DBT_INTERNAL_SOURCE."ORDER_DATE","TOTAL_REVENUE" = DBT_INTERNAL_SOURCE."TOTAL_REVENUE","AVG_REVENUE" = DBT_INTERNAL_SOURCE."AVG_REVENUE","MAX_REVENUE" = DBT_INTERNAL_SOURCE."MAX_REVENUE","MIN_REVENUE" = DBT_INTERNAL_SOURCE."MIN_REVENUE","LINE_COUNT" = DBT_INTERNAL_SOURCE."LINE_COUNT","REVENUE_RANK" = DBT_INTERNAL_SOURCE."REVENUE_RANK"
    

    when not matched then insert
        ("ORDER_ID", "PRODUCT_ID", "CUSTOMER_ID", "EMPLOYEE_ID", "SHIPPER_ID", "ORDER_DATE", "TOTAL_REVENUE", "AVG_REVENUE", "MAX_REVENUE", "MIN_REVENUE", "LINE_COUNT", "REVENUE_RANK")
    values
        ("ORDER_ID", "PRODUCT_ID", "CUSTOMER_ID", "EMPLOYEE_ID", "SHIPPER_ID", "ORDER_DATE", "TOTAL_REVENUE", "AVG_REVENUE", "MAX_REVENUE", "MIN_REVENUE", "LINE_COUNT", "REVENUE_RANK")

;
[0m23:45:30.315819 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.354 seconds
[0m23:45:30.324790 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a76b22e-fd9f-4d8e-a721-2bfa8fb1eb73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026BB4354910>]}
[0m23:45:30.327289 [info ] [Thread-2  ]: 8 of 10 OK created sql table model public.dim_employees ........................ [[32mSUCCESS 1[0m in 1.40s]
[0m23:45:30.330912 [debug] [Thread-2  ]: Finished running node model.northwind_dbt.dim_employees
[0m23:45:30.369564 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.592 seconds
[0m23:45:30.378483 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a76b22e-fd9f-4d8e-a721-2bfa8fb1eb73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026BB48390D0>]}
[0m23:45:30.381110 [info ] [Thread-1  ]: 6 of 10 OK created sql table model public.dim_customers ........................ [[32mSUCCESS 1[0m in 1.65s]
[0m23:45:30.385736 [debug] [Thread-1  ]: Finished running node model.northwind_dbt.dim_customers
[0m23:45:30.788589 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1.461 seconds
[0m23:45:30.792925 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a76b22e-fd9f-4d8e-a721-2bfa8fb1eb73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026B9AA52C70>]}
[0m23:45:30.793938 [info ] [Thread-3  ]: 9 of 10 OK created sql table model public.dim_products ......................... [[32mSUCCESS 1[0m in 1.50s]
[0m23:45:30.796279 [debug] [Thread-3  ]: Finished running node model.northwind_dbt.dim_products
[0m23:45:31.230729 [debug] [Thread-4  ]: SQL status: SUCCESS 32 in 1.155 seconds
[0m23:45:31.231848 [debug] [Thread-4  ]: Using snowflake connection "model.northwind_dbt.fact_order_details"
[0m23:45:31.234095 [debug] [Thread-4  ]: On model.northwind_dbt.fact_order_details: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.fact_order_details"} */
COMMIT
[0m23:45:31.528980 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.295 seconds
[0m23:45:31.538569 [debug] [Thread-4  ]: Applying DROP to: Project_2.public.fact_order_details__dbt_tmp
[0m23:45:31.545363 [debug] [Thread-4  ]: Using snowflake connection "model.northwind_dbt.fact_order_details"
[0m23:45:31.545363 [debug] [Thread-4  ]: On model.northwind_dbt.fact_order_details: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.fact_order_details"} */
drop view if exists Project_2.public.fact_order_details__dbt_tmp cascade
[0m23:45:31.697087 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.148 seconds
[0m23:45:31.701592 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a76b22e-fd9f-4d8e-a721-2bfa8fb1eb73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026BB4839DF0>]}
[0m23:45:31.702583 [info ] [Thread-4  ]: 7 of 10 OK created sql incremental model public.fact_order_details ............. [[32mSUCCESS 32[0m in 2.85s]
[0m23:45:31.703581 [debug] [Thread-4  ]: Finished running node model.northwind_dbt.fact_order_details
[0m23:45:31.704582 [debug] [Thread-2  ]: Began running node model.northwind_dbt.obt_orders
[0m23:45:31.705581 [info ] [Thread-2  ]: 10 of 10 START sql table model public.obt_orders ............................... [RUN]
[0m23:45:31.706582 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.northwind_dbt.dim_employees, now model.northwind_dbt.obt_orders)
[0m23:45:31.706582 [debug] [Thread-2  ]: Began compiling node model.northwind_dbt.obt_orders
[0m23:45:31.711581 [debug] [Thread-2  ]: Writing injected SQL for node "model.northwind_dbt.obt_orders"
[0m23:45:31.723652 [debug] [Thread-2  ]: Began executing node model.northwind_dbt.obt_orders
[0m23:45:31.729652 [debug] [Thread-2  ]: Writing runtime sql for node "model.northwind_dbt.obt_orders"
[0m23:45:31.743306 [debug] [Thread-2  ]: Using snowflake connection "model.northwind_dbt.obt_orders"
[0m23:45:31.744306 [debug] [Thread-2  ]: On model.northwind_dbt.obt_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.obt_orders"} */
create or replace transient table Project_2.public.obt_orders
         as
        (select 
    f.order_id,
    f.product_id,
    f.customer_id,
    f.employee_id,
    f.shipper_id,
    f.order_date,
    f.total_revenue,
    f.avg_revenue,
    f.max_revenue,
    f.min_revenue,
    f.line_count,
    f.revenue_rank,

    c.company_name as customer_name,
    p.product_name,
    p.category_name,
    p.supplier_name,
    e.first_name || ' ' || e.last_name as employee_name,
    s.company_name as shipper_name

from Project_2.public.fact_order_details f
left join Project_2.public.dim_customers c on f.customer_id = c.customer_id
left join Project_2.public.dim_products p on f.product_id = p.product_id
left join Project_2.public.dim_employees e on f.employee_id = e.employee_id
left join PROJECT_2.PUBLIC.shippers s on f.shipper_id = s.shipper_id
        );
[0m23:45:33.131218 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.386 seconds
[0m23:45:33.134939 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a76b22e-fd9f-4d8e-a721-2bfa8fb1eb73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026BB48544F0>]}
[0m23:45:33.136941 [info ] [Thread-2  ]: 10 of 10 OK created sql table model public.obt_orders .......................... [[32mSUCCESS 1[0m in 1.43s]
[0m23:45:33.139115 [debug] [Thread-2  ]: Finished running node model.northwind_dbt.obt_orders
[0m23:45:33.143133 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:45:33.145135 [debug] [MainThread]: Connection 'list_Project_2' was left open.
[0m23:45:33.147516 [debug] [MainThread]: On list_Project_2: Close
[0m23:45:33.289548 [debug] [MainThread]: Connection 'list_Project_2_snapshots' was left open.
[0m23:45:33.290795 [debug] [MainThread]: On list_Project_2_snapshots: Close
[0m23:45:33.429912 [debug] [MainThread]: Connection 'list_Project_2_public' was left open.
[0m23:45:33.431426 [debug] [MainThread]: On list_Project_2_public: Close
[0m23:45:33.559051 [debug] [MainThread]: Connection 'model.northwind_dbt.dim_customers' was left open.
[0m23:45:33.561313 [debug] [MainThread]: On model.northwind_dbt.dim_customers: Close
[0m23:45:33.704079 [debug] [MainThread]: Connection 'model.northwind_dbt.obt_orders' was left open.
[0m23:45:33.705099 [debug] [MainThread]: On model.northwind_dbt.obt_orders: Close
[0m23:45:33.832143 [debug] [MainThread]: Connection 'model.northwind_dbt.dim_products' was left open.
[0m23:45:33.833569 [debug] [MainThread]: On model.northwind_dbt.dim_products: Close
[0m23:45:33.955708 [debug] [MainThread]: Connection 'model.northwind_dbt.fact_order_details' was left open.
[0m23:45:33.956690 [debug] [MainThread]: On model.northwind_dbt.fact_order_details: Close
[0m23:45:34.107353 [info ] [MainThread]: 
[0m23:45:34.107353 [info ] [MainThread]: Finished running 1 incremental model, 4 table models, 5 view models in 0 hours 0 minutes and 8.87 seconds (8.87s).
[0m23:45:34.107353 [debug] [MainThread]: Command end result
[0m23:45:34.236050 [debug] [MainThread]: Wrote artifact WritableManifest to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\manifest.json
[0m23:45:34.251538 [debug] [MainThread]: Wrote artifact SemanticManifest to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\semantic_manifest.json
[0m23:45:34.270889 [debug] [MainThread]: Wrote artifact RunExecutionResult to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\run_results.json
[0m23:45:34.270889 [info ] [MainThread]: 
[0m23:45:34.272888 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:45:34.273893 [info ] [MainThread]: 
[0m23:45:34.274892 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m23:45:34.275890 [debug] [MainThread]: Command `dbt run` succeeded at 23:45:34.275890 after 11.98 seconds
[0m23:45:34.276892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026B996EF430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026BB42BFA60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026BB437B040>]}
[0m23:45:34.277923 [debug] [MainThread]: Flushing usage events
[0m23:45:35.656043 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:45:58.240693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D866AF370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D87A05AC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D88700250>]}


============================== 23:45:58.240693 | d7b33ac1-3ef5-42f9-8009-3b45f0b0a577 ==============================
[0m23:45:58.240693 [info ] [MainThread]: Running with dbt=1.9.0
[0m23:45:58.240693 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'c:\\Users\\fitzp\\Documents\\Alpaca_Market\\zproject_2\\northwind_psql', 'debug': 'False', 'version_check': 'True', 'log_path': 'c:\\Users\\fitzp\\Documents\\Alpaca_Market\\zproject_2\\northwind_psql\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m23:45:59.181802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd7b33ac1-3ef5-42f9-8009-3b45f0b0a577', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016DA11C94C0>]}
[0m23:45:59.227322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd7b33ac1-3ef5-42f9-8009-3b45f0b0a577', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D88578370>]}
[0m23:45:59.227322 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m23:45:59.569382 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m23:45:59.942700 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:45:59.942700 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:45:59.942700 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.northwind_dbt.marts.bi
[0m23:46:00.024957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd7b33ac1-3ef5-42f9-8009-3b45f0b0a577', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016DA1822130>]}
[0m23:46:00.400650 [debug] [MainThread]: Wrote artifact WritableManifest to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\manifest.json
[0m23:46:00.408767 [debug] [MainThread]: Wrote artifact SemanticManifest to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\semantic_manifest.json
[0m23:46:00.507472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd7b33ac1-3ef5-42f9-8009-3b45f0b0a577', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D8804BA00>]}
[0m23:46:00.507472 [info ] [MainThread]: Found 10 models, 1 snapshot, 13 data tests, 8 sources, 706 macros
[0m23:46:00.507472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd7b33ac1-3ef5-42f9-8009-3b45f0b0a577', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016DA184AD60>]}
[0m23:46:00.512126 [info ] [MainThread]: 
[0m23:46:00.512126 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:46:00.512126 [info ] [MainThread]: 
[0m23:46:00.517933 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:46:00.526208 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_Project_2_snapshots'
[0m23:46:00.542287 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_Project_2_public'
[0m23:46:00.654988 [debug] [ThreadPool]: Using snowflake connection "list_Project_2_snapshots"
[0m23:46:00.654988 [debug] [ThreadPool]: Using snowflake connection "list_Project_2_public"
[0m23:46:00.654988 [debug] [ThreadPool]: On list_Project_2_snapshots: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "connection_name": "list_Project_2_snapshots"} */
show objects in Project_2.snapshots limit 10000;
[0m23:46:00.654988 [debug] [ThreadPool]: On list_Project_2_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "connection_name": "list_Project_2_public"} */
show objects in Project_2.public limit 10000;
[0m23:46:00.654988 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:46:00.654988 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:46:01.383792 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bba742-020d-01bb-000c-83e7000ac3c2
[0m23:46:01.387100 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m23:46:01.387100 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m23:46:01.387100 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m23:46:01.415039 [debug] [ThreadPool]: SQL status: SUCCESS 24 in 0.756 seconds
[0m23:46:01.415039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd7b33ac1-3ef5-42f9-8009-3b45f0b0a577', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016DA1852610>]}
[0m23:46:01.415039 [debug] [Thread-1  ]: Began running node test.northwind_dbt.not_null_dim_customers_customer_id.dd91cd1c8d
[0m23:46:01.415039 [debug] [Thread-2  ]: Began running node test.northwind_dbt.not_null_dim_employees_employee_key.232a183ffe
[0m23:46:01.415039 [debug] [Thread-3  ]: Began running node test.northwind_dbt.not_null_dim_products_product_id.c8aba288d1
[0m23:46:01.415039 [debug] [Thread-4  ]: Began running node test.northwind_dbt.not_null_fact_order_details_customer_id.6aaefe4888
[0m23:46:01.415039 [info ] [Thread-1  ]: 1 of 13 START test not_null_dim_customers_customer_id .......................... [RUN]
[0m23:46:01.415039 [info ] [Thread-2  ]: 2 of 13 START test not_null_dim_employees_employee_key ......................... [RUN]
[0m23:46:01.415039 [info ] [Thread-3  ]: 3 of 13 START test not_null_dim_products_product_id ............................ [RUN]
[0m23:46:01.415039 [info ] [Thread-4  ]: 4 of 13 START test not_null_fact_order_details_customer_id ..................... [RUN]
[0m23:46:01.415039 [debug] [Thread-1  ]: Acquiring new snowflake connection 'test.northwind_dbt.not_null_dim_customers_customer_id.dd91cd1c8d'
[0m23:46:01.415039 [debug] [Thread-2  ]: Acquiring new snowflake connection 'test.northwind_dbt.not_null_dim_employees_employee_key.232a183ffe'
[0m23:46:01.430734 [debug] [Thread-4  ]: Acquiring new snowflake connection 'test.northwind_dbt.not_null_fact_order_details_customer_id.6aaefe4888'
[0m23:46:01.430734 [debug] [Thread-3  ]: Acquiring new snowflake connection 'test.northwind_dbt.not_null_dim_products_product_id.c8aba288d1'
[0m23:46:01.434052 [debug] [Thread-1  ]: Began compiling node test.northwind_dbt.not_null_dim_customers_customer_id.dd91cd1c8d
[0m23:46:01.435957 [debug] [Thread-2  ]: Began compiling node test.northwind_dbt.not_null_dim_employees_employee_key.232a183ffe
[0m23:46:01.436536 [debug] [Thread-4  ]: Began compiling node test.northwind_dbt.not_null_fact_order_details_customer_id.6aaefe4888
[0m23:46:01.436536 [debug] [Thread-3  ]: Began compiling node test.northwind_dbt.not_null_dim_products_product_id.c8aba288d1
[0m23:46:01.453043 [debug] [Thread-1  ]: Writing injected SQL for node "test.northwind_dbt.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m23:46:01.460780 [debug] [Thread-2  ]: Writing injected SQL for node "test.northwind_dbt.not_null_dim_employees_employee_key.232a183ffe"
[0m23:46:01.466368 [debug] [Thread-4  ]: Writing injected SQL for node "test.northwind_dbt.not_null_fact_order_details_customer_id.6aaefe4888"
[0m23:46:01.469279 [debug] [Thread-3  ]: Writing injected SQL for node "test.northwind_dbt.not_null_dim_products_product_id.c8aba288d1"
[0m23:46:01.476618 [debug] [Thread-2  ]: Began executing node test.northwind_dbt.not_null_dim_employees_employee_key.232a183ffe
[0m23:46:01.479126 [debug] [Thread-1  ]: Began executing node test.northwind_dbt.not_null_dim_customers_customer_id.dd91cd1c8d
[0m23:46:01.489988 [debug] [Thread-3  ]: Began executing node test.northwind_dbt.not_null_dim_products_product_id.c8aba288d1
[0m23:46:01.496789 [debug] [Thread-2  ]: Writing runtime sql for node "test.northwind_dbt.not_null_dim_employees_employee_key.232a183ffe"
[0m23:46:01.497855 [debug] [Thread-4  ]: Began executing node test.northwind_dbt.not_null_fact_order_details_customer_id.6aaefe4888
[0m23:46:01.499850 [debug] [Thread-1  ]: Writing runtime sql for node "test.northwind_dbt.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m23:46:01.503860 [debug] [Thread-3  ]: Writing runtime sql for node "test.northwind_dbt.not_null_dim_products_product_id.c8aba288d1"
[0m23:46:01.507357 [debug] [Thread-4  ]: Writing runtime sql for node "test.northwind_dbt.not_null_fact_order_details_customer_id.6aaefe4888"
[0m23:46:01.513438 [debug] [Thread-2  ]: Using snowflake connection "test.northwind_dbt.not_null_dim_employees_employee_key.232a183ffe"
[0m23:46:01.513438 [debug] [Thread-1  ]: Using snowflake connection "test.northwind_dbt.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m23:46:01.515027 [debug] [Thread-3  ]: Using snowflake connection "test.northwind_dbt.not_null_dim_products_product_id.c8aba288d1"
[0m23:46:01.515027 [debug] [Thread-2  ]: On test.northwind_dbt.not_null_dim_employees_employee_key.232a183ffe: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "test.northwind_dbt.not_null_dim_employees_employee_key.232a183ffe"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select employee_key
from Project_2.public.dim_employees
where employee_key is null



      
    ) dbt_internal_test
[0m23:46:01.516074 [debug] [Thread-1  ]: On test.northwind_dbt.not_null_dim_customers_customer_id.dd91cd1c8d: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "test.northwind_dbt.not_null_dim_customers_customer_id.dd91cd1c8d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from Project_2.public.dim_customers
where customer_id is null



      
    ) dbt_internal_test
[0m23:46:01.516074 [debug] [Thread-3  ]: On test.northwind_dbt.not_null_dim_products_product_id.c8aba288d1: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "test.northwind_dbt.not_null_dim_products_product_id.c8aba288d1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_id
from Project_2.public.dim_products
where product_id is null



      
    ) dbt_internal_test
[0m23:46:01.517066 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m23:46:01.517066 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m23:46:01.518072 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m23:46:01.521045 [debug] [Thread-4  ]: Using snowflake connection "test.northwind_dbt.not_null_fact_order_details_customer_id.6aaefe4888"
[0m23:46:01.524687 [debug] [Thread-4  ]: On test.northwind_dbt.not_null_fact_order_details_customer_id.6aaefe4888: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "test.northwind_dbt.not_null_fact_order_details_customer_id.6aaefe4888"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from Project_2.public.fact_order_details
where customer_id is null



      
    ) dbt_internal_test
[0m23:46:01.524687 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m23:46:01.900306 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.384 seconds
[0m23:46:01.917220 [info ] [Thread-2  ]: 2 of 13 PASS not_null_dim_employees_employee_key ............................... [[32mPASS[0m in 0.50s]
[0m23:46:01.917220 [debug] [Thread-2  ]: Finished running node test.northwind_dbt.not_null_dim_employees_employee_key.232a183ffe
[0m23:46:01.917220 [debug] [Thread-2  ]: Began running node test.northwind_dbt.not_null_fact_order_details_order_id.8d47c14c82
[0m23:46:01.917220 [info ] [Thread-2  ]: 5 of 13 START test not_null_fact_order_details_order_id ........................ [RUN]
[0m23:46:01.917220 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.northwind_dbt.not_null_dim_employees_employee_key.232a183ffe, now test.northwind_dbt.not_null_fact_order_details_order_id.8d47c14c82)
[0m23:46:01.917220 [debug] [Thread-2  ]: Began compiling node test.northwind_dbt.not_null_fact_order_details_order_id.8d47c14c82
[0m23:46:01.917220 [debug] [Thread-2  ]: Writing injected SQL for node "test.northwind_dbt.not_null_fact_order_details_order_id.8d47c14c82"
[0m23:46:01.917220 [debug] [Thread-2  ]: Began executing node test.northwind_dbt.not_null_fact_order_details_order_id.8d47c14c82
[0m23:46:01.934627 [debug] [Thread-2  ]: Writing runtime sql for node "test.northwind_dbt.not_null_fact_order_details_order_id.8d47c14c82"
[0m23:46:01.938394 [debug] [Thread-2  ]: Using snowflake connection "test.northwind_dbt.not_null_fact_order_details_order_id.8d47c14c82"
[0m23:46:01.938394 [debug] [Thread-2  ]: On test.northwind_dbt.not_null_fact_order_details_order_id.8d47c14c82: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "test.northwind_dbt.not_null_fact_order_details_order_id.8d47c14c82"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from Project_2.public.fact_order_details
where order_id is null



      
    ) dbt_internal_test
[0m23:46:02.069782 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.551 seconds
[0m23:46:02.081991 [info ] [Thread-4  ]: 4 of 13 PASS not_null_fact_order_details_customer_id ........................... [[32mPASS[0m in 0.65s]
[0m23:46:02.085090 [debug] [Thread-4  ]: Finished running node test.northwind_dbt.not_null_fact_order_details_customer_id.6aaefe4888
[0m23:46:02.086970 [debug] [Thread-4  ]: Began running node test.northwind_dbt.not_null_fact_order_details_product_id.85713db7b9
[0m23:46:02.088980 [info ] [Thread-4  ]: 6 of 13 START test not_null_fact_order_details_product_id ...................... [RUN]
[0m23:46:02.088980 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.northwind_dbt.not_null_fact_order_details_customer_id.6aaefe4888, now test.northwind_dbt.not_null_fact_order_details_product_id.85713db7b9)
[0m23:46:02.091980 [debug] [Thread-4  ]: Began compiling node test.northwind_dbt.not_null_fact_order_details_product_id.85713db7b9
[0m23:46:02.098900 [debug] [Thread-4  ]: Writing injected SQL for node "test.northwind_dbt.not_null_fact_order_details_product_id.85713db7b9"
[0m23:46:02.105862 [debug] [Thread-4  ]: Began executing node test.northwind_dbt.not_null_fact_order_details_product_id.85713db7b9
[0m23:46:02.105862 [debug] [Thread-4  ]: Writing runtime sql for node "test.northwind_dbt.not_null_fact_order_details_product_id.85713db7b9"
[0m23:46:02.105862 [debug] [Thread-4  ]: Using snowflake connection "test.northwind_dbt.not_null_fact_order_details_product_id.85713db7b9"
[0m23:46:02.105862 [debug] [Thread-4  ]: On test.northwind_dbt.not_null_fact_order_details_product_id.85713db7b9: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "test.northwind_dbt.not_null_fact_order_details_product_id.85713db7b9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_id
from Project_2.public.fact_order_details
where product_id is null



      
    ) dbt_internal_test
[0m23:46:02.187362 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.669 seconds
[0m23:46:02.192077 [info ] [Thread-3  ]: 3 of 13 PASS not_null_dim_products_product_id .................................. [[32mPASS[0m in 0.78s]
[0m23:46:02.194075 [debug] [Thread-3  ]: Finished running node test.northwind_dbt.not_null_dim_products_product_id.c8aba288d1
[0m23:46:02.195079 [debug] [Thread-3  ]: Began running node test.northwind_dbt.not_null_obt_orders_customer_id.1e3c4ae465
[0m23:46:02.196079 [info ] [Thread-3  ]: 7 of 13 START test not_null_obt_orders_customer_id ............................. [RUN]
[0m23:46:02.200575 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.northwind_dbt.not_null_dim_products_product_id.c8aba288d1, now test.northwind_dbt.not_null_obt_orders_customer_id.1e3c4ae465)
[0m23:46:02.202754 [debug] [Thread-3  ]: Began compiling node test.northwind_dbt.not_null_obt_orders_customer_id.1e3c4ae465
[0m23:46:02.205341 [debug] [Thread-3  ]: Writing injected SQL for node "test.northwind_dbt.not_null_obt_orders_customer_id.1e3c4ae465"
[0m23:46:02.205341 [debug] [Thread-3  ]: Began executing node test.northwind_dbt.not_null_obt_orders_customer_id.1e3c4ae465
[0m23:46:02.216818 [debug] [Thread-3  ]: Writing runtime sql for node "test.northwind_dbt.not_null_obt_orders_customer_id.1e3c4ae465"
[0m23:46:02.223230 [debug] [Thread-3  ]: Using snowflake connection "test.northwind_dbt.not_null_obt_orders_customer_id.1e3c4ae465"
[0m23:46:02.224293 [debug] [Thread-3  ]: On test.northwind_dbt.not_null_obt_orders_customer_id.1e3c4ae465: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "test.northwind_dbt.not_null_obt_orders_customer_id.1e3c4ae465"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from Project_2.public.obt_orders
where customer_id is null



      
    ) dbt_internal_test
[0m23:46:02.290726 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.773 seconds
[0m23:46:02.294867 [info ] [Thread-1  ]: 1 of 13 PASS not_null_dim_customers_customer_id ................................ [[32mPASS[0m in 0.88s]
[0m23:46:02.296516 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.355 seconds
[0m23:46:02.297137 [debug] [Thread-1  ]: Finished running node test.northwind_dbt.not_null_dim_customers_customer_id.dd91cd1c8d
[0m23:46:02.299922 [debug] [Thread-1  ]: Began running node test.northwind_dbt.not_null_obt_orders_order_date.5632203db3
[0m23:46:02.299396 [info ] [Thread-2  ]: 5 of 13 PASS not_null_fact_order_details_order_id .............................. [[32mPASS[0m in 0.38s]
[0m23:46:02.301061 [debug] [Thread-2  ]: Finished running node test.northwind_dbt.not_null_fact_order_details_order_id.8d47c14c82
[0m23:46:02.300439 [info ] [Thread-1  ]: 8 of 13 START test not_null_obt_orders_order_date .............................. [RUN]
[0m23:46:02.301061 [debug] [Thread-2  ]: Began running node test.northwind_dbt.not_null_obt_orders_order_id.218f605f9c
[0m23:46:02.301061 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.northwind_dbt.not_null_dim_customers_customer_id.dd91cd1c8d, now test.northwind_dbt.not_null_obt_orders_order_date.5632203db3)
[0m23:46:02.301061 [info ] [Thread-2  ]: 9 of 13 START test not_null_obt_orders_order_id ................................ [RUN]
[0m23:46:02.301061 [debug] [Thread-1  ]: Began compiling node test.northwind_dbt.not_null_obt_orders_order_date.5632203db3
[0m23:46:02.304479 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.northwind_dbt.not_null_fact_order_details_order_id.8d47c14c82, now test.northwind_dbt.not_null_obt_orders_order_id.218f605f9c)
[0m23:46:02.305665 [debug] [Thread-1  ]: Writing injected SQL for node "test.northwind_dbt.not_null_obt_orders_order_date.5632203db3"
[0m23:46:02.305665 [debug] [Thread-2  ]: Began compiling node test.northwind_dbt.not_null_obt_orders_order_id.218f605f9c
[0m23:46:02.313860 [debug] [Thread-2  ]: Writing injected SQL for node "test.northwind_dbt.not_null_obt_orders_order_id.218f605f9c"
[0m23:46:02.318413 [debug] [Thread-1  ]: Began executing node test.northwind_dbt.not_null_obt_orders_order_date.5632203db3
[0m23:46:02.318413 [debug] [Thread-2  ]: Began executing node test.northwind_dbt.not_null_obt_orders_order_id.218f605f9c
[0m23:46:02.322911 [debug] [Thread-1  ]: Writing runtime sql for node "test.northwind_dbt.not_null_obt_orders_order_date.5632203db3"
[0m23:46:02.322911 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.208 seconds
[0m23:46:02.328640 [debug] [Thread-2  ]: Writing runtime sql for node "test.northwind_dbt.not_null_obt_orders_order_id.218f605f9c"
[0m23:46:02.328640 [info ] [Thread-4  ]: 6 of 13 PASS not_null_fact_order_details_product_id ............................ [[32mPASS[0m in 0.24s]
[0m23:46:02.328640 [debug] [Thread-4  ]: Finished running node test.northwind_dbt.not_null_fact_order_details_product_id.85713db7b9
[0m23:46:02.328640 [debug] [Thread-4  ]: Began running node test.northwind_dbt.not_null_obt_orders_product_id.caa3082c7f
[0m23:46:02.328640 [info ] [Thread-4  ]: 10 of 13 START test not_null_obt_orders_product_id ............................. [RUN]
[0m23:46:02.328640 [debug] [Thread-1  ]: Using snowflake connection "test.northwind_dbt.not_null_obt_orders_order_date.5632203db3"
[0m23:46:02.328640 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.northwind_dbt.not_null_fact_order_details_product_id.85713db7b9, now test.northwind_dbt.not_null_obt_orders_product_id.caa3082c7f)
[0m23:46:02.328640 [debug] [Thread-1  ]: On test.northwind_dbt.not_null_obt_orders_order_date.5632203db3: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "test.northwind_dbt.not_null_obt_orders_order_date.5632203db3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_date
from Project_2.public.obt_orders
where order_date is null



      
    ) dbt_internal_test
[0m23:46:02.338365 [debug] [Thread-2  ]: Using snowflake connection "test.northwind_dbt.not_null_obt_orders_order_id.218f605f9c"
[0m23:46:02.339248 [debug] [Thread-4  ]: Began compiling node test.northwind_dbt.not_null_obt_orders_product_id.caa3082c7f
[0m23:46:02.339248 [debug] [Thread-2  ]: On test.northwind_dbt.not_null_obt_orders_order_id.218f605f9c: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "test.northwind_dbt.not_null_obt_orders_order_id.218f605f9c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from Project_2.public.obt_orders
where order_id is null



      
    ) dbt_internal_test
[0m23:46:02.339248 [debug] [Thread-4  ]: Writing injected SQL for node "test.northwind_dbt.not_null_obt_orders_product_id.caa3082c7f"
[0m23:46:02.339248 [debug] [Thread-4  ]: Began executing node test.northwind_dbt.not_null_obt_orders_product_id.caa3082c7f
[0m23:46:02.423871 [debug] [Thread-4  ]: Writing runtime sql for node "test.northwind_dbt.not_null_obt_orders_product_id.caa3082c7f"
[0m23:46:02.429265 [debug] [Thread-4  ]: Using snowflake connection "test.northwind_dbt.not_null_obt_orders_product_id.caa3082c7f"
[0m23:46:02.430308 [debug] [Thread-4  ]: On test.northwind_dbt.not_null_obt_orders_product_id.caa3082c7f: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "test.northwind_dbt.not_null_obt_orders_product_id.caa3082c7f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_id
from Project_2.public.obt_orders
where product_id is null



      
    ) dbt_internal_test
[0m23:46:02.431382 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.207 seconds
[0m23:46:02.434348 [info ] [Thread-3  ]: 7 of 13 PASS not_null_obt_orders_customer_id ................................... [[32mPASS[0m in 0.23s]
[0m23:46:02.436258 [debug] [Thread-3  ]: Finished running node test.northwind_dbt.not_null_obt_orders_customer_id.1e3c4ae465
[0m23:46:02.437462 [debug] [Thread-3  ]: Began running node test.northwind_dbt.unique_dim_customers_customer_id.15c9f1e2fd
[0m23:46:02.437462 [info ] [Thread-3  ]: 11 of 13 START test unique_dim_customers_customer_id ........................... [RUN]
[0m23:46:02.438851 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.northwind_dbt.not_null_obt_orders_customer_id.1e3c4ae465, now test.northwind_dbt.unique_dim_customers_customer_id.15c9f1e2fd)
[0m23:46:02.439861 [debug] [Thread-3  ]: Began compiling node test.northwind_dbt.unique_dim_customers_customer_id.15c9f1e2fd
[0m23:46:02.440860 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.101 seconds
[0m23:46:02.446890 [debug] [Thread-3  ]: Writing injected SQL for node "test.northwind_dbt.unique_dim_customers_customer_id.15c9f1e2fd"
[0m23:46:02.448917 [info ] [Thread-1  ]: 8 of 13 PASS not_null_obt_orders_order_date .................................... [[32mPASS[0m in 0.15s]
[0m23:46:02.449893 [debug] [Thread-1  ]: Finished running node test.northwind_dbt.not_null_obt_orders_order_date.5632203db3
[0m23:46:02.450661 [debug] [Thread-1  ]: Began running node test.northwind_dbt.unique_dim_employees_employee_key.3824d24782
[0m23:46:02.451766 [info ] [Thread-1  ]: 12 of 13 START test unique_dim_employees_employee_key .......................... [RUN]
[0m23:46:02.452769 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.northwind_dbt.not_null_obt_orders_order_date.5632203db3, now test.northwind_dbt.unique_dim_employees_employee_key.3824d24782)
[0m23:46:02.452769 [debug] [Thread-1  ]: Began compiling node test.northwind_dbt.unique_dim_employees_employee_key.3824d24782
[0m23:46:02.455068 [debug] [Thread-1  ]: Writing injected SQL for node "test.northwind_dbt.unique_dim_employees_employee_key.3824d24782"
[0m23:46:02.455068 [debug] [Thread-3  ]: Began executing node test.northwind_dbt.unique_dim_customers_customer_id.15c9f1e2fd
[0m23:46:02.462630 [debug] [Thread-3  ]: Writing runtime sql for node "test.northwind_dbt.unique_dim_customers_customer_id.15c9f1e2fd"
[0m23:46:02.462630 [debug] [Thread-1  ]: Began executing node test.northwind_dbt.unique_dim_employees_employee_key.3824d24782
[0m23:46:02.462630 [debug] [Thread-1  ]: Writing runtime sql for node "test.northwind_dbt.unique_dim_employees_employee_key.3824d24782"
[0m23:46:02.470609 [debug] [Thread-3  ]: Using snowflake connection "test.northwind_dbt.unique_dim_customers_customer_id.15c9f1e2fd"
[0m23:46:02.473495 [debug] [Thread-3  ]: On test.northwind_dbt.unique_dim_customers_customer_id.15c9f1e2fd: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "test.northwind_dbt.unique_dim_customers_customer_id.15c9f1e2fd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from Project_2.public.dim_customers
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m23:46:02.477513 [debug] [Thread-1  ]: Using snowflake connection "test.northwind_dbt.unique_dim_employees_employee_key.3824d24782"
[0m23:46:02.477513 [debug] [Thread-1  ]: On test.northwind_dbt.unique_dim_employees_employee_key.3824d24782: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "test.northwind_dbt.unique_dim_employees_employee_key.3824d24782"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    employee_key as unique_field,
    count(*) as n_records

from Project_2.public.dim_employees
where employee_key is not null
group by employee_key
having count(*) > 1



      
    ) dbt_internal_test
[0m23:46:02.489282 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.154 seconds
[0m23:46:02.489282 [info ] [Thread-2  ]: 9 of 13 PASS not_null_obt_orders_order_id ...................................... [[32mPASS[0m in 0.18s]
[0m23:46:02.505101 [debug] [Thread-2  ]: Finished running node test.northwind_dbt.not_null_obt_orders_order_id.218f605f9c
[0m23:46:02.505527 [debug] [Thread-2  ]: Began running node test.northwind_dbt.unique_dim_products_product_id.ef7b2a9985
[0m23:46:02.505527 [info ] [Thread-2  ]: 13 of 13 START test unique_dim_products_product_id ............................. [RUN]
[0m23:46:02.505527 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.northwind_dbt.not_null_obt_orders_order_id.218f605f9c, now test.northwind_dbt.unique_dim_products_product_id.ef7b2a9985)
[0m23:46:02.505527 [debug] [Thread-2  ]: Began compiling node test.northwind_dbt.unique_dim_products_product_id.ef7b2a9985
[0m23:46:02.505527 [debug] [Thread-2  ]: Writing injected SQL for node "test.northwind_dbt.unique_dim_products_product_id.ef7b2a9985"
[0m23:46:02.505527 [debug] [Thread-2  ]: Began executing node test.northwind_dbt.unique_dim_products_product_id.ef7b2a9985
[0m23:46:02.520705 [debug] [Thread-2  ]: Writing runtime sql for node "test.northwind_dbt.unique_dim_products_product_id.ef7b2a9985"
[0m23:46:02.526433 [debug] [Thread-2  ]: Using snowflake connection "test.northwind_dbt.unique_dim_products_product_id.ef7b2a9985"
[0m23:46:02.526433 [debug] [Thread-2  ]: On test.northwind_dbt.unique_dim_products_product_id.ef7b2a9985: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "test.northwind_dbt.unique_dim_products_product_id.ef7b2a9985"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    product_id as unique_field,
    count(*) as n_records

from Project_2.public.dim_products
where product_id is not null
group by product_id
having count(*) > 1



      
    ) dbt_internal_test
[0m23:46:02.620492 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.188 seconds
[0m23:46:02.626450 [info ] [Thread-4  ]: 10 of 13 PASS not_null_obt_orders_product_id ................................... [[32mPASS[0m in 0.30s]
[0m23:46:02.627814 [debug] [Thread-4  ]: Finished running node test.northwind_dbt.not_null_obt_orders_product_id.caa3082c7f
[0m23:46:02.637760 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.173 seconds
[0m23:46:02.657956 [info ] [Thread-1  ]: 12 of 13 PASS unique_dim_employees_employee_key ................................ [[32mPASS[0m in 0.21s]
[0m23:46:02.659954 [debug] [Thread-1  ]: Finished running node test.northwind_dbt.unique_dim_employees_employee_key.3824d24782
[0m23:46:02.662955 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.189 seconds
[0m23:46:02.665001 [info ] [Thread-3  ]: 11 of 13 PASS unique_dim_customers_customer_id ................................. [[32mPASS[0m in 0.23s]
[0m23:46:02.667570 [debug] [Thread-3  ]: Finished running node test.northwind_dbt.unique_dim_customers_customer_id.15c9f1e2fd
[0m23:46:02.728724 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.199 seconds
[0m23:46:02.731724 [info ] [Thread-2  ]: 13 of 13 PASS unique_dim_products_product_id ................................... [[32mPASS[0m in 0.23s]
[0m23:46:02.733711 [debug] [Thread-2  ]: Finished running node test.northwind_dbt.unique_dim_products_product_id.ef7b2a9985
[0m23:46:02.735709 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:46:02.736731 [debug] [MainThread]: Connection 'list_Project_2_snapshots' was left open.
[0m23:46:02.737631 [debug] [MainThread]: On list_Project_2_snapshots: Close
[0m23:46:02.909887 [debug] [MainThread]: Connection 'list_Project_2_public' was left open.
[0m23:46:02.909887 [debug] [MainThread]: On list_Project_2_public: Close
[0m23:46:03.027282 [debug] [MainThread]: Connection 'test.northwind_dbt.unique_dim_employees_employee_key.3824d24782' was left open.
[0m23:46:03.027282 [debug] [MainThread]: On test.northwind_dbt.unique_dim_employees_employee_key.3824d24782: Close
[0m23:46:03.160851 [debug] [MainThread]: Connection 'test.northwind_dbt.unique_dim_products_product_id.ef7b2a9985' was left open.
[0m23:46:03.160851 [debug] [MainThread]: On test.northwind_dbt.unique_dim_products_product_id.ef7b2a9985: Close
[0m23:46:03.265491 [debug] [MainThread]: Connection 'test.northwind_dbt.unique_dim_customers_customer_id.15c9f1e2fd' was left open.
[0m23:46:03.265491 [debug] [MainThread]: On test.northwind_dbt.unique_dim_customers_customer_id.15c9f1e2fd: Close
[0m23:46:03.375443 [debug] [MainThread]: Connection 'test.northwind_dbt.not_null_obt_orders_product_id.caa3082c7f' was left open.
[0m23:46:03.375443 [debug] [MainThread]: On test.northwind_dbt.not_null_obt_orders_product_id.caa3082c7f: Close
[0m23:46:03.501440 [info ] [MainThread]: 
[0m23:46:03.502672 [info ] [MainThread]: Finished running 13 data tests in 0 hours 0 minutes and 2.98 seconds (2.98s).
[0m23:46:03.503615 [debug] [MainThread]: Command end result
[0m23:46:03.673033 [debug] [MainThread]: Wrote artifact WritableManifest to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\manifest.json
[0m23:46:03.680189 [debug] [MainThread]: Wrote artifact SemanticManifest to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\semantic_manifest.json
[0m23:46:03.690365 [debug] [MainThread]: Wrote artifact RunExecutionResult to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\run_results.json
[0m23:46:03.690365 [info ] [MainThread]: 
[0m23:46:03.690365 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:46:03.704435 [info ] [MainThread]: 
[0m23:46:03.704435 [info ] [MainThread]: Done. PASS=13 WARN=0 ERROR=0 SKIP=0 TOTAL=13
[0m23:46:03.704435 [debug] [MainThread]: Command `dbt test` succeeded at 23:46:03.704435 after 5.56 seconds
[0m23:46:03.704435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D866AF370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D886D41C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016DA184D100>]}
[0m23:46:03.704435 [debug] [MainThread]: Flushing usage events
[0m23:46:04.478844 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:33:06.003772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BA00B90340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BA02D20670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BA02D20E20>]}


============================== 19:33:06.011401 | 7bc3deda-f167-45ac-9cab-f84f675b7f9f ==============================
[0m19:33:06.011401 [info ] [MainThread]: Running with dbt=1.9.0
[0m19:33:06.013606 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'c:\\Users\\fitzp\\Documents\\Alpaca_Market\\zproject_2\\northwind_psql', 'debug': 'False', 'version_check': 'True', 'log_path': 'c:\\Users\\fitzp\\Documents\\Alpaca_Market\\zproject_2\\northwind_psql\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt test', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:33:07.942247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7bc3deda-f167-45ac-9cab-f84f675b7f9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BA7F377850>]}
[0m19:33:08.003732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7bc3deda-f167-45ac-9cab-f84f675b7f9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BA02D030A0>]}
[0m19:33:08.003732 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m19:33:08.414345 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m19:33:09.065823 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m19:33:09.066886 [debug] [MainThread]: Partial parsing: added file: northwind_dbt://models\marts\analysis\top_customer_revenue.sql
[0m19:33:09.067416 [debug] [MainThread]: Partial parsing: added file: northwind_dbt://models\marts\analysis\schema.yml
[0m19:33:09.394638 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.northwind_dbt.marts.bi
[0m19:33:09.409572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7bc3deda-f167-45ac-9cab-f84f675b7f9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BA1BFC5130>]}
[0m19:33:09.710393 [debug] [MainThread]: Wrote artifact WritableManifest to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\manifest.json
[0m19:33:09.710393 [debug] [MainThread]: Wrote artifact SemanticManifest to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\semantic_manifest.json
[0m19:33:09.805075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7bc3deda-f167-45ac-9cab-f84f675b7f9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BA1BE83850>]}
[0m19:33:09.805075 [info ] [MainThread]: Found 11 models, 1 snapshot, 13 data tests, 8 sources, 706 macros
[0m19:33:09.805075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7bc3deda-f167-45ac-9cab-f84f675b7f9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BA1BE83700>]}
[0m19:33:09.819976 [info ] [MainThread]: 
[0m19:33:09.821680 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:33:09.824699 [info ] [MainThread]: 
[0m19:33:09.827402 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:33:09.831284 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_Project_2_snapshots'
[0m19:33:09.831284 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_Project_2_public'
[0m19:33:10.041397 [debug] [ThreadPool]: Using snowflake connection "list_Project_2_snapshots"
[0m19:33:10.041397 [debug] [ThreadPool]: Using snowflake connection "list_Project_2_public"
[0m19:33:10.041397 [debug] [ThreadPool]: On list_Project_2_snapshots: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "connection_name": "list_Project_2_snapshots"} */
show objects in Project_2.snapshots limit 10000;
[0m19:33:10.045083 [debug] [ThreadPool]: On list_Project_2_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "connection_name": "list_Project_2_public"} */
show objects in Project_2.public limit 10000;
[0m19:33:10.047089 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:33:10.047089 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:33:13.665484 [debug] [ThreadPool]: SQL status: SUCCESS 24 in 3.617 seconds
[0m19:33:13.824603 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bbb185-020d-07b8-000c-83e7000b8012
[0m19:33:13.826796 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m19:33:13.826796 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m19:33:13.826796 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m19:33:13.828802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7bc3deda-f167-45ac-9cab-f84f675b7f9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BA1C0B9BB0>]}
[0m19:33:13.828802 [debug] [Thread-1  ]: Began running node test.northwind_dbt.not_null_dim_customers_customer_id.dd91cd1c8d
[0m19:33:13.828802 [debug] [Thread-2  ]: Began running node test.northwind_dbt.not_null_dim_employees_employee_key.232a183ffe
[0m19:33:13.828802 [debug] [Thread-3  ]: Began running node test.northwind_dbt.not_null_dim_products_product_id.c8aba288d1
[0m19:33:13.828802 [debug] [Thread-4  ]: Began running node test.northwind_dbt.not_null_fact_order_details_customer_id.6aaefe4888
[0m19:33:13.828802 [info ] [Thread-1  ]: 1 of 13 START test not_null_dim_customers_customer_id .......................... [RUN]
[0m19:33:13.828802 [info ] [Thread-2  ]: 2 of 13 START test not_null_dim_employees_employee_key ......................... [RUN]
[0m19:33:13.828802 [info ] [Thread-3  ]: 3 of 13 START test not_null_dim_products_product_id ............................ [RUN]
[0m19:33:13.828802 [info ] [Thread-4  ]: 4 of 13 START test not_null_fact_order_details_customer_id ..................... [RUN]
[0m19:33:13.828802 [debug] [Thread-1  ]: Acquiring new snowflake connection 'test.northwind_dbt.not_null_dim_customers_customer_id.dd91cd1c8d'
[0m19:33:13.828802 [debug] [Thread-2  ]: Acquiring new snowflake connection 'test.northwind_dbt.not_null_dim_employees_employee_key.232a183ffe'
[0m19:33:13.828802 [debug] [Thread-3  ]: Acquiring new snowflake connection 'test.northwind_dbt.not_null_dim_products_product_id.c8aba288d1'
[0m19:33:13.828802 [debug] [Thread-4  ]: Acquiring new snowflake connection 'test.northwind_dbt.not_null_fact_order_details_customer_id.6aaefe4888'
[0m19:33:13.828802 [debug] [Thread-1  ]: Began compiling node test.northwind_dbt.not_null_dim_customers_customer_id.dd91cd1c8d
[0m19:33:13.828802 [debug] [Thread-2  ]: Began compiling node test.northwind_dbt.not_null_dim_employees_employee_key.232a183ffe
[0m19:33:13.840928 [debug] [Thread-4  ]: Began compiling node test.northwind_dbt.not_null_fact_order_details_customer_id.6aaefe4888
[0m19:33:13.828802 [debug] [Thread-3  ]: Began compiling node test.northwind_dbt.not_null_dim_products_product_id.c8aba288d1
[0m19:33:13.853939 [debug] [Thread-1  ]: Writing injected SQL for node "test.northwind_dbt.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m19:33:13.932133 [debug] [Thread-2  ]: Writing injected SQL for node "test.northwind_dbt.not_null_dim_employees_employee_key.232a183ffe"
[0m19:33:13.936862 [debug] [Thread-4  ]: Writing injected SQL for node "test.northwind_dbt.not_null_fact_order_details_customer_id.6aaefe4888"
[0m19:33:13.936862 [debug] [Thread-3  ]: Writing injected SQL for node "test.northwind_dbt.not_null_dim_products_product_id.c8aba288d1"
[0m19:33:14.013807 [debug] [Thread-3  ]: Began executing node test.northwind_dbt.not_null_dim_products_product_id.c8aba288d1
[0m19:33:14.013807 [debug] [Thread-2  ]: Began executing node test.northwind_dbt.not_null_dim_employees_employee_key.232a183ffe
[0m19:33:14.029258 [debug] [Thread-1  ]: Began executing node test.northwind_dbt.not_null_dim_customers_customer_id.dd91cd1c8d
[0m19:33:14.029258 [debug] [Thread-4  ]: Began executing node test.northwind_dbt.not_null_fact_order_details_customer_id.6aaefe4888
[0m19:33:14.036244 [debug] [Thread-3  ]: Writing runtime sql for node "test.northwind_dbt.not_null_dim_products_product_id.c8aba288d1"
[0m19:33:14.036244 [debug] [Thread-2  ]: Writing runtime sql for node "test.northwind_dbt.not_null_dim_employees_employee_key.232a183ffe"
[0m19:33:14.042029 [debug] [Thread-1  ]: Writing runtime sql for node "test.northwind_dbt.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m19:33:14.044692 [debug] [Thread-4  ]: Writing runtime sql for node "test.northwind_dbt.not_null_fact_order_details_customer_id.6aaefe4888"
[0m19:33:14.076012 [debug] [Thread-3  ]: Using snowflake connection "test.northwind_dbt.not_null_dim_products_product_id.c8aba288d1"
[0m19:33:14.079979 [debug] [Thread-2  ]: Using snowflake connection "test.northwind_dbt.not_null_dim_employees_employee_key.232a183ffe"
[0m19:33:14.079979 [debug] [Thread-1  ]: Using snowflake connection "test.northwind_dbt.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m19:33:14.079979 [debug] [Thread-4  ]: Using snowflake connection "test.northwind_dbt.not_null_fact_order_details_customer_id.6aaefe4888"
[0m19:33:14.079979 [debug] [Thread-3  ]: On test.northwind_dbt.not_null_dim_products_product_id.c8aba288d1: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "test.northwind_dbt.not_null_dim_products_product_id.c8aba288d1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_id
from Project_2.public.dim_products
where product_id is null



      
    ) dbt_internal_test
[0m19:33:14.079979 [debug] [Thread-2  ]: On test.northwind_dbt.not_null_dim_employees_employee_key.232a183ffe: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "test.northwind_dbt.not_null_dim_employees_employee_key.232a183ffe"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select employee_key
from Project_2.public.dim_employees
where employee_key is null



      
    ) dbt_internal_test
[0m19:33:14.079979 [debug] [Thread-1  ]: On test.northwind_dbt.not_null_dim_customers_customer_id.dd91cd1c8d: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "test.northwind_dbt.not_null_dim_customers_customer_id.dd91cd1c8d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from Project_2.public.dim_customers
where customer_id is null



      
    ) dbt_internal_test
[0m19:33:14.079979 [debug] [Thread-4  ]: On test.northwind_dbt.not_null_fact_order_details_customer_id.6aaefe4888: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "test.northwind_dbt.not_null_fact_order_details_customer_id.6aaefe4888"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from Project_2.public.fact_order_details
where customer_id is null



      
    ) dbt_internal_test
[0m19:33:14.079979 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m19:33:14.079979 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m19:33:14.079979 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m19:33:14.079979 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m19:33:15.289442 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.203 seconds
[0m19:33:15.300277 [info ] [Thread-2  ]: 2 of 13 PASS not_null_dim_employees_employee_key ............................... [[32mPASS[0m in 1.47s]
[0m19:33:15.310123 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1.224 seconds
[0m19:33:15.310123 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1.224 seconds
[0m19:33:15.310123 [debug] [Thread-2  ]: Finished running node test.northwind_dbt.not_null_dim_employees_employee_key.232a183ffe
[0m19:33:15.310123 [info ] [Thread-3  ]: 3 of 13 PASS not_null_dim_products_product_id .................................. [[32mPASS[0m in 1.48s]
[0m19:33:15.318698 [info ] [Thread-4  ]: 4 of 13 PASS not_null_fact_order_details_customer_id ........................... [[32mPASS[0m in 1.48s]
[0m19:33:15.321049 [debug] [Thread-2  ]: Began running node test.northwind_dbt.not_null_fact_order_details_order_id.8d47c14c82
[0m19:33:15.322132 [debug] [Thread-3  ]: Finished running node test.northwind_dbt.not_null_dim_products_product_id.c8aba288d1
[0m19:33:15.322132 [debug] [Thread-4  ]: Finished running node test.northwind_dbt.not_null_fact_order_details_customer_id.6aaefe4888
[0m19:33:15.322132 [info ] [Thread-2  ]: 5 of 13 START test not_null_fact_order_details_order_id ........................ [RUN]
[0m19:33:15.322132 [debug] [Thread-3  ]: Began running node test.northwind_dbt.not_null_fact_order_details_product_id.85713db7b9
[0m19:33:15.322132 [debug] [Thread-4  ]: Began running node test.northwind_dbt.not_null_obt_orders_customer_id.1e3c4ae465
[0m19:33:15.322132 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.northwind_dbt.not_null_dim_employees_employee_key.232a183ffe, now test.northwind_dbt.not_null_fact_order_details_order_id.8d47c14c82)
[0m19:33:15.322132 [info ] [Thread-3  ]: 6 of 13 START test not_null_fact_order_details_product_id ...................... [RUN]
[0m19:33:15.322132 [debug] [Thread-2  ]: Began compiling node test.northwind_dbt.not_null_fact_order_details_order_id.8d47c14c82
[0m19:33:15.322132 [info ] [Thread-4  ]: 7 of 13 START test not_null_obt_orders_customer_id ............................. [RUN]
[0m19:33:15.322132 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.northwind_dbt.not_null_dim_products_product_id.c8aba288d1, now test.northwind_dbt.not_null_fact_order_details_product_id.85713db7b9)
[0m19:33:15.322132 [debug] [Thread-2  ]: Writing injected SQL for node "test.northwind_dbt.not_null_fact_order_details_order_id.8d47c14c82"
[0m19:33:15.322132 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.northwind_dbt.not_null_fact_order_details_customer_id.6aaefe4888, now test.northwind_dbt.not_null_obt_orders_customer_id.1e3c4ae465)
[0m19:33:15.337727 [debug] [Thread-3  ]: Began compiling node test.northwind_dbt.not_null_fact_order_details_product_id.85713db7b9
[0m19:33:15.339489 [debug] [Thread-4  ]: Began compiling node test.northwind_dbt.not_null_obt_orders_customer_id.1e3c4ae465
[0m19:33:15.344504 [debug] [Thread-3  ]: Writing injected SQL for node "test.northwind_dbt.not_null_fact_order_details_product_id.85713db7b9"
[0m19:33:15.346516 [debug] [Thread-4  ]: Writing injected SQL for node "test.northwind_dbt.not_null_obt_orders_customer_id.1e3c4ae465"
[0m19:33:15.355034 [debug] [Thread-2  ]: Began executing node test.northwind_dbt.not_null_fact_order_details_order_id.8d47c14c82
[0m19:33:15.355034 [debug] [Thread-2  ]: Writing runtime sql for node "test.northwind_dbt.not_null_fact_order_details_order_id.8d47c14c82"
[0m19:33:15.365224 [debug] [Thread-3  ]: Began executing node test.northwind_dbt.not_null_fact_order_details_product_id.85713db7b9
[0m19:33:15.372226 [debug] [Thread-3  ]: Writing runtime sql for node "test.northwind_dbt.not_null_fact_order_details_product_id.85713db7b9"
[0m19:33:15.372226 [debug] [Thread-4  ]: Began executing node test.northwind_dbt.not_null_obt_orders_customer_id.1e3c4ae465
[0m19:33:15.380383 [debug] [Thread-2  ]: Using snowflake connection "test.northwind_dbt.not_null_fact_order_details_order_id.8d47c14c82"
[0m19:33:15.380383 [debug] [Thread-4  ]: Writing runtime sql for node "test.northwind_dbt.not_null_obt_orders_customer_id.1e3c4ae465"
[0m19:33:15.380383 [debug] [Thread-2  ]: On test.northwind_dbt.not_null_fact_order_details_order_id.8d47c14c82: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "test.northwind_dbt.not_null_fact_order_details_order_id.8d47c14c82"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from Project_2.public.fact_order_details
where order_id is null



      
    ) dbt_internal_test
[0m19:33:15.387922 [debug] [Thread-3  ]: Using snowflake connection "test.northwind_dbt.not_null_fact_order_details_product_id.85713db7b9"
[0m19:33:15.388292 [debug] [Thread-3  ]: On test.northwind_dbt.not_null_fact_order_details_product_id.85713db7b9: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "test.northwind_dbt.not_null_fact_order_details_product_id.85713db7b9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_id
from Project_2.public.fact_order_details
where product_id is null



      
    ) dbt_internal_test
[0m19:33:15.395298 [debug] [Thread-4  ]: Using snowflake connection "test.northwind_dbt.not_null_obt_orders_customer_id.1e3c4ae465"
[0m19:33:15.395298 [debug] [Thread-4  ]: On test.northwind_dbt.not_null_obt_orders_customer_id.1e3c4ae465: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "test.northwind_dbt.not_null_obt_orders_customer_id.1e3c4ae465"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from Project_2.public.obt_orders
where customer_id is null



      
    ) dbt_internal_test
[0m19:33:15.435803 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.349 seconds
[0m19:33:15.437978 [info ] [Thread-1  ]: 1 of 13 PASS not_null_dim_customers_customer_id ................................ [[32mPASS[0m in 1.61s]
[0m19:33:15.439978 [debug] [Thread-1  ]: Finished running node test.northwind_dbt.not_null_dim_customers_customer_id.dd91cd1c8d
[0m19:33:15.439978 [debug] [Thread-1  ]: Began running node test.northwind_dbt.not_null_obt_orders_order_date.5632203db3
[0m19:33:15.440978 [info ] [Thread-1  ]: 8 of 13 START test not_null_obt_orders_order_date .............................. [RUN]
[0m19:33:15.442989 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.northwind_dbt.not_null_dim_customers_customer_id.dd91cd1c8d, now test.northwind_dbt.not_null_obt_orders_order_date.5632203db3)
[0m19:33:15.444007 [debug] [Thread-1  ]: Began compiling node test.northwind_dbt.not_null_obt_orders_order_date.5632203db3
[0m19:33:15.450996 [debug] [Thread-1  ]: Writing injected SQL for node "test.northwind_dbt.not_null_obt_orders_order_date.5632203db3"
[0m19:33:15.464348 [debug] [Thread-1  ]: Began executing node test.northwind_dbt.not_null_obt_orders_order_date.5632203db3
[0m19:33:15.468016 [debug] [Thread-1  ]: Writing runtime sql for node "test.northwind_dbt.not_null_obt_orders_order_date.5632203db3"
[0m19:33:15.472870 [debug] [Thread-1  ]: Using snowflake connection "test.northwind_dbt.not_null_obt_orders_order_date.5632203db3"
[0m19:33:15.472870 [debug] [Thread-1  ]: On test.northwind_dbt.not_null_obt_orders_order_date.5632203db3: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "test.northwind_dbt.not_null_obt_orders_order_date.5632203db3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_date
from Project_2.public.obt_orders
where order_date is null



      
    ) dbt_internal_test
[0m19:33:15.567784 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.170 seconds
[0m19:33:15.572812 [info ] [Thread-4  ]: 7 of 13 PASS not_null_obt_orders_customer_id ................................... [[32mPASS[0m in 0.25s]
[0m19:33:15.574815 [debug] [Thread-4  ]: Finished running node test.northwind_dbt.not_null_obt_orders_customer_id.1e3c4ae465
[0m19:33:15.575810 [debug] [Thread-4  ]: Began running node test.northwind_dbt.not_null_obt_orders_order_id.218f605f9c
[0m19:33:15.576809 [info ] [Thread-4  ]: 9 of 13 START test not_null_obt_orders_order_id ................................ [RUN]
[0m19:33:15.578802 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.northwind_dbt.not_null_obt_orders_customer_id.1e3c4ae465, now test.northwind_dbt.not_null_obt_orders_order_id.218f605f9c)
[0m19:33:15.581233 [debug] [Thread-4  ]: Began compiling node test.northwind_dbt.not_null_obt_orders_order_id.218f605f9c
[0m19:33:15.587845 [debug] [Thread-4  ]: Writing injected SQL for node "test.northwind_dbt.not_null_obt_orders_order_id.218f605f9c"
[0m19:33:15.588770 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.200 seconds
[0m19:33:15.588770 [info ] [Thread-3  ]: 6 of 13 PASS not_null_fact_order_details_product_id ............................ [[32mPASS[0m in 0.27s]
[0m19:33:15.594003 [debug] [Thread-3  ]: Finished running node test.northwind_dbt.not_null_fact_order_details_product_id.85713db7b9
[0m19:33:15.596010 [debug] [Thread-3  ]: Began running node test.northwind_dbt.not_null_obt_orders_product_id.caa3082c7f
[0m19:33:15.596010 [info ] [Thread-3  ]: 10 of 13 START test not_null_obt_orders_product_id ............................. [RUN]
[0m19:33:15.596010 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.northwind_dbt.not_null_fact_order_details_product_id.85713db7b9, now test.northwind_dbt.not_null_obt_orders_product_id.caa3082c7f)
[0m19:33:15.599816 [debug] [Thread-3  ]: Began compiling node test.northwind_dbt.not_null_obt_orders_product_id.caa3082c7f
[0m19:33:15.606003 [debug] [Thread-3  ]: Writing injected SQL for node "test.northwind_dbt.not_null_obt_orders_product_id.caa3082c7f"
[0m19:33:15.606003 [debug] [Thread-4  ]: Began executing node test.northwind_dbt.not_null_obt_orders_order_id.218f605f9c
[0m19:33:15.609900 [debug] [Thread-4  ]: Writing runtime sql for node "test.northwind_dbt.not_null_obt_orders_order_id.218f605f9c"
[0m19:33:15.628111 [debug] [Thread-3  ]: Began executing node test.northwind_dbt.not_null_obt_orders_product_id.caa3082c7f
[0m19:33:15.631228 [debug] [Thread-4  ]: Using snowflake connection "test.northwind_dbt.not_null_obt_orders_order_id.218f605f9c"
[0m19:33:15.634143 [debug] [Thread-3  ]: Writing runtime sql for node "test.northwind_dbt.not_null_obt_orders_product_id.caa3082c7f"
[0m19:33:15.634143 [debug] [Thread-4  ]: On test.northwind_dbt.not_null_obt_orders_order_id.218f605f9c: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "test.northwind_dbt.not_null_obt_orders_order_id.218f605f9c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from Project_2.public.obt_orders
where order_id is null



      
    ) dbt_internal_test
[0m19:33:15.646165 [debug] [Thread-3  ]: Using snowflake connection "test.northwind_dbt.not_null_obt_orders_product_id.caa3082c7f"
[0m19:33:15.651840 [debug] [Thread-3  ]: On test.northwind_dbt.not_null_obt_orders_product_id.caa3082c7f: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "test.northwind_dbt.not_null_obt_orders_product_id.caa3082c7f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_id
from Project_2.public.obt_orders
where product_id is null



      
    ) dbt_internal_test
[0m19:33:15.766686 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.382 seconds
[0m19:33:15.771564 [info ] [Thread-2  ]: 5 of 13 PASS not_null_fact_order_details_order_id .............................. [[32mPASS[0m in 0.45s]
[0m19:33:15.775134 [debug] [Thread-2  ]: Finished running node test.northwind_dbt.not_null_fact_order_details_order_id.8d47c14c82
[0m19:33:15.777370 [debug] [Thread-2  ]: Began running node test.northwind_dbt.unique_dim_customers_customer_id.15c9f1e2fd
[0m19:33:15.779376 [info ] [Thread-2  ]: 11 of 13 START test unique_dim_customers_customer_id ........................... [RUN]
[0m19:33:15.782298 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.northwind_dbt.not_null_fact_order_details_order_id.8d47c14c82, now test.northwind_dbt.unique_dim_customers_customer_id.15c9f1e2fd)
[0m19:33:15.784164 [debug] [Thread-2  ]: Began compiling node test.northwind_dbt.unique_dim_customers_customer_id.15c9f1e2fd
[0m19:33:15.800775 [debug] [Thread-2  ]: Writing injected SQL for node "test.northwind_dbt.unique_dim_customers_customer_id.15c9f1e2fd"
[0m19:33:15.810897 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.158 seconds
[0m19:33:15.816232 [info ] [Thread-3  ]: 10 of 13 PASS not_null_obt_orders_product_id ................................... [[32mPASS[0m in 0.22s]
[0m19:33:15.819459 [debug] [Thread-3  ]: Finished running node test.northwind_dbt.not_null_obt_orders_product_id.caa3082c7f
[0m19:33:15.822016 [debug] [Thread-3  ]: Began running node test.northwind_dbt.unique_dim_employees_employee_key.3824d24782
[0m19:33:15.824261 [debug] [Thread-2  ]: Began executing node test.northwind_dbt.unique_dim_customers_customer_id.15c9f1e2fd
[0m19:33:15.836506 [debug] [Thread-2  ]: Writing runtime sql for node "test.northwind_dbt.unique_dim_customers_customer_id.15c9f1e2fd"
[0m19:33:15.826300 [info ] [Thread-3  ]: 12 of 13 START test unique_dim_employees_employee_key .......................... [RUN]
[0m19:33:15.840399 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.northwind_dbt.not_null_obt_orders_product_id.caa3082c7f, now test.northwind_dbt.unique_dim_employees_employee_key.3824d24782)
[0m19:33:15.843217 [debug] [Thread-3  ]: Began compiling node test.northwind_dbt.unique_dim_employees_employee_key.3824d24782
[0m19:33:15.856849 [debug] [Thread-3  ]: Writing injected SQL for node "test.northwind_dbt.unique_dim_employees_employee_key.3824d24782"
[0m19:33:15.861212 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.223 seconds
[0m19:33:15.870858 [debug] [Thread-2  ]: Using snowflake connection "test.northwind_dbt.unique_dim_customers_customer_id.15c9f1e2fd"
[0m19:33:15.868118 [info ] [Thread-4  ]: 9 of 13 PASS not_null_obt_orders_order_id ...................................... [[32mPASS[0m in 0.29s]
[0m19:33:15.874303 [debug] [Thread-2  ]: On test.northwind_dbt.unique_dim_customers_customer_id.15c9f1e2fd: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "test.northwind_dbt.unique_dim_customers_customer_id.15c9f1e2fd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from Project_2.public.dim_customers
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m19:33:15.876581 [debug] [Thread-4  ]: Finished running node test.northwind_dbt.not_null_obt_orders_order_id.218f605f9c
[0m19:33:15.879813 [debug] [Thread-3  ]: Began executing node test.northwind_dbt.unique_dim_employees_employee_key.3824d24782
[0m19:33:15.880884 [debug] [Thread-4  ]: Began running node test.northwind_dbt.unique_dim_products_product_id.ef7b2a9985
[0m19:33:15.890038 [debug] [Thread-3  ]: Writing runtime sql for node "test.northwind_dbt.unique_dim_employees_employee_key.3824d24782"
[0m19:33:15.892804 [info ] [Thread-4  ]: 13 of 13 START test unique_dim_products_product_id ............................. [RUN]
[0m19:33:15.894943 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.northwind_dbt.not_null_obt_orders_order_id.218f605f9c, now test.northwind_dbt.unique_dim_products_product_id.ef7b2a9985)
[0m19:33:15.896035 [debug] [Thread-4  ]: Began compiling node test.northwind_dbt.unique_dim_products_product_id.ef7b2a9985
[0m19:33:15.901401 [debug] [Thread-4  ]: Writing injected SQL for node "test.northwind_dbt.unique_dim_products_product_id.ef7b2a9985"
[0m19:33:15.909457 [debug] [Thread-3  ]: Using snowflake connection "test.northwind_dbt.unique_dim_employees_employee_key.3824d24782"
[0m19:33:15.910567 [debug] [Thread-3  ]: On test.northwind_dbt.unique_dim_employees_employee_key.3824d24782: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "test.northwind_dbt.unique_dim_employees_employee_key.3824d24782"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    employee_key as unique_field,
    count(*) as n_records

from Project_2.public.dim_employees
where employee_key is not null
group by employee_key
having count(*) > 1



      
    ) dbt_internal_test
[0m19:33:15.915622 [debug] [Thread-4  ]: Began executing node test.northwind_dbt.unique_dim_products_product_id.ef7b2a9985
[0m19:33:15.920854 [debug] [Thread-4  ]: Writing runtime sql for node "test.northwind_dbt.unique_dim_products_product_id.ef7b2a9985"
[0m19:33:15.933602 [debug] [Thread-4  ]: Using snowflake connection "test.northwind_dbt.unique_dim_products_product_id.ef7b2a9985"
[0m19:33:15.935692 [debug] [Thread-4  ]: On test.northwind_dbt.unique_dim_products_product_id.ef7b2a9985: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "test.northwind_dbt.unique_dim_products_product_id.ef7b2a9985"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    product_id as unique_field,
    count(*) as n_records

from Project_2.public.dim_products
where product_id is not null
group by product_id
having count(*) > 1



      
    ) dbt_internal_test
[0m19:33:15.946370 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.460 seconds
[0m19:33:15.948983 [info ] [Thread-1  ]: 8 of 13 PASS not_null_obt_orders_order_date .................................... [[32mPASS[0m in 0.51s]
[0m19:33:15.951729 [debug] [Thread-1  ]: Finished running node test.northwind_dbt.not_null_obt_orders_order_date.5632203db3
[0m19:33:16.103503 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.227 seconds
[0m19:33:16.105833 [info ] [Thread-2  ]: 11 of 13 PASS unique_dim_customers_customer_id ................................. [[32mPASS[0m in 0.32s]
[0m19:33:16.108945 [debug] [Thread-2  ]: Finished running node test.northwind_dbt.unique_dim_customers_customer_id.15c9f1e2fd
[0m19:33:16.235478 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.326 seconds
[0m19:33:16.240219 [info ] [Thread-3  ]: 12 of 13 PASS unique_dim_employees_employee_key ................................ [[32mPASS[0m in 0.40s]
[0m19:33:16.240219 [debug] [Thread-3  ]: Finished running node test.northwind_dbt.unique_dim_employees_employee_key.3824d24782
[0m19:33:16.283939 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.347 seconds
[0m19:33:16.286818 [info ] [Thread-4  ]: 13 of 13 PASS unique_dim_products_product_id ................................... [[32mPASS[0m in 0.39s]
[0m19:33:16.288835 [debug] [Thread-4  ]: Finished running node test.northwind_dbt.unique_dim_products_product_id.ef7b2a9985
[0m19:33:16.291515 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:33:16.292588 [debug] [MainThread]: Connection 'list_Project_2_snapshots' was left open.
[0m19:33:16.293643 [debug] [MainThread]: On list_Project_2_snapshots: Close
[0m19:33:16.435162 [debug] [MainThread]: Connection 'list_Project_2_public' was left open.
[0m19:33:16.435162 [debug] [MainThread]: On list_Project_2_public: Close
[0m19:33:16.544868 [debug] [MainThread]: Connection 'test.northwind_dbt.not_null_obt_orders_order_date.5632203db3' was left open.
[0m19:33:16.544868 [debug] [MainThread]: On test.northwind_dbt.not_null_obt_orders_order_date.5632203db3: Close
[0m19:33:16.671048 [debug] [MainThread]: Connection 'test.northwind_dbt.unique_dim_customers_customer_id.15c9f1e2fd' was left open.
[0m19:33:16.671048 [debug] [MainThread]: On test.northwind_dbt.unique_dim_customers_customer_id.15c9f1e2fd: Close
[0m19:33:16.782086 [debug] [MainThread]: Connection 'test.northwind_dbt.unique_dim_employees_employee_key.3824d24782' was left open.
[0m19:33:16.784402 [debug] [MainThread]: On test.northwind_dbt.unique_dim_employees_employee_key.3824d24782: Close
[0m19:33:16.904924 [debug] [MainThread]: Connection 'test.northwind_dbt.unique_dim_products_product_id.ef7b2a9985' was left open.
[0m19:33:16.904924 [debug] [MainThread]: On test.northwind_dbt.unique_dim_products_product_id.ef7b2a9985: Close
[0m19:33:17.045916 [info ] [MainThread]: 
[0m19:33:17.046927 [info ] [MainThread]: Finished running 13 data tests in 0 hours 0 minutes and 7.22 seconds (7.22s).
[0m19:33:17.051482 [debug] [MainThread]: Command end result
[0m19:33:17.224811 [debug] [MainThread]: Wrote artifact WritableManifest to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\manifest.json
[0m19:33:17.234589 [debug] [MainThread]: Wrote artifact SemanticManifest to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\semantic_manifest.json
[0m19:33:17.249859 [debug] [MainThread]: Wrote artifact RunExecutionResult to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\run_results.json
[0m19:33:17.249859 [info ] [MainThread]: 
[0m19:33:17.249859 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:33:17.249859 [info ] [MainThread]: 
[0m19:33:17.249859 [info ] [MainThread]: Done. PASS=13 WARN=0 ERROR=0 SKIP=0 TOTAL=13
[0m19:33:17.249859 [debug] [MainThread]: Command `dbt test` succeeded at 19:33:17.249859 after 11.39 seconds
[0m19:33:17.249859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BA00B90340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BA1C0B99A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BA02CE7610>]}
[0m19:33:17.259986 [debug] [MainThread]: Flushing usage events
[0m19:33:18.078049 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:33:38.590943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3F52F0280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3F7363B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3F7363940>]}


============================== 19:33:38.602174 | 3330d23d-e653-411b-be07-423993c93077 ==============================
[0m19:33:38.602174 [info ] [MainThread]: Running with dbt=1.9.0
[0m19:33:38.602174 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'c:\\Users\\fitzp\\Documents\\Alpaca_Market\\zproject_2\\northwind_psql', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'c:\\Users\\fitzp\\Documents\\Alpaca_Market\\zproject_2\\northwind_psql\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m19:33:39.750420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3330d23d-e653-411b-be07-423993c93077', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B38FEB95E0>]}
[0m19:33:39.852207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3330d23d-e653-411b-be07-423993c93077', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B38FE029A0>]}
[0m19:33:39.854444 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m19:33:40.496425 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m19:33:40.992067 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:33:40.992067 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:33:41.001344 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.northwind_dbt.marts.bi
[0m19:33:41.076577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3330d23d-e653-411b-be07-423993c93077', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B39046DEE0>]}
[0m19:33:41.354219 [debug] [MainThread]: Wrote artifact WritableManifest to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\manifest.json
[0m19:33:41.359282 [debug] [MainThread]: Wrote artifact SemanticManifest to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\semantic_manifest.json
[0m19:33:41.514246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3330d23d-e653-411b-be07-423993c93077', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B38FE356A0>]}
[0m19:33:41.514246 [info ] [MainThread]: Found 11 models, 1 snapshot, 13 data tests, 8 sources, 706 macros
[0m19:33:41.514246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3330d23d-e653-411b-be07-423993c93077', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B38FE6CF70>]}
[0m19:33:41.514246 [info ] [MainThread]: 
[0m19:33:41.514246 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:33:41.514246 [info ] [MainThread]: 
[0m19:33:41.514246 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:33:41.527298 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_Project_2'
[0m19:33:41.632707 [debug] [ThreadPool]: Using snowflake connection "list_Project_2"
[0m19:33:41.632707 [debug] [ThreadPool]: On list_Project_2: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "connection_name": "list_Project_2"} */
show terse schemas in database Project_2
    limit 10000
[0m19:33:41.632707 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:33:42.448922 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.814 seconds
[0m19:33:42.451590 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_Project_2_public'
[0m19:33:42.451590 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_Project_2_snapshots'
[0m19:33:42.461691 [debug] [ThreadPool]: Using snowflake connection "list_Project_2_public"
[0m19:33:42.464971 [debug] [ThreadPool]: Using snowflake connection "list_Project_2_snapshots"
[0m19:33:42.466981 [debug] [ThreadPool]: On list_Project_2_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "connection_name": "list_Project_2_public"} */
show objects in Project_2.public limit 10000;
[0m19:33:42.466981 [debug] [ThreadPool]: On list_Project_2_snapshots: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "connection_name": "list_Project_2_snapshots"} */
show objects in Project_2.snapshots limit 10000;
[0m19:33:42.466981 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:33:42.466981 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:33:42.914562 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bbb185-020d-03e4-000c-83e7000ba022
[0m19:33:42.930144 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m19:33:42.930782 [debug] [ThreadPool]: SQL status: SUCCESS 24 in 0.464 seconds
[0m19:33:42.930782 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m19:33:42.937204 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m19:33:42.937204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3330d23d-e653-411b-be07-423993c93077', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3F44E4FA0>]}
[0m19:33:42.937204 [debug] [Thread-1  ]: Began running node model.northwind_dbt.stg_customers
[0m19:33:42.937204 [debug] [Thread-2  ]: Began running node model.northwind_dbt.stg_employees
[0m19:33:42.945787 [debug] [Thread-4  ]: Began running node model.northwind_dbt.stg_orders
[0m19:33:42.945787 [debug] [Thread-3  ]: Began running node model.northwind_dbt.stg_order_details
[0m19:33:42.945787 [info ] [Thread-1  ]: 1 of 11 START sql view model public.stg_customers .............................. [RUN]
[0m19:33:42.945787 [info ] [Thread-2  ]: 2 of 11 START sql view model public.stg_employees .............................. [RUN]
[0m19:33:42.945787 [info ] [Thread-4  ]: 4 of 11 START sql view model public.stg_orders ................................. [RUN]
[0m19:33:42.945787 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.northwind_dbt.stg_customers'
[0m19:33:42.945787 [info ] [Thread-3  ]: 3 of 11 START sql view model public.stg_order_details .......................... [RUN]
[0m19:33:42.945787 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.northwind_dbt.stg_employees'
[0m19:33:42.945787 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.northwind_dbt.stg_orders'
[0m19:33:42.945787 [debug] [Thread-1  ]: Began compiling node model.northwind_dbt.stg_customers
[0m19:33:42.945787 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.northwind_dbt.stg_order_details'
[0m19:33:42.945787 [debug] [Thread-2  ]: Began compiling node model.northwind_dbt.stg_employees
[0m19:33:42.945787 [debug] [Thread-4  ]: Began compiling node model.northwind_dbt.stg_orders
[0m19:33:42.964438 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind_dbt.stg_customers"
[0m19:33:42.964438 [debug] [Thread-3  ]: Began compiling node model.northwind_dbt.stg_order_details
[0m19:33:42.969431 [debug] [Thread-2  ]: Writing injected SQL for node "model.northwind_dbt.stg_employees"
[0m19:33:42.969431 [debug] [Thread-4  ]: Writing injected SQL for node "model.northwind_dbt.stg_orders"
[0m19:33:42.969431 [debug] [Thread-3  ]: Writing injected SQL for node "model.northwind_dbt.stg_order_details"
[0m19:33:42.998110 [debug] [Thread-3  ]: Began executing node model.northwind_dbt.stg_order_details
[0m19:33:42.998110 [debug] [Thread-2  ]: Began executing node model.northwind_dbt.stg_employees
[0m19:33:42.998110 [debug] [Thread-1  ]: Began executing node model.northwind_dbt.stg_customers
[0m19:33:42.998110 [debug] [Thread-4  ]: Began executing node model.northwind_dbt.stg_orders
[0m19:33:43.027459 [debug] [Thread-3  ]: Writing runtime sql for node "model.northwind_dbt.stg_order_details"
[0m19:33:43.032563 [debug] [Thread-2  ]: Writing runtime sql for node "model.northwind_dbt.stg_employees"
[0m19:33:43.036573 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind_dbt.stg_customers"
[0m19:33:43.042572 [debug] [Thread-4  ]: Writing runtime sql for node "model.northwind_dbt.stg_orders"
[0m19:33:43.064003 [debug] [Thread-4  ]: Using snowflake connection "model.northwind_dbt.stg_orders"
[0m19:33:43.064003 [debug] [Thread-4  ]: On model.northwind_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.stg_orders"} */
create or replace   view Project_2.public.stg_orders
  
   as (
    select * from PROJECT_2.PUBLIC.orders
  );
[0m19:33:43.071529 [debug] [Thread-3  ]: Using snowflake connection "model.northwind_dbt.stg_order_details"
[0m19:33:43.071529 [debug] [Thread-1  ]: Using snowflake connection "model.northwind_dbt.stg_customers"
[0m19:33:43.071529 [debug] [Thread-2  ]: Using snowflake connection "model.northwind_dbt.stg_employees"
[0m19:33:43.071529 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m19:33:43.078354 [debug] [Thread-3  ]: On model.northwind_dbt.stg_order_details: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.stg_order_details"} */
create or replace   view Project_2.public.stg_order_details
  
   as (
    select * from PROJECT_2.PUBLIC.order_details
  );
[0m19:33:43.078354 [debug] [Thread-1  ]: On model.northwind_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.stg_customers"} */
create or replace   view Project_2.public.stg_customers
  
   as (
    select * from PROJECT_2.PUBLIC.customers
  );
[0m19:33:43.078354 [debug] [Thread-2  ]: On model.northwind_dbt.stg_employees: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.stg_employees"} */
create or replace   view Project_2.public.stg_employees
  
   as (
    select * from PROJECT_2.PUBLIC.employees
  );
[0m19:33:43.082382 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m19:33:43.082382 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m19:33:43.087083 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m19:33:43.876074 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.799 seconds
[0m19:33:43.901751 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3330d23d-e653-411b-be07-423993c93077', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B38FDFB490>]}
[0m19:33:43.901751 [info ] [Thread-3  ]: 3 of 11 OK created sql view model public.stg_order_details ..................... [[32mSUCCESS 1[0m in 0.95s]
[0m19:33:43.901751 [debug] [Thread-3  ]: Finished running node model.northwind_dbt.stg_order_details
[0m19:33:43.901751 [debug] [Thread-3  ]: Began running node model.northwind_dbt.stg_products
[0m19:33:43.901751 [info ] [Thread-3  ]: 5 of 11 START sql view model public.stg_products ............................... [RUN]
[0m19:33:43.907489 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.northwind_dbt.stg_order_details, now model.northwind_dbt.stg_products)
[0m19:33:43.907489 [debug] [Thread-3  ]: Began compiling node model.northwind_dbt.stg_products
[0m19:33:43.911175 [debug] [Thread-3  ]: Writing injected SQL for node "model.northwind_dbt.stg_products"
[0m19:33:43.925637 [debug] [Thread-3  ]: Began executing node model.northwind_dbt.stg_products
[0m19:33:43.935413 [debug] [Thread-3  ]: Writing runtime sql for node "model.northwind_dbt.stg_products"
[0m19:33:43.935413 [debug] [Thread-3  ]: Using snowflake connection "model.northwind_dbt.stg_products"
[0m19:33:43.935413 [debug] [Thread-3  ]: On model.northwind_dbt.stg_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.stg_products"} */
create or replace   view Project_2.public.stg_products
  
   as (
    select * from PROJECT_2.PUBLIC.products
  );
[0m19:33:44.002922 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.918 seconds
[0m19:33:44.006511 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3330d23d-e653-411b-be07-423993c93077', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B390D1ECA0>]}
[0m19:33:44.007682 [info ] [Thread-1  ]: 1 of 11 OK created sql view model public.stg_customers ......................... [[32mSUCCESS 1[0m in 1.06s]
[0m19:33:44.008911 [debug] [Thread-1  ]: Finished running node model.northwind_dbt.stg_customers
[0m19:33:44.009496 [debug] [Thread-1  ]: Began running node model.northwind_dbt.dim_customers
[0m19:33:44.010652 [info ] [Thread-1  ]: 6 of 11 START sql table model public.dim_customers ............................. [RUN]
[0m19:33:44.011161 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.northwind_dbt.stg_customers, now model.northwind_dbt.dim_customers)
[0m19:33:44.012166 [debug] [Thread-1  ]: Began compiling node model.northwind_dbt.dim_customers
[0m19:33:44.015165 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind_dbt.dim_customers"
[0m19:33:44.028184 [debug] [Thread-1  ]: Began executing node model.northwind_dbt.dim_customers
[0m19:33:44.034826 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind_dbt.dim_customers"
[0m19:33:44.052517 [debug] [Thread-1  ]: Using snowflake connection "model.northwind_dbt.dim_customers"
[0m19:33:44.052517 [debug] [Thread-1  ]: On model.northwind_dbt.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.dim_customers"} */
create or replace transient table Project_2.public.dim_customers
         as
        (select * from Project_2.public.stg_customers
        );
[0m19:33:44.067378 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.995 seconds
[0m19:33:44.072241 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3330d23d-e653-411b-be07-423993c93077', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B390ABB130>]}
[0m19:33:44.072241 [info ] [Thread-4  ]: 4 of 11 OK created sql view model public.stg_orders ............................ [[32mSUCCESS 1[0m in 1.13s]
[0m19:33:44.072241 [debug] [Thread-4  ]: Finished running node model.northwind_dbt.stg_orders
[0m19:33:44.072241 [debug] [Thread-4  ]: Began running node model.northwind_dbt.fact_order_details
[0m19:33:44.072241 [info ] [Thread-4  ]: 7 of 11 START sql incremental model public.fact_order_details .................. [RUN]
[0m19:33:44.072241 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.northwind_dbt.stg_orders, now model.northwind_dbt.fact_order_details)
[0m19:33:44.072241 [debug] [Thread-4  ]: Began compiling node model.northwind_dbt.fact_order_details
[0m19:33:44.086021 [debug] [Thread-4  ]: Writing injected SQL for node "model.northwind_dbt.fact_order_details"
[0m19:33:44.093368 [debug] [Thread-4  ]: Began executing node model.northwind_dbt.fact_order_details
[0m19:33:44.118242 [debug] [Thread-4  ]: Using snowflake connection "model.northwind_dbt.fact_order_details"
[0m19:33:44.118242 [debug] [Thread-4  ]: On model.northwind_dbt.fact_order_details: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.fact_order_details"} */
create or replace  temporary view Project_2.public.fact_order_details__dbt_tmp
  
   as (
    

with base as (
    select 
        od.order_id,
        od.product_id,
        o.customer_id,
        o.employee_id,
        o.ship_via as shipper_id,
        o.order_date,
        od.unit_price,
        od.quantity,
        od.discount,
        od.unit_price * od.quantity * (1 - od.discount) as revenue
    from Project_2.public.stg_order_details od
    join Project_2.public.stg_orders o on od.order_id = o.order_id
    
        and o.order_date >= (select max(order_date) from Project_2.public.fact_order_details)
    
),
aggregated as (
    select 
        order_id,
        product_id,
        customer_id,
        employee_id,
        shipper_id,
        cast(order_date as date) as order_date,
        sum(revenue) as total_revenue,
        avg(revenue) as avg_revenue,
        max(revenue) as max_revenue,
        min(revenue) as min_revenue,
        count(*) as line_count,
        rank() over (partition by customer_id order by sum(revenue) desc) as revenue_rank
    from base
    group by order_id, product_id, customer_id, employee_id, shipper_id, order_date
)
select * from aggregated
  );
[0m19:33:44.236604 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.150 seconds
[0m19:33:44.243374 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3330d23d-e653-411b-be07-423993c93077', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B390B74460>]}
[0m19:33:44.243374 [info ] [Thread-2  ]: 2 of 11 OK created sql view model public.stg_employees ......................... [[32mSUCCESS 1[0m in 1.30s]
[0m19:33:44.243374 [debug] [Thread-2  ]: Finished running node model.northwind_dbt.stg_employees
[0m19:33:44.243374 [debug] [Thread-2  ]: Began running node model.northwind_dbt.dim_employees
[0m19:33:44.243374 [info ] [Thread-2  ]: 8 of 11 START sql table model public.dim_employees ............................. [RUN]
[0m19:33:44.248476 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.northwind_dbt.stg_employees, now model.northwind_dbt.dim_employees)
[0m19:33:44.248476 [debug] [Thread-2  ]: Began compiling node model.northwind_dbt.dim_employees
[0m19:33:44.260363 [debug] [Thread-2  ]: Writing injected SQL for node "model.northwind_dbt.dim_employees"
[0m19:33:44.272121 [debug] [Thread-2  ]: Began executing node model.northwind_dbt.dim_employees
[0m19:33:44.276121 [debug] [Thread-2  ]: Writing runtime sql for node "model.northwind_dbt.dim_employees"
[0m19:33:44.285744 [debug] [Thread-2  ]: Using snowflake connection "model.northwind_dbt.dim_employees"
[0m19:33:44.285744 [debug] [Thread-2  ]: On model.northwind_dbt.dim_employees: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.dim_employees"} */
create or replace transient table Project_2.public.dim_employees
         as
        (with source_data as (
    select * from Project_2.public.stg_employees
),
scd2 as (
    select 
        md5(cast(coalesce(cast(employee_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as employee_key,
        *,
        current_timestamp as dbt_updated_at
    from source_data
)
select * from scd2
        );
[0m19:33:44.463858 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.518 seconds
[0m19:33:44.463858 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3330d23d-e653-411b-be07-423993c93077', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B38FDFB490>]}
[0m19:33:44.463858 [info ] [Thread-3  ]: 5 of 11 OK created sql view model public.stg_products .......................... [[32mSUCCESS 1[0m in 0.56s]
[0m19:33:44.463858 [debug] [Thread-3  ]: Finished running node model.northwind_dbt.stg_products
[0m19:33:44.463858 [debug] [Thread-3  ]: Began running node model.northwind_dbt.dim_products
[0m19:33:44.463858 [info ] [Thread-3  ]: 9 of 11 START sql table model public.dim_products .............................. [RUN]
[0m19:33:44.463858 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.northwind_dbt.stg_products, now model.northwind_dbt.dim_products)
[0m19:33:44.477012 [debug] [Thread-3  ]: Began compiling node model.northwind_dbt.dim_products
[0m19:33:44.481689 [debug] [Thread-3  ]: Writing injected SQL for node "model.northwind_dbt.dim_products"
[0m19:33:44.492892 [debug] [Thread-3  ]: Began executing node model.northwind_dbt.dim_products
[0m19:33:44.494457 [debug] [Thread-3  ]: Writing runtime sql for node "model.northwind_dbt.dim_products"
[0m19:33:44.511962 [debug] [Thread-3  ]: Using snowflake connection "model.northwind_dbt.dim_products"
[0m19:33:44.511962 [debug] [Thread-3  ]: On model.northwind_dbt.dim_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.dim_products"} */
create or replace transient table Project_2.public.dim_products
         as
        (select 
    p.product_id,
    p.product_name,
    p.supplier_id,
    s.company_name as supplier_name,
    p.category_id,
    c.category_name,
    p.quantity_per_unit,
    p.unit_price,
    p.units_in_stock,
    p.units_on_order,
    p.reorder_level,
    p.discontinued
from Project_2.public.stg_products p
left join PROJECT_2.PUBLIC.suppliers s on p.supplier_id = s.supplier_id
left join PROJECT_2.PUBLIC.categories c on p.category_id = c.category_id
        );
[0m19:33:44.544019 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.413 seconds
[0m19:33:44.611972 [debug] [Thread-4  ]: Using snowflake connection "model.northwind_dbt.fact_order_details"
[0m19:33:44.611972 [debug] [Thread-4  ]: On model.northwind_dbt.fact_order_details: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.fact_order_details"} */
describe table Project_2.public.fact_order_details__dbt_tmp
[0m19:33:44.716327 [debug] [Thread-4  ]: SQL status: SUCCESS 12 in 0.097 seconds
[0m19:33:44.721339 [debug] [Thread-4  ]: Using snowflake connection "model.northwind_dbt.fact_order_details"
[0m19:33:44.721917 [debug] [Thread-4  ]: On model.northwind_dbt.fact_order_details: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.fact_order_details"} */
describe table Project_2.public.fact_order_details
[0m19:33:44.802468 [debug] [Thread-4  ]: SQL status: SUCCESS 12 in 0.082 seconds
[0m19:33:44.812440 [debug] [Thread-4  ]: Using snowflake connection "model.northwind_dbt.fact_order_details"
[0m19:33:44.812440 [debug] [Thread-4  ]: On model.northwind_dbt.fact_order_details: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.fact_order_details"} */
describe table "PROJECT_2"."PUBLIC"."FACT_ORDER_DETAILS"
[0m19:33:44.887532 [debug] [Thread-4  ]: SQL status: SUCCESS 12 in 0.080 seconds
[0m19:33:44.912675 [debug] [Thread-4  ]: Writing runtime sql for node "model.northwind_dbt.fact_order_details"
[0m19:33:44.928436 [debug] [Thread-4  ]: Using snowflake connection "model.northwind_dbt.fact_order_details"
[0m19:33:44.928436 [debug] [Thread-4  ]: On model.northwind_dbt.fact_order_details: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.fact_order_details"} */
-- back compat for old kwarg name
  
  begin;
[0m19:33:45.040031 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.109 seconds
[0m19:33:45.040031 [debug] [Thread-4  ]: Using snowflake connection "model.northwind_dbt.fact_order_details"
[0m19:33:45.040031 [debug] [Thread-4  ]: On model.northwind_dbt.fact_order_details: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.fact_order_details"} */
merge into Project_2.public.fact_order_details as DBT_INTERNAL_DEST
        using Project_2.public.fact_order_details__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.order_id = DBT_INTERNAL_DEST.order_id
                ) and (
                    DBT_INTERNAL_SOURCE.product_id = DBT_INTERNAL_DEST.product_id
                )

    
    when matched then update set
        "ORDER_ID" = DBT_INTERNAL_SOURCE."ORDER_ID","PRODUCT_ID" = DBT_INTERNAL_SOURCE."PRODUCT_ID","CUSTOMER_ID" = DBT_INTERNAL_SOURCE."CUSTOMER_ID","EMPLOYEE_ID" = DBT_INTERNAL_SOURCE."EMPLOYEE_ID","SHIPPER_ID" = DBT_INTERNAL_SOURCE."SHIPPER_ID","ORDER_DATE" = DBT_INTERNAL_SOURCE."ORDER_DATE","TOTAL_REVENUE" = DBT_INTERNAL_SOURCE."TOTAL_REVENUE","AVG_REVENUE" = DBT_INTERNAL_SOURCE."AVG_REVENUE","MAX_REVENUE" = DBT_INTERNAL_SOURCE."MAX_REVENUE","MIN_REVENUE" = DBT_INTERNAL_SOURCE."MIN_REVENUE","LINE_COUNT" = DBT_INTERNAL_SOURCE."LINE_COUNT","REVENUE_RANK" = DBT_INTERNAL_SOURCE."REVENUE_RANK"
    

    when not matched then insert
        ("ORDER_ID", "PRODUCT_ID", "CUSTOMER_ID", "EMPLOYEE_ID", "SHIPPER_ID", "ORDER_DATE", "TOTAL_REVENUE", "AVG_REVENUE", "MAX_REVENUE", "MIN_REVENUE", "LINE_COUNT", "REVENUE_RANK")
    values
        ("ORDER_ID", "PRODUCT_ID", "CUSTOMER_ID", "EMPLOYEE_ID", "SHIPPER_ID", "ORDER_DATE", "TOTAL_REVENUE", "AVG_REVENUE", "MAX_REVENUE", "MIN_REVENUE", "LINE_COUNT", "REVENUE_RANK")

;
[0m19:33:45.198304 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.149 seconds
[0m19:33:45.198304 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3330d23d-e653-411b-be07-423993c93077', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B390D1ECA0>]}
[0m19:33:45.198304 [info ] [Thread-1  ]: 6 of 11 OK created sql table model public.dim_customers ........................ [[32mSUCCESS 1[0m in 1.19s]
[0m19:33:45.214925 [debug] [Thread-1  ]: Finished running node model.northwind_dbt.dim_customers
[0m19:33:45.456211 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.168 seconds
[0m19:33:45.463021 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3330d23d-e653-411b-be07-423993c93077', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B391E8DFA0>]}
[0m19:33:45.463021 [info ] [Thread-2  ]: 8 of 11 OK created sql table model public.dim_employees ........................ [[32mSUCCESS 1[0m in 1.21s]
[0m19:33:45.465037 [debug] [Thread-2  ]: Finished running node model.northwind_dbt.dim_employees
[0m19:33:46.100307 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1.598 seconds
[0m19:33:46.112548 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3330d23d-e653-411b-be07-423993c93077', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B390C78280>]}
[0m19:33:46.114614 [info ] [Thread-3  ]: 9 of 11 OK created sql table model public.dim_products ......................... [[32mSUCCESS 1[0m in 1.65s]
[0m19:33:46.116344 [debug] [Thread-3  ]: Finished running node model.northwind_dbt.dim_products
[0m19:33:46.630210 [debug] [Thread-4  ]: SQL status: SUCCESS 32 in 1.585 seconds
[0m19:33:46.630210 [debug] [Thread-4  ]: Using snowflake connection "model.northwind_dbt.fact_order_details"
[0m19:33:46.630210 [debug] [Thread-4  ]: On model.northwind_dbt.fact_order_details: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.fact_order_details"} */
COMMIT
[0m19:33:46.954982 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.321 seconds
[0m19:33:46.956887 [debug] [Thread-4  ]: Applying DROP to: Project_2.public.fact_order_details__dbt_tmp
[0m19:33:46.956887 [debug] [Thread-4  ]: Using snowflake connection "model.northwind_dbt.fact_order_details"
[0m19:33:46.956887 [debug] [Thread-4  ]: On model.northwind_dbt.fact_order_details: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.fact_order_details"} */
drop view if exists Project_2.public.fact_order_details__dbt_tmp cascade
[0m19:33:47.208630 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.241 seconds
[0m19:33:47.208630 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3330d23d-e653-411b-be07-423993c93077', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B390BAE910>]}
[0m19:33:47.208630 [info ] [Thread-4  ]: 7 of 11 OK created sql incremental model public.fact_order_details ............. [[32mSUCCESS 32[0m in 3.14s]
[0m19:33:47.216962 [debug] [Thread-4  ]: Finished running node model.northwind_dbt.fact_order_details
[0m19:33:47.216962 [debug] [Thread-1  ]: Began running node model.northwind_dbt.obt_orders
[0m19:33:47.216962 [debug] [Thread-2  ]: Began running node model.northwind_dbt.top_customer_revenue
[0m19:33:47.216962 [info ] [Thread-1  ]: 10 of 11 START sql table model public.obt_orders ............................... [RUN]
[0m19:33:47.216962 [info ] [Thread-2  ]: 11 of 11 START sql table model public.top_customer_revenue ..................... [RUN]
[0m19:33:47.222209 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.northwind_dbt.dim_customers, now model.northwind_dbt.obt_orders)
[0m19:33:47.222622 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.northwind_dbt.dim_employees, now model.northwind_dbt.top_customer_revenue)
[0m19:33:47.222622 [debug] [Thread-1  ]: Began compiling node model.northwind_dbt.obt_orders
[0m19:33:47.222622 [debug] [Thread-2  ]: Began compiling node model.northwind_dbt.top_customer_revenue
[0m19:33:47.232070 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind_dbt.obt_orders"
[0m19:33:47.234085 [debug] [Thread-2  ]: Writing injected SQL for node "model.northwind_dbt.top_customer_revenue"
[0m19:33:47.249819 [debug] [Thread-1  ]: Began executing node model.northwind_dbt.obt_orders
[0m19:33:47.251237 [debug] [Thread-2  ]: Began executing node model.northwind_dbt.top_customer_revenue
[0m19:33:47.251237 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind_dbt.obt_orders"
[0m19:33:47.251237 [debug] [Thread-2  ]: Writing runtime sql for node "model.northwind_dbt.top_customer_revenue"
[0m19:33:47.266277 [debug] [Thread-1  ]: Using snowflake connection "model.northwind_dbt.obt_orders"
[0m19:33:47.266277 [debug] [Thread-2  ]: Using snowflake connection "model.northwind_dbt.top_customer_revenue"
[0m19:33:47.266277 [debug] [Thread-1  ]: On model.northwind_dbt.obt_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.obt_orders"} */
create or replace transient table Project_2.public.obt_orders
         as
        (select 
    f.order_id,
    f.product_id,
    f.customer_id,
    f.employee_id,
    f.shipper_id,
    f.order_date,
    f.total_revenue,
    f.avg_revenue,
    f.max_revenue,
    f.min_revenue,
    f.line_count,
    f.revenue_rank,

    c.company_name as customer_name,
    p.product_name,
    p.category_name,
    p.supplier_name,
    e.first_name || ' ' || e.last_name as employee_name,
    s.company_name as shipper_name

from Project_2.public.fact_order_details f
left join Project_2.public.dim_customers c on f.customer_id = c.customer_id
left join Project_2.public.dim_products p on f.product_id = p.product_id
left join Project_2.public.dim_employees e on f.employee_id = e.employee_id
left join PROJECT_2.PUBLIC.shippers s on f.shipper_id = s.shipper_id
        );
[0m19:33:47.266277 [debug] [Thread-2  ]: On model.northwind_dbt.top_customer_revenue: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.top_customer_revenue"} */
create or replace transient table Project_2.public.top_customer_revenue
         as
        (

select
  c.customer_id,
  c.company_name as customer_name,
  sum(f.total_revenue) as total_revenue
from Project_2.public.fact_order_details f
join Project_2.public.dim_customers c using (customer_id)
group by c.customer_id, c.company_name
order by total_revenue des
        );
[0m19:33:47.378603 [debug] [Thread-2  ]: Snowflake adapter: Snowflake query id: 01bbb185-020d-00ab-000c-83e7000b517e
[0m19:33:47.379573 [debug] [Thread-2  ]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 12 at position 23 unexpected 'des'.
[0m19:33:47.381785 [debug] [Thread-2  ]: Database Error in model top_customer_revenue (models\marts\analysis\top_customer_revenue.sql)
  001003 (42000): SQL compilation error:
  syntax error line 12 at position 23 unexpected 'des'.
  compiled code at target\run\northwind_dbt\models\marts\analysis\top_customer_revenue.sql
[0m19:33:47.386565 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3330d23d-e653-411b-be07-423993c93077', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B391E88370>]}
[0m19:33:47.386565 [error] [Thread-2  ]: 11 of 11 ERROR creating sql table model public.top_customer_revenue ............ [[31mERROR[0m in 0.16s]
[0m19:33:47.386565 [debug] [Thread-2  ]: Finished running node model.northwind_dbt.top_customer_revenue
[0m19:33:47.386565 [debug] [Thread-7  ]: Marking all children of 'model.northwind_dbt.top_customer_revenue' to be skipped because of status 'error'.  Reason: Database Error in model top_customer_revenue (models\marts\analysis\top_customer_revenue.sql)
  001003 (42000): SQL compilation error:
  syntax error line 12 at position 23 unexpected 'des'.
  compiled code at target\run\northwind_dbt\models\marts\analysis\top_customer_revenue.sql.
[0m19:33:48.707923 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.431 seconds
[0m19:33:48.707923 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3330d23d-e653-411b-be07-423993c93077', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3F72F6CA0>]}
[0m19:33:48.712341 [info ] [Thread-1  ]: 10 of 11 OK created sql table model public.obt_orders .......................... [[32mSUCCESS 1[0m in 1.49s]
[0m19:33:48.712341 [debug] [Thread-1  ]: Finished running node model.northwind_dbt.obt_orders
[0m19:33:48.712341 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:33:48.712341 [debug] [MainThread]: Connection 'list_Project_2' was left open.
[0m19:33:48.719171 [debug] [MainThread]: On list_Project_2: Close
[0m19:33:48.841144 [debug] [MainThread]: Connection 'list_Project_2_public' was left open.
[0m19:33:48.842587 [debug] [MainThread]: On list_Project_2_public: Close
[0m19:33:48.994161 [debug] [MainThread]: Connection 'list_Project_2_snapshots' was left open.
[0m19:33:48.995852 [debug] [MainThread]: On list_Project_2_snapshots: Close
[0m19:33:49.127378 [debug] [MainThread]: Connection 'model.northwind_dbt.obt_orders' was left open.
[0m19:33:49.128487 [debug] [MainThread]: On model.northwind_dbt.obt_orders: Close
[0m19:33:49.282166 [debug] [MainThread]: Connection 'model.northwind_dbt.top_customer_revenue' was left open.
[0m19:33:49.282166 [debug] [MainThread]: On model.northwind_dbt.top_customer_revenue: Close
[0m19:33:49.420363 [debug] [MainThread]: Connection 'model.northwind_dbt.fact_order_details' was left open.
[0m19:33:49.420363 [debug] [MainThread]: On model.northwind_dbt.fact_order_details: Close
[0m19:33:49.595320 [debug] [MainThread]: Connection 'model.northwind_dbt.dim_products' was left open.
[0m19:33:49.595320 [debug] [MainThread]: On model.northwind_dbt.dim_products: Close
[0m19:33:49.722783 [info ] [MainThread]: 
[0m19:33:49.722783 [info ] [MainThread]: Finished running 1 incremental model, 5 table models, 5 view models in 0 hours 0 minutes and 8.21 seconds (8.21s).
[0m19:33:49.722783 [debug] [MainThread]: Command end result
[0m19:33:49.877781 [debug] [MainThread]: Wrote artifact WritableManifest to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\manifest.json
[0m19:33:49.886203 [debug] [MainThread]: Wrote artifact SemanticManifest to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\semantic_manifest.json
[0m19:33:49.899244 [debug] [MainThread]: Wrote artifact RunExecutionResult to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\run_results.json
[0m19:33:49.899244 [info ] [MainThread]: 
[0m19:33:49.908315 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m19:33:49.908893 [info ] [MainThread]: 
[0m19:33:49.908893 [error] [MainThread]:   Database Error in model top_customer_revenue (models\marts\analysis\top_customer_revenue.sql)
  001003 (42000): SQL compilation error:
  syntax error line 12 at position 23 unexpected 'des'.
  compiled code at target\run\northwind_dbt\models\marts\analysis\top_customer_revenue.sql
[0m19:33:49.908893 [info ] [MainThread]: 
[0m19:33:49.908893 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=1 SKIP=0 TOTAL=11
[0m19:33:49.914968 [debug] [MainThread]: Command `dbt run` failed at 19:33:49.914968 after 11.41 seconds
[0m19:33:49.914968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3F52F0280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B38FE35DC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B391E88BB0>]}
[0m19:33:49.916264 [debug] [MainThread]: Flushing usage events
[0m19:33:50.929295 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:45:10.431350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D8DBE02E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D8FC53BE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D8FC539D0>]}


============================== 19:45:10.435535 | 42072cdc-bc16-4ad3-a194-eb4d2432722e ==============================
[0m19:45:10.435535 [info ] [MainThread]: Running with dbt=1.9.0
[0m19:45:10.435535 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'c:\\Users\\fitzp\\Documents\\Alpaca_Market\\zproject_2\\northwind_psql\\logs', 'fail_fast': 'False', 'profiles_dir': 'c:\\Users\\fitzp\\Documents\\Alpaca_Market\\zproject_2\\northwind_psql', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:45:11.934960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '42072cdc-bc16-4ad3-a194-eb4d2432722e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018DA8704A90>]}
[0m19:45:12.000079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '42072cdc-bc16-4ad3-a194-eb4d2432722e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018DA879E3A0>]}
[0m19:45:12.002060 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m19:45:12.360236 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m19:45:12.835248 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m19:45:12.837259 [debug] [MainThread]: Partial parsing: updated file: northwind_dbt://models\marts\analysis\schema.yml
[0m19:45:12.838268 [debug] [MainThread]: Partial parsing: updated file: northwind_dbt://models\marts\analysis\top_customer_revenue.sql
[0m19:45:13.289953 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.northwind_dbt.marts.bi
[0m19:45:13.305238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '42072cdc-bc16-4ad3-a194-eb4d2432722e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018DA9061EE0>]}
[0m19:45:13.588011 [debug] [MainThread]: Wrote artifact WritableManifest to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\manifest.json
[0m19:45:13.593912 [debug] [MainThread]: Wrote artifact SemanticManifest to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\semantic_manifest.json
[0m19:45:13.645955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '42072cdc-bc16-4ad3-a194-eb4d2432722e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018DA8704E50>]}
[0m19:45:13.645955 [info ] [MainThread]: Found 11 models, 1 snapshot, 14 data tests, 8 sources, 706 macros
[0m19:45:13.645955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '42072cdc-bc16-4ad3-a194-eb4d2432722e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018DA90E6DF0>]}
[0m19:45:13.645955 [info ] [MainThread]: 
[0m19:45:13.645955 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:45:13.645955 [info ] [MainThread]: 
[0m19:45:13.662632 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:45:13.670698 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_Project_2'
[0m19:45:13.766936 [debug] [ThreadPool]: Using snowflake connection "list_Project_2"
[0m19:45:13.766936 [debug] [ThreadPool]: On list_Project_2: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "connection_name": "list_Project_2"} */
show terse schemas in database Project_2
    limit 10000
[0m19:45:13.766936 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:45:14.525564 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.754 seconds
[0m19:45:14.532719 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_Project_2_snapshots'
[0m19:45:14.537435 [debug] [ThreadPool]: Using snowflake connection "list_Project_2_snapshots"
[0m19:45:14.537435 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_Project_2_public'
[0m19:45:14.537435 [debug] [ThreadPool]: On list_Project_2_snapshots: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "connection_name": "list_Project_2_snapshots"} */
show objects in Project_2.snapshots limit 10000;
[0m19:45:14.537435 [debug] [ThreadPool]: Using snowflake connection "list_Project_2_public"
[0m19:45:14.537435 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:45:14.537435 [debug] [ThreadPool]: On list_Project_2_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "connection_name": "list_Project_2_public"} */
show objects in Project_2.public limit 10000;
[0m19:45:14.548477 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:45:15.022594 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bbb191-020d-034d-000c-83e7000bc02a
[0m19:45:15.022594 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m19:45:15.022594 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m19:45:15.022594 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m19:45:15.038703 [debug] [ThreadPool]: SQL status: SUCCESS 24 in 0.503 seconds
[0m19:45:15.057059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '42072cdc-bc16-4ad3-a194-eb4d2432722e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D8CDD4670>]}
[0m19:45:15.062002 [debug] [Thread-1  ]: Began running node model.northwind_dbt.stg_customers
[0m19:45:15.062002 [debug] [Thread-2  ]: Began running node model.northwind_dbt.stg_employees
[0m19:45:15.062002 [debug] [Thread-3  ]: Began running node model.northwind_dbt.stg_order_details
[0m19:45:15.062002 [debug] [Thread-4  ]: Began running node model.northwind_dbt.stg_orders
[0m19:45:15.062002 [info ] [Thread-1  ]: 1 of 11 START sql view model public.stg_customers .............................. [RUN]
[0m19:45:15.062002 [info ] [Thread-2  ]: 2 of 11 START sql view model public.stg_employees .............................. [RUN]
[0m19:45:15.062002 [info ] [Thread-3  ]: 3 of 11 START sql view model public.stg_order_details .......................... [RUN]
[0m19:45:15.068150 [info ] [Thread-4  ]: 4 of 11 START sql view model public.stg_orders ................................. [RUN]
[0m19:45:15.068150 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.northwind_dbt.stg_customers'
[0m19:45:15.068150 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.northwind_dbt.stg_employees'
[0m19:45:15.070157 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.northwind_dbt.stg_order_details'
[0m19:45:15.072124 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.northwind_dbt.stg_orders'
[0m19:45:15.072648 [debug] [Thread-1  ]: Began compiling node model.northwind_dbt.stg_customers
[0m19:45:15.073416 [debug] [Thread-2  ]: Began compiling node model.northwind_dbt.stg_employees
[0m19:45:15.074603 [debug] [Thread-3  ]: Began compiling node model.northwind_dbt.stg_order_details
[0m19:45:15.075140 [debug] [Thread-4  ]: Began compiling node model.northwind_dbt.stg_orders
[0m19:45:15.081379 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind_dbt.stg_customers"
[0m19:45:15.156973 [debug] [Thread-2  ]: Writing injected SQL for node "model.northwind_dbt.stg_employees"
[0m19:45:15.159969 [debug] [Thread-3  ]: Writing injected SQL for node "model.northwind_dbt.stg_order_details"
[0m19:45:15.162476 [debug] [Thread-4  ]: Writing injected SQL for node "model.northwind_dbt.stg_orders"
[0m19:45:15.184023 [debug] [Thread-2  ]: Began executing node model.northwind_dbt.stg_employees
[0m19:45:15.184749 [debug] [Thread-4  ]: Began executing node model.northwind_dbt.stg_orders
[0m19:45:15.185758 [debug] [Thread-3  ]: Began executing node model.northwind_dbt.stg_order_details
[0m19:45:15.185758 [debug] [Thread-1  ]: Began executing node model.northwind_dbt.stg_customers
[0m19:45:15.201396 [debug] [Thread-2  ]: Writing runtime sql for node "model.northwind_dbt.stg_employees"
[0m19:45:15.217143 [debug] [Thread-4  ]: Writing runtime sql for node "model.northwind_dbt.stg_orders"
[0m19:45:15.217143 [debug] [Thread-3  ]: Writing runtime sql for node "model.northwind_dbt.stg_order_details"
[0m19:45:15.224803 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind_dbt.stg_customers"
[0m19:45:15.249694 [debug] [Thread-4  ]: Using snowflake connection "model.northwind_dbt.stg_orders"
[0m19:45:15.250202 [debug] [Thread-2  ]: Using snowflake connection "model.northwind_dbt.stg_employees"
[0m19:45:15.250793 [debug] [Thread-1  ]: Using snowflake connection "model.northwind_dbt.stg_customers"
[0m19:45:15.250793 [debug] [Thread-3  ]: Using snowflake connection "model.northwind_dbt.stg_order_details"
[0m19:45:15.250793 [debug] [Thread-4  ]: On model.northwind_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.stg_orders"} */
create or replace   view Project_2.public.stg_orders
  
   as (
    select * from PROJECT_2.PUBLIC.orders
  );
[0m19:45:15.250793 [debug] [Thread-2  ]: On model.northwind_dbt.stg_employees: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.stg_employees"} */
create or replace   view Project_2.public.stg_employees
  
   as (
    select * from PROJECT_2.PUBLIC.employees
  );
[0m19:45:15.250793 [debug] [Thread-1  ]: On model.northwind_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.stg_customers"} */
create or replace   view Project_2.public.stg_customers
  
   as (
    select * from PROJECT_2.PUBLIC.customers
  );
[0m19:45:15.250793 [debug] [Thread-3  ]: On model.northwind_dbt.stg_order_details: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.stg_order_details"} */
create or replace   view Project_2.public.stg_order_details
  
   as (
    select * from PROJECT_2.PUBLIC.order_details
  );
[0m19:45:15.250793 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m19:45:15.250793 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m19:45:15.250793 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m19:45:15.250793 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m19:45:15.997204 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.742 seconds
[0m19:45:16.020610 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42072cdc-bc16-4ad3-a194-eb4d2432722e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018DAA7CEC40>]}
[0m19:45:16.020610 [info ] [Thread-3  ]: 3 of 11 OK created sql view model public.stg_order_details ..................... [[32mSUCCESS 1[0m in 0.95s]
[0m19:45:16.022863 [debug] [Thread-3  ]: Finished running node model.northwind_dbt.stg_order_details
[0m19:45:16.022863 [debug] [Thread-3  ]: Began running node model.northwind_dbt.stg_products
[0m19:45:16.022863 [info ] [Thread-3  ]: 5 of 11 START sql view model public.stg_products ............................... [RUN]
[0m19:45:16.026646 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.northwind_dbt.stg_order_details, now model.northwind_dbt.stg_products)
[0m19:45:16.026646 [debug] [Thread-3  ]: Began compiling node model.northwind_dbt.stg_products
[0m19:45:16.032845 [debug] [Thread-3  ]: Writing injected SQL for node "model.northwind_dbt.stg_products"
[0m19:45:16.034850 [debug] [Thread-3  ]: Began executing node model.northwind_dbt.stg_products
[0m19:45:16.047995 [debug] [Thread-3  ]: Writing runtime sql for node "model.northwind_dbt.stg_products"
[0m19:45:16.054701 [debug] [Thread-3  ]: Using snowflake connection "model.northwind_dbt.stg_products"
[0m19:45:16.060935 [debug] [Thread-3  ]: On model.northwind_dbt.stg_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.stg_products"} */
create or replace   view Project_2.public.stg_products
  
   as (
    select * from PROJECT_2.PUBLIC.products
  );
[0m19:45:16.199737 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.946 seconds
[0m19:45:16.204173 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42072cdc-bc16-4ad3-a194-eb4d2432722e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018DAA7A9FA0>]}
[0m19:45:16.204173 [info ] [Thread-1  ]: 1 of 11 OK created sql view model public.stg_customers ......................... [[32mSUCCESS 1[0m in 1.13s]
[0m19:45:16.204173 [debug] [Thread-1  ]: Finished running node model.northwind_dbt.stg_customers
[0m19:45:16.204173 [debug] [Thread-1  ]: Began running node model.northwind_dbt.dim_customers
[0m19:45:16.204173 [info ] [Thread-1  ]: 6 of 11 START sql table model public.dim_customers ............................. [RUN]
[0m19:45:16.204173 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.northwind_dbt.stg_customers, now model.northwind_dbt.dim_customers)
[0m19:45:16.204173 [debug] [Thread-1  ]: Began compiling node model.northwind_dbt.dim_customers
[0m19:45:16.204173 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind_dbt.dim_customers"
[0m19:45:16.229484 [debug] [Thread-1  ]: Began executing node model.northwind_dbt.dim_customers
[0m19:45:16.252897 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind_dbt.dim_customers"
[0m19:45:16.255536 [debug] [Thread-1  ]: Using snowflake connection "model.northwind_dbt.dim_customers"
[0m19:45:16.255536 [debug] [Thread-1  ]: On model.northwind_dbt.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.dim_customers"} */
create or replace transient table Project_2.public.dim_customers
         as
        (select * from Project_2.public.stg_customers
        );
[0m19:45:16.324939 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1.074 seconds
[0m19:45:16.331133 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42072cdc-bc16-4ad3-a194-eb4d2432722e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D8CDD4670>]}
[0m19:45:16.331133 [info ] [Thread-4  ]: 4 of 11 OK created sql view model public.stg_orders ............................ [[32mSUCCESS 1[0m in 1.26s]
[0m19:45:16.333787 [debug] [Thread-4  ]: Finished running node model.northwind_dbt.stg_orders
[0m19:45:16.334797 [debug] [Thread-4  ]: Began running node model.northwind_dbt.fact_order_details
[0m19:45:16.334797 [info ] [Thread-4  ]: 7 of 11 START sql incremental model public.fact_order_details .................. [RUN]
[0m19:45:16.337463 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.northwind_dbt.stg_orders, now model.northwind_dbt.fact_order_details)
[0m19:45:16.337463 [debug] [Thread-4  ]: Began compiling node model.northwind_dbt.fact_order_details
[0m19:45:16.349534 [debug] [Thread-4  ]: Writing injected SQL for node "model.northwind_dbt.fact_order_details"
[0m19:45:16.352176 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.097 seconds
[0m19:45:16.355681 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42072cdc-bc16-4ad3-a194-eb4d2432722e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018DA906F6D0>]}
[0m19:45:16.355681 [info ] [Thread-2  ]: 2 of 11 OK created sql view model public.stg_employees ......................... [[32mSUCCESS 1[0m in 1.29s]
[0m19:45:16.355681 [debug] [Thread-2  ]: Finished running node model.northwind_dbt.stg_employees
[0m19:45:16.355681 [debug] [Thread-2  ]: Began running node model.northwind_dbt.dim_employees
[0m19:45:16.361750 [debug] [Thread-4  ]: Began executing node model.northwind_dbt.fact_order_details
[0m19:45:16.361750 [info ] [Thread-2  ]: 8 of 11 START sql table model public.dim_employees ............................. [RUN]
[0m19:45:16.409252 [debug] [Thread-4  ]: Using snowflake connection "model.northwind_dbt.fact_order_details"
[0m19:45:16.410363 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.northwind_dbt.stg_employees, now model.northwind_dbt.dim_employees)
[0m19:45:16.411460 [debug] [Thread-4  ]: On model.northwind_dbt.fact_order_details: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.fact_order_details"} */
create or replace  temporary view Project_2.public.fact_order_details__dbt_tmp
  
   as (
    

with base as (
    select 
        od.order_id,
        od.product_id,
        o.customer_id,
        o.employee_id,
        o.ship_via as shipper_id,
        o.order_date,
        od.unit_price,
        od.quantity,
        od.discount,
        od.unit_price * od.quantity * (1 - od.discount) as revenue
    from Project_2.public.stg_order_details od
    join Project_2.public.stg_orders o on od.order_id = o.order_id
    
        and o.order_date >= (select max(order_date) from Project_2.public.fact_order_details)
    
),
aggregated as (
    select 
        order_id,
        product_id,
        customer_id,
        employee_id,
        shipper_id,
        cast(order_date as date) as order_date,
        sum(revenue) as total_revenue,
        avg(revenue) as avg_revenue,
        max(revenue) as max_revenue,
        min(revenue) as min_revenue,
        count(*) as line_count,
        rank() over (partition by customer_id order by sum(revenue) desc) as revenue_rank
    from base
    group by order_id, product_id, customer_id, employee_id, shipper_id, order_date
)
select * from aggregated
  );
[0m19:45:16.413836 [debug] [Thread-2  ]: Began compiling node model.northwind_dbt.dim_employees
[0m19:45:16.437448 [debug] [Thread-2  ]: Writing injected SQL for node "model.northwind_dbt.dim_employees"
[0m19:45:16.452114 [debug] [Thread-2  ]: Began executing node model.northwind_dbt.dim_employees
[0m19:45:16.458199 [debug] [Thread-2  ]: Writing runtime sql for node "model.northwind_dbt.dim_employees"
[0m19:45:16.474121 [debug] [Thread-2  ]: Using snowflake connection "model.northwind_dbt.dim_employees"
[0m19:45:16.475821 [debug] [Thread-2  ]: On model.northwind_dbt.dim_employees: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.dim_employees"} */
create or replace transient table Project_2.public.dim_employees
         as
        (with source_data as (
    select * from Project_2.public.stg_employees
),
scd2 as (
    select 
        md5(cast(coalesce(cast(employee_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as employee_key,
        *,
        current_timestamp as dbt_updated_at
    from source_data
)
select * from scd2
        );
[0m19:45:16.533772 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.472 seconds
[0m19:45:16.540236 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42072cdc-bc16-4ad3-a194-eb4d2432722e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018DAA7CEC40>]}
[0m19:45:16.542936 [info ] [Thread-3  ]: 5 of 11 OK created sql view model public.stg_products .......................... [[32mSUCCESS 1[0m in 0.51s]
[0m19:45:16.545672 [debug] [Thread-3  ]: Finished running node model.northwind_dbt.stg_products
[0m19:45:16.547977 [debug] [Thread-3  ]: Began running node model.northwind_dbt.dim_products
[0m19:45:16.549627 [info ] [Thread-3  ]: 9 of 11 START sql table model public.dim_products .............................. [RUN]
[0m19:45:16.552346 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.northwind_dbt.stg_products, now model.northwind_dbt.dim_products)
[0m19:45:16.553872 [debug] [Thread-3  ]: Began compiling node model.northwind_dbt.dim_products
[0m19:45:16.564754 [debug] [Thread-3  ]: Writing injected SQL for node "model.northwind_dbt.dim_products"
[0m19:45:16.581390 [debug] [Thread-3  ]: Began executing node model.northwind_dbt.dim_products
[0m19:45:16.591711 [debug] [Thread-3  ]: Writing runtime sql for node "model.northwind_dbt.dim_products"
[0m19:45:16.611265 [debug] [Thread-3  ]: Using snowflake connection "model.northwind_dbt.dim_products"
[0m19:45:16.613075 [debug] [Thread-3  ]: On model.northwind_dbt.dim_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.dim_products"} */
create or replace transient table Project_2.public.dim_products
         as
        (select 
    p.product_id,
    p.product_name,
    p.supplier_id,
    s.company_name as supplier_name,
    p.category_id,
    c.category_name,
    p.quantity_per_unit,
    p.unit_price,
    p.units_in_stock,
    p.units_on_order,
    p.reorder_level,
    p.discontinued
from Project_2.public.stg_products p
left join PROJECT_2.PUBLIC.suppliers s on p.supplier_id = s.supplier_id
left join PROJECT_2.PUBLIC.categories c on p.category_id = c.category_id
        );
[0m19:45:17.059378 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.644 seconds
[0m19:45:17.077846 [debug] [Thread-4  ]: Using snowflake connection "model.northwind_dbt.fact_order_details"
[0m19:45:17.079511 [debug] [Thread-4  ]: On model.northwind_dbt.fact_order_details: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.fact_order_details"} */
describe table Project_2.public.fact_order_details__dbt_tmp
[0m19:45:17.227900 [debug] [Thread-4  ]: SQL status: SUCCESS 12 in 0.148 seconds
[0m19:45:17.232609 [debug] [Thread-4  ]: Using snowflake connection "model.northwind_dbt.fact_order_details"
[0m19:45:17.232609 [debug] [Thread-4  ]: On model.northwind_dbt.fact_order_details: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.fact_order_details"} */
describe table Project_2.public.fact_order_details
[0m19:45:17.318135 [debug] [Thread-4  ]: SQL status: SUCCESS 12 in 0.084 seconds
[0m19:45:17.330365 [debug] [Thread-4  ]: Using snowflake connection "model.northwind_dbt.fact_order_details"
[0m19:45:17.331437 [debug] [Thread-4  ]: On model.northwind_dbt.fact_order_details: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.fact_order_details"} */
describe table "PROJECT_2"."PUBLIC"."FACT_ORDER_DETAILS"
[0m19:45:17.442466 [debug] [Thread-4  ]: SQL status: SUCCESS 12 in 0.122 seconds
[0m19:45:17.487817 [debug] [Thread-4  ]: Writing runtime sql for node "model.northwind_dbt.fact_order_details"
[0m19:45:17.504644 [debug] [Thread-4  ]: Using snowflake connection "model.northwind_dbt.fact_order_details"
[0m19:45:17.505701 [debug] [Thread-4  ]: On model.northwind_dbt.fact_order_details: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.fact_order_details"} */
-- back compat for old kwarg name
  
  begin;
[0m19:45:17.588381 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.323 seconds
[0m19:45:17.592389 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42072cdc-bc16-4ad3-a194-eb4d2432722e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018DAA7A9FA0>]}
[0m19:45:17.592389 [info ] [Thread-1  ]: 6 of 11 OK created sql table model public.dim_customers ........................ [[32mSUCCESS 1[0m in 1.39s]
[0m19:45:17.594392 [debug] [Thread-1  ]: Finished running node model.northwind_dbt.dim_customers
[0m19:45:17.602096 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.098 seconds
[0m19:45:17.605231 [debug] [Thread-4  ]: Using snowflake connection "model.northwind_dbt.fact_order_details"
[0m19:45:17.605231 [debug] [Thread-4  ]: On model.northwind_dbt.fact_order_details: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.fact_order_details"} */
merge into Project_2.public.fact_order_details as DBT_INTERNAL_DEST
        using Project_2.public.fact_order_details__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.order_id = DBT_INTERNAL_DEST.order_id
                ) and (
                    DBT_INTERNAL_SOURCE.product_id = DBT_INTERNAL_DEST.product_id
                )

    
    when matched then update set
        "ORDER_ID" = DBT_INTERNAL_SOURCE."ORDER_ID","PRODUCT_ID" = DBT_INTERNAL_SOURCE."PRODUCT_ID","CUSTOMER_ID" = DBT_INTERNAL_SOURCE."CUSTOMER_ID","EMPLOYEE_ID" = DBT_INTERNAL_SOURCE."EMPLOYEE_ID","SHIPPER_ID" = DBT_INTERNAL_SOURCE."SHIPPER_ID","ORDER_DATE" = DBT_INTERNAL_SOURCE."ORDER_DATE","TOTAL_REVENUE" = DBT_INTERNAL_SOURCE."TOTAL_REVENUE","AVG_REVENUE" = DBT_INTERNAL_SOURCE."AVG_REVENUE","MAX_REVENUE" = DBT_INTERNAL_SOURCE."MAX_REVENUE","MIN_REVENUE" = DBT_INTERNAL_SOURCE."MIN_REVENUE","LINE_COUNT" = DBT_INTERNAL_SOURCE."LINE_COUNT","REVENUE_RANK" = DBT_INTERNAL_SOURCE."REVENUE_RANK"
    

    when not matched then insert
        ("ORDER_ID", "PRODUCT_ID", "CUSTOMER_ID", "EMPLOYEE_ID", "SHIPPER_ID", "ORDER_DATE", "TOTAL_REVENUE", "AVG_REVENUE", "MAX_REVENUE", "MIN_REVENUE", "LINE_COUNT", "REVENUE_RANK")
    values
        ("ORDER_ID", "PRODUCT_ID", "CUSTOMER_ID", "EMPLOYEE_ID", "SHIPPER_ID", "ORDER_DATE", "TOTAL_REVENUE", "AVG_REVENUE", "MAX_REVENUE", "MIN_REVENUE", "LINE_COUNT", "REVENUE_RANK")

;
[0m19:45:18.035474 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.564 seconds
[0m19:45:18.035474 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42072cdc-bc16-4ad3-a194-eb4d2432722e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018DA906F6D0>]}
[0m19:45:18.035474 [info ] [Thread-2  ]: 8 of 11 OK created sql table model public.dim_employees ........................ [[32mSUCCESS 1[0m in 1.63s]
[0m19:45:18.035474 [debug] [Thread-2  ]: Finished running node model.northwind_dbt.dim_employees
[0m19:45:18.060583 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1.452 seconds
[0m19:45:18.070080 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42072cdc-bc16-4ad3-a194-eb4d2432722e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D8DAD16D0>]}
[0m19:45:18.072304 [info ] [Thread-3  ]: 9 of 11 OK created sql table model public.dim_products ......................... [[32mSUCCESS 1[0m in 1.52s]
[0m19:45:18.072304 [debug] [Thread-3  ]: Finished running node model.northwind_dbt.dim_products
[0m19:45:18.626915 [debug] [Thread-4  ]: SQL status: SUCCESS 32 in 1.030 seconds
[0m19:45:18.638120 [debug] [Thread-4  ]: Using snowflake connection "model.northwind_dbt.fact_order_details"
[0m19:45:18.638120 [debug] [Thread-4  ]: On model.northwind_dbt.fact_order_details: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.fact_order_details"} */
COMMIT
[0m19:45:19.014731 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.374 seconds
[0m19:45:19.033925 [debug] [Thread-4  ]: Applying DROP to: Project_2.public.fact_order_details__dbt_tmp
[0m19:45:19.044254 [debug] [Thread-4  ]: Using snowflake connection "model.northwind_dbt.fact_order_details"
[0m19:45:19.048047 [debug] [Thread-4  ]: On model.northwind_dbt.fact_order_details: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.fact_order_details"} */
drop view if exists Project_2.public.fact_order_details__dbt_tmp cascade
[0m19:45:19.181585 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.138 seconds
[0m19:45:19.189814 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42072cdc-bc16-4ad3-a194-eb4d2432722e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018DA8704BB0>]}
[0m19:45:19.189814 [info ] [Thread-4  ]: 7 of 11 OK created sql incremental model public.fact_order_details ............. [[32mSUCCESS 32[0m in 2.85s]
[0m19:45:19.189814 [debug] [Thread-4  ]: Finished running node model.northwind_dbt.fact_order_details
[0m19:45:19.189814 [debug] [Thread-1  ]: Began running node model.northwind_dbt.obt_orders
[0m19:45:19.189814 [debug] [Thread-2  ]: Began running node model.northwind_dbt.top_customer_revenue
[0m19:45:19.189814 [info ] [Thread-1  ]: 10 of 11 START sql table model public.obt_orders ............................... [RUN]
[0m19:45:19.189814 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.northwind_dbt.dim_customers, now model.northwind_dbt.obt_orders)
[0m19:45:19.189814 [info ] [Thread-2  ]: 11 of 11 START sql table model public.top_customer_revenue ..................... [RUN]
[0m19:45:19.189814 [debug] [Thread-1  ]: Began compiling node model.northwind_dbt.obt_orders
[0m19:45:19.200624 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.northwind_dbt.dim_employees, now model.northwind_dbt.top_customer_revenue)
[0m19:45:19.202446 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind_dbt.obt_orders"
[0m19:45:19.202446 [debug] [Thread-2  ]: Began compiling node model.northwind_dbt.top_customer_revenue
[0m19:45:19.212372 [debug] [Thread-2  ]: Writing injected SQL for node "model.northwind_dbt.top_customer_revenue"
[0m19:45:19.229984 [debug] [Thread-2  ]: Began executing node model.northwind_dbt.top_customer_revenue
[0m19:45:19.232450 [debug] [Thread-1  ]: Began executing node model.northwind_dbt.obt_orders
[0m19:45:19.238099 [debug] [Thread-2  ]: Writing runtime sql for node "model.northwind_dbt.top_customer_revenue"
[0m19:45:19.242141 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind_dbt.obt_orders"
[0m19:45:19.263145 [debug] [Thread-1  ]: Using snowflake connection "model.northwind_dbt.obt_orders"
[0m19:45:19.264137 [debug] [Thread-2  ]: Using snowflake connection "model.northwind_dbt.top_customer_revenue"
[0m19:45:19.264137 [debug] [Thread-1  ]: On model.northwind_dbt.obt_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.obt_orders"} */
create or replace transient table Project_2.public.obt_orders
         as
        (select 
    f.order_id,
    f.product_id,
    f.customer_id,
    f.employee_id,
    f.shipper_id,
    f.order_date,
    f.total_revenue,
    f.avg_revenue,
    f.max_revenue,
    f.min_revenue,
    f.line_count,
    f.revenue_rank,

    c.company_name as customer_name,
    p.product_name,
    p.category_name,
    p.supplier_name,
    e.first_name || ' ' || e.last_name as employee_name,
    s.company_name as shipper_name

from Project_2.public.fact_order_details f
left join Project_2.public.dim_customers c on f.customer_id = c.customer_id
left join Project_2.public.dim_products p on f.product_id = p.product_id
left join Project_2.public.dim_employees e on f.employee_id = e.employee_id
left join PROJECT_2.PUBLIC.shippers s on f.shipper_id = s.shipper_id
        );
[0m19:45:19.265175 [debug] [Thread-2  ]: On model.northwind_dbt.top_customer_revenue: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.top_customer_revenue"} */
create or replace transient table Project_2.public.top_customer_revenue
         as
        (

select
  c.customer_id,
  c.company_name as customer_name,
  sum(f.total_revenue) as total_revenue
from Project_2.public.fact_order_details f
join Project_2.public.dim_customers c using (customer_id)
group by c.customer_id, c.company_name
order by total_revenue desc
        );
[0m19:45:20.191693 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.930 seconds
[0m19:45:20.191693 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42072cdc-bc16-4ad3-a194-eb4d2432722e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018DAA94FFD0>]}
[0m19:45:20.191693 [info ] [Thread-2  ]: 11 of 11 OK created sql table model public.top_customer_revenue ................ [[32mSUCCESS 1[0m in 0.99s]
[0m19:45:20.191693 [debug] [Thread-2  ]: Finished running node model.northwind_dbt.top_customer_revenue
[0m19:45:21.022825 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.769 seconds
[0m19:45:21.036515 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42072cdc-bc16-4ad3-a194-eb4d2432722e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018DA8E6D520>]}
[0m19:45:21.038527 [info ] [Thread-1  ]: 10 of 11 OK created sql table model public.obt_orders .......................... [[32mSUCCESS 1[0m in 1.85s]
[0m19:45:21.038527 [debug] [Thread-1  ]: Finished running node model.northwind_dbt.obt_orders
[0m19:45:21.045626 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:45:21.046801 [debug] [MainThread]: Connection 'list_Project_2' was left open.
[0m19:45:21.047975 [debug] [MainThread]: On list_Project_2: Close
[0m19:45:21.213430 [debug] [MainThread]: Connection 'list_Project_2_snapshots' was left open.
[0m19:45:21.213430 [debug] [MainThread]: On list_Project_2_snapshots: Close
[0m19:45:21.393774 [debug] [MainThread]: Connection 'list_Project_2_public' was left open.
[0m19:45:21.393774 [debug] [MainThread]: On list_Project_2_public: Close
[0m19:45:21.534835 [debug] [MainThread]: Connection 'model.northwind_dbt.obt_orders' was left open.
[0m19:45:21.539105 [debug] [MainThread]: On model.northwind_dbt.obt_orders: Close
[0m19:45:21.671095 [debug] [MainThread]: Connection 'model.northwind_dbt.top_customer_revenue' was left open.
[0m19:45:21.671095 [debug] [MainThread]: On model.northwind_dbt.top_customer_revenue: Close
[0m19:45:21.817017 [debug] [MainThread]: Connection 'model.northwind_dbt.dim_products' was left open.
[0m19:45:21.817017 [debug] [MainThread]: On model.northwind_dbt.dim_products: Close
[0m19:45:21.969767 [debug] [MainThread]: Connection 'model.northwind_dbt.fact_order_details' was left open.
[0m19:45:21.969767 [debug] [MainThread]: On model.northwind_dbt.fact_order_details: Close
[0m19:45:22.090917 [info ] [MainThread]: 
[0m19:45:22.092928 [info ] [MainThread]: Finished running 1 incremental model, 5 table models, 5 view models in 0 hours 0 minutes and 8.43 seconds (8.43s).
[0m19:45:22.096227 [debug] [MainThread]: Command end result
[0m19:45:22.292338 [debug] [MainThread]: Wrote artifact WritableManifest to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\manifest.json
[0m19:45:22.293319 [debug] [MainThread]: Wrote artifact SemanticManifest to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\semantic_manifest.json
[0m19:45:22.308138 [debug] [MainThread]: Wrote artifact RunExecutionResult to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\run_results.json
[0m19:45:22.308138 [info ] [MainThread]: 
[0m19:45:22.308138 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:45:22.308138 [info ] [MainThread]: 
[0m19:45:22.308138 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m19:45:22.308138 [debug] [MainThread]: Command `dbt run` succeeded at 19:45:22.308138 after 11.99 seconds
[0m19:45:22.308138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D8DBE02E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018DA8749580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018DA8749820>]}
[0m19:45:22.324203 [debug] [MainThread]: Flushing usage events
[0m19:45:23.055654 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:55:49.188974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000296C2DDF400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000296C4E53BB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000296C4E539A0>]}


============================== 19:55:49.198473 | 2525d6d9-d551-4049-aa19-4511179c6c96 ==============================
[0m19:55:49.198473 [info ] [MainThread]: Running with dbt=1.9.0
[0m19:55:49.199553 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'c:\\Users\\fitzp\\Documents\\Alpaca_Market\\zproject_2\\northwind_psql', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'c:\\Users\\fitzp\\Documents\\Alpaca_Market\\zproject_2\\northwind_psql\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m19:55:50.629484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2525d6d9-d551-4049-aa19-4511179c6c96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000296C1DC79A0>]}
[0m19:55:50.703881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2525d6d9-d551-4049-aa19-4511179c6c96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000296DD939E80>]}
[0m19:55:50.705631 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m19:55:51.135243 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m19:55:51.711113 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 1 files changed.
[0m19:55:51.711113 [debug] [MainThread]: Partial parsing: added file: northwind_dbt://models\marts\analysis\top_employee_revenue.sql
[0m19:55:51.711113 [debug] [MainThread]: Partial parsing: added file: northwind_dbt://models\marts\analysis\underperforming_products.sql
[0m19:55:51.711113 [debug] [MainThread]: Partial parsing: updated file: northwind_dbt://models\marts\analysis\schema.yml
[0m19:55:52.173473 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.northwind_dbt.marts.bi
[0m19:55:52.190521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2525d6d9-d551-4049-aa19-4511179c6c96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000296DE2D1130>]}
[0m19:55:52.435739 [debug] [MainThread]: Wrote artifact WritableManifest to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\manifest.json
[0m19:55:52.435739 [debug] [MainThread]: Wrote artifact SemanticManifest to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\semantic_manifest.json
[0m19:55:52.498791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2525d6d9-d551-4049-aa19-4511179c6c96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000296DE23DF10>]}
[0m19:55:52.498791 [info ] [MainThread]: Found 13 models, 1 snapshot, 16 data tests, 8 sources, 706 macros
[0m19:55:52.498791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2525d6d9-d551-4049-aa19-4511179c6c96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000296DDF44AC0>]}
[0m19:55:52.498791 [info ] [MainThread]: 
[0m19:55:52.498791 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:55:52.498791 [info ] [MainThread]: 
[0m19:55:52.510910 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:55:52.516922 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_Project_2'
[0m19:55:52.633872 [debug] [ThreadPool]: Using snowflake connection "list_Project_2"
[0m19:55:52.637180 [debug] [ThreadPool]: On list_Project_2: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "connection_name": "list_Project_2"} */
show terse schemas in database Project_2
    limit 10000
[0m19:55:52.637180 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:55:53.380397 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.745 seconds
[0m19:55:53.388336 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_Project_2_public'
[0m19:55:53.395957 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_Project_2_snapshots'
[0m19:55:53.422327 [debug] [ThreadPool]: Using snowflake connection "list_Project_2_public"
[0m19:55:53.432330 [debug] [ThreadPool]: Using snowflake connection "list_Project_2_snapshots"
[0m19:55:53.435130 [debug] [ThreadPool]: On list_Project_2_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "connection_name": "list_Project_2_public"} */
show objects in Project_2.public limit 10000;
[0m19:55:53.437143 [debug] [ThreadPool]: On list_Project_2_snapshots: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "connection_name": "list_Project_2_snapshots"} */
show objects in Project_2.snapshots limit 10000;
[0m19:55:53.439138 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:55:53.441137 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:55:53.882243 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bbb19b-020d-00ab-000c-83e7000b51b6
[0m19:55:53.882243 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m19:55:53.893516 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m19:55:53.894155 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m19:55:53.909248 [debug] [ThreadPool]: SQL status: SUCCESS 25 in 0.475 seconds
[0m19:55:53.918942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2525d6d9-d551-4049-aa19-4511179c6c96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000296C1CD2850>]}
[0m19:55:53.918942 [debug] [Thread-1  ]: Began running node model.northwind_dbt.stg_customers
[0m19:55:53.918942 [debug] [Thread-2  ]: Began running node model.northwind_dbt.stg_employees
[0m19:55:53.918942 [debug] [Thread-3  ]: Began running node model.northwind_dbt.stg_order_details
[0m19:55:53.924931 [debug] [Thread-4  ]: Began running node model.northwind_dbt.stg_orders
[0m19:55:53.924931 [info ] [Thread-1  ]: 1 of 13 START sql view model public.stg_customers .............................. [RUN]
[0m19:55:53.924931 [info ] [Thread-2  ]: 2 of 13 START sql view model public.stg_employees .............................. [RUN]
[0m19:55:53.924931 [info ] [Thread-3  ]: 3 of 13 START sql view model public.stg_order_details .......................... [RUN]
[0m19:55:53.924931 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.northwind_dbt.stg_customers'
[0m19:55:53.924931 [info ] [Thread-4  ]: 4 of 13 START sql view model public.stg_orders ................................. [RUN]
[0m19:55:53.924931 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.northwind_dbt.stg_employees'
[0m19:55:53.924931 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.northwind_dbt.stg_order_details'
[0m19:55:53.924931 [debug] [Thread-1  ]: Began compiling node model.northwind_dbt.stg_customers
[0m19:55:53.924931 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.northwind_dbt.stg_orders'
[0m19:55:53.924931 [debug] [Thread-2  ]: Began compiling node model.northwind_dbt.stg_employees
[0m19:55:53.924931 [debug] [Thread-3  ]: Began compiling node model.northwind_dbt.stg_order_details
[0m19:55:53.941834 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind_dbt.stg_customers"
[0m19:55:53.942591 [debug] [Thread-4  ]: Began compiling node model.northwind_dbt.stg_orders
[0m19:55:54.022502 [debug] [Thread-2  ]: Writing injected SQL for node "model.northwind_dbt.stg_employees"
[0m19:55:54.025804 [debug] [Thread-3  ]: Writing injected SQL for node "model.northwind_dbt.stg_order_details"
[0m19:55:54.029781 [debug] [Thread-4  ]: Writing injected SQL for node "model.northwind_dbt.stg_orders"
[0m19:55:54.038177 [debug] [Thread-1  ]: Began executing node model.northwind_dbt.stg_customers
[0m19:55:54.038177 [debug] [Thread-4  ]: Began executing node model.northwind_dbt.stg_orders
[0m19:55:54.075712 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind_dbt.stg_customers"
[0m19:55:54.075712 [debug] [Thread-4  ]: Writing runtime sql for node "model.northwind_dbt.stg_orders"
[0m19:55:54.102030 [debug] [Thread-3  ]: Began executing node model.northwind_dbt.stg_order_details
[0m19:55:54.102030 [debug] [Thread-2  ]: Began executing node model.northwind_dbt.stg_employees
[0m19:55:54.102030 [debug] [Thread-1  ]: Using snowflake connection "model.northwind_dbt.stg_customers"
[0m19:55:54.102030 [debug] [Thread-4  ]: Using snowflake connection "model.northwind_dbt.stg_orders"
[0m19:55:54.114064 [debug] [Thread-3  ]: Writing runtime sql for node "model.northwind_dbt.stg_order_details"
[0m19:55:54.117853 [debug] [Thread-2  ]: Writing runtime sql for node "model.northwind_dbt.stg_employees"
[0m19:55:54.117853 [debug] [Thread-1  ]: On model.northwind_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.stg_customers"} */
create or replace   view Project_2.public.stg_customers
  
   as (
    select * from PROJECT_2.PUBLIC.customers
  );
[0m19:55:54.117853 [debug] [Thread-4  ]: On model.northwind_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.stg_orders"} */
create or replace   view Project_2.public.stg_orders
  
   as (
    select * from PROJECT_2.PUBLIC.orders
  );
[0m19:55:54.117853 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m19:55:54.117853 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m19:55:54.133849 [debug] [Thread-2  ]: Using snowflake connection "model.northwind_dbt.stg_employees"
[0m19:55:54.133849 [debug] [Thread-3  ]: Using snowflake connection "model.northwind_dbt.stg_order_details"
[0m19:55:54.133849 [debug] [Thread-2  ]: On model.northwind_dbt.stg_employees: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.stg_employees"} */
create or replace   view Project_2.public.stg_employees
  
   as (
    select * from PROJECT_2.PUBLIC.employees
  );
[0m19:55:54.133849 [debug] [Thread-3  ]: On model.northwind_dbt.stg_order_details: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.stg_order_details"} */
create or replace   view Project_2.public.stg_order_details
  
   as (
    select * from PROJECT_2.PUBLIC.order_details
  );
[0m19:55:54.133849 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m19:55:54.133849 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m19:55:54.850082 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.718 seconds
[0m19:55:54.878870 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2525d6d9-d551-4049-aa19-4511179c6c96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000296DF9DCA60>]}
[0m19:55:54.878870 [info ] [Thread-3  ]: 3 of 13 OK created sql view model public.stg_order_details ..................... [[32mSUCCESS 1[0m in 0.95s]
[0m19:55:54.882129 [debug] [Thread-3  ]: Finished running node model.northwind_dbt.stg_order_details
[0m19:55:54.882603 [debug] [Thread-3  ]: Began running node model.northwind_dbt.stg_products
[0m19:55:54.883108 [info ] [Thread-3  ]: 5 of 13 START sql view model public.stg_products ............................... [RUN]
[0m19:55:54.884042 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.northwind_dbt.stg_order_details, now model.northwind_dbt.stg_products)
[0m19:55:54.884570 [debug] [Thread-3  ]: Began compiling node model.northwind_dbt.stg_products
[0m19:55:54.886960 [debug] [Thread-3  ]: Writing injected SQL for node "model.northwind_dbt.stg_products"
[0m19:55:54.894127 [debug] [Thread-3  ]: Began executing node model.northwind_dbt.stg_products
[0m19:55:54.900933 [debug] [Thread-3  ]: Writing runtime sql for node "model.northwind_dbt.stg_products"
[0m19:55:54.910138 [debug] [Thread-3  ]: Using snowflake connection "model.northwind_dbt.stg_products"
[0m19:55:54.910138 [debug] [Thread-3  ]: On model.northwind_dbt.stg_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.stg_products"} */
create or replace   view Project_2.public.stg_products
  
   as (
    select * from PROJECT_2.PUBLIC.products
  );
[0m19:55:54.966051 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.844 seconds
[0m19:55:54.970049 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2525d6d9-d551-4049-aa19-4511179c6c96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000296DDF6B610>]}
[0m19:55:54.971049 [info ] [Thread-4  ]: 4 of 13 OK created sql view model public.stg_orders ............................ [[32mSUCCESS 1[0m in 1.05s]
[0m19:55:54.973051 [debug] [Thread-4  ]: Finished running node model.northwind_dbt.stg_orders
[0m19:55:54.973051 [debug] [Thread-4  ]: Began running node model.northwind_dbt.fact_order_details
[0m19:55:54.974050 [info ] [Thread-4  ]: 6 of 13 START sql incremental model public.fact_order_details .................. [RUN]
[0m19:55:54.975050 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.northwind_dbt.stg_orders, now model.northwind_dbt.fact_order_details)
[0m19:55:54.975050 [debug] [Thread-4  ]: Began compiling node model.northwind_dbt.fact_order_details
[0m19:55:54.976553 [debug] [Thread-4  ]: Writing injected SQL for node "model.northwind_dbt.fact_order_details"
[0m19:55:54.976553 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.867 seconds
[0m19:55:54.976553 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2525d6d9-d551-4049-aa19-4511179c6c96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000296C1CD2850>]}
[0m19:55:54.993060 [info ] [Thread-1  ]: 1 of 13 OK created sql view model public.stg_customers ......................... [[32mSUCCESS 1[0m in 1.05s]
[0m19:55:54.994771 [debug] [Thread-1  ]: Finished running node model.northwind_dbt.stg_customers
[0m19:55:54.995344 [debug] [Thread-1  ]: Began running node model.northwind_dbt.dim_customers
[0m19:55:54.995344 [debug] [Thread-4  ]: Began executing node model.northwind_dbt.fact_order_details
[0m19:55:54.995344 [info ] [Thread-1  ]: 7 of 13 START sql table model public.dim_customers ............................. [RUN]
[0m19:55:55.027158 [debug] [Thread-4  ]: Using snowflake connection "model.northwind_dbt.fact_order_details"
[0m19:55:55.027158 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.northwind_dbt.stg_customers, now model.northwind_dbt.dim_customers)
[0m19:55:55.027158 [debug] [Thread-4  ]: On model.northwind_dbt.fact_order_details: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.fact_order_details"} */
create or replace  temporary view Project_2.public.fact_order_details__dbt_tmp
  
   as (
    

with base as (
    select 
        od.order_id,
        od.product_id,
        o.customer_id,
        o.employee_id,
        o.ship_via as shipper_id,
        o.order_date,
        od.unit_price,
        od.quantity,
        od.discount,
        od.unit_price * od.quantity * (1 - od.discount) as revenue
    from Project_2.public.stg_order_details od
    join Project_2.public.stg_orders o on od.order_id = o.order_id
    
        and o.order_date >= (select max(order_date) from Project_2.public.fact_order_details)
    
),
aggregated as (
    select 
        order_id,
        product_id,
        customer_id,
        employee_id,
        shipper_id,
        cast(order_date as date) as order_date,
        sum(revenue) as total_revenue,
        avg(revenue) as avg_revenue,
        max(revenue) as max_revenue,
        min(revenue) as min_revenue,
        count(*) as line_count,
        rank() over (partition by customer_id order by sum(revenue) desc) as revenue_rank
    from base
    group by order_id, product_id, customer_id, employee_id, shipper_id, order_date
)
select * from aggregated
  );
[0m19:55:55.027158 [debug] [Thread-1  ]: Began compiling node model.northwind_dbt.dim_customers
[0m19:55:55.036224 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind_dbt.dim_customers"
[0m19:55:55.045290 [debug] [Thread-1  ]: Began executing node model.northwind_dbt.dim_customers
[0m19:55:55.067447 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind_dbt.dim_customers"
[0m19:55:55.076718 [debug] [Thread-1  ]: Using snowflake connection "model.northwind_dbt.dim_customers"
[0m19:55:55.077726 [debug] [Thread-1  ]: On model.northwind_dbt.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.dim_customers"} */
create or replace transient table Project_2.public.dim_customers
         as
        (select * from Project_2.public.stg_customers
        );
[0m19:55:55.312291 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.175 seconds
[0m19:55:55.312291 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2525d6d9-d551-4049-aa19-4511179c6c96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000296DF9DCA30>]}
[0m19:55:55.312291 [info ] [Thread-2  ]: 2 of 13 OK created sql view model public.stg_employees ......................... [[32mSUCCESS 1[0m in 1.39s]
[0m19:55:55.312291 [debug] [Thread-2  ]: Finished running node model.northwind_dbt.stg_employees
[0m19:55:55.312291 [debug] [Thread-2  ]: Began running node model.northwind_dbt.dim_employees
[0m19:55:55.312291 [info ] [Thread-2  ]: 8 of 13 START sql table model public.dim_employees ............................. [RUN]
[0m19:55:55.312291 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.northwind_dbt.stg_employees, now model.northwind_dbt.dim_employees)
[0m19:55:55.312291 [debug] [Thread-2  ]: Began compiling node model.northwind_dbt.dim_employees
[0m19:55:55.330871 [debug] [Thread-2  ]: Writing injected SQL for node "model.northwind_dbt.dim_employees"
[0m19:55:55.357855 [debug] [Thread-2  ]: Began executing node model.northwind_dbt.dim_employees
[0m19:55:55.357855 [debug] [Thread-2  ]: Writing runtime sql for node "model.northwind_dbt.dim_employees"
[0m19:55:55.377046 [debug] [Thread-2  ]: Using snowflake connection "model.northwind_dbt.dim_employees"
[0m19:55:55.377046 [debug] [Thread-2  ]: On model.northwind_dbt.dim_employees: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.dim_employees"} */
create or replace transient table Project_2.public.dim_employees
         as
        (with source_data as (
    select * from Project_2.public.stg_employees
),
scd2 as (
    select 
        md5(cast(coalesce(cast(employee_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as employee_key,
        *,
        current_timestamp as dbt_updated_at
    from source_data
)
select * from scd2
        );
[0m19:55:55.383271 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.468 seconds
[0m19:55:55.390237 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2525d6d9-d551-4049-aa19-4511179c6c96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000296C4135940>]}
[0m19:55:55.392194 [info ] [Thread-3  ]: 5 of 13 OK created sql view model public.stg_products .......................... [[32mSUCCESS 1[0m in 0.51s]
[0m19:55:55.396520 [debug] [Thread-3  ]: Finished running node model.northwind_dbt.stg_products
[0m19:55:55.398512 [debug] [Thread-3  ]: Began running node model.northwind_dbt.dim_products
[0m19:55:55.400566 [info ] [Thread-3  ]: 9 of 13 START sql table model public.dim_products .............................. [RUN]
[0m19:55:55.402833 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.northwind_dbt.stg_products, now model.northwind_dbt.dim_products)
[0m19:55:55.404462 [debug] [Thread-3  ]: Began compiling node model.northwind_dbt.dim_products
[0m19:55:55.410700 [debug] [Thread-3  ]: Writing injected SQL for node "model.northwind_dbt.dim_products"
[0m19:55:55.423927 [debug] [Thread-3  ]: Began executing node model.northwind_dbt.dim_products
[0m19:55:55.428833 [debug] [Thread-3  ]: Writing runtime sql for node "model.northwind_dbt.dim_products"
[0m19:55:55.441028 [debug] [Thread-3  ]: Using snowflake connection "model.northwind_dbt.dim_products"
[0m19:55:55.441028 [debug] [Thread-3  ]: On model.northwind_dbt.dim_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.dim_products"} */
create or replace transient table Project_2.public.dim_products
         as
        (select 
    p.product_id,
    p.product_name,
    p.supplier_id,
    s.company_name as supplier_name,
    p.category_id,
    c.category_name,
    p.quantity_per_unit,
    p.unit_price,
    p.units_in_stock,
    p.units_on_order,
    p.reorder_level,
    p.discontinued
from Project_2.public.stg_products p
left join PROJECT_2.PUBLIC.suppliers s on p.supplier_id = s.supplier_id
left join PROJECT_2.PUBLIC.categories c on p.category_id = c.category_id
        );
[0m19:55:55.479134 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.447 seconds
[0m19:55:55.488437 [debug] [Thread-4  ]: Using snowflake connection "model.northwind_dbt.fact_order_details"
[0m19:55:55.489531 [debug] [Thread-4  ]: On model.northwind_dbt.fact_order_details: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.fact_order_details"} */
describe table Project_2.public.fact_order_details__dbt_tmp
[0m19:55:55.595652 [debug] [Thread-4  ]: SQL status: SUCCESS 12 in 0.106 seconds
[0m19:55:55.601682 [debug] [Thread-4  ]: Using snowflake connection "model.northwind_dbt.fact_order_details"
[0m19:55:55.601682 [debug] [Thread-4  ]: On model.northwind_dbt.fact_order_details: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.fact_order_details"} */
describe table Project_2.public.fact_order_details
[0m19:55:55.714030 [debug] [Thread-4  ]: SQL status: SUCCESS 12 in 0.112 seconds
[0m19:55:55.737913 [debug] [Thread-4  ]: Using snowflake connection "model.northwind_dbt.fact_order_details"
[0m19:55:55.738461 [debug] [Thread-4  ]: On model.northwind_dbt.fact_order_details: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.fact_order_details"} */
describe table "PROJECT_2"."PUBLIC"."FACT_ORDER_DETAILS"
[0m19:55:55.794126 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.721 seconds
[0m19:55:55.794126 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2525d6d9-d551-4049-aa19-4511179c6c96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000296DE23DFA0>]}
[0m19:55:55.794126 [info ] [Thread-1  ]: 7 of 13 OK created sql table model public.dim_customers ........................ [[32mSUCCESS 1[0m in 0.77s]
[0m19:55:55.794126 [debug] [Thread-1  ]: Finished running node model.northwind_dbt.dim_customers
[0m19:55:55.809685 [debug] [Thread-4  ]: SQL status: SUCCESS 12 in 0.080 seconds
[0m19:55:55.842223 [debug] [Thread-4  ]: Writing runtime sql for node "model.northwind_dbt.fact_order_details"
[0m19:55:55.860130 [debug] [Thread-4  ]: Using snowflake connection "model.northwind_dbt.fact_order_details"
[0m19:55:55.861144 [debug] [Thread-4  ]: On model.northwind_dbt.fact_order_details: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.fact_order_details"} */
-- back compat for old kwarg name
  
  begin;
[0m19:55:56.150094 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.288 seconds
[0m19:55:56.151218 [debug] [Thread-4  ]: Using snowflake connection "model.northwind_dbt.fact_order_details"
[0m19:55:56.152370 [debug] [Thread-4  ]: On model.northwind_dbt.fact_order_details: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.fact_order_details"} */
merge into Project_2.public.fact_order_details as DBT_INTERNAL_DEST
        using Project_2.public.fact_order_details__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.order_id = DBT_INTERNAL_DEST.order_id
                ) and (
                    DBT_INTERNAL_SOURCE.product_id = DBT_INTERNAL_DEST.product_id
                )

    
    when matched then update set
        "ORDER_ID" = DBT_INTERNAL_SOURCE."ORDER_ID","PRODUCT_ID" = DBT_INTERNAL_SOURCE."PRODUCT_ID","CUSTOMER_ID" = DBT_INTERNAL_SOURCE."CUSTOMER_ID","EMPLOYEE_ID" = DBT_INTERNAL_SOURCE."EMPLOYEE_ID","SHIPPER_ID" = DBT_INTERNAL_SOURCE."SHIPPER_ID","ORDER_DATE" = DBT_INTERNAL_SOURCE."ORDER_DATE","TOTAL_REVENUE" = DBT_INTERNAL_SOURCE."TOTAL_REVENUE","AVG_REVENUE" = DBT_INTERNAL_SOURCE."AVG_REVENUE","MAX_REVENUE" = DBT_INTERNAL_SOURCE."MAX_REVENUE","MIN_REVENUE" = DBT_INTERNAL_SOURCE."MIN_REVENUE","LINE_COUNT" = DBT_INTERNAL_SOURCE."LINE_COUNT","REVENUE_RANK" = DBT_INTERNAL_SOURCE."REVENUE_RANK"
    

    when not matched then insert
        ("ORDER_ID", "PRODUCT_ID", "CUSTOMER_ID", "EMPLOYEE_ID", "SHIPPER_ID", "ORDER_DATE", "TOTAL_REVENUE", "AVG_REVENUE", "MAX_REVENUE", "MIN_REVENUE", "LINE_COUNT", "REVENUE_RANK")
    values
        ("ORDER_ID", "PRODUCT_ID", "CUSTOMER_ID", "EMPLOYEE_ID", "SHIPPER_ID", "ORDER_DATE", "TOTAL_REVENUE", "AVG_REVENUE", "MAX_REVENUE", "MIN_REVENUE", "LINE_COUNT", "REVENUE_RANK")

;
[0m19:55:56.217705 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.837 seconds
[0m19:55:56.221204 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2525d6d9-d551-4049-aa19-4511179c6c96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000296DE0BF6A0>]}
[0m19:55:56.222434 [info ] [Thread-2  ]: 8 of 13 OK created sql table model public.dim_employees ........................ [[32mSUCCESS 1[0m in 0.91s]
[0m19:55:56.224172 [debug] [Thread-2  ]: Finished running node model.northwind_dbt.dim_employees
[0m19:55:56.905066 [debug] [Thread-4  ]: SQL status: SUCCESS 32 in 0.751 seconds
[0m19:55:56.905648 [debug] [Thread-4  ]: Using snowflake connection "model.northwind_dbt.fact_order_details"
[0m19:55:56.906302 [debug] [Thread-4  ]: On model.northwind_dbt.fact_order_details: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.fact_order_details"} */
COMMIT
[0m19:55:56.979017 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1.535 seconds
[0m19:55:56.982911 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2525d6d9-d551-4049-aa19-4511179c6c96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000296DF9DCA60>]}
[0m19:55:56.985108 [info ] [Thread-3  ]: 9 of 13 OK created sql table model public.dim_products ......................... [[32mSUCCESS 1[0m in 1.58s]
[0m19:55:56.986737 [debug] [Thread-3  ]: Finished running node model.northwind_dbt.dim_products
[0m19:55:57.282095 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.375 seconds
[0m19:55:57.289894 [debug] [Thread-4  ]: Applying DROP to: Project_2.public.fact_order_details__dbt_tmp
[0m19:55:57.299084 [debug] [Thread-4  ]: Using snowflake connection "model.northwind_dbt.fact_order_details"
[0m19:55:57.300253 [debug] [Thread-4  ]: On model.northwind_dbt.fact_order_details: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.fact_order_details"} */
drop view if exists Project_2.public.fact_order_details__dbt_tmp cascade
[0m19:55:57.507964 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.207 seconds
[0m19:55:57.516085 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2525d6d9-d551-4049-aa19-4511179c6c96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000296DDF6B610>]}
[0m19:55:57.518374 [info ] [Thread-4  ]: 6 of 13 OK created sql incremental model public.fact_order_details ............. [[32mSUCCESS 32[0m in 2.54s]
[0m19:55:57.522874 [debug] [Thread-4  ]: Finished running node model.northwind_dbt.fact_order_details
[0m19:55:57.525650 [debug] [Thread-1  ]: Began running node model.northwind_dbt.obt_orders
[0m19:55:57.526765 [debug] [Thread-2  ]: Began running node model.northwind_dbt.top_customer_revenue
[0m19:55:57.527855 [debug] [Thread-3  ]: Began running node model.northwind_dbt.top_employee_revenue
[0m19:55:57.528949 [debug] [Thread-4  ]: Began running node model.northwind_dbt.underperforming_products
[0m19:55:57.531337 [info ] [Thread-1  ]: 10 of 13 START sql table model public.obt_orders ............................... [RUN]
[0m19:55:57.533127 [info ] [Thread-2  ]: 11 of 13 START sql table model public.top_customer_revenue ..................... [RUN]
[0m19:55:57.534830 [info ] [Thread-3  ]: 12 of 13 START sql table model public.top_employee_revenue ..................... [RUN]
[0m19:55:57.536513 [info ] [Thread-4  ]: 13 of 13 START sql table model public.underperforming_products ................. [RUN]
[0m19:55:57.538724 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.northwind_dbt.dim_customers, now model.northwind_dbt.obt_orders)
[0m19:55:57.540421 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.northwind_dbt.dim_employees, now model.northwind_dbt.top_customer_revenue)
[0m19:55:57.541526 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.northwind_dbt.dim_products, now model.northwind_dbt.top_employee_revenue)
[0m19:55:57.542619 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.northwind_dbt.fact_order_details, now model.northwind_dbt.underperforming_products)
[0m19:55:57.543147 [debug] [Thread-1  ]: Began compiling node model.northwind_dbt.obt_orders
[0m19:55:57.544237 [debug] [Thread-2  ]: Began compiling node model.northwind_dbt.top_customer_revenue
[0m19:55:57.544793 [debug] [Thread-3  ]: Began compiling node model.northwind_dbt.top_employee_revenue
[0m19:55:57.546493 [debug] [Thread-4  ]: Began compiling node model.northwind_dbt.underperforming_products
[0m19:55:57.553177 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind_dbt.obt_orders"
[0m19:55:57.560104 [debug] [Thread-2  ]: Writing injected SQL for node "model.northwind_dbt.top_customer_revenue"
[0m19:55:57.567522 [debug] [Thread-3  ]: Writing injected SQL for node "model.northwind_dbt.top_employee_revenue"
[0m19:55:57.576265 [debug] [Thread-4  ]: Writing injected SQL for node "model.northwind_dbt.underperforming_products"
[0m19:55:57.596492 [debug] [Thread-4  ]: Began executing node model.northwind_dbt.underperforming_products
[0m19:55:57.596492 [debug] [Thread-1  ]: Began executing node model.northwind_dbt.obt_orders
[0m19:55:57.598510 [debug] [Thread-3  ]: Began executing node model.northwind_dbt.top_employee_revenue
[0m19:55:57.603628 [debug] [Thread-4  ]: Writing runtime sql for node "model.northwind_dbt.underperforming_products"
[0m19:55:57.604595 [debug] [Thread-2  ]: Began executing node model.northwind_dbt.top_customer_revenue
[0m19:55:57.611753 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind_dbt.obt_orders"
[0m19:55:57.616751 [debug] [Thread-3  ]: Writing runtime sql for node "model.northwind_dbt.top_employee_revenue"
[0m19:55:57.626459 [debug] [Thread-2  ]: Writing runtime sql for node "model.northwind_dbt.top_customer_revenue"
[0m19:55:57.633443 [debug] [Thread-4  ]: Using snowflake connection "model.northwind_dbt.underperforming_products"
[0m19:55:57.634441 [debug] [Thread-4  ]: On model.northwind_dbt.underperforming_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.underperforming_products"} */
create or replace transient table Project_2.public.underperforming_products
         as
        (

select
  p.product_id,
  p.product_name,
  p.units_in_stock,
  coalesce(sum(f.total_revenue), 0) as total_revenue
from Project_2.public.dim_products p
left join Project_2.public.fact_order_details f on p.product_id = f.product_id
group by p.product_id, p.product_name, p.units_in_stock
having total_revenue < 1000 and units_in_stock > 10
order by total_revenue asc
        );
[0m19:55:57.647558 [debug] [Thread-2  ]: Using snowflake connection "model.northwind_dbt.top_customer_revenue"
[0m19:55:57.647558 [debug] [Thread-1  ]: Using snowflake connection "model.northwind_dbt.obt_orders"
[0m19:55:57.651994 [debug] [Thread-3  ]: Using snowflake connection "model.northwind_dbt.top_employee_revenue"
[0m19:55:57.653156 [debug] [Thread-2  ]: On model.northwind_dbt.top_customer_revenue: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.top_customer_revenue"} */
create or replace transient table Project_2.public.top_customer_revenue
         as
        (

select
  c.customer_id,
  c.company_name as customer_name,
  sum(f.total_revenue) as total_revenue
from Project_2.public.fact_order_details f
join Project_2.public.dim_customers c using (customer_id)
group by c.customer_id, c.company_name
order by total_revenue desc
        );
[0m19:55:57.654829 [debug] [Thread-1  ]: On model.northwind_dbt.obt_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.obt_orders"} */
create or replace transient table Project_2.public.obt_orders
         as
        (select 
    f.order_id,
    f.product_id,
    f.customer_id,
    f.employee_id,
    f.shipper_id,
    f.order_date,
    f.total_revenue,
    f.avg_revenue,
    f.max_revenue,
    f.min_revenue,
    f.line_count,
    f.revenue_rank,

    c.company_name as customer_name,
    p.product_name,
    p.category_name,
    p.supplier_name,
    e.first_name || ' ' || e.last_name as employee_name,
    s.company_name as shipper_name

from Project_2.public.fact_order_details f
left join Project_2.public.dim_customers c on f.customer_id = c.customer_id
left join Project_2.public.dim_products p on f.product_id = p.product_id
left join Project_2.public.dim_employees e on f.employee_id = e.employee_id
left join PROJECT_2.PUBLIC.shippers s on f.shipper_id = s.shipper_id
        );
[0m19:55:57.656487 [debug] [Thread-3  ]: On model.northwind_dbt.top_employee_revenue: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.top_employee_revenue"} */
create or replace transient table Project_2.public.top_employee_revenue
         as
        (

select
  e.employee_key,
  e.first_name || ' ' || e.last_name as employee_name,
  sum(f.total_revenue) as total_revenue
from Project_2.public.fact_order_details f
join Project_2.public.dim_employees e on f.employee_id = e.employee_id
group by e.employee_key, employee_name
order by total_revenue desc
        );
[0m19:55:58.060503 [debug] [Thread-4  ]: Snowflake adapter: Snowflake query id: 01bbb19b-020d-05f9-000c-83e7000b9062
[0m19:55:58.061079 [debug] [Thread-4  ]: Snowflake adapter: Snowflake error: 000979 (42601): SQL compilation error:
[F.TOTAL_REVENUE] is not a valid group by expression
[0m19:55:58.064547 [debug] [Thread-4  ]: Database Error in model underperforming_products (models\marts\analysis\underperforming_products.sql)
  000979 (42601): SQL compilation error:
  [F.TOTAL_REVENUE] is not a valid group by expression
  compiled code at target\run\northwind_dbt\models\marts\analysis\underperforming_products.sql
[0m19:55:58.065091 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2525d6d9-d551-4049-aa19-4511179c6c96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000296DFB54460>]}
[0m19:55:58.066313 [error] [Thread-4  ]: 13 of 13 ERROR creating sql table model public.underperforming_products ........ [[31mERROR[0m in 0.52s]
[0m19:55:58.067457 [debug] [Thread-4  ]: Finished running node model.northwind_dbt.underperforming_products
[0m19:55:58.068097 [debug] [Thread-7  ]: Marking all children of 'model.northwind_dbt.underperforming_products' to be skipped because of status 'error'.  Reason: Database Error in model underperforming_products (models\marts\analysis\underperforming_products.sql)
  000979 (42601): SQL compilation error:
  [F.TOTAL_REVENUE] is not a valid group by expression
  compiled code at target\run\northwind_dbt\models\marts\analysis\underperforming_products.sql.
[0m19:55:58.695680 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1.033 seconds
[0m19:55:58.702495 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2525d6d9-d551-4049-aa19-4511179c6c96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000296DF9E97C0>]}
[0m19:55:58.704658 [info ] [Thread-3  ]: 12 of 13 OK created sql table model public.top_employee_revenue ................ [[32mSUCCESS 1[0m in 1.16s]
[0m19:55:58.707440 [debug] [Thread-3  ]: Finished running node model.northwind_dbt.top_employee_revenue
[0m19:55:58.981550 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.325 seconds
[0m19:55:58.983389 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2525d6d9-d551-4049-aa19-4511179c6c96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000296DFB160A0>]}
[0m19:55:58.983389 [info ] [Thread-2  ]: 11 of 13 OK created sql table model public.top_customer_revenue ................ [[32mSUCCESS 1[0m in 1.44s]
[0m19:55:58.983389 [debug] [Thread-2  ]: Finished running node model.northwind_dbt.top_customer_revenue
[0m19:55:59.165605 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.505 seconds
[0m19:55:59.168324 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2525d6d9-d551-4049-aa19-4511179c6c96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000296DFB74FA0>]}
[0m19:55:59.168324 [info ] [Thread-1  ]: 10 of 13 OK created sql table model public.obt_orders .......................... [[32mSUCCESS 1[0m in 1.63s]
[0m19:55:59.168324 [debug] [Thread-1  ]: Finished running node model.northwind_dbt.obt_orders
[0m19:55:59.168324 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:55:59.168324 [debug] [MainThread]: Connection 'list_Project_2' was left open.
[0m19:55:59.168324 [debug] [MainThread]: On list_Project_2: Close
[0m19:55:59.335001 [debug] [MainThread]: Connection 'list_Project_2_public' was left open.
[0m19:55:59.335001 [debug] [MainThread]: On list_Project_2_public: Close
[0m19:55:59.462957 [debug] [MainThread]: Connection 'list_Project_2_snapshots' was left open.
[0m19:55:59.462957 [debug] [MainThread]: On list_Project_2_snapshots: Close
[0m19:55:59.587469 [debug] [MainThread]: Connection 'model.northwind_dbt.obt_orders' was left open.
[0m19:55:59.587469 [debug] [MainThread]: On model.northwind_dbt.obt_orders: Close
[0m19:55:59.715421 [debug] [MainThread]: Connection 'model.northwind_dbt.top_customer_revenue' was left open.
[0m19:55:59.715421 [debug] [MainThread]: On model.northwind_dbt.top_customer_revenue: Close
[0m19:55:59.826016 [debug] [MainThread]: Connection 'model.northwind_dbt.top_employee_revenue' was left open.
[0m19:55:59.826016 [debug] [MainThread]: On model.northwind_dbt.top_employee_revenue: Close
[0m19:55:59.951745 [debug] [MainThread]: Connection 'model.northwind_dbt.underperforming_products' was left open.
[0m19:55:59.951745 [debug] [MainThread]: On model.northwind_dbt.underperforming_products: Close
[0m19:56:00.079528 [info ] [MainThread]: 
[0m19:56:00.081550 [info ] [MainThread]: Finished running 1 incremental model, 7 table models, 5 view models in 0 hours 0 minutes and 7.57 seconds (7.57s).
[0m19:56:00.083567 [debug] [MainThread]: Command end result
[0m19:56:00.262267 [debug] [MainThread]: Wrote artifact WritableManifest to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\manifest.json
[0m19:56:00.267974 [debug] [MainThread]: Wrote artifact SemanticManifest to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\semantic_manifest.json
[0m19:56:00.285701 [debug] [MainThread]: Wrote artifact RunExecutionResult to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\run_results.json
[0m19:56:00.285701 [info ] [MainThread]: 
[0m19:56:00.287095 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m19:56:00.288137 [info ] [MainThread]: 
[0m19:56:00.289180 [error] [MainThread]:   Database Error in model underperforming_products (models\marts\analysis\underperforming_products.sql)
  000979 (42601): SQL compilation error:
  [F.TOTAL_REVENUE] is not a valid group by expression
  compiled code at target\run\northwind_dbt\models\marts\analysis\underperforming_products.sql
[0m19:56:00.289180 [info ] [MainThread]: 
[0m19:56:00.290113 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=1 SKIP=0 TOTAL=13
[0m19:56:00.291053 [debug] [MainThread]: Command `dbt run` failed at 19:56:00.291053 after 11.22 seconds
[0m19:56:00.292116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000296C2DDF400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000296DFB765E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000296DFB76FD0>]}
[0m19:56:00.292116 [debug] [MainThread]: Flushing usage events
[0m19:56:01.151866 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:57:09.621417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D56C4F340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D58CC3C40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D58CC3A30>]}


============================== 19:57:09.637265 | 66c29ea0-2ca3-4d9e-bf22-0f33aa818413 ==============================
[0m19:57:09.637265 [info ] [MainThread]: Running with dbt=1.9.0
[0m19:57:09.637265 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'c:\\Users\\fitzp\\Documents\\Alpaca_Market\\zproject_2\\northwind_psql', 'debug': 'False', 'warn_error': 'None', 'log_path': 'c:\\Users\\fitzp\\Documents\\Alpaca_Market\\zproject_2\\northwind_psql\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:57:10.540722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '66c29ea0-2ca3-4d9e-bf22-0f33aa818413', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D55C37850>]}
[0m19:57:10.601654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '66c29ea0-2ca3-4d9e-bf22-0f33aa818413', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D717B10A0>]}
[0m19:57:10.601654 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m19:57:10.929031 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m19:57:11.376559 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:57:11.378574 [debug] [MainThread]: Partial parsing: updated file: northwind_dbt://models\marts\analysis\underperforming_products.sql
[0m19:57:11.759498 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.northwind_dbt.marts.bi
[0m19:57:11.773736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '66c29ea0-2ca3-4d9e-bf22-0f33aa818413', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D72146130>]}
[0m19:57:12.039863 [debug] [MainThread]: Wrote artifact WritableManifest to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\manifest.json
[0m19:57:12.050625 [debug] [MainThread]: Wrote artifact SemanticManifest to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\semantic_manifest.json
[0m19:57:12.093823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '66c29ea0-2ca3-4d9e-bf22-0f33aa818413', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D721319A0>]}
[0m19:57:12.099664 [info ] [MainThread]: Found 13 models, 1 snapshot, 16 data tests, 8 sources, 706 macros
[0m19:57:12.099664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '66c29ea0-2ca3-4d9e-bf22-0f33aa818413', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D720F78B0>]}
[0m19:57:12.099664 [info ] [MainThread]: 
[0m19:57:12.099664 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:57:12.099664 [info ] [MainThread]: 
[0m19:57:12.106965 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:57:12.112739 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_Project_2'
[0m19:57:12.198654 [debug] [ThreadPool]: Using snowflake connection "list_Project_2"
[0m19:57:12.198654 [debug] [ThreadPool]: On list_Project_2: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "connection_name": "list_Project_2"} */
show terse schemas in database Project_2
    limit 10000
[0m19:57:12.198654 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:57:12.855397 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.653 seconds
[0m19:57:12.859419 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_Project_2_public'
[0m19:57:12.859419 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_Project_2_snapshots'
[0m19:57:12.869168 [debug] [ThreadPool]: Using snowflake connection "list_Project_2_public"
[0m19:57:12.869168 [debug] [ThreadPool]: Using snowflake connection "list_Project_2_snapshots"
[0m19:57:12.869168 [debug] [ThreadPool]: On list_Project_2_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "connection_name": "list_Project_2_public"} */
show objects in Project_2.public limit 10000;
[0m19:57:12.869168 [debug] [ThreadPool]: On list_Project_2_snapshots: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "connection_name": "list_Project_2_snapshots"} */
show objects in Project_2.snapshots limit 10000;
[0m19:57:12.869168 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:57:12.869168 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:57:13.402975 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bbb19d-020d-034d-000c-83e7000bc062
[0m19:57:13.410268 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m19:57:13.410268 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m19:57:13.410268 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m19:57:13.420351 [debug] [ThreadPool]: SQL status: SUCCESS 26 in 0.543 seconds
[0m19:57:13.422356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '66c29ea0-2ca3-4d9e-bf22-0f33aa818413', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D7176FE80>]}
[0m19:57:13.422356 [debug] [Thread-1  ]: Began running node model.northwind_dbt.stg_customers
[0m19:57:13.422356 [debug] [Thread-2  ]: Began running node model.northwind_dbt.stg_employees
[0m19:57:13.422356 [debug] [Thread-3  ]: Began running node model.northwind_dbt.stg_order_details
[0m19:57:13.422356 [debug] [Thread-4  ]: Began running node model.northwind_dbt.stg_orders
[0m19:57:13.422356 [info ] [Thread-1  ]: 1 of 13 START sql view model public.stg_customers .............................. [RUN]
[0m19:57:13.422356 [info ] [Thread-2  ]: 2 of 13 START sql view model public.stg_employees .............................. [RUN]
[0m19:57:13.422356 [info ] [Thread-3  ]: 3 of 13 START sql view model public.stg_order_details .......................... [RUN]
[0m19:57:13.434229 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.northwind_dbt.stg_customers'
[0m19:57:13.434229 [info ] [Thread-4  ]: 4 of 13 START sql view model public.stg_orders ................................. [RUN]
[0m19:57:13.434229 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.northwind_dbt.stg_employees'
[0m19:57:13.434229 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.northwind_dbt.stg_order_details'
[0m19:57:13.434229 [debug] [Thread-1  ]: Began compiling node model.northwind_dbt.stg_customers
[0m19:57:13.434229 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.northwind_dbt.stg_orders'
[0m19:57:13.434229 [debug] [Thread-2  ]: Began compiling node model.northwind_dbt.stg_employees
[0m19:57:13.434229 [debug] [Thread-3  ]: Began compiling node model.northwind_dbt.stg_order_details
[0m19:57:13.444649 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind_dbt.stg_customers"
[0m19:57:13.444649 [debug] [Thread-4  ]: Began compiling node model.northwind_dbt.stg_orders
[0m19:57:13.515637 [debug] [Thread-2  ]: Writing injected SQL for node "model.northwind_dbt.stg_employees"
[0m19:57:13.518527 [debug] [Thread-3  ]: Writing injected SQL for node "model.northwind_dbt.stg_order_details"
[0m19:57:13.521146 [debug] [Thread-4  ]: Writing injected SQL for node "model.northwind_dbt.stg_orders"
[0m19:57:13.538211 [debug] [Thread-1  ]: Began executing node model.northwind_dbt.stg_customers
[0m19:57:13.540208 [debug] [Thread-4  ]: Began executing node model.northwind_dbt.stg_orders
[0m19:57:13.541208 [debug] [Thread-2  ]: Began executing node model.northwind_dbt.stg_employees
[0m19:57:13.541208 [debug] [Thread-3  ]: Began executing node model.northwind_dbt.stg_order_details
[0m19:57:13.560176 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind_dbt.stg_customers"
[0m19:57:13.569108 [debug] [Thread-4  ]: Writing runtime sql for node "model.northwind_dbt.stg_orders"
[0m19:57:13.569108 [debug] [Thread-2  ]: Writing runtime sql for node "model.northwind_dbt.stg_employees"
[0m19:57:13.574573 [debug] [Thread-3  ]: Writing runtime sql for node "model.northwind_dbt.stg_order_details"
[0m19:57:13.589665 [debug] [Thread-4  ]: Using snowflake connection "model.northwind_dbt.stg_orders"
[0m19:57:13.589665 [debug] [Thread-2  ]: Using snowflake connection "model.northwind_dbt.stg_employees"
[0m19:57:13.589665 [debug] [Thread-1  ]: Using snowflake connection "model.northwind_dbt.stg_customers"
[0m19:57:13.589665 [debug] [Thread-4  ]: On model.northwind_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.stg_orders"} */
create or replace   view Project_2.public.stg_orders
  
   as (
    select * from PROJECT_2.PUBLIC.orders
  );
[0m19:57:13.589665 [debug] [Thread-2  ]: On model.northwind_dbt.stg_employees: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.stg_employees"} */
create or replace   view Project_2.public.stg_employees
  
   as (
    select * from PROJECT_2.PUBLIC.employees
  );
[0m19:57:13.589665 [debug] [Thread-1  ]: On model.northwind_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.stg_customers"} */
create or replace   view Project_2.public.stg_customers
  
   as (
    select * from PROJECT_2.PUBLIC.customers
  );
[0m19:57:13.589665 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m19:57:13.589665 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m19:57:13.589665 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m19:57:13.589665 [debug] [Thread-3  ]: Using snowflake connection "model.northwind_dbt.stg_order_details"
[0m19:57:13.605928 [debug] [Thread-3  ]: On model.northwind_dbt.stg_order_details: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.stg_order_details"} */
create or replace   view Project_2.public.stg_order_details
  
   as (
    select * from PROJECT_2.PUBLIC.order_details
  );
[0m19:57:13.605928 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m19:57:14.314113 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.704 seconds
[0m19:57:14.336071 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '66c29ea0-2ca3-4d9e-bf22-0f33aa818413', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D58C95970>]}
[0m19:57:14.336071 [info ] [Thread-3  ]: 3 of 13 OK created sql view model public.stg_order_details ..................... [[32mSUCCESS 1[0m in 0.89s]
[0m19:57:14.336071 [debug] [Thread-3  ]: Finished running node model.northwind_dbt.stg_order_details
[0m19:57:14.336071 [debug] [Thread-3  ]: Began running node model.northwind_dbt.stg_products
[0m19:57:14.339516 [info ] [Thread-3  ]: 5 of 13 START sql view model public.stg_products ............................... [RUN]
[0m19:57:14.339516 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.northwind_dbt.stg_order_details, now model.northwind_dbt.stg_products)
[0m19:57:14.339516 [debug] [Thread-3  ]: Began compiling node model.northwind_dbt.stg_products
[0m19:57:14.344265 [debug] [Thread-3  ]: Writing injected SQL for node "model.northwind_dbt.stg_products"
[0m19:57:14.355379 [debug] [Thread-3  ]: Began executing node model.northwind_dbt.stg_products
[0m19:57:14.362905 [debug] [Thread-3  ]: Writing runtime sql for node "model.northwind_dbt.stg_products"
[0m19:57:14.363499 [debug] [Thread-3  ]: Using snowflake connection "model.northwind_dbt.stg_products"
[0m19:57:14.363499 [debug] [Thread-3  ]: On model.northwind_dbt.stg_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.stg_products"} */
create or replace   view Project_2.public.stg_products
  
   as (
    select * from PROJECT_2.PUBLIC.products
  );
[0m19:57:14.607045 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.006 seconds
[0m19:57:14.607045 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1.008 seconds
[0m19:57:14.607045 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '66c29ea0-2ca3-4d9e-bf22-0f33aa818413', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D72157BE0>]}
[0m19:57:14.613430 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '66c29ea0-2ca3-4d9e-bf22-0f33aa818413', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D58C95730>]}
[0m19:57:14.613430 [info ] [Thread-1  ]: 1 of 13 OK created sql view model public.stg_customers ......................... [[32mSUCCESS 1[0m in 1.17s]
[0m19:57:14.617316 [info ] [Thread-4  ]: 4 of 13 OK created sql view model public.stg_orders ............................ [[32mSUCCESS 1[0m in 1.18s]
[0m19:57:14.622190 [debug] [Thread-1  ]: Finished running node model.northwind_dbt.stg_customers
[0m19:57:14.629348 [debug] [Thread-4  ]: Finished running node model.northwind_dbt.stg_orders
[0m19:57:14.631003 [debug] [Thread-1  ]: Began running node model.northwind_dbt.dim_customers
[0m19:57:14.632227 [debug] [Thread-4  ]: Began running node model.northwind_dbt.fact_order_details
[0m19:57:14.633777 [info ] [Thread-1  ]: 6 of 13 START sql table model public.dim_customers ............................. [RUN]
[0m19:57:14.636020 [info ] [Thread-4  ]: 7 of 13 START sql incremental model public.fact_order_details .................. [RUN]
[0m19:57:14.636020 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.northwind_dbt.stg_customers, now model.northwind_dbt.dim_customers)
[0m19:57:14.636020 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.northwind_dbt.stg_orders, now model.northwind_dbt.fact_order_details)
[0m19:57:14.636020 [debug] [Thread-1  ]: Began compiling node model.northwind_dbt.dim_customers
[0m19:57:14.636020 [debug] [Thread-4  ]: Began compiling node model.northwind_dbt.fact_order_details
[0m19:57:14.643487 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind_dbt.dim_customers"
[0m19:57:14.643487 [debug] [Thread-4  ]: Writing injected SQL for node "model.northwind_dbt.fact_order_details"
[0m19:57:14.660277 [debug] [Thread-1  ]: Began executing node model.northwind_dbt.dim_customers
[0m19:57:14.660277 [debug] [Thread-4  ]: Began executing node model.northwind_dbt.fact_order_details
[0m19:57:14.688922 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind_dbt.dim_customers"
[0m19:57:14.719469 [debug] [Thread-4  ]: Using snowflake connection "model.northwind_dbt.fact_order_details"
[0m19:57:14.720471 [debug] [Thread-4  ]: On model.northwind_dbt.fact_order_details: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.fact_order_details"} */
create or replace  temporary view Project_2.public.fact_order_details__dbt_tmp
  
   as (
    

with base as (
    select 
        od.order_id,
        od.product_id,
        o.customer_id,
        o.employee_id,
        o.ship_via as shipper_id,
        o.order_date,
        od.unit_price,
        od.quantity,
        od.discount,
        od.unit_price * od.quantity * (1 - od.discount) as revenue
    from Project_2.public.stg_order_details od
    join Project_2.public.stg_orders o on od.order_id = o.order_id
    
        and o.order_date >= (select max(order_date) from Project_2.public.fact_order_details)
    
),
aggregated as (
    select 
        order_id,
        product_id,
        customer_id,
        employee_id,
        shipper_id,
        cast(order_date as date) as order_date,
        sum(revenue) as total_revenue,
        avg(revenue) as avg_revenue,
        max(revenue) as max_revenue,
        min(revenue) as min_revenue,
        count(*) as line_count,
        rank() over (partition by customer_id order by sum(revenue) desc) as revenue_rank
    from base
    group by order_id, product_id, customer_id, employee_id, shipper_id, order_date
)
select * from aggregated
  );
[0m19:57:14.730471 [debug] [Thread-1  ]: Using snowflake connection "model.northwind_dbt.dim_customers"
[0m19:57:14.731470 [debug] [Thread-1  ]: On model.northwind_dbt.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.dim_customers"} */
create or replace transient table Project_2.public.dim_customers
         as
        (select * from Project_2.public.stg_customers
        );
[0m19:57:14.740713 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.364 seconds
[0m19:57:14.742714 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '66c29ea0-2ca3-4d9e-bf22-0f33aa818413', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D57F86370>]}
[0m19:57:14.745913 [info ] [Thread-3  ]: 5 of 13 OK created sql view model public.stg_products .......................... [[32mSUCCESS 1[0m in 0.40s]
[0m19:57:14.746971 [debug] [Thread-3  ]: Finished running node model.northwind_dbt.stg_products
[0m19:57:14.748003 [debug] [Thread-3  ]: Began running node model.northwind_dbt.dim_products
[0m19:57:14.749063 [info ] [Thread-3  ]: 8 of 13 START sql table model public.dim_products .............................. [RUN]
[0m19:57:14.751192 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.northwind_dbt.stg_products, now model.northwind_dbt.dim_products)
[0m19:57:14.751192 [debug] [Thread-3  ]: Began compiling node model.northwind_dbt.dim_products
[0m19:57:14.755279 [debug] [Thread-3  ]: Writing injected SQL for node "model.northwind_dbt.dim_products"
[0m19:57:14.767756 [debug] [Thread-3  ]: Began executing node model.northwind_dbt.dim_products
[0m19:57:14.771687 [debug] [Thread-3  ]: Writing runtime sql for node "model.northwind_dbt.dim_products"
[0m19:57:14.779092 [debug] [Thread-3  ]: Using snowflake connection "model.northwind_dbt.dim_products"
[0m19:57:14.779092 [debug] [Thread-3  ]: On model.northwind_dbt.dim_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.dim_products"} */
create or replace transient table Project_2.public.dim_products
         as
        (select 
    p.product_id,
    p.product_name,
    p.supplier_id,
    s.company_name as supplier_name,
    p.category_id,
    c.category_name,
    p.quantity_per_unit,
    p.unit_price,
    p.units_in_stock,
    p.units_on_order,
    p.reorder_level,
    p.discontinued
from Project_2.public.stg_products p
left join PROJECT_2.PUBLIC.suppliers s on p.supplier_id = s.supplier_id
left join PROJECT_2.PUBLIC.categories c on p.category_id = c.category_id
        );
[0m19:57:15.042017 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.442 seconds
[0m19:57:15.046509 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '66c29ea0-2ca3-4d9e-bf22-0f33aa818413', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D71EA6790>]}
[0m19:57:15.047499 [info ] [Thread-2  ]: 2 of 13 OK created sql view model public.stg_employees ......................... [[32mSUCCESS 1[0m in 1.61s]
[0m19:57:15.049455 [debug] [Thread-2  ]: Finished running node model.northwind_dbt.stg_employees
[0m19:57:15.051088 [debug] [Thread-2  ]: Began running node model.northwind_dbt.dim_employees
[0m19:57:15.051088 [info ] [Thread-2  ]: 9 of 13 START sql table model public.dim_employees ............................. [RUN]
[0m19:57:15.053388 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.northwind_dbt.stg_employees, now model.northwind_dbt.dim_employees)
[0m19:57:15.053388 [debug] [Thread-2  ]: Began compiling node model.northwind_dbt.dim_employees
[0m19:57:15.069204 [debug] [Thread-2  ]: Writing injected SQL for node "model.northwind_dbt.dim_employees"
[0m19:57:15.076634 [debug] [Thread-2  ]: Began executing node model.northwind_dbt.dim_employees
[0m19:57:15.081871 [debug] [Thread-2  ]: Writing runtime sql for node "model.northwind_dbt.dim_employees"
[0m19:57:15.094141 [debug] [Thread-2  ]: Using snowflake connection "model.northwind_dbt.dim_employees"
[0m19:57:15.094141 [debug] [Thread-2  ]: On model.northwind_dbt.dim_employees: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.dim_employees"} */
create or replace transient table Project_2.public.dim_employees
         as
        (with source_data as (
    select * from Project_2.public.stg_employees
),
scd2 as (
    select 
        md5(cast(coalesce(cast(employee_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as employee_key,
        *,
        current_timestamp as dbt_updated_at
    from source_data
)
select * from scd2
        );
[0m19:57:15.173343 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.452 seconds
[0m19:57:15.181883 [debug] [Thread-4  ]: Using snowflake connection "model.northwind_dbt.fact_order_details"
[0m19:57:15.182907 [debug] [Thread-4  ]: On model.northwind_dbt.fact_order_details: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.fact_order_details"} */
describe table Project_2.public.fact_order_details__dbt_tmp
[0m19:57:15.288943 [debug] [Thread-4  ]: SQL status: SUCCESS 12 in 0.104 seconds
[0m19:57:15.292398 [debug] [Thread-4  ]: Using snowflake connection "model.northwind_dbt.fact_order_details"
[0m19:57:15.292398 [debug] [Thread-4  ]: On model.northwind_dbt.fact_order_details: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.fact_order_details"} */
describe table Project_2.public.fact_order_details
[0m19:57:15.417240 [debug] [Thread-4  ]: SQL status: SUCCESS 12 in 0.124 seconds
[0m19:57:15.417240 [debug] [Thread-4  ]: Using snowflake connection "model.northwind_dbt.fact_order_details"
[0m19:57:15.417240 [debug] [Thread-4  ]: On model.northwind_dbt.fact_order_details: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.fact_order_details"} */
describe table "PROJECT_2"."PUBLIC"."FACT_ORDER_DETAILS"
[0m19:57:15.507637 [debug] [Thread-4  ]: SQL status: SUCCESS 12 in 0.085 seconds
[0m19:57:15.539310 [debug] [Thread-4  ]: Writing runtime sql for node "model.northwind_dbt.fact_order_details"
[0m19:57:15.545886 [debug] [Thread-4  ]: Using snowflake connection "model.northwind_dbt.fact_order_details"
[0m19:57:15.555243 [debug] [Thread-4  ]: On model.northwind_dbt.fact_order_details: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.fact_order_details"} */
-- back compat for old kwarg name
  
  begin;
[0m19:57:15.651281 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.099 seconds
[0m19:57:15.651281 [debug] [Thread-4  ]: Using snowflake connection "model.northwind_dbt.fact_order_details"
[0m19:57:15.651281 [debug] [Thread-4  ]: On model.northwind_dbt.fact_order_details: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.fact_order_details"} */
merge into Project_2.public.fact_order_details as DBT_INTERNAL_DEST
        using Project_2.public.fact_order_details__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.order_id = DBT_INTERNAL_DEST.order_id
                ) and (
                    DBT_INTERNAL_SOURCE.product_id = DBT_INTERNAL_DEST.product_id
                )

    
    when matched then update set
        "ORDER_ID" = DBT_INTERNAL_SOURCE."ORDER_ID","PRODUCT_ID" = DBT_INTERNAL_SOURCE."PRODUCT_ID","CUSTOMER_ID" = DBT_INTERNAL_SOURCE."CUSTOMER_ID","EMPLOYEE_ID" = DBT_INTERNAL_SOURCE."EMPLOYEE_ID","SHIPPER_ID" = DBT_INTERNAL_SOURCE."SHIPPER_ID","ORDER_DATE" = DBT_INTERNAL_SOURCE."ORDER_DATE","TOTAL_REVENUE" = DBT_INTERNAL_SOURCE."TOTAL_REVENUE","AVG_REVENUE" = DBT_INTERNAL_SOURCE."AVG_REVENUE","MAX_REVENUE" = DBT_INTERNAL_SOURCE."MAX_REVENUE","MIN_REVENUE" = DBT_INTERNAL_SOURCE."MIN_REVENUE","LINE_COUNT" = DBT_INTERNAL_SOURCE."LINE_COUNT","REVENUE_RANK" = DBT_INTERNAL_SOURCE."REVENUE_RANK"
    

    when not matched then insert
        ("ORDER_ID", "PRODUCT_ID", "CUSTOMER_ID", "EMPLOYEE_ID", "SHIPPER_ID", "ORDER_DATE", "TOTAL_REVENUE", "AVG_REVENUE", "MAX_REVENUE", "MIN_REVENUE", "LINE_COUNT", "REVENUE_RANK")
    values
        ("ORDER_ID", "PRODUCT_ID", "CUSTOMER_ID", "EMPLOYEE_ID", "SHIPPER_ID", "ORDER_DATE", "TOTAL_REVENUE", "AVG_REVENUE", "MAX_REVENUE", "MIN_REVENUE", "LINE_COUNT", "REVENUE_RANK")

;
[0m19:57:15.700042 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.974 seconds
[0m19:57:15.700042 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '66c29ea0-2ca3-4d9e-bf22-0f33aa818413', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D7391C7F0>]}
[0m19:57:15.700042 [info ] [Thread-1  ]: 6 of 13 OK created sql table model public.dim_customers ........................ [[32mSUCCESS 1[0m in 1.06s]
[0m19:57:15.700042 [debug] [Thread-1  ]: Finished running node model.northwind_dbt.dim_customers
[0m19:57:15.993136 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1.209 seconds
[0m19:57:15.996503 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '66c29ea0-2ca3-4d9e-bf22-0f33aa818413', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D58C95970>]}
[0m19:57:15.997609 [info ] [Thread-3  ]: 8 of 13 OK created sql table model public.dim_products ......................... [[32mSUCCESS 1[0m in 1.25s]
[0m19:57:15.999328 [debug] [Thread-3  ]: Finished running node model.northwind_dbt.dim_products
[0m19:57:16.112747 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.014 seconds
[0m19:57:16.120504 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '66c29ea0-2ca3-4d9e-bf22-0f33aa818413', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D71EA6790>]}
[0m19:57:16.122806 [info ] [Thread-2  ]: 9 of 13 OK created sql table model public.dim_employees ........................ [[32mSUCCESS 1[0m in 1.07s]
[0m19:57:16.125023 [debug] [Thread-2  ]: Finished running node model.northwind_dbt.dim_employees
[0m19:57:16.769265 [debug] [Thread-4  ]: SQL status: SUCCESS 32 in 1.115 seconds
[0m19:57:16.776150 [debug] [Thread-4  ]: Using snowflake connection "model.northwind_dbt.fact_order_details"
[0m19:57:16.778164 [debug] [Thread-4  ]: On model.northwind_dbt.fact_order_details: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.fact_order_details"} */
COMMIT
[0m19:57:17.102364 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.323 seconds
[0m19:57:17.127877 [debug] [Thread-4  ]: Applying DROP to: Project_2.public.fact_order_details__dbt_tmp
[0m19:57:17.142997 [debug] [Thread-4  ]: Using snowflake connection "model.northwind_dbt.fact_order_details"
[0m19:57:17.145677 [debug] [Thread-4  ]: On model.northwind_dbt.fact_order_details: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.fact_order_details"} */
drop view if exists Project_2.public.fact_order_details__dbt_tmp cascade
[0m19:57:17.292723 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.145 seconds
[0m19:57:17.296506 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '66c29ea0-2ca3-4d9e-bf22-0f33aa818413', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D71C1F790>]}
[0m19:57:17.297031 [info ] [Thread-4  ]: 7 of 13 OK created sql incremental model public.fact_order_details ............. [[32mSUCCESS 32[0m in 2.66s]
[0m19:57:17.299167 [debug] [Thread-4  ]: Finished running node model.northwind_dbt.fact_order_details
[0m19:57:17.299167 [debug] [Thread-1  ]: Began running node model.northwind_dbt.obt_orders
[0m19:57:17.299167 [debug] [Thread-3  ]: Began running node model.northwind_dbt.top_customer_revenue
[0m19:57:17.299167 [debug] [Thread-2  ]: Began running node model.northwind_dbt.top_employee_revenue
[0m19:57:17.304972 [debug] [Thread-4  ]: Began running node model.northwind_dbt.underperforming_products
[0m19:57:17.305298 [info ] [Thread-1  ]: 10 of 13 START sql table model public.obt_orders ............................... [RUN]
[0m19:57:17.305298 [info ] [Thread-3  ]: 11 of 13 START sql table model public.top_customer_revenue ..................... [RUN]
[0m19:57:17.310805 [info ] [Thread-2  ]: 12 of 13 START sql table model public.top_employee_revenue ..................... [RUN]
[0m19:57:17.312985 [info ] [Thread-4  ]: 13 of 13 START sql table model public.underperforming_products ................. [RUN]
[0m19:57:17.315263 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.northwind_dbt.dim_customers, now model.northwind_dbt.obt_orders)
[0m19:57:17.317531 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.northwind_dbt.dim_products, now model.northwind_dbt.top_customer_revenue)
[0m19:57:17.319175 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.northwind_dbt.dim_employees, now model.northwind_dbt.top_employee_revenue)
[0m19:57:17.320862 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.northwind_dbt.fact_order_details, now model.northwind_dbt.underperforming_products)
[0m19:57:17.322526 [debug] [Thread-1  ]: Began compiling node model.northwind_dbt.obt_orders
[0m19:57:17.324556 [debug] [Thread-3  ]: Began compiling node model.northwind_dbt.top_customer_revenue
[0m19:57:17.324556 [debug] [Thread-2  ]: Began compiling node model.northwind_dbt.top_employee_revenue
[0m19:57:17.327347 [debug] [Thread-4  ]: Began compiling node model.northwind_dbt.underperforming_products
[0m19:57:17.334389 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind_dbt.obt_orders"
[0m19:57:17.343476 [debug] [Thread-3  ]: Writing injected SQL for node "model.northwind_dbt.top_customer_revenue"
[0m19:57:17.351591 [debug] [Thread-2  ]: Writing injected SQL for node "model.northwind_dbt.top_employee_revenue"
[0m19:57:17.354937 [debug] [Thread-4  ]: Writing injected SQL for node "model.northwind_dbt.underperforming_products"
[0m19:57:17.384751 [debug] [Thread-3  ]: Began executing node model.northwind_dbt.top_customer_revenue
[0m19:57:17.385750 [debug] [Thread-4  ]: Began executing node model.northwind_dbt.underperforming_products
[0m19:57:17.387751 [debug] [Thread-1  ]: Began executing node model.northwind_dbt.obt_orders
[0m19:57:17.387751 [debug] [Thread-2  ]: Began executing node model.northwind_dbt.top_employee_revenue
[0m19:57:17.396603 [debug] [Thread-3  ]: Writing runtime sql for node "model.northwind_dbt.top_customer_revenue"
[0m19:57:17.405628 [debug] [Thread-4  ]: Writing runtime sql for node "model.northwind_dbt.underperforming_products"
[0m19:57:17.412832 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind_dbt.obt_orders"
[0m19:57:17.419964 [debug] [Thread-2  ]: Writing runtime sql for node "model.northwind_dbt.top_employee_revenue"
[0m19:57:17.446655 [debug] [Thread-4  ]: Using snowflake connection "model.northwind_dbt.underperforming_products"
[0m19:57:17.451637 [debug] [Thread-3  ]: Using snowflake connection "model.northwind_dbt.top_customer_revenue"
[0m19:57:17.453648 [debug] [Thread-2  ]: Using snowflake connection "model.northwind_dbt.top_employee_revenue"
[0m19:57:17.458155 [debug] [Thread-1  ]: Using snowflake connection "model.northwind_dbt.obt_orders"
[0m19:57:17.460035 [debug] [Thread-4  ]: On model.northwind_dbt.underperforming_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.underperforming_products"} */
create or replace transient table Project_2.public.underperforming_products
         as
        (

select
  p.product_id,
  p.product_name,
  p.units_in_stock,
  coalesce(sum(f.total_revenue), 0) as total_revenue
from Project_2.public.dim_products p
left join Project_2.public.fact_order_details f on p.product_id = f.product_id
group by p.product_id, p.product_name, p.units_in_stock, f.product_id
having coalesce(sum(f.total_revenue), 0) < 1000 and p.units_in_stock > 10
order by total_revenue asc
        );
[0m19:57:17.462310 [debug] [Thread-3  ]: On model.northwind_dbt.top_customer_revenue: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.top_customer_revenue"} */
create or replace transient table Project_2.public.top_customer_revenue
         as
        (

select
  c.customer_id,
  c.company_name as customer_name,
  sum(f.total_revenue) as total_revenue
from Project_2.public.fact_order_details f
join Project_2.public.dim_customers c using (customer_id)
group by c.customer_id, c.company_name
order by total_revenue desc
        );
[0m19:57:17.464186 [debug] [Thread-2  ]: On model.northwind_dbt.top_employee_revenue: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.top_employee_revenue"} */
create or replace transient table Project_2.public.top_employee_revenue
         as
        (

select
  e.employee_key,
  e.first_name || ' ' || e.last_name as employee_name,
  sum(f.total_revenue) as total_revenue
from Project_2.public.fact_order_details f
join Project_2.public.dim_employees e on f.employee_id = e.employee_id
group by e.employee_key, employee_name
order by total_revenue desc
        );
[0m19:57:17.466757 [debug] [Thread-1  ]: On model.northwind_dbt.obt_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.obt_orders"} */
create or replace transient table Project_2.public.obt_orders
         as
        (select 
    f.order_id,
    f.product_id,
    f.customer_id,
    f.employee_id,
    f.shipper_id,
    f.order_date,
    f.total_revenue,
    f.avg_revenue,
    f.max_revenue,
    f.min_revenue,
    f.line_count,
    f.revenue_rank,

    c.company_name as customer_name,
    p.product_name,
    p.category_name,
    p.supplier_name,
    e.first_name || ' ' || e.last_name as employee_name,
    s.company_name as shipper_name

from Project_2.public.fact_order_details f
left join Project_2.public.dim_customers c on f.customer_id = c.customer_id
left join Project_2.public.dim_products p on f.product_id = p.product_id
left join Project_2.public.dim_employees e on f.employee_id = e.employee_id
left join PROJECT_2.PUBLIC.shippers s on f.shipper_id = s.shipper_id
        );
[0m19:57:18.284352 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.817 seconds
[0m19:57:18.287910 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '66c29ea0-2ca3-4d9e-bf22-0f33aa818413', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D73997340>]}
[0m19:57:18.289927 [info ] [Thread-4  ]: 13 of 13 OK created sql table model public.underperforming_products ............ [[32mSUCCESS 1[0m in 0.97s]
[0m19:57:18.291940 [debug] [Thread-4  ]: Finished running node model.northwind_dbt.underperforming_products
[0m19:57:18.329384 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.865 seconds
[0m19:57:18.338488 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '66c29ea0-2ca3-4d9e-bf22-0f33aa818413', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D739BEC10>]}
[0m19:57:18.340500 [info ] [Thread-3  ]: 11 of 13 OK created sql table model public.top_customer_revenue ................ [[32mSUCCESS 1[0m in 1.02s]
[0m19:57:18.342511 [debug] [Thread-3  ]: Finished running node model.northwind_dbt.top_customer_revenue
[0m19:57:18.399437 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.927 seconds
[0m19:57:18.407515 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '66c29ea0-2ca3-4d9e-bf22-0f33aa818413', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D738519D0>]}
[0m19:57:18.410444 [info ] [Thread-2  ]: 12 of 13 OK created sql table model public.top_employee_revenue ................ [[32mSUCCESS 1[0m in 1.09s]
[0m19:57:18.416574 [debug] [Thread-2  ]: Finished running node model.northwind_dbt.top_employee_revenue
[0m19:57:18.494345 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.020 seconds
[0m19:57:18.500048 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '66c29ea0-2ca3-4d9e-bf22-0f33aa818413', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D73972130>]}
[0m19:57:18.500048 [info ] [Thread-1  ]: 10 of 13 OK created sql table model public.obt_orders .......................... [[32mSUCCESS 1[0m in 1.18s]
[0m19:57:18.502056 [debug] [Thread-1  ]: Finished running node model.northwind_dbt.obt_orders
[0m19:57:18.502056 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:57:18.502056 [debug] [MainThread]: Connection 'list_Project_2' was left open.
[0m19:57:18.502056 [debug] [MainThread]: On list_Project_2: Close
[0m19:57:18.643042 [debug] [MainThread]: Connection 'list_Project_2_public' was left open.
[0m19:57:18.643042 [debug] [MainThread]: On list_Project_2_public: Close
[0m19:57:18.802656 [debug] [MainThread]: Connection 'list_Project_2_snapshots' was left open.
[0m19:57:18.802656 [debug] [MainThread]: On list_Project_2_snapshots: Close
[0m19:57:18.974946 [debug] [MainThread]: Connection 'model.northwind_dbt.obt_orders' was left open.
[0m19:57:18.974946 [debug] [MainThread]: On model.northwind_dbt.obt_orders: Close
[0m19:57:19.110782 [debug] [MainThread]: Connection 'model.northwind_dbt.top_employee_revenue' was left open.
[0m19:57:19.112297 [debug] [MainThread]: On model.northwind_dbt.top_employee_revenue: Close
[0m19:57:19.226845 [debug] [MainThread]: Connection 'model.northwind_dbt.top_customer_revenue' was left open.
[0m19:57:19.226845 [debug] [MainThread]: On model.northwind_dbt.top_customer_revenue: Close
[0m19:57:19.375244 [debug] [MainThread]: Connection 'model.northwind_dbt.underperforming_products' was left open.
[0m19:57:19.375244 [debug] [MainThread]: On model.northwind_dbt.underperforming_products: Close
[0m19:57:19.550507 [info ] [MainThread]: 
[0m19:57:19.550507 [info ] [MainThread]: Finished running 1 incremental model, 7 table models, 5 view models in 0 hours 0 minutes and 7.44 seconds (7.44s).
[0m19:57:19.564151 [debug] [MainThread]: Command end result
[0m19:57:19.762620 [debug] [MainThread]: Wrote artifact WritableManifest to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\manifest.json
[0m19:57:19.771682 [debug] [MainThread]: Wrote artifact SemanticManifest to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\semantic_manifest.json
[0m19:57:19.790269 [debug] [MainThread]: Wrote artifact RunExecutionResult to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\run_results.json
[0m19:57:19.790269 [info ] [MainThread]: 
[0m19:57:19.790269 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:57:19.794008 [info ] [MainThread]: 
[0m19:57:19.796603 [info ] [MainThread]: Done. PASS=13 WARN=0 ERROR=0 SKIP=0 TOTAL=13
[0m19:57:19.796603 [debug] [MainThread]: Command `dbt run` succeeded at 19:57:19.796603 after 10.28 seconds
[0m19:57:19.799138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D56C4F340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D567F6580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D72131070>]}
[0m19:57:19.799138 [debug] [MainThread]: Flushing usage events
[0m19:57:20.601206 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:59:29.307638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E9AEAF400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E9CF22D00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E9CF22AF0>]}


============================== 20:59:29.323327 | 6d415a07-2770-493a-bf36-86fa91300e7c ==============================
[0m20:59:29.323327 [info ] [MainThread]: Running with dbt=1.9.0
[0m20:59:29.323327 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'c:\\Users\\fitzp\\Documents\\Alpaca_Market\\zproject_2\\northwind_psql', 'log_path': 'c:\\Users\\fitzp\\Documents\\Alpaca_Market\\zproject_2\\northwind_psql\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --select underperforming_products', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:59:31.091133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6d415a07-2770-493a-bf36-86fa91300e7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E99E979A0>]}
[0m20:59:31.165908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6d415a07-2770-493a-bf36-86fa91300e7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E9CD78250>]}
[0m20:59:31.165908 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m20:59:32.006163 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m20:59:32.655268 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:59:32.657279 [debug] [MainThread]: Partial parsing: updated file: northwind_dbt://models\marts\analysis\underperforming_products.sql
[0m20:59:33.125370 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.northwind_dbt.marts.bi
[0m20:59:33.143632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6d415a07-2770-493a-bf36-86fa91300e7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019EB63A5130>]}
[0m20:59:33.435090 [debug] [MainThread]: Wrote artifact WritableManifest to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\manifest.json
[0m20:59:33.443768 [debug] [MainThread]: Wrote artifact SemanticManifest to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\semantic_manifest.json
[0m20:59:33.500371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6d415a07-2770-493a-bf36-86fa91300e7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019EB5D12880>]}
[0m20:59:33.500371 [info ] [MainThread]: Found 13 models, 1 snapshot, 16 data tests, 8 sources, 706 macros
[0m20:59:33.500371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6d415a07-2770-493a-bf36-86fa91300e7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019EB5FF9AF0>]}
[0m20:59:33.500371 [info ] [MainThread]: 
[0m20:59:33.500371 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:59:33.505244 [info ] [MainThread]: 
[0m20:59:33.507775 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:59:33.510404 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_Project_2'
[0m20:59:33.611068 [debug] [ThreadPool]: Using snowflake connection "list_Project_2"
[0m20:59:33.611068 [debug] [ThreadPool]: On list_Project_2: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "connection_name": "list_Project_2"} */
show terse schemas in database Project_2
    limit 10000
[0m20:59:33.611068 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:59:34.553831 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.940 seconds
[0m20:59:34.553831 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_Project_2_public'
[0m20:59:34.577566 [debug] [ThreadPool]: Using snowflake connection "list_Project_2_public"
[0m20:59:34.577566 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_Project_2_snapshots'
[0m20:59:34.578797 [debug] [ThreadPool]: On list_Project_2_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "connection_name": "list_Project_2_public"} */
show objects in Project_2.public limit 10000;
[0m20:59:34.581417 [debug] [ThreadPool]: Using snowflake connection "list_Project_2_snapshots"
[0m20:59:34.581417 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:59:34.581417 [debug] [ThreadPool]: On list_Project_2_snapshots: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "connection_name": "list_Project_2_snapshots"} */
show objects in Project_2.snapshots limit 10000;
[0m20:59:34.585745 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:59:35.340449 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bbb1db-020d-00ab-000c-83e7000b520a
[0m20:59:35.341555 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m20:59:35.342683 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m20:59:35.343222 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m20:59:35.545151 [debug] [ThreadPool]: SQL status: SUCCESS 27 in 0.962 seconds
[0m20:59:35.560428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6d415a07-2770-493a-bf36-86fa91300e7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019EB59D1F40>]}
[0m20:59:35.567400 [debug] [Thread-1  ]: Began running node model.northwind_dbt.underperforming_products
[0m20:59:35.569034 [info ] [Thread-1  ]: 1 of 1 START sql table model public.underperforming_products ................... [RUN]
[0m20:59:35.571224 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.northwind_dbt.underperforming_products'
[0m20:59:35.572350 [debug] [Thread-1  ]: Began compiling node model.northwind_dbt.underperforming_products
[0m20:59:35.593457 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind_dbt.underperforming_products"
[0m20:59:35.629170 [debug] [Thread-1  ]: Began executing node model.northwind_dbt.underperforming_products
[0m20:59:35.790513 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind_dbt.underperforming_products"
[0m20:59:35.807013 [debug] [Thread-1  ]: Using snowflake connection "model.northwind_dbt.underperforming_products"
[0m20:59:35.808711 [debug] [Thread-1  ]: On model.northwind_dbt.underperforming_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.underperforming_products"} */
create or replace transient table Project_2.public.underperforming_products
         as
        (

select
  p.product_id,
  p.product_name,
  p.units_in_stock,
  coalesce(sum(f.total_revenue), 0) as total_revenue
from Project_2.public.dim_products p
left join Project_2.public.fact_order_details f on p.product_id = f.product_id
where p.units_in_stock > 10
group by p.product_id, p.product_name, p.units_in_stock
having coalesce(sum(f.total_revenue), 0) < 1000
order by total_revenue asc
        );
[0m20:59:35.809956 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m20:59:38.285583 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.477 seconds
[0m20:59:38.305677 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d415a07-2770-493a-bf36-86fa91300e7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E994849A0>]}
[0m20:59:38.305677 [info ] [Thread-1  ]: 1 of 1 OK created sql table model public.underperforming_products .............. [[32mSUCCESS 1[0m in 2.73s]
[0m20:59:38.307688 [debug] [Thread-1  ]: Finished running node model.northwind_dbt.underperforming_products
[0m20:59:38.307688 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:59:38.307688 [debug] [MainThread]: Connection 'list_Project_2' was left open.
[0m20:59:38.307688 [debug] [MainThread]: On list_Project_2: Close
[0m20:59:38.446415 [debug] [MainThread]: Connection 'list_Project_2_public' was left open.
[0m20:59:38.448661 [debug] [MainThread]: On list_Project_2_public: Close
[0m20:59:38.577021 [debug] [MainThread]: Connection 'list_Project_2_snapshots' was left open.
[0m20:59:38.577021 [debug] [MainThread]: On list_Project_2_snapshots: Close
[0m20:59:38.712091 [debug] [MainThread]: Connection 'model.northwind_dbt.underperforming_products' was left open.
[0m20:59:38.713091 [debug] [MainThread]: On model.northwind_dbt.underperforming_products: Close
[0m20:59:38.870253 [info ] [MainThread]: 
[0m20:59:38.871992 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.37 seconds (5.37s).
[0m20:59:38.873747 [debug] [MainThread]: Command end result
[0m20:59:39.043035 [debug] [MainThread]: Wrote artifact WritableManifest to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\manifest.json
[0m20:59:39.066117 [debug] [MainThread]: Wrote artifact SemanticManifest to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\semantic_manifest.json
[0m20:59:39.075773 [debug] [MainThread]: Wrote artifact RunExecutionResult to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\run_results.json
[0m20:59:39.075773 [info ] [MainThread]: 
[0m20:59:39.075773 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:59:39.075773 [info ] [MainThread]: 
[0m20:59:39.075773 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:59:39.075773 [debug] [MainThread]: Command `dbt run` succeeded at 20:59:39.075773 after 9.87 seconds
[0m20:59:39.075773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E9AEAF400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E9C2037F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E9C1CD280>]}
[0m20:59:39.089052 [debug] [MainThread]: Flushing usage events
[0m20:59:39.906686 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:04:33.636725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF2B7DF370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF2CB35AC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF2D830250>]}


============================== 21:04:33.641261 | ac6abf73-5541-4f77-a95c-7d769a151425 ==============================
[0m21:04:33.641261 [info ] [MainThread]: Running with dbt=1.9.0
[0m21:04:33.641261 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'c:\\Users\\fitzp\\Documents\\Alpaca_Market\\zproject_2\\northwind_psql', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'c:\\Users\\fitzp\\Documents\\Alpaca_Market\\zproject_2\\northwind_psql\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt test', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:04:34.678696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ac6abf73-5541-4f77-a95c-7d769a151425', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF462F84C0>]}
[0m21:04:34.726271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ac6abf73-5541-4f77-a95c-7d769a151425', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF2D6A8370>]}
[0m21:04:34.726271 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m21:04:35.087792 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m21:04:35.629759 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:04:35.629759 [debug] [MainThread]: Partial parsing: updated file: northwind_dbt://models\marts\analysis\underperforming_products.sql
[0m21:04:36.542534 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.northwind_dbt.marts.bi
[0m21:04:36.571012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ac6abf73-5541-4f77-a95c-7d769a151425', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF46CD6130>]}
[0m21:04:36.890055 [debug] [MainThread]: Wrote artifact WritableManifest to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\manifest.json
[0m21:04:36.895846 [debug] [MainThread]: Wrote artifact SemanticManifest to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\semantic_manifest.json
[0m21:04:36.981755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ac6abf73-5541-4f77-a95c-7d769a151425', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF46EC8D90>]}
[0m21:04:36.981755 [info ] [MainThread]: Found 13 models, 1 snapshot, 16 data tests, 8 sources, 706 macros
[0m21:04:36.981755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ac6abf73-5541-4f77-a95c-7d769a151425', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF46C85AC0>]}
[0m21:04:36.981755 [info ] [MainThread]: 
[0m21:04:36.981755 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:04:36.998157 [info ] [MainThread]: 
[0m21:04:36.998157 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:04:37.007163 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_Project_2_public'
[0m21:04:37.007163 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_Project_2_snapshots'
[0m21:04:37.224145 [debug] [ThreadPool]: Using snowflake connection "list_Project_2_public"
[0m21:04:37.224145 [debug] [ThreadPool]: Using snowflake connection "list_Project_2_snapshots"
[0m21:04:37.224145 [debug] [ThreadPool]: On list_Project_2_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "connection_name": "list_Project_2_public"} */
show objects in Project_2.public limit 10000;
[0m21:04:37.224145 [debug] [ThreadPool]: On list_Project_2_snapshots: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "connection_name": "list_Project_2_snapshots"} */
show objects in Project_2.snapshots limit 10000;
[0m21:04:37.224145 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:04:37.230170 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:04:37.979951 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bbb1e0-020d-07b8-000c-83e7000b80ae
[0m21:04:37.981804 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m21:04:37.983070 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m21:04:37.983070 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m21:04:38.058402 [debug] [ThreadPool]: SQL status: SUCCESS 27 in 0.830 seconds
[0m21:04:38.058402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ac6abf73-5541-4f77-a95c-7d769a151425', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF462F8FA0>]}
[0m21:04:38.069940 [debug] [Thread-1  ]: Began running node test.northwind_dbt.not_null_dim_customers_customer_id.dd91cd1c8d
[0m21:04:38.069940 [debug] [Thread-2  ]: Began running node test.northwind_dbt.not_null_dim_employees_employee_key.232a183ffe
[0m21:04:38.069940 [debug] [Thread-3  ]: Began running node test.northwind_dbt.not_null_dim_products_product_id.c8aba288d1
[0m21:04:38.069940 [debug] [Thread-4  ]: Began running node test.northwind_dbt.not_null_fact_order_details_customer_id.6aaefe4888
[0m21:04:38.069940 [info ] [Thread-1  ]: 1 of 16 START test not_null_dim_customers_customer_id .......................... [RUN]
[0m21:04:38.069940 [info ] [Thread-2  ]: 2 of 16 START test not_null_dim_employees_employee_key ......................... [RUN]
[0m21:04:38.069940 [info ] [Thread-3  ]: 3 of 16 START test not_null_dim_products_product_id ............................ [RUN]
[0m21:04:38.069940 [info ] [Thread-4  ]: 4 of 16 START test not_null_fact_order_details_customer_id ..................... [RUN]
[0m21:04:38.146482 [debug] [Thread-1  ]: Acquiring new snowflake connection 'test.northwind_dbt.not_null_dim_customers_customer_id.dd91cd1c8d'
[0m21:04:38.147737 [debug] [Thread-2  ]: Acquiring new snowflake connection 'test.northwind_dbt.not_null_dim_employees_employee_key.232a183ffe'
[0m21:04:38.148435 [debug] [Thread-3  ]: Acquiring new snowflake connection 'test.northwind_dbt.not_null_dim_products_product_id.c8aba288d1'
[0m21:04:38.148964 [debug] [Thread-4  ]: Acquiring new snowflake connection 'test.northwind_dbt.not_null_fact_order_details_customer_id.6aaefe4888'
[0m21:04:38.149537 [debug] [Thread-1  ]: Began compiling node test.northwind_dbt.not_null_dim_customers_customer_id.dd91cd1c8d
[0m21:04:38.150149 [debug] [Thread-2  ]: Began compiling node test.northwind_dbt.not_null_dim_employees_employee_key.232a183ffe
[0m21:04:38.151219 [debug] [Thread-3  ]: Began compiling node test.northwind_dbt.not_null_dim_products_product_id.c8aba288d1
[0m21:04:38.151746 [debug] [Thread-4  ]: Began compiling node test.northwind_dbt.not_null_fact_order_details_customer_id.6aaefe4888
[0m21:04:38.164755 [debug] [Thread-1  ]: Writing injected SQL for node "test.northwind_dbt.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m21:04:38.168757 [debug] [Thread-2  ]: Writing injected SQL for node "test.northwind_dbt.not_null_dim_employees_employee_key.232a183ffe"
[0m21:04:38.172291 [debug] [Thread-3  ]: Writing injected SQL for node "test.northwind_dbt.not_null_dim_products_product_id.c8aba288d1"
[0m21:04:38.176289 [debug] [Thread-4  ]: Writing injected SQL for node "test.northwind_dbt.not_null_fact_order_details_customer_id.6aaefe4888"
[0m21:04:38.206449 [debug] [Thread-3  ]: Began executing node test.northwind_dbt.not_null_dim_products_product_id.c8aba288d1
[0m21:04:38.207934 [debug] [Thread-2  ]: Began executing node test.northwind_dbt.not_null_dim_employees_employee_key.232a183ffe
[0m21:04:38.209056 [debug] [Thread-1  ]: Began executing node test.northwind_dbt.not_null_dim_customers_customer_id.dd91cd1c8d
[0m21:04:38.209590 [debug] [Thread-4  ]: Began executing node test.northwind_dbt.not_null_fact_order_details_customer_id.6aaefe4888
[0m21:04:38.232908 [debug] [Thread-3  ]: Writing runtime sql for node "test.northwind_dbt.not_null_dim_products_product_id.c8aba288d1"
[0m21:04:38.232908 [debug] [Thread-2  ]: Writing runtime sql for node "test.northwind_dbt.not_null_dim_employees_employee_key.232a183ffe"
[0m21:04:38.232908 [debug] [Thread-1  ]: Writing runtime sql for node "test.northwind_dbt.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m21:04:38.242194 [debug] [Thread-4  ]: Writing runtime sql for node "test.northwind_dbt.not_null_fact_order_details_customer_id.6aaefe4888"
[0m21:04:38.267989 [debug] [Thread-2  ]: Using snowflake connection "test.northwind_dbt.not_null_dim_employees_employee_key.232a183ffe"
[0m21:04:38.267989 [debug] [Thread-1  ]: Using snowflake connection "test.northwind_dbt.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m21:04:38.270419 [debug] [Thread-2  ]: On test.northwind_dbt.not_null_dim_employees_employee_key.232a183ffe: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "test.northwind_dbt.not_null_dim_employees_employee_key.232a183ffe"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select employee_key
from Project_2.public.dim_employees
where employee_key is null



      
    ) dbt_internal_test
[0m21:04:38.272444 [debug] [Thread-1  ]: On test.northwind_dbt.not_null_dim_customers_customer_id.dd91cd1c8d: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "test.northwind_dbt.not_null_dim_customers_customer_id.dd91cd1c8d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from Project_2.public.dim_customers
where customer_id is null



      
    ) dbt_internal_test
[0m21:04:38.274030 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m21:04:38.274873 [debug] [Thread-3  ]: Using snowflake connection "test.northwind_dbt.not_null_dim_products_product_id.c8aba288d1"
[0m21:04:38.274873 [debug] [Thread-4  ]: Using snowflake connection "test.northwind_dbt.not_null_fact_order_details_customer_id.6aaefe4888"
[0m21:04:38.274873 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m21:04:38.274873 [debug] [Thread-3  ]: On test.northwind_dbt.not_null_dim_products_product_id.c8aba288d1: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "test.northwind_dbt.not_null_dim_products_product_id.c8aba288d1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_id
from Project_2.public.dim_products
where product_id is null



      
    ) dbt_internal_test
[0m21:04:38.274873 [debug] [Thread-4  ]: On test.northwind_dbt.not_null_fact_order_details_customer_id.6aaefe4888: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "test.northwind_dbt.not_null_fact_order_details_customer_id.6aaefe4888"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from Project_2.public.fact_order_details
where customer_id is null



      
    ) dbt_internal_test
[0m21:04:38.274873 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m21:04:38.274873 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m21:04:38.915242 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.644 seconds
[0m21:04:38.931046 [info ] [Thread-2  ]: 2 of 16 PASS not_null_dim_employees_employee_key ............................... [[32mPASS[0m in 0.78s]
[0m21:04:38.931046 [debug] [Thread-2  ]: Finished running node test.northwind_dbt.not_null_dim_employees_employee_key.232a183ffe
[0m21:04:38.931046 [debug] [Thread-2  ]: Began running node test.northwind_dbt.not_null_fact_order_details_order_id.8d47c14c82
[0m21:04:38.931046 [info ] [Thread-2  ]: 5 of 16 START test not_null_fact_order_details_order_id ........................ [RUN]
[0m21:04:38.931046 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.northwind_dbt.not_null_dim_employees_employee_key.232a183ffe, now test.northwind_dbt.not_null_fact_order_details_order_id.8d47c14c82)
[0m21:04:38.931046 [debug] [Thread-2  ]: Began compiling node test.northwind_dbt.not_null_fact_order_details_order_id.8d47c14c82
[0m21:04:38.931046 [debug] [Thread-2  ]: Writing injected SQL for node "test.northwind_dbt.not_null_fact_order_details_order_id.8d47c14c82"
[0m21:04:38.952150 [debug] [Thread-2  ]: Began executing node test.northwind_dbt.not_null_fact_order_details_order_id.8d47c14c82
[0m21:04:38.961595 [debug] [Thread-2  ]: Writing runtime sql for node "test.northwind_dbt.not_null_fact_order_details_order_id.8d47c14c82"
[0m21:04:38.976727 [debug] [Thread-2  ]: Using snowflake connection "test.northwind_dbt.not_null_fact_order_details_order_id.8d47c14c82"
[0m21:04:38.978157 [debug] [Thread-2  ]: On test.northwind_dbt.not_null_fact_order_details_order_id.8d47c14c82: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "test.northwind_dbt.not_null_fact_order_details_order_id.8d47c14c82"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from Project_2.public.fact_order_details
where order_id is null



      
    ) dbt_internal_test
[0m21:04:39.066060 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.788 seconds
[0m21:04:39.071760 [info ] [Thread-1  ]: 1 of 16 PASS not_null_dim_customers_customer_id ................................ [[32mPASS[0m in 1.00s]
[0m21:04:39.073053 [debug] [Thread-1  ]: Finished running node test.northwind_dbt.not_null_dim_customers_customer_id.dd91cd1c8d
[0m21:04:39.073053 [debug] [Thread-1  ]: Began running node test.northwind_dbt.not_null_fact_order_details_product_id.85713db7b9
[0m21:04:39.073053 [info ] [Thread-1  ]: 6 of 16 START test not_null_fact_order_details_product_id ...................... [RUN]
[0m21:04:39.073053 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.northwind_dbt.not_null_dim_customers_customer_id.dd91cd1c8d, now test.northwind_dbt.not_null_fact_order_details_product_id.85713db7b9)
[0m21:04:39.075926 [debug] [Thread-1  ]: Began compiling node test.northwind_dbt.not_null_fact_order_details_product_id.85713db7b9
[0m21:04:39.079290 [debug] [Thread-1  ]: Writing injected SQL for node "test.northwind_dbt.not_null_fact_order_details_product_id.85713db7b9"
[0m21:04:39.094350 [debug] [Thread-1  ]: Began executing node test.northwind_dbt.not_null_fact_order_details_product_id.85713db7b9
[0m21:04:39.097251 [debug] [Thread-1  ]: Writing runtime sql for node "test.northwind_dbt.not_null_fact_order_details_product_id.85713db7b9"
[0m21:04:39.108321 [debug] [Thread-1  ]: Using snowflake connection "test.northwind_dbt.not_null_fact_order_details_product_id.85713db7b9"
[0m21:04:39.108321 [debug] [Thread-1  ]: On test.northwind_dbt.not_null_fact_order_details_product_id.85713db7b9: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "test.northwind_dbt.not_null_fact_order_details_product_id.85713db7b9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_id
from Project_2.public.fact_order_details
where product_id is null



      
    ) dbt_internal_test
[0m21:04:39.127409 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.154 seconds
[0m21:04:39.135063 [info ] [Thread-2  ]: 5 of 16 PASS not_null_fact_order_details_order_id .............................. [[32mPASS[0m in 0.20s]
[0m21:04:39.135063 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.856 seconds
[0m21:04:39.142887 [debug] [Thread-2  ]: Finished running node test.northwind_dbt.not_null_fact_order_details_order_id.8d47c14c82
[0m21:04:39.142887 [debug] [Thread-2  ]: Began running node test.northwind_dbt.not_null_obt_orders_customer_id.1e3c4ae465
[0m21:04:39.142887 [info ] [Thread-3  ]: 3 of 16 PASS not_null_dim_products_product_id .................................. [[32mPASS[0m in 0.99s]
[0m21:04:39.142887 [debug] [Thread-3  ]: Finished running node test.northwind_dbt.not_null_dim_products_product_id.c8aba288d1
[0m21:04:39.142887 [info ] [Thread-2  ]: 7 of 16 START test not_null_obt_orders_customer_id ............................. [RUN]
[0m21:04:39.142887 [debug] [Thread-3  ]: Began running node test.northwind_dbt.not_null_obt_orders_order_date.5632203db3
[0m21:04:39.142887 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.northwind_dbt.not_null_fact_order_details_order_id.8d47c14c82, now test.northwind_dbt.not_null_obt_orders_customer_id.1e3c4ae465)
[0m21:04:39.142887 [debug] [Thread-2  ]: Began compiling node test.northwind_dbt.not_null_obt_orders_customer_id.1e3c4ae465
[0m21:04:39.142887 [info ] [Thread-3  ]: 8 of 16 START test not_null_obt_orders_order_date .............................. [RUN]
[0m21:04:39.160279 [debug] [Thread-2  ]: Writing injected SQL for node "test.northwind_dbt.not_null_obt_orders_customer_id.1e3c4ae465"
[0m21:04:39.160279 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.northwind_dbt.not_null_dim_products_product_id.c8aba288d1, now test.northwind_dbt.not_null_obt_orders_order_date.5632203db3)
[0m21:04:39.160279 [debug] [Thread-3  ]: Began compiling node test.northwind_dbt.not_null_obt_orders_order_date.5632203db3
[0m21:04:39.160279 [debug] [Thread-3  ]: Writing injected SQL for node "test.northwind_dbt.not_null_obt_orders_order_date.5632203db3"
[0m21:04:39.180110 [debug] [Thread-2  ]: Began executing node test.northwind_dbt.not_null_obt_orders_customer_id.1e3c4ae465
[0m21:04:39.180110 [debug] [Thread-3  ]: Began executing node test.northwind_dbt.not_null_obt_orders_order_date.5632203db3
[0m21:04:39.180110 [debug] [Thread-2  ]: Writing runtime sql for node "test.northwind_dbt.not_null_obt_orders_customer_id.1e3c4ae465"
[0m21:04:39.180110 [debug] [Thread-3  ]: Writing runtime sql for node "test.northwind_dbt.not_null_obt_orders_order_date.5632203db3"
[0m21:04:39.207981 [debug] [Thread-2  ]: Using snowflake connection "test.northwind_dbt.not_null_obt_orders_customer_id.1e3c4ae465"
[0m21:04:39.210009 [debug] [Thread-3  ]: Using snowflake connection "test.northwind_dbt.not_null_obt_orders_order_date.5632203db3"
[0m21:04:39.212249 [debug] [Thread-2  ]: On test.northwind_dbt.not_null_obt_orders_customer_id.1e3c4ae465: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "test.northwind_dbt.not_null_obt_orders_customer_id.1e3c4ae465"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from Project_2.public.obt_orders
where customer_id is null



      
    ) dbt_internal_test
[0m21:04:39.212249 [debug] [Thread-3  ]: On test.northwind_dbt.not_null_obt_orders_order_date.5632203db3: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "test.northwind_dbt.not_null_obt_orders_order_date.5632203db3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_date
from Project_2.public.obt_orders
where order_date is null



      
    ) dbt_internal_test
[0m21:04:39.356234 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1.071 seconds
[0m21:04:39.360678 [info ] [Thread-4  ]: 4 of 16 PASS not_null_fact_order_details_customer_id ........................... [[32mPASS[0m in 1.21s]
[0m21:04:39.360678 [debug] [Thread-4  ]: Finished running node test.northwind_dbt.not_null_fact_order_details_customer_id.6aaefe4888
[0m21:04:39.360678 [debug] [Thread-4  ]: Began running node test.northwind_dbt.not_null_obt_orders_order_id.218f605f9c
[0m21:04:39.360678 [info ] [Thread-4  ]: 9 of 16 START test not_null_obt_orders_order_id ................................ [RUN]
[0m21:04:39.360678 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.northwind_dbt.not_null_fact_order_details_customer_id.6aaefe4888, now test.northwind_dbt.not_null_obt_orders_order_id.218f605f9c)
[0m21:04:39.360678 [debug] [Thread-4  ]: Began compiling node test.northwind_dbt.not_null_obt_orders_order_id.218f605f9c
[0m21:04:39.371881 [debug] [Thread-4  ]: Writing injected SQL for node "test.northwind_dbt.not_null_obt_orders_order_id.218f605f9c"
[0m21:04:39.382039 [debug] [Thread-4  ]: Began executing node test.northwind_dbt.not_null_obt_orders_order_id.218f605f9c
[0m21:04:39.384051 [debug] [Thread-4  ]: Writing runtime sql for node "test.northwind_dbt.not_null_obt_orders_order_id.218f605f9c"
[0m21:04:39.397007 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.288 seconds
[0m21:04:39.397007 [debug] [Thread-4  ]: Using snowflake connection "test.northwind_dbt.not_null_obt_orders_order_id.218f605f9c"
[0m21:04:39.397007 [info ] [Thread-1  ]: 6 of 16 PASS not_null_fact_order_details_product_id ............................ [[32mPASS[0m in 0.32s]
[0m21:04:39.397007 [debug] [Thread-4  ]: On test.northwind_dbt.not_null_obt_orders_order_id.218f605f9c: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "test.northwind_dbt.not_null_obt_orders_order_id.218f605f9c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from Project_2.public.obt_orders
where order_id is null



      
    ) dbt_internal_test
[0m21:04:39.397007 [debug] [Thread-1  ]: Finished running node test.northwind_dbt.not_null_fact_order_details_product_id.85713db7b9
[0m21:04:39.410077 [debug] [Thread-1  ]: Began running node test.northwind_dbt.not_null_obt_orders_product_id.caa3082c7f
[0m21:04:39.412958 [info ] [Thread-1  ]: 10 of 16 START test not_null_obt_orders_product_id ............................. [RUN]
[0m21:04:39.412958 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.northwind_dbt.not_null_fact_order_details_product_id.85713db7b9, now test.northwind_dbt.not_null_obt_orders_product_id.caa3082c7f)
[0m21:04:39.412958 [debug] [Thread-1  ]: Began compiling node test.northwind_dbt.not_null_obt_orders_product_id.caa3082c7f
[0m21:04:39.419486 [debug] [Thread-1  ]: Writing injected SQL for node "test.northwind_dbt.not_null_obt_orders_product_id.caa3082c7f"
[0m21:04:39.429250 [debug] [Thread-1  ]: Began executing node test.northwind_dbt.not_null_obt_orders_product_id.caa3082c7f
[0m21:04:39.436284 [debug] [Thread-1  ]: Writing runtime sql for node "test.northwind_dbt.not_null_obt_orders_product_id.caa3082c7f"
[0m21:04:39.447378 [debug] [Thread-1  ]: Using snowflake connection "test.northwind_dbt.not_null_obt_orders_product_id.caa3082c7f"
[0m21:04:39.447378 [debug] [Thread-1  ]: On test.northwind_dbt.not_null_obt_orders_product_id.caa3082c7f: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "test.northwind_dbt.not_null_obt_orders_product_id.caa3082c7f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_id
from Project_2.public.obt_orders
where product_id is null



      
    ) dbt_internal_test
[0m21:04:39.455539 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.241 seconds
[0m21:04:39.458955 [info ] [Thread-2  ]: 7 of 16 PASS not_null_obt_orders_customer_id ................................... [[32mPASS[0m in 0.32s]
[0m21:04:39.460677 [debug] [Thread-2  ]: Finished running node test.northwind_dbt.not_null_obt_orders_customer_id.1e3c4ae465
[0m21:04:39.460677 [debug] [Thread-2  ]: Began running node test.northwind_dbt.not_null_top_customer_revenue_customer_id.668bb5e112
[0m21:04:39.460677 [info ] [Thread-2  ]: 11 of 16 START test not_null_top_customer_revenue_customer_id .................. [RUN]
[0m21:04:39.460677 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.northwind_dbt.not_null_obt_orders_customer_id.1e3c4ae465, now test.northwind_dbt.not_null_top_customer_revenue_customer_id.668bb5e112)
[0m21:04:39.460677 [debug] [Thread-2  ]: Began compiling node test.northwind_dbt.not_null_top_customer_revenue_customer_id.668bb5e112
[0m21:04:39.460677 [debug] [Thread-2  ]: Writing injected SQL for node "test.northwind_dbt.not_null_top_customer_revenue_customer_id.668bb5e112"
[0m21:04:39.476528 [debug] [Thread-2  ]: Began executing node test.northwind_dbt.not_null_top_customer_revenue_customer_id.668bb5e112
[0m21:04:39.478053 [debug] [Thread-2  ]: Writing runtime sql for node "test.northwind_dbt.not_null_top_customer_revenue_customer_id.668bb5e112"
[0m21:04:39.478053 [debug] [Thread-2  ]: Using snowflake connection "test.northwind_dbt.not_null_top_customer_revenue_customer_id.668bb5e112"
[0m21:04:39.478053 [debug] [Thread-2  ]: On test.northwind_dbt.not_null_top_customer_revenue_customer_id.668bb5e112: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "test.northwind_dbt.not_null_top_customer_revenue_customer_id.668bb5e112"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from Project_2.public.top_customer_revenue
where customer_id is null



      
    ) dbt_internal_test
[0m21:04:39.630112 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.222 seconds
[0m21:04:39.632622 [info ] [Thread-4  ]: 9 of 16 PASS not_null_obt_orders_order_id ...................................... [[32mPASS[0m in 0.27s]
[0m21:04:39.634632 [debug] [Thread-4  ]: Finished running node test.northwind_dbt.not_null_obt_orders_order_id.218f605f9c
[0m21:04:39.634632 [debug] [Thread-4  ]: Began running node test.northwind_dbt.not_null_top_employee_revenue_employee_key.cb63db6526
[0m21:04:39.636397 [info ] [Thread-4  ]: 12 of 16 START test not_null_top_employee_revenue_employee_key ................. [RUN]
[0m21:04:39.637469 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.northwind_dbt.not_null_obt_orders_order_id.218f605f9c, now test.northwind_dbt.not_null_top_employee_revenue_employee_key.cb63db6526)
[0m21:04:39.639808 [debug] [Thread-4  ]: Began compiling node test.northwind_dbt.not_null_top_employee_revenue_employee_key.cb63db6526
[0m21:04:39.640466 [debug] [Thread-4  ]: Writing injected SQL for node "test.northwind_dbt.not_null_top_employee_revenue_employee_key.cb63db6526"
[0m21:04:39.647556 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.434 seconds
[0m21:04:39.647556 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.198 seconds
[0m21:04:39.652021 [info ] [Thread-3  ]: 8 of 16 PASS not_null_obt_orders_order_date .................................... [[32mPASS[0m in 0.49s]
[0m21:04:39.656975 [debug] [Thread-4  ]: Began executing node test.northwind_dbt.not_null_top_employee_revenue_employee_key.cb63db6526
[0m21:04:39.655858 [info ] [Thread-1  ]: 10 of 16 PASS not_null_obt_orders_product_id ................................... [[32mPASS[0m in 0.24s]
[0m21:04:39.659015 [debug] [Thread-3  ]: Finished running node test.northwind_dbt.not_null_obt_orders_order_date.5632203db3
[0m21:04:39.663055 [debug] [Thread-4  ]: Writing runtime sql for node "test.northwind_dbt.not_null_top_employee_revenue_employee_key.cb63db6526"
[0m21:04:39.663055 [debug] [Thread-1  ]: Finished running node test.northwind_dbt.not_null_obt_orders_product_id.caa3082c7f
[0m21:04:39.665069 [debug] [Thread-3  ]: Began running node test.northwind_dbt.not_null_underperforming_products_product_id.6cbdbd70f6
[0m21:04:39.665069 [debug] [Thread-1  ]: Began running node test.northwind_dbt.unique_dim_customers_customer_id.15c9f1e2fd
[0m21:04:39.665069 [info ] [Thread-3  ]: 13 of 16 START test not_null_underperforming_products_product_id ............... [RUN]
[0m21:04:39.667315 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.northwind_dbt.not_null_obt_orders_order_date.5632203db3, now test.northwind_dbt.not_null_underperforming_products_product_id.6cbdbd70f6)
[0m21:04:39.667315 [info ] [Thread-1  ]: 14 of 16 START test unique_dim_customers_customer_id ........................... [RUN]
[0m21:04:39.667315 [debug] [Thread-3  ]: Began compiling node test.northwind_dbt.not_null_underperforming_products_product_id.6cbdbd70f6
[0m21:04:39.669604 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.northwind_dbt.not_null_obt_orders_product_id.caa3082c7f, now test.northwind_dbt.unique_dim_customers_customer_id.15c9f1e2fd)
[0m21:04:39.674467 [debug] [Thread-3  ]: Writing injected SQL for node "test.northwind_dbt.not_null_underperforming_products_product_id.6cbdbd70f6"
[0m21:04:39.675600 [debug] [Thread-4  ]: Using snowflake connection "test.northwind_dbt.not_null_top_employee_revenue_employee_key.cb63db6526"
[0m21:04:39.677137 [debug] [Thread-1  ]: Began compiling node test.northwind_dbt.unique_dim_customers_customer_id.15c9f1e2fd
[0m21:04:39.677137 [debug] [Thread-4  ]: On test.northwind_dbt.not_null_top_employee_revenue_employee_key.cb63db6526: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "test.northwind_dbt.not_null_top_employee_revenue_employee_key.cb63db6526"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select employee_key
from Project_2.public.top_employee_revenue
where employee_key is null



      
    ) dbt_internal_test
[0m21:04:39.683105 [debug] [Thread-1  ]: Writing injected SQL for node "test.northwind_dbt.unique_dim_customers_customer_id.15c9f1e2fd"
[0m21:04:39.691167 [debug] [Thread-3  ]: Began executing node test.northwind_dbt.not_null_underperforming_products_product_id.6cbdbd70f6
[0m21:04:39.693580 [debug] [Thread-3  ]: Writing runtime sql for node "test.northwind_dbt.not_null_underperforming_products_product_id.6cbdbd70f6"
[0m21:04:39.700173 [debug] [Thread-1  ]: Began executing node test.northwind_dbt.unique_dim_customers_customer_id.15c9f1e2fd
[0m21:04:39.700173 [debug] [Thread-1  ]: Writing runtime sql for node "test.northwind_dbt.unique_dim_customers_customer_id.15c9f1e2fd"
[0m21:04:39.700173 [debug] [Thread-3  ]: Using snowflake connection "test.northwind_dbt.not_null_underperforming_products_product_id.6cbdbd70f6"
[0m21:04:39.700173 [debug] [Thread-3  ]: On test.northwind_dbt.not_null_underperforming_products_product_id.6cbdbd70f6: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "test.northwind_dbt.not_null_underperforming_products_product_id.6cbdbd70f6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_id
from Project_2.public.underperforming_products
where product_id is null



      
    ) dbt_internal_test
[0m21:04:39.710532 [debug] [Thread-1  ]: Using snowflake connection "test.northwind_dbt.unique_dim_customers_customer_id.15c9f1e2fd"
[0m21:04:39.710532 [debug] [Thread-1  ]: On test.northwind_dbt.unique_dim_customers_customer_id.15c9f1e2fd: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "test.northwind_dbt.unique_dim_customers_customer_id.15c9f1e2fd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from Project_2.public.dim_customers
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m21:04:39.917991 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.432 seconds
[0m21:04:39.917991 [info ] [Thread-2  ]: 11 of 16 PASS not_null_top_customer_revenue_customer_id ........................ [[32mPASS[0m in 0.46s]
[0m21:04:39.917991 [debug] [Thread-2  ]: Finished running node test.northwind_dbt.not_null_top_customer_revenue_customer_id.668bb5e112
[0m21:04:39.917991 [debug] [Thread-2  ]: Began running node test.northwind_dbt.unique_dim_employees_employee_key.3824d24782
[0m21:04:39.917991 [info ] [Thread-2  ]: 15 of 16 START test unique_dim_employees_employee_key .......................... [RUN]
[0m21:04:39.917991 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.northwind_dbt.not_null_top_customer_revenue_customer_id.668bb5e112, now test.northwind_dbt.unique_dim_employees_employee_key.3824d24782)
[0m21:04:39.917991 [debug] [Thread-2  ]: Began compiling node test.northwind_dbt.unique_dim_employees_employee_key.3824d24782
[0m21:04:39.933814 [debug] [Thread-2  ]: Writing injected SQL for node "test.northwind_dbt.unique_dim_employees_employee_key.3824d24782"
[0m21:04:39.945567 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.250 seconds
[0m21:04:39.962158 [debug] [Thread-2  ]: Began executing node test.northwind_dbt.unique_dim_employees_employee_key.3824d24782
[0m21:04:39.962158 [info ] [Thread-3  ]: 13 of 16 PASS not_null_underperforming_products_product_id ..................... [[32mPASS[0m in 0.29s]
[0m21:04:39.967556 [debug] [Thread-2  ]: Writing runtime sql for node "test.northwind_dbt.unique_dim_employees_employee_key.3824d24782"
[0m21:04:39.969574 [debug] [Thread-3  ]: Finished running node test.northwind_dbt.not_null_underperforming_products_product_id.6cbdbd70f6
[0m21:04:39.969574 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.284 seconds
[0m21:04:39.972083 [debug] [Thread-3  ]: Began running node test.northwind_dbt.unique_dim_products_product_id.ef7b2a9985
[0m21:04:39.975869 [info ] [Thread-4  ]: 12 of 16 PASS not_null_top_employee_revenue_employee_key ....................... [[32mPASS[0m in 0.34s]
[0m21:04:39.977748 [info ] [Thread-3  ]: 16 of 16 START test unique_dim_products_product_id ............................. [RUN]
[0m21:04:39.977748 [debug] [Thread-4  ]: Finished running node test.northwind_dbt.not_null_top_employee_revenue_employee_key.cb63db6526
[0m21:04:39.977748 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.northwind_dbt.not_null_underperforming_products_product_id.6cbdbd70f6, now test.northwind_dbt.unique_dim_products_product_id.ef7b2a9985)
[0m21:04:39.977748 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.262 seconds
[0m21:04:39.977748 [debug] [Thread-3  ]: Began compiling node test.northwind_dbt.unique_dim_products_product_id.ef7b2a9985
[0m21:04:39.986464 [info ] [Thread-1  ]: 14 of 16 PASS unique_dim_customers_customer_id ................................. [[32mPASS[0m in 0.32s]
[0m21:04:39.993428 [debug] [Thread-3  ]: Writing injected SQL for node "test.northwind_dbt.unique_dim_products_product_id.ef7b2a9985"
[0m21:04:39.993428 [debug] [Thread-2  ]: Using snowflake connection "test.northwind_dbt.unique_dim_employees_employee_key.3824d24782"
[0m21:04:39.993428 [debug] [Thread-1  ]: Finished running node test.northwind_dbt.unique_dim_customers_customer_id.15c9f1e2fd
[0m21:04:39.993428 [debug] [Thread-2  ]: On test.northwind_dbt.unique_dim_employees_employee_key.3824d24782: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "test.northwind_dbt.unique_dim_employees_employee_key.3824d24782"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    employee_key as unique_field,
    count(*) as n_records

from Project_2.public.dim_employees
where employee_key is not null
group by employee_key
having count(*) > 1



      
    ) dbt_internal_test
[0m21:04:40.018758 [debug] [Thread-3  ]: Began executing node test.northwind_dbt.unique_dim_products_product_id.ef7b2a9985
[0m21:04:40.018758 [debug] [Thread-3  ]: Writing runtime sql for node "test.northwind_dbt.unique_dim_products_product_id.ef7b2a9985"
[0m21:04:40.031629 [debug] [Thread-3  ]: Using snowflake connection "test.northwind_dbt.unique_dim_products_product_id.ef7b2a9985"
[0m21:04:40.031629 [debug] [Thread-3  ]: On test.northwind_dbt.unique_dim_products_product_id.ef7b2a9985: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "test.northwind_dbt.unique_dim_products_product_id.ef7b2a9985"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    product_id as unique_field,
    count(*) as n_records

from Project_2.public.dim_products
where product_id is not null
group by product_id
having count(*) > 1



      
    ) dbt_internal_test
[0m21:04:40.264977 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.271 seconds
[0m21:04:40.272833 [info ] [Thread-2  ]: 15 of 16 PASS unique_dim_employees_employee_key ................................ [[32mPASS[0m in 0.35s]
[0m21:04:40.272833 [debug] [Thread-2  ]: Finished running node test.northwind_dbt.unique_dim_employees_employee_key.3824d24782
[0m21:04:40.419227 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.384 seconds
[0m21:04:40.419227 [info ] [Thread-3  ]: 16 of 16 PASS unique_dim_products_product_id ................................... [[32mPASS[0m in 0.44s]
[0m21:04:40.419227 [debug] [Thread-3  ]: Finished running node test.northwind_dbt.unique_dim_products_product_id.ef7b2a9985
[0m21:04:40.432605 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:04:40.432605 [debug] [MainThread]: Connection 'list_Project_2_public' was left open.
[0m21:04:40.432605 [debug] [MainThread]: On list_Project_2_public: Close
[0m21:04:40.554965 [debug] [MainThread]: Connection 'list_Project_2_snapshots' was left open.
[0m21:04:40.554965 [debug] [MainThread]: On list_Project_2_snapshots: Close
[0m21:04:40.684261 [debug] [MainThread]: Connection 'test.northwind_dbt.unique_dim_customers_customer_id.15c9f1e2fd' was left open.
[0m21:04:40.684261 [debug] [MainThread]: On test.northwind_dbt.unique_dim_customers_customer_id.15c9f1e2fd: Close
[0m21:04:40.801443 [debug] [MainThread]: Connection 'test.northwind_dbt.unique_dim_employees_employee_key.3824d24782' was left open.
[0m21:04:40.806100 [debug] [MainThread]: On test.northwind_dbt.unique_dim_employees_employee_key.3824d24782: Close
[0m21:04:40.923470 [debug] [MainThread]: Connection 'test.northwind_dbt.unique_dim_products_product_id.ef7b2a9985' was left open.
[0m21:04:40.924530 [debug] [MainThread]: On test.northwind_dbt.unique_dim_products_product_id.ef7b2a9985: Close
[0m21:04:41.057280 [debug] [MainThread]: Connection 'test.northwind_dbt.not_null_top_employee_revenue_employee_key.cb63db6526' was left open.
[0m21:04:41.058914 [debug] [MainThread]: On test.northwind_dbt.not_null_top_employee_revenue_employee_key.cb63db6526: Close
[0m21:04:41.191261 [info ] [MainThread]: 
[0m21:04:41.192881 [info ] [MainThread]: Finished running 16 data tests in 0 hours 0 minutes and 4.19 seconds (4.19s).
[0m21:04:41.196038 [debug] [MainThread]: Command end result
[0m21:04:41.391719 [debug] [MainThread]: Wrote artifact WritableManifest to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\manifest.json
[0m21:04:41.399245 [debug] [MainThread]: Wrote artifact SemanticManifest to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\semantic_manifest.json
[0m21:04:41.418873 [debug] [MainThread]: Wrote artifact RunExecutionResult to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\run_results.json
[0m21:04:41.421551 [info ] [MainThread]: 
[0m21:04:41.421551 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:04:41.423564 [info ] [MainThread]: 
[0m21:04:41.425570 [info ] [MainThread]: Done. PASS=16 WARN=0 ERROR=0 SKIP=0 TOTAL=16
[0m21:04:41.427574 [debug] [MainThread]: Command `dbt test` succeeded at 21:04:41.425570 after 7.89 seconds
[0m21:04:41.427574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF2B7DF370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF4695A1C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF46F25F10>]}
[0m21:04:41.427574 [debug] [MainThread]: Flushing usage events
[0m21:04:42.195124 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:04:49.049957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6D07803D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6D27F3CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6D27F3AC0>]}


============================== 21:04:49.054693 | 8bcbb418-3d4a-4be8-9f8e-e671ddf5407b ==============================
[0m21:04:49.054693 [info ] [MainThread]: Running with dbt=1.9.0
[0m21:04:49.054693 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'c:\\Users\\fitzp\\Documents\\Alpaca_Market\\zproject_2\\northwind_psql', 'debug': 'False', 'version_check': 'True', 'log_path': 'c:\\Users\\fitzp\\Documents\\Alpaca_Market\\zproject_2\\northwind_psql\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:04:49.930849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8bcbb418-3d4a-4be8-9f8e-e671ddf5407b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6CF767F40>]}
[0m21:04:49.996539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8bcbb418-3d4a-4be8-9f8e-e671ddf5407b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6EB292820>]}
[0m21:04:49.996539 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m21:04:50.387510 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m21:04:50.838558 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:04:50.838558 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:04:50.848333 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.northwind_dbt.marts.bi
[0m21:04:50.955881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8bcbb418-3d4a-4be8-9f8e-e671ddf5407b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6EB900130>]}
[0m21:04:51.380217 [debug] [MainThread]: Wrote artifact WritableManifest to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\manifest.json
[0m21:04:51.388524 [debug] [MainThread]: Wrote artifact SemanticManifest to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\semantic_manifest.json
[0m21:04:51.441211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8bcbb418-3d4a-4be8-9f8e-e671ddf5407b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6EB29C430>]}
[0m21:04:51.441211 [info ] [MainThread]: Found 13 models, 1 snapshot, 16 data tests, 8 sources, 706 macros
[0m21:04:51.441211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8bcbb418-3d4a-4be8-9f8e-e671ddf5407b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6EB928790>]}
[0m21:04:51.441211 [info ] [MainThread]: 
[0m21:04:51.441211 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:04:51.441211 [info ] [MainThread]: 
[0m21:04:51.453931 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:04:51.460497 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_Project_2'
[0m21:04:51.582246 [debug] [ThreadPool]: Using snowflake connection "list_Project_2"
[0m21:04:51.582246 [debug] [ThreadPool]: On list_Project_2: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "connection_name": "list_Project_2"} */
show terse schemas in database Project_2
    limit 10000
[0m21:04:51.582246 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:04:52.357071 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.774 seconds
[0m21:04:52.358008 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_Project_2_snapshots'
[0m21:04:52.358008 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_Project_2_public'
[0m21:04:52.372898 [debug] [ThreadPool]: Using snowflake connection "list_Project_2_snapshots"
[0m21:04:52.376586 [debug] [ThreadPool]: Using snowflake connection "list_Project_2_public"
[0m21:04:52.376586 [debug] [ThreadPool]: On list_Project_2_snapshots: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "connection_name": "list_Project_2_snapshots"} */
show objects in Project_2.snapshots limit 10000;
[0m21:04:52.376586 [debug] [ThreadPool]: On list_Project_2_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "connection_name": "list_Project_2_public"} */
show objects in Project_2.public limit 10000;
[0m21:04:52.378604 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:04:52.378604 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:04:52.794344 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bbb1e0-020d-034d-000c-83e7000bc0ba
[0m21:04:52.795391 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m21:04:52.796331 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m21:04:52.797447 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m21:04:52.903227 [debug] [ThreadPool]: SQL status: SUCCESS 27 in 0.532 seconds
[0m21:04:52.903227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8bcbb418-3d4a-4be8-9f8e-e671ddf5407b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6CF672970>]}
[0m21:04:52.919834 [debug] [Thread-1  ]: Began running node model.northwind_dbt.stg_customers
[0m21:04:52.919834 [debug] [Thread-2  ]: Began running node model.northwind_dbt.stg_employees
[0m21:04:52.919834 [info ] [Thread-1  ]: 1 of 13 START sql view model public.stg_customers .............................. [RUN]
[0m21:04:52.919834 [debug] [Thread-4  ]: Began running node model.northwind_dbt.stg_orders
[0m21:04:52.919834 [debug] [Thread-3  ]: Began running node model.northwind_dbt.stg_order_details
[0m21:04:52.919834 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.northwind_dbt.stg_customers'
[0m21:04:52.919834 [debug] [Thread-1  ]: Began compiling node model.northwind_dbt.stg_customers
[0m21:04:52.919834 [info ] [Thread-2  ]: 2 of 13 START sql view model public.stg_employees .............................. [RUN]
[0m21:04:52.919834 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind_dbt.stg_customers"
[0m21:04:52.919834 [info ] [Thread-4  ]: 4 of 13 START sql view model public.stg_orders ................................. [RUN]
[0m21:04:52.936548 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.northwind_dbt.stg_employees'
[0m21:04:52.919834 [info ] [Thread-3  ]: 3 of 13 START sql view model public.stg_order_details .......................... [RUN]
[0m21:04:52.938478 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.northwind_dbt.stg_orders'
[0m21:04:52.939242 [debug] [Thread-2  ]: Began compiling node model.northwind_dbt.stg_employees
[0m21:04:52.940405 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.northwind_dbt.stg_order_details'
[0m21:04:52.943091 [debug] [Thread-4  ]: Began compiling node model.northwind_dbt.stg_orders
[0m21:04:52.948935 [debug] [Thread-2  ]: Writing injected SQL for node "model.northwind_dbt.stg_employees"
[0m21:04:52.949500 [debug] [Thread-3  ]: Began compiling node model.northwind_dbt.stg_order_details
[0m21:04:52.951449 [debug] [Thread-4  ]: Writing injected SQL for node "model.northwind_dbt.stg_orders"
[0m21:04:52.951449 [debug] [Thread-1  ]: Began executing node model.northwind_dbt.stg_customers
[0m21:04:52.956057 [debug] [Thread-3  ]: Writing injected SQL for node "model.northwind_dbt.stg_order_details"
[0m21:04:52.990735 [debug] [Thread-4  ]: Began executing node model.northwind_dbt.stg_orders
[0m21:04:52.991386 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind_dbt.stg_customers"
[0m21:04:52.991904 [debug] [Thread-2  ]: Began executing node model.northwind_dbt.stg_employees
[0m21:04:52.997671 [debug] [Thread-4  ]: Writing runtime sql for node "model.northwind_dbt.stg_orders"
[0m21:04:53.001587 [debug] [Thread-2  ]: Writing runtime sql for node "model.northwind_dbt.stg_employees"
[0m21:04:53.005411 [debug] [Thread-3  ]: Began executing node model.northwind_dbt.stg_order_details
[0m21:04:53.009081 [debug] [Thread-3  ]: Writing runtime sql for node "model.northwind_dbt.stg_order_details"
[0m21:04:53.021584 [debug] [Thread-1  ]: Using snowflake connection "model.northwind_dbt.stg_customers"
[0m21:04:53.022596 [debug] [Thread-2  ]: Using snowflake connection "model.northwind_dbt.stg_employees"
[0m21:04:53.022596 [debug] [Thread-1  ]: On model.northwind_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.stg_customers"} */
create or replace   view Project_2.public.stg_customers
  
   as (
    select * from PROJECT_2.PUBLIC.customers
  );
[0m21:04:53.023590 [debug] [Thread-2  ]: On model.northwind_dbt.stg_employees: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.stg_employees"} */
create or replace   view Project_2.public.stg_employees
  
   as (
    select * from PROJECT_2.PUBLIC.employees
  );
[0m21:04:53.023590 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m21:04:53.024591 [debug] [Thread-4  ]: Using snowflake connection "model.northwind_dbt.stg_orders"
[0m21:04:53.025208 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m21:04:53.026830 [debug] [Thread-3  ]: Using snowflake connection "model.northwind_dbt.stg_order_details"
[0m21:04:53.028441 [debug] [Thread-4  ]: On model.northwind_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.stg_orders"} */
create or replace   view Project_2.public.stg_orders
  
   as (
    select * from PROJECT_2.PUBLIC.orders
  );
[0m21:04:53.030521 [debug] [Thread-3  ]: On model.northwind_dbt.stg_order_details: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.stg_order_details"} */
create or replace   view Project_2.public.stg_order_details
  
   as (
    select * from PROJECT_2.PUBLIC.order_details
  );
[0m21:04:53.031554 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m21:04:53.032646 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m21:04:53.953407 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.927 seconds
[0m21:04:53.981380 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8bcbb418-3d4a-4be8-9f8e-e671ddf5407b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6D27BE100>]}
[0m21:04:53.981380 [info ] [Thread-3  ]: 3 of 13 OK created sql view model public.stg_order_details ..................... [[32mSUCCESS 1[0m in 1.04s]
[0m21:04:53.981380 [debug] [Thread-3  ]: Finished running node model.northwind_dbt.stg_order_details
[0m21:04:53.984855 [debug] [Thread-3  ]: Began running node model.northwind_dbt.stg_products
[0m21:04:53.984855 [info ] [Thread-3  ]: 5 of 13 START sql view model public.stg_products ............................... [RUN]
[0m21:04:53.984855 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.northwind_dbt.stg_order_details, now model.northwind_dbt.stg_products)
[0m21:04:53.984855 [debug] [Thread-3  ]: Began compiling node model.northwind_dbt.stg_products
[0m21:04:53.993600 [debug] [Thread-3  ]: Writing injected SQL for node "model.northwind_dbt.stg_products"
[0m21:04:54.003426 [debug] [Thread-3  ]: Began executing node model.northwind_dbt.stg_products
[0m21:04:54.009120 [debug] [Thread-3  ]: Writing runtime sql for node "model.northwind_dbt.stg_products"
[0m21:04:54.011127 [debug] [Thread-3  ]: Using snowflake connection "model.northwind_dbt.stg_products"
[0m21:04:54.011127 [debug] [Thread-3  ]: On model.northwind_dbt.stg_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.stg_products"} */
create or replace   view Project_2.public.stg_products
  
   as (
    select * from PROJECT_2.PUBLIC.products
  );
[0m21:04:54.118693 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.094 seconds
[0m21:04:54.122717 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8bcbb418-3d4a-4be8-9f8e-e671ddf5407b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6D27BE610>]}
[0m21:04:54.122717 [info ] [Thread-1  ]: 1 of 13 OK created sql view model public.stg_customers ......................... [[32mSUCCESS 1[0m in 1.20s]
[0m21:04:54.122717 [debug] [Thread-1  ]: Finished running node model.northwind_dbt.stg_customers
[0m21:04:54.122717 [debug] [Thread-1  ]: Began running node model.northwind_dbt.dim_customers
[0m21:04:54.122717 [info ] [Thread-1  ]: 6 of 13 START sql table model public.dim_customers ............................. [RUN]
[0m21:04:54.122717 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.northwind_dbt.stg_customers, now model.northwind_dbt.dim_customers)
[0m21:04:54.128729 [debug] [Thread-1  ]: Began compiling node model.northwind_dbt.dim_customers
[0m21:04:54.132751 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind_dbt.dim_customers"
[0m21:04:54.132751 [debug] [Thread-1  ]: Began executing node model.northwind_dbt.dim_customers
[0m21:04:54.166990 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind_dbt.dim_customers"
[0m21:04:54.166990 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1.137 seconds
[0m21:04:54.166990 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8bcbb418-3d4a-4be8-9f8e-e671ddf5407b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6EC056DF0>]}
[0m21:04:54.166990 [info ] [Thread-4  ]: 4 of 13 OK created sql view model public.stg_orders ............................ [[32mSUCCESS 1[0m in 1.23s]
[0m21:04:54.166990 [debug] [Thread-4  ]: Finished running node model.northwind_dbt.stg_orders
[0m21:04:54.175554 [debug] [Thread-4  ]: Began running node model.northwind_dbt.fact_order_details
[0m21:04:54.175554 [info ] [Thread-4  ]: 7 of 13 START sql incremental model public.fact_order_details .................. [RUN]
[0m21:04:54.175554 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.northwind_dbt.stg_orders, now model.northwind_dbt.fact_order_details)
[0m21:04:54.179421 [debug] [Thread-4  ]: Began compiling node model.northwind_dbt.fact_order_details
[0m21:04:54.180431 [debug] [Thread-1  ]: Using snowflake connection "model.northwind_dbt.dim_customers"
[0m21:04:54.191095 [debug] [Thread-4  ]: Writing injected SQL for node "model.northwind_dbt.fact_order_details"
[0m21:04:54.191095 [debug] [Thread-1  ]: On model.northwind_dbt.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.dim_customers"} */
create or replace transient table Project_2.public.dim_customers
         as
        (select * from Project_2.public.stg_customers
        );
[0m21:04:54.198622 [debug] [Thread-4  ]: Began executing node model.northwind_dbt.fact_order_details
[0m21:04:54.237488 [debug] [Thread-4  ]: Using snowflake connection "model.northwind_dbt.fact_order_details"
[0m21:04:54.237488 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.218 seconds
[0m21:04:54.237488 [debug] [Thread-4  ]: On model.northwind_dbt.fact_order_details: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.fact_order_details"} */
create or replace  temporary view Project_2.public.fact_order_details__dbt_tmp
  
   as (
    

with base as (
    select 
        od.order_id,
        od.product_id,
        o.customer_id,
        o.employee_id,
        o.ship_via as shipper_id,
        o.order_date,
        od.unit_price,
        od.quantity,
        od.discount,
        od.unit_price * od.quantity * (1 - od.discount) as revenue
    from Project_2.public.stg_order_details od
    join Project_2.public.stg_orders o on od.order_id = o.order_id
    
        and o.order_date >= (select max(order_date) from Project_2.public.fact_order_details)
    
),
aggregated as (
    select 
        order_id,
        product_id,
        customer_id,
        employee_id,
        shipper_id,
        cast(order_date as date) as order_date,
        sum(revenue) as total_revenue,
        avg(revenue) as avg_revenue,
        max(revenue) as max_revenue,
        min(revenue) as min_revenue,
        count(*) as line_count,
        rank() over (partition by customer_id order by sum(revenue) desc) as revenue_rank
    from base
    group by order_id, product_id, customer_id, employee_id, shipper_id, order_date
)
select * from aggregated
  );
[0m21:04:54.245952 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8bcbb418-3d4a-4be8-9f8e-e671ddf5407b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6EC017D90>]}
[0m21:04:54.248058 [info ] [Thread-2  ]: 2 of 13 OK created sql view model public.stg_employees ......................... [[32mSUCCESS 1[0m in 1.31s]
[0m21:04:54.248058 [debug] [Thread-2  ]: Finished running node model.northwind_dbt.stg_employees
[0m21:04:54.248058 [debug] [Thread-2  ]: Began running node model.northwind_dbt.dim_employees
[0m21:04:54.248058 [info ] [Thread-2  ]: 8 of 13 START sql table model public.dim_employees ............................. [RUN]
[0m21:04:54.248058 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.northwind_dbt.stg_employees, now model.northwind_dbt.dim_employees)
[0m21:04:54.248058 [debug] [Thread-2  ]: Began compiling node model.northwind_dbt.dim_employees
[0m21:04:54.270391 [debug] [Thread-2  ]: Writing injected SQL for node "model.northwind_dbt.dim_employees"
[0m21:04:54.284879 [debug] [Thread-2  ]: Began executing node model.northwind_dbt.dim_employees
[0m21:04:54.287609 [debug] [Thread-2  ]: Writing runtime sql for node "model.northwind_dbt.dim_employees"
[0m21:04:54.298046 [debug] [Thread-2  ]: Using snowflake connection "model.northwind_dbt.dim_employees"
[0m21:04:54.298046 [debug] [Thread-2  ]: On model.northwind_dbt.dim_employees: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.dim_employees"} */
create or replace transient table Project_2.public.dim_employees
         as
        (with source_data as (
    select * from Project_2.public.stg_employees
),
scd2 as (
    select 
        md5(cast(coalesce(cast(employee_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as employee_key,
        *,
        current_timestamp as dbt_updated_at
    from source_data
)
select * from scd2
        );
[0m21:04:54.793786 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.776 seconds
[0m21:04:54.801148 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8bcbb418-3d4a-4be8-9f8e-e671ddf5407b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6D066A100>]}
[0m21:04:54.801148 [info ] [Thread-3  ]: 5 of 13 OK created sql view model public.stg_products .......................... [[32mSUCCESS 1[0m in 0.82s]
[0m21:04:54.804344 [debug] [Thread-3  ]: Finished running node model.northwind_dbt.stg_products
[0m21:04:54.804344 [debug] [Thread-3  ]: Began running node model.northwind_dbt.dim_products
[0m21:04:54.804344 [info ] [Thread-3  ]: 9 of 13 START sql table model public.dim_products .............................. [RUN]
[0m21:04:54.804344 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.northwind_dbt.stg_products, now model.northwind_dbt.dim_products)
[0m21:04:54.804344 [debug] [Thread-3  ]: Began compiling node model.northwind_dbt.dim_products
[0m21:04:54.881080 [debug] [Thread-3  ]: Writing injected SQL for node "model.northwind_dbt.dim_products"
[0m21:04:54.894092 [debug] [Thread-3  ]: Began executing node model.northwind_dbt.dim_products
[0m21:04:54.894092 [debug] [Thread-3  ]: Writing runtime sql for node "model.northwind_dbt.dim_products"
[0m21:04:54.910898 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.663 seconds
[0m21:04:54.921527 [debug] [Thread-4  ]: Using snowflake connection "model.northwind_dbt.fact_order_details"
[0m21:04:54.923564 [debug] [Thread-3  ]: Using snowflake connection "model.northwind_dbt.dim_products"
[0m21:04:54.924532 [debug] [Thread-4  ]: On model.northwind_dbt.fact_order_details: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.fact_order_details"} */
describe table Project_2.public.fact_order_details__dbt_tmp
[0m21:04:54.925528 [debug] [Thread-3  ]: On model.northwind_dbt.dim_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.dim_products"} */
create or replace transient table Project_2.public.dim_products
         as
        (select 
    p.product_id,
    p.product_name,
    p.supplier_id,
    s.company_name as supplier_name,
    p.category_id,
    c.category_name,
    p.quantity_per_unit,
    p.unit_price,
    p.units_in_stock,
    p.units_on_order,
    p.reorder_level,
    p.discontinued
from Project_2.public.stg_products p
left join PROJECT_2.PUBLIC.suppliers s on p.supplier_id = s.supplier_id
left join PROJECT_2.PUBLIC.categories c on p.category_id = c.category_id
        );
[0m21:04:55.049559 [debug] [Thread-4  ]: SQL status: SUCCESS 12 in 0.126 seconds
[0m21:04:55.049559 [debug] [Thread-4  ]: Using snowflake connection "model.northwind_dbt.fact_order_details"
[0m21:04:55.049559 [debug] [Thread-4  ]: On model.northwind_dbt.fact_order_details: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.fact_order_details"} */
describe table Project_2.public.fact_order_details
[0m21:04:55.155077 [debug] [Thread-4  ]: SQL status: SUCCESS 12 in 0.101 seconds
[0m21:04:55.171089 [debug] [Thread-4  ]: Using snowflake connection "model.northwind_dbt.fact_order_details"
[0m21:04:55.171089 [debug] [Thread-4  ]: On model.northwind_dbt.fact_order_details: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.fact_order_details"} */
describe table "PROJECT_2"."PUBLIC"."FACT_ORDER_DETAILS"
[0m21:04:55.269415 [debug] [Thread-4  ]: SQL status: SUCCESS 12 in 0.094 seconds
[0m21:04:55.294609 [debug] [Thread-4  ]: Writing runtime sql for node "model.northwind_dbt.fact_order_details"
[0m21:04:55.298552 [debug] [Thread-4  ]: Using snowflake connection "model.northwind_dbt.fact_order_details"
[0m21:04:55.307479 [debug] [Thread-4  ]: On model.northwind_dbt.fact_order_details: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.fact_order_details"} */
-- back compat for old kwarg name
  
  begin;
[0m21:04:55.359588 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.063 seconds
[0m21:04:55.370081 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8bcbb418-3d4a-4be8-9f8e-e671ddf5407b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6EC13AD30>]}
[0m21:04:55.372092 [info ] [Thread-2  ]: 8 of 13 OK created sql table model public.dim_employees ........................ [[32mSUCCESS 1[0m in 1.12s]
[0m21:04:55.372092 [debug] [Thread-2  ]: Finished running node model.northwind_dbt.dim_employees
[0m21:04:55.434973 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.127 seconds
[0m21:04:55.435984 [debug] [Thread-4  ]: Using snowflake connection "model.northwind_dbt.fact_order_details"
[0m21:04:55.436778 [debug] [Thread-4  ]: On model.northwind_dbt.fact_order_details: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.fact_order_details"} */
merge into Project_2.public.fact_order_details as DBT_INTERNAL_DEST
        using Project_2.public.fact_order_details__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.order_id = DBT_INTERNAL_DEST.order_id
                ) and (
                    DBT_INTERNAL_SOURCE.product_id = DBT_INTERNAL_DEST.product_id
                )

    
    when matched then update set
        "ORDER_ID" = DBT_INTERNAL_SOURCE."ORDER_ID","PRODUCT_ID" = DBT_INTERNAL_SOURCE."PRODUCT_ID","CUSTOMER_ID" = DBT_INTERNAL_SOURCE."CUSTOMER_ID","EMPLOYEE_ID" = DBT_INTERNAL_SOURCE."EMPLOYEE_ID","SHIPPER_ID" = DBT_INTERNAL_SOURCE."SHIPPER_ID","ORDER_DATE" = DBT_INTERNAL_SOURCE."ORDER_DATE","TOTAL_REVENUE" = DBT_INTERNAL_SOURCE."TOTAL_REVENUE","AVG_REVENUE" = DBT_INTERNAL_SOURCE."AVG_REVENUE","MAX_REVENUE" = DBT_INTERNAL_SOURCE."MAX_REVENUE","MIN_REVENUE" = DBT_INTERNAL_SOURCE."MIN_REVENUE","LINE_COUNT" = DBT_INTERNAL_SOURCE."LINE_COUNT","REVENUE_RANK" = DBT_INTERNAL_SOURCE."REVENUE_RANK"
    

    when not matched then insert
        ("ORDER_ID", "PRODUCT_ID", "CUSTOMER_ID", "EMPLOYEE_ID", "SHIPPER_ID", "ORDER_DATE", "TOTAL_REVENUE", "AVG_REVENUE", "MAX_REVENUE", "MIN_REVENUE", "LINE_COUNT", "REVENUE_RANK")
    values
        ("ORDER_ID", "PRODUCT_ID", "CUSTOMER_ID", "EMPLOYEE_ID", "SHIPPER_ID", "ORDER_DATE", "TOTAL_REVENUE", "AVG_REVENUE", "MAX_REVENUE", "MIN_REVENUE", "LINE_COUNT", "REVENUE_RANK")

;
[0m21:04:55.629768 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.436 seconds
[0m21:04:55.637477 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8bcbb418-3d4a-4be8-9f8e-e671ddf5407b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6ED2337C0>]}
[0m21:04:55.639539 [info ] [Thread-1  ]: 6 of 13 OK created sql table model public.dim_customers ........................ [[32mSUCCESS 1[0m in 1.51s]
[0m21:04:55.642328 [debug] [Thread-1  ]: Finished running node model.northwind_dbt.dim_customers
[0m21:04:56.006728 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1.080 seconds
[0m21:04:56.011360 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8bcbb418-3d4a-4be8-9f8e-e671ddf5407b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6ED1F26A0>]}
[0m21:04:56.012947 [info ] [Thread-3  ]: 9 of 13 OK created sql table model public.dim_products ......................... [[32mSUCCESS 1[0m in 1.21s]
[0m21:04:56.014537 [debug] [Thread-3  ]: Finished running node model.northwind_dbt.dim_products
[0m21:04:56.447250 [debug] [Thread-4  ]: SQL status: SUCCESS 32 in 1.010 seconds
[0m21:04:56.449132 [debug] [Thread-4  ]: Using snowflake connection "model.northwind_dbt.fact_order_details"
[0m21:04:56.450274 [debug] [Thread-4  ]: On model.northwind_dbt.fact_order_details: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.fact_order_details"} */
COMMIT
[0m21:04:56.891260 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.440 seconds
[0m21:04:56.901026 [debug] [Thread-4  ]: Applying DROP to: Project_2.public.fact_order_details__dbt_tmp
[0m21:04:56.909978 [debug] [Thread-4  ]: Using snowflake connection "model.northwind_dbt.fact_order_details"
[0m21:04:56.909978 [debug] [Thread-4  ]: On model.northwind_dbt.fact_order_details: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.fact_order_details"} */
drop view if exists Project_2.public.fact_order_details__dbt_tmp cascade
[0m21:04:57.072451 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.160 seconds
[0m21:04:57.075533 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8bcbb418-3d4a-4be8-9f8e-e671ddf5407b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6ED246E20>]}
[0m21:04:57.075533 [info ] [Thread-4  ]: 7 of 13 OK created sql incremental model public.fact_order_details ............. [[32mSUCCESS 32[0m in 2.90s]
[0m21:04:57.080184 [debug] [Thread-4  ]: Finished running node model.northwind_dbt.fact_order_details
[0m21:04:57.082564 [debug] [Thread-2  ]: Began running node model.northwind_dbt.obt_orders
[0m21:04:57.083195 [debug] [Thread-1  ]: Began running node model.northwind_dbt.top_customer_revenue
[0m21:04:57.083738 [debug] [Thread-3  ]: Began running node model.northwind_dbt.top_employee_revenue
[0m21:04:57.084312 [debug] [Thread-4  ]: Began running node model.northwind_dbt.underperforming_products
[0m21:04:57.085411 [info ] [Thread-2  ]: 10 of 13 START sql table model public.obt_orders ............................... [RUN]
[0m21:04:57.087092 [info ] [Thread-1  ]: 11 of 13 START sql table model public.top_customer_revenue ..................... [RUN]
[0m21:04:57.089373 [info ] [Thread-3  ]: 12 of 13 START sql table model public.top_employee_revenue ..................... [RUN]
[0m21:04:57.091106 [info ] [Thread-4  ]: 13 of 13 START sql table model public.underperforming_products ................. [RUN]
[0m21:04:57.092158 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.northwind_dbt.dim_employees, now model.northwind_dbt.obt_orders)
[0m21:04:57.092158 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.northwind_dbt.dim_customers, now model.northwind_dbt.top_customer_revenue)
[0m21:04:57.092158 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.northwind_dbt.dim_products, now model.northwind_dbt.top_employee_revenue)
[0m21:04:57.092158 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.northwind_dbt.fact_order_details, now model.northwind_dbt.underperforming_products)
[0m21:04:57.096281 [debug] [Thread-2  ]: Began compiling node model.northwind_dbt.obt_orders
[0m21:04:57.096281 [debug] [Thread-1  ]: Began compiling node model.northwind_dbt.top_customer_revenue
[0m21:04:57.098893 [debug] [Thread-3  ]: Began compiling node model.northwind_dbt.top_employee_revenue
[0m21:04:57.100902 [debug] [Thread-4  ]: Began compiling node model.northwind_dbt.underperforming_products
[0m21:04:57.100902 [debug] [Thread-2  ]: Writing injected SQL for node "model.northwind_dbt.obt_orders"
[0m21:04:57.109048 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind_dbt.top_customer_revenue"
[0m21:04:57.109048 [debug] [Thread-3  ]: Writing injected SQL for node "model.northwind_dbt.top_employee_revenue"
[0m21:04:57.119768 [debug] [Thread-4  ]: Writing injected SQL for node "model.northwind_dbt.underperforming_products"
[0m21:04:57.134210 [debug] [Thread-4  ]: Began executing node model.northwind_dbt.underperforming_products
[0m21:04:57.134210 [debug] [Thread-1  ]: Began executing node model.northwind_dbt.top_customer_revenue
[0m21:04:57.134210 [debug] [Thread-3  ]: Began executing node model.northwind_dbt.top_employee_revenue
[0m21:04:57.134210 [debug] [Thread-2  ]: Began executing node model.northwind_dbt.obt_orders
[0m21:04:57.144457 [debug] [Thread-4  ]: Writing runtime sql for node "model.northwind_dbt.underperforming_products"
[0m21:04:57.148987 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind_dbt.top_customer_revenue"
[0m21:04:57.152528 [debug] [Thread-3  ]: Writing runtime sql for node "model.northwind_dbt.top_employee_revenue"
[0m21:04:57.152528 [debug] [Thread-2  ]: Writing runtime sql for node "model.northwind_dbt.obt_orders"
[0m21:04:57.186078 [debug] [Thread-4  ]: Using snowflake connection "model.northwind_dbt.underperforming_products"
[0m21:04:57.189075 [debug] [Thread-3  ]: Using snowflake connection "model.northwind_dbt.top_employee_revenue"
[0m21:04:57.190072 [debug] [Thread-2  ]: Using snowflake connection "model.northwind_dbt.obt_orders"
[0m21:04:57.191070 [debug] [Thread-1  ]: Using snowflake connection "model.northwind_dbt.top_customer_revenue"
[0m21:04:57.192072 [debug] [Thread-4  ]: On model.northwind_dbt.underperforming_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.underperforming_products"} */
create or replace transient table Project_2.public.underperforming_products
         as
        (

select
  p.product_id,
  p.product_name,
  p.units_in_stock,
  coalesce(f.total_revenue, 0) as total_revenue
from Project_2.public.dim_products p
left join (
    select
      product_id,
      sum(total_revenue) as total_revenue
    from Project_2.public.fact_order_details
    group by product_id
) f on p.product_id = f.product_id
where p.units_in_stock > 10
  and coalesce(f.total_revenue, 0) < 1000
order by total_revenue asc
        );
[0m21:04:57.193074 [debug] [Thread-3  ]: On model.northwind_dbt.top_employee_revenue: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.top_employee_revenue"} */
create or replace transient table Project_2.public.top_employee_revenue
         as
        (

select
  e.employee_key,
  e.first_name || ' ' || e.last_name as employee_name,
  sum(f.total_revenue) as total_revenue
from Project_2.public.fact_order_details f
join Project_2.public.dim_employees e on f.employee_id = e.employee_id
group by e.employee_key, employee_name
order by total_revenue desc
        );
[0m21:04:57.194076 [debug] [Thread-2  ]: On model.northwind_dbt.obt_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.obt_orders"} */
create or replace transient table Project_2.public.obt_orders
         as
        (select 
    f.order_id,
    f.product_id,
    f.customer_id,
    f.employee_id,
    f.shipper_id,
    f.order_date,
    f.total_revenue,
    f.avg_revenue,
    f.max_revenue,
    f.min_revenue,
    f.line_count,
    f.revenue_rank,

    c.company_name as customer_name,
    p.product_name,
    p.category_name,
    p.supplier_name,
    e.first_name || ' ' || e.last_name as employee_name,
    s.company_name as shipper_name

from Project_2.public.fact_order_details f
left join Project_2.public.dim_customers c on f.customer_id = c.customer_id
left join Project_2.public.dim_products p on f.product_id = p.product_id
left join Project_2.public.dim_employees e on f.employee_id = e.employee_id
left join PROJECT_2.PUBLIC.shippers s on f.shipper_id = s.shipper_id
        );
[0m21:04:57.195073 [debug] [Thread-1  ]: On model.northwind_dbt.top_customer_revenue: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.top_customer_revenue"} */
create or replace transient table Project_2.public.top_customer_revenue
         as
        (

select
  c.customer_id,
  c.company_name as customer_name,
  sum(f.total_revenue) as total_revenue
from Project_2.public.fact_order_details f
join Project_2.public.dim_customers c using (customer_id)
group by c.customer_id, c.company_name
order by total_revenue desc
        );
[0m21:04:58.002172 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.807 seconds
[0m21:04:58.004180 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8bcbb418-3d4a-4be8-9f8e-e671ddf5407b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6EC1234C0>]}
[0m21:04:58.004180 [info ] [Thread-4  ]: 13 of 13 OK created sql table model public.underperforming_products ............ [[32mSUCCESS 1[0m in 0.91s]
[0m21:04:58.004180 [debug] [Thread-4  ]: Finished running node model.northwind_dbt.underperforming_products
[0m21:04:58.169920 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.972 seconds
[0m21:04:58.174293 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8bcbb418-3d4a-4be8-9f8e-e671ddf5407b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6EC056F10>]}
[0m21:04:58.174927 [info ] [Thread-3  ]: 12 of 13 OK created sql table model public.top_employee_revenue ................ [[32mSUCCESS 1[0m in 1.08s]
[0m21:04:58.176567 [debug] [Thread-3  ]: Finished running node model.northwind_dbt.top_employee_revenue
[0m21:04:58.315729 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.112 seconds
[0m21:04:58.323220 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8bcbb418-3d4a-4be8-9f8e-e671ddf5407b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6EC13A4F0>]}
[0m21:04:58.325500 [info ] [Thread-1  ]: 11 of 13 OK created sql table model public.top_customer_revenue ................ [[32mSUCCESS 1[0m in 1.23s]
[0m21:04:58.328212 [debug] [Thread-1  ]: Finished running node model.northwind_dbt.top_customer_revenue
[0m21:04:58.542021 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.349 seconds
[0m21:04:58.542021 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8bcbb418-3d4a-4be8-9f8e-e671ddf5407b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6EC18B190>]}
[0m21:04:58.555552 [info ] [Thread-2  ]: 10 of 13 OK created sql table model public.obt_orders .......................... [[32mSUCCESS 1[0m in 1.45s]
[0m21:04:58.555552 [debug] [Thread-2  ]: Finished running node model.northwind_dbt.obt_orders
[0m21:04:58.555552 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:04:58.555552 [debug] [MainThread]: Connection 'list_Project_2' was left open.
[0m21:04:58.555552 [debug] [MainThread]: On list_Project_2: Close
[0m21:04:58.742241 [debug] [MainThread]: Connection 'list_Project_2_snapshots' was left open.
[0m21:04:58.742241 [debug] [MainThread]: On list_Project_2_snapshots: Close
[0m21:04:58.896049 [debug] [MainThread]: Connection 'list_Project_2_public' was left open.
[0m21:04:58.898817 [debug] [MainThread]: On list_Project_2_public: Close
[0m21:04:59.020975 [debug] [MainThread]: Connection 'model.northwind_dbt.top_customer_revenue' was left open.
[0m21:04:59.020975 [debug] [MainThread]: On model.northwind_dbt.top_customer_revenue: Close
[0m21:04:59.158604 [debug] [MainThread]: Connection 'model.northwind_dbt.obt_orders' was left open.
[0m21:04:59.158604 [debug] [MainThread]: On model.northwind_dbt.obt_orders: Close
[0m21:04:59.301860 [debug] [MainThread]: Connection 'model.northwind_dbt.underperforming_products' was left open.
[0m21:04:59.301860 [debug] [MainThread]: On model.northwind_dbt.underperforming_products: Close
[0m21:04:59.423397 [debug] [MainThread]: Connection 'model.northwind_dbt.top_employee_revenue' was left open.
[0m21:04:59.423954 [debug] [MainThread]: On model.northwind_dbt.top_employee_revenue: Close
[0m21:04:59.523557 [info ] [MainThread]: 
[0m21:04:59.536365 [info ] [MainThread]: Finished running 1 incremental model, 7 table models, 5 view models in 0 hours 0 minutes and 8.07 seconds (8.07s).
[0m21:04:59.539596 [debug] [MainThread]: Command end result
[0m21:04:59.712004 [debug] [MainThread]: Wrote artifact WritableManifest to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\manifest.json
[0m21:04:59.712770 [debug] [MainThread]: Wrote artifact SemanticManifest to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\semantic_manifest.json
[0m21:04:59.743831 [debug] [MainThread]: Wrote artifact RunExecutionResult to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\run_results.json
[0m21:04:59.743831 [info ] [MainThread]: 
[0m21:04:59.752086 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:04:59.752086 [info ] [MainThread]: 
[0m21:04:59.752086 [info ] [MainThread]: Done. PASS=13 WARN=0 ERROR=0 SKIP=0 TOTAL=13
[0m21:04:59.752086 [debug] [MainThread]: Command `dbt run` succeeded at 21:04:59.752086 after 10.80 seconds
[0m21:04:59.752086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6D07803D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6D0304C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6D0366940>]}
[0m21:04:59.752086 [debug] [MainThread]: Flushing usage events
[0m21:05:00.537193 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:10:16.245551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253F1A7F370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253F3AF3C70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253F3AF3A60>]}


============================== 21:10:16.252176 | e0012ef7-f6b6-4a5b-b08b-0b14f73524c8 ==============================
[0m21:10:16.252176 [info ] [MainThread]: Running with dbt=1.9.0
[0m21:10:16.252724 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'c:\\Users\\fitzp\\Documents\\Alpaca_Market\\zproject_2\\northwind_psql', 'debug': 'False', 'warn_error': 'None', 'log_path': 'c:\\Users\\fitzp\\Documents\\Alpaca_Market\\zproject_2\\northwind_psql\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:10:17.517418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e0012ef7-f6b6-4a5b-b08b-0b14f73524c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253F3AC4D30>]}
[0m21:10:17.606839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e0012ef7-f6b6-4a5b-b08b-0b14f73524c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002538C5E1940>]}
[0m21:10:17.606839 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m21:10:18.076624 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m21:10:18.488309 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 1 files changed.
[0m21:10:18.488309 [debug] [MainThread]: Partial parsing: added file: northwind_dbt://models\marts\analysis\monthly_revenue_by_region.sql
[0m21:10:18.488309 [debug] [MainThread]: Partial parsing: updated file: northwind_dbt://models\marts\analysis\schema.yml
[0m21:10:18.488309 [debug] [MainThread]: Partial parsing: deleted file: northwind_dbt://models\marts\analysis\underperforming_products.sql
[0m21:10:18.771188 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.northwind_dbt.monthly_revenue_by_region' (models\marts\analysis\monthly_revenue_by_region.sql) depends on a node named 'dim_orders' which was not found
[0m21:10:18.771188 [debug] [MainThread]: Command `dbt run` failed at 21:10:18.771188 after 2.69 seconds
[0m21:10:18.771188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253F1A7F370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002538CD4FBE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002538CD4F790>]}
[0m21:10:18.771188 [debug] [MainThread]: Flushing usage events
[0m21:10:19.467662 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:13:02.803069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8462DF340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C848353C40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C848353A30>]}


============================== 21:13:02.812619 | 8709d161-56e4-4b48-a3f6-0eccf675eac8 ==============================
[0m21:13:02.812619 [info ] [MainThread]: Running with dbt=1.9.0
[0m21:13:02.812619 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'c:\\Users\\fitzp\\Documents\\Alpaca_Market\\zproject_2\\northwind_psql', 'version_check': 'True', 'debug': 'False', 'log_path': 'c:\\Users\\fitzp\\Documents\\Alpaca_Market\\zproject_2\\northwind_psql\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:13:03.716500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8709d161-56e4-4b48-a3f6-0eccf675eac8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8452C7850>]}
[0m21:13:03.779144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8709d161-56e4-4b48-a3f6-0eccf675eac8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C860E410A0>]}
[0m21:13:03.781145 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m21:13:04.179164 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m21:13:04.627095 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 1 files changed.
[0m21:13:04.642769 [debug] [MainThread]: Partial parsing: added file: northwind_dbt://models\marts\analysis\monthly_revenue_by_region.sql
[0m21:13:04.642769 [debug] [MainThread]: Partial parsing: updated file: northwind_dbt://models\marts\analysis\schema.yml
[0m21:13:04.642769 [debug] [MainThread]: Partial parsing: deleted file: northwind_dbt://models\marts\analysis\underperforming_products.sql
[0m21:13:04.903153 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.northwind_dbt.monthly_revenue_by_region' (models\marts\analysis\monthly_revenue_by_region.sql) depends on a node named 'dim_territories' which was not found
[0m21:13:04.905159 [debug] [MainThread]: Command `dbt run` failed at 21:13:04.905159 after 2.19 seconds
[0m21:13:04.905159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8462DF340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8615AFBB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8615907C0>]}
[0m21:13:04.905159 [debug] [MainThread]: Flushing usage events
[0m21:13:05.636797 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:22:03.092526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001054E27F3A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010550303B20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010550303910>]}


============================== 21:22:03.094572 | bba6c366-abd5-4dc3-bd49-32ef41d87d57 ==============================
[0m21:22:03.094572 [info ] [MainThread]: Running with dbt=1.9.0
[0m21:22:03.094572 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'c:\\Users\\fitzp\\Documents\\Alpaca_Market\\zproject_2\\northwind_psql', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'c:\\Users\\fitzp\\Documents\\Alpaca_Market\\zproject_2\\northwind_psql\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:22:04.334614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bba6c366-abd5-4dc3-bd49-32ef41d87d57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010568E4D190>]}
[0m21:22:04.425649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bba6c366-abd5-4dc3-bd49-32ef41d87d57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001054F5CEDC0>]}
[0m21:22:04.427657 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m21:22:04.907308 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m21:22:05.328452 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 1 files changed.
[0m21:22:05.328452 [debug] [MainThread]: Partial parsing: added file: northwind_dbt://models\marts\analysis\top_performing_products.sql
[0m21:22:05.328452 [debug] [MainThread]: Partial parsing: updated file: northwind_dbt://models\marts\analysis\schema.yml
[0m21:22:05.328452 [debug] [MainThread]: Partial parsing: deleted file: northwind_dbt://models\marts\analysis\underperforming_products.sql
[0m21:22:05.734046 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.northwind_dbt.marts.bi
[0m21:22:05.751728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bba6c366-abd5-4dc3-bd49-32ef41d87d57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010569783130>]}
[0m21:22:05.985320 [debug] [MainThread]: Wrote artifact WritableManifest to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\manifest.json
[0m21:22:05.990119 [debug] [MainThread]: Wrote artifact SemanticManifest to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\semantic_manifest.json
[0m21:22:06.052537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bba6c366-abd5-4dc3-bd49-32ef41d87d57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010569788C70>]}
[0m21:22:06.052537 [info ] [MainThread]: Found 13 models, 1 snapshot, 16 data tests, 8 sources, 706 macros
[0m21:22:06.052537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bba6c366-abd5-4dc3-bd49-32ef41d87d57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010569734BB0>]}
[0m21:22:06.052537 [info ] [MainThread]: 
[0m21:22:06.052537 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:22:06.069505 [info ] [MainThread]: 
[0m21:22:06.071812 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:22:06.077213 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_Project_2'
[0m21:22:06.190751 [debug] [ThreadPool]: Using snowflake connection "list_Project_2"
[0m21:22:06.193146 [debug] [ThreadPool]: On list_Project_2: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "connection_name": "list_Project_2"} */
show terse schemas in database Project_2
    limit 10000
[0m21:22:06.193146 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:22:07.178271 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.984 seconds
[0m21:22:07.182668 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_Project_2_snapshots'
[0m21:22:07.186178 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_Project_2_public'
[0m21:22:07.198048 [debug] [ThreadPool]: Using snowflake connection "list_Project_2_snapshots"
[0m21:22:07.202751 [debug] [ThreadPool]: Using snowflake connection "list_Project_2_public"
[0m21:22:07.204257 [debug] [ThreadPool]: On list_Project_2_snapshots: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "connection_name": "list_Project_2_snapshots"} */
show objects in Project_2.snapshots limit 10000;
[0m21:22:07.205421 [debug] [ThreadPool]: On list_Project_2_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "connection_name": "list_Project_2_public"} */
show objects in Project_2.public limit 10000;
[0m21:22:07.207425 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:22:07.207425 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:22:07.752452 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bbb1f2-020d-03f1-000c-83e7000b704a
[0m21:22:07.754998 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m21:22:07.754998 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m21:22:07.754998 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m21:22:07.828603 [debug] [ThreadPool]: SQL status: SUCCESS 27 in 0.624 seconds
[0m21:22:07.841827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bba6c366-abd5-4dc3-bd49-32ef41d87d57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001054C972970>]}
[0m21:22:07.849490 [debug] [Thread-1  ]: Began running node model.northwind_dbt.stg_customers
[0m21:22:07.850086 [debug] [Thread-2  ]: Began running node model.northwind_dbt.stg_employees
[0m21:22:07.851169 [debug] [Thread-3  ]: Began running node model.northwind_dbt.stg_order_details
[0m21:22:07.851707 [debug] [Thread-4  ]: Began running node model.northwind_dbt.stg_orders
[0m21:22:07.852241 [info ] [Thread-1  ]: 1 of 13 START sql view model public.stg_customers .............................. [RUN]
[0m21:22:07.853321 [info ] [Thread-2  ]: 2 of 13 START sql view model public.stg_employees .............................. [RUN]
[0m21:22:07.853861 [info ] [Thread-3  ]: 3 of 13 START sql view model public.stg_order_details .......................... [RUN]
[0m21:22:07.855488 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.northwind_dbt.stg_customers'
[0m21:22:07.854389 [info ] [Thread-4  ]: 4 of 13 START sql view model public.stg_orders ................................. [RUN]
[0m21:22:07.856021 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.northwind_dbt.stg_employees'
[0m21:22:07.857107 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.northwind_dbt.stg_order_details'
[0m21:22:07.857642 [debug] [Thread-1  ]: Began compiling node model.northwind_dbt.stg_customers
[0m21:22:07.858176 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.northwind_dbt.stg_orders'
[0m21:22:07.859240 [debug] [Thread-2  ]: Began compiling node model.northwind_dbt.stg_employees
[0m21:22:07.859240 [debug] [Thread-3  ]: Began compiling node model.northwind_dbt.stg_order_details
[0m21:22:07.871977 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind_dbt.stg_customers"
[0m21:22:07.871977 [debug] [Thread-4  ]: Began compiling node model.northwind_dbt.stg_orders
[0m21:22:07.947597 [debug] [Thread-2  ]: Writing injected SQL for node "model.northwind_dbt.stg_employees"
[0m21:22:07.951293 [debug] [Thread-3  ]: Writing injected SQL for node "model.northwind_dbt.stg_order_details"
[0m21:22:07.954312 [debug] [Thread-4  ]: Writing injected SQL for node "model.northwind_dbt.stg_orders"
[0m21:22:07.967317 [debug] [Thread-1  ]: Began executing node model.northwind_dbt.stg_customers
[0m21:22:07.967317 [debug] [Thread-4  ]: Began executing node model.northwind_dbt.stg_orders
[0m21:22:07.967317 [debug] [Thread-2  ]: Began executing node model.northwind_dbt.stg_employees
[0m21:22:07.967317 [debug] [Thread-3  ]: Began executing node model.northwind_dbt.stg_order_details
[0m21:22:07.983968 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind_dbt.stg_customers"
[0m21:22:07.983968 [debug] [Thread-4  ]: Writing runtime sql for node "model.northwind_dbt.stg_orders"
[0m21:22:07.999022 [debug] [Thread-2  ]: Writing runtime sql for node "model.northwind_dbt.stg_employees"
[0m21:22:07.999022 [debug] [Thread-3  ]: Writing runtime sql for node "model.northwind_dbt.stg_order_details"
[0m21:22:08.030797 [debug] [Thread-2  ]: Using snowflake connection "model.northwind_dbt.stg_employees"
[0m21:22:08.030797 [debug] [Thread-1  ]: Using snowflake connection "model.northwind_dbt.stg_customers"
[0m21:22:08.030797 [debug] [Thread-4  ]: Using snowflake connection "model.northwind_dbt.stg_orders"
[0m21:22:08.030797 [debug] [Thread-3  ]: Using snowflake connection "model.northwind_dbt.stg_order_details"
[0m21:22:08.030797 [debug] [Thread-2  ]: On model.northwind_dbt.stg_employees: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.stg_employees"} */
create or replace   view Project_2.public.stg_employees
  
   as (
    select * from PROJECT_2.PUBLIC.employees
  );
[0m21:22:08.030797 [debug] [Thread-1  ]: On model.northwind_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.stg_customers"} */
create or replace   view Project_2.public.stg_customers
  
   as (
    select * from PROJECT_2.PUBLIC.customers
  );
[0m21:22:08.030797 [debug] [Thread-4  ]: On model.northwind_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.stg_orders"} */
create or replace   view Project_2.public.stg_orders
  
   as (
    select * from PROJECT_2.PUBLIC.orders
  );
[0m21:22:08.030797 [debug] [Thread-3  ]: On model.northwind_dbt.stg_order_details: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.stg_order_details"} */
create or replace   view Project_2.public.stg_order_details
  
   as (
    select * from PROJECT_2.PUBLIC.order_details
  );
[0m21:22:08.030797 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m21:22:08.030797 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m21:22:08.030797 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m21:22:08.030797 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m21:22:08.923282 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.886 seconds
[0m21:22:08.923282 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.890 seconds
[0m21:22:08.971406 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bba6c366-abd5-4dc3-bd49-32ef41d87d57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000105697881F0>]}
[0m21:22:08.972000 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bba6c366-abd5-4dc3-bd49-32ef41d87d57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010568DDD5E0>]}
[0m21:22:08.972620 [info ] [Thread-3  ]: 3 of 13 OK created sql view model public.stg_order_details ..................... [[32mSUCCESS 1[0m in 1.11s]
[0m21:22:08.972620 [info ] [Thread-4  ]: 4 of 13 OK created sql view model public.stg_orders ............................ [[32mSUCCESS 1[0m in 1.11s]
[0m21:22:08.972620 [debug] [Thread-3  ]: Finished running node model.northwind_dbt.stg_order_details
[0m21:22:08.972620 [debug] [Thread-4  ]: Finished running node model.northwind_dbt.stg_orders
[0m21:22:08.972620 [debug] [Thread-3  ]: Began running node model.northwind_dbt.stg_products
[0m21:22:08.972620 [debug] [Thread-4  ]: Began running node model.northwind_dbt.fact_order_details
[0m21:22:08.972620 [info ] [Thread-3  ]: 5 of 13 START sql view model public.stg_products ............................... [RUN]
[0m21:22:08.972620 [info ] [Thread-4  ]: 6 of 13 START sql incremental model public.fact_order_details .................. [RUN]
[0m21:22:08.983270 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.northwind_dbt.stg_order_details, now model.northwind_dbt.stg_products)
[0m21:22:08.984378 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.northwind_dbt.stg_orders, now model.northwind_dbt.fact_order_details)
[0m21:22:08.985395 [debug] [Thread-3  ]: Began compiling node model.northwind_dbt.stg_products
[0m21:22:08.985395 [debug] [Thread-4  ]: Began compiling node model.northwind_dbt.fact_order_details
[0m21:22:08.985395 [debug] [Thread-3  ]: Writing injected SQL for node "model.northwind_dbt.stg_products"
[0m21:22:09.001163 [debug] [Thread-4  ]: Writing injected SQL for node "model.northwind_dbt.fact_order_details"
[0m21:22:09.008487 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.973 seconds
[0m21:22:09.011953 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bba6c366-abd5-4dc3-bd49-32ef41d87d57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001056AE41550>]}
[0m21:22:09.014224 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.978 seconds
[0m21:22:09.016382 [info ] [Thread-1  ]: 1 of 13 OK created sql view model public.stg_customers ......................... [[32mSUCCESS 1[0m in 1.16s]
[0m21:22:09.020388 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bba6c366-abd5-4dc3-bd49-32ef41d87d57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000105694E6A90>]}
[0m21:22:09.021730 [debug] [Thread-1  ]: Finished running node model.northwind_dbt.stg_customers
[0m21:22:09.023978 [debug] [Thread-3  ]: Began executing node model.northwind_dbt.stg_products
[0m21:22:09.023428 [info ] [Thread-2  ]: 2 of 13 OK created sql view model public.stg_employees ......................... [[32mSUCCESS 1[0m in 1.16s]
[0m21:22:09.025113 [debug] [Thread-1  ]: Began running node model.northwind_dbt.dim_customers
[0m21:22:09.029125 [debug] [Thread-3  ]: Writing runtime sql for node "model.northwind_dbt.stg_products"
[0m21:22:09.029125 [debug] [Thread-4  ]: Began executing node model.northwind_dbt.fact_order_details
[0m21:22:09.029125 [debug] [Thread-2  ]: Finished running node model.northwind_dbt.stg_employees
[0m21:22:09.029125 [info ] [Thread-1  ]: 7 of 13 START sql table model public.dim_customers ............................. [RUN]
[0m21:22:09.062712 [debug] [Thread-4  ]: Using snowflake connection "model.northwind_dbt.fact_order_details"
[0m21:22:09.062712 [debug] [Thread-2  ]: Began running node model.northwind_dbt.dim_employees
[0m21:22:09.062712 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.northwind_dbt.stg_customers, now model.northwind_dbt.dim_customers)
[0m21:22:09.062712 [debug] [Thread-4  ]: On model.northwind_dbt.fact_order_details: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.fact_order_details"} */
create or replace  temporary view Project_2.public.fact_order_details__dbt_tmp
  
   as (
    

with base as (
    select 
        od.order_id,
        od.product_id,
        o.customer_id,
        o.employee_id,
        o.ship_via as shipper_id,
        o.order_date,
        od.unit_price,
        od.quantity,
        od.discount,
        od.unit_price * od.quantity * (1 - od.discount) as revenue
    from Project_2.public.stg_order_details od
    join Project_2.public.stg_orders o on od.order_id = o.order_id
    
        and o.order_date >= (select max(order_date) from Project_2.public.fact_order_details)
    
),
aggregated as (
    select 
        order_id,
        product_id,
        customer_id,
        employee_id,
        shipper_id,
        cast(order_date as date) as order_date,
        sum(revenue) as total_revenue,
        avg(revenue) as avg_revenue,
        max(revenue) as max_revenue,
        min(revenue) as min_revenue,
        count(*) as line_count,
        rank() over (partition by customer_id order by sum(revenue) desc) as revenue_rank
    from base
    group by order_id, product_id, customer_id, employee_id, shipper_id, order_date
)
select * from aggregated
  );
[0m21:22:09.062712 [debug] [Thread-1  ]: Began compiling node model.northwind_dbt.dim_customers
[0m21:22:09.062712 [debug] [Thread-3  ]: Using snowflake connection "model.northwind_dbt.stg_products"
[0m21:22:09.062712 [info ] [Thread-2  ]: 8 of 13 START sql table model public.dim_employees ............................. [RUN]
[0m21:22:09.077904 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind_dbt.dim_customers"
[0m21:22:09.079483 [debug] [Thread-3  ]: On model.northwind_dbt.stg_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.stg_products"} */
create or replace   view Project_2.public.stg_products
  
   as (
    select * from PROJECT_2.PUBLIC.products
  );
[0m21:22:09.079483 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.northwind_dbt.stg_employees, now model.northwind_dbt.dim_employees)
[0m21:22:09.079483 [debug] [Thread-2  ]: Began compiling node model.northwind_dbt.dim_employees
[0m21:22:09.095704 [debug] [Thread-2  ]: Writing injected SQL for node "model.northwind_dbt.dim_employees"
[0m21:22:09.095704 [debug] [Thread-1  ]: Began executing node model.northwind_dbt.dim_customers
[0m21:22:09.128909 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind_dbt.dim_customers"
[0m21:22:09.137428 [debug] [Thread-2  ]: Began executing node model.northwind_dbt.dim_employees
[0m21:22:09.141828 [debug] [Thread-2  ]: Writing runtime sql for node "model.northwind_dbt.dim_employees"
[0m21:22:09.149629 [debug] [Thread-1  ]: Using snowflake connection "model.northwind_dbt.dim_customers"
[0m21:22:09.150635 [debug] [Thread-1  ]: On model.northwind_dbt.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.dim_customers"} */
create or replace transient table Project_2.public.dim_customers
         as
        (select * from Project_2.public.stg_customers
        );
[0m21:22:09.156667 [debug] [Thread-2  ]: Using snowflake connection "model.northwind_dbt.dim_employees"
[0m21:22:09.156667 [debug] [Thread-2  ]: On model.northwind_dbt.dim_employees: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.dim_employees"} */
create or replace transient table Project_2.public.dim_employees
         as
        (with source_data as (
    select * from Project_2.public.stg_employees
),
scd2 as (
    select 
        md5(cast(coalesce(cast(employee_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as employee_key,
        *,
        current_timestamp as dbt_updated_at
    from source_data
)
select * from scd2
        );
[0m21:22:09.654552 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.584 seconds
[0m21:22:09.654552 [debug] [Thread-4  ]: Using snowflake connection "model.northwind_dbt.fact_order_details"
[0m21:22:09.654552 [debug] [Thread-4  ]: On model.northwind_dbt.fact_order_details: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.fact_order_details"} */
describe table Project_2.public.fact_order_details__dbt_tmp
[0m21:22:09.731723 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.651 seconds
[0m21:22:09.731723 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bba6c366-abd5-4dc3-bd49-32ef41d87d57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000105697881F0>]}
[0m21:22:09.731723 [info ] [Thread-3  ]: 5 of 13 OK created sql view model public.stg_products .......................... [[32mSUCCESS 1[0m in 0.76s]
[0m21:22:09.740774 [debug] [Thread-3  ]: Finished running node model.northwind_dbt.stg_products
[0m21:22:09.742414 [debug] [Thread-3  ]: Began running node model.northwind_dbt.dim_products
[0m21:22:09.742414 [info ] [Thread-3  ]: 9 of 13 START sql table model public.dim_products .............................. [RUN]
[0m21:22:09.742414 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.northwind_dbt.stg_products, now model.northwind_dbt.dim_products)
[0m21:22:09.742414 [debug] [Thread-3  ]: Began compiling node model.northwind_dbt.dim_products
[0m21:22:09.742414 [debug] [Thread-3  ]: Writing injected SQL for node "model.northwind_dbt.dim_products"
[0m21:22:09.761223 [debug] [Thread-3  ]: Began executing node model.northwind_dbt.dim_products
[0m21:22:09.761223 [debug] [Thread-3  ]: Writing runtime sql for node "model.northwind_dbt.dim_products"
[0m21:22:09.777897 [debug] [Thread-3  ]: Using snowflake connection "model.northwind_dbt.dim_products"
[0m21:22:09.777897 [debug] [Thread-3  ]: On model.northwind_dbt.dim_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.dim_products"} */
create or replace transient table Project_2.public.dim_products
         as
        (select 
    p.product_id,
    p.product_name,
    p.supplier_id,
    s.company_name as supplier_name,
    p.category_id,
    c.category_name,
    p.quantity_per_unit,
    p.unit_price,
    p.units_in_stock,
    p.units_on_order,
    p.reorder_level,
    p.discontinued
from Project_2.public.stg_products p
left join PROJECT_2.PUBLIC.suppliers s on p.supplier_id = s.supplier_id
left join PROJECT_2.PUBLIC.categories c on p.category_id = c.category_id
        );
[0m21:22:09.811932 [debug] [Thread-4  ]: SQL status: SUCCESS 12 in 0.142 seconds
[0m21:22:09.813360 [debug] [Thread-4  ]: Using snowflake connection "model.northwind_dbt.fact_order_details"
[0m21:22:09.813360 [debug] [Thread-4  ]: On model.northwind_dbt.fact_order_details: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.fact_order_details"} */
describe table Project_2.public.fact_order_details
[0m21:22:10.052584 [debug] [Thread-4  ]: SQL status: SUCCESS 12 in 0.234 seconds
[0m21:22:10.052584 [debug] [Thread-4  ]: Using snowflake connection "model.northwind_dbt.fact_order_details"
[0m21:22:10.063307 [debug] [Thread-4  ]: On model.northwind_dbt.fact_order_details: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.fact_order_details"} */
describe table "PROJECT_2"."PUBLIC"."FACT_ORDER_DETAILS"
[0m21:22:10.131899 [debug] [Thread-4  ]: SQL status: SUCCESS 12 in 0.077 seconds
[0m21:22:10.167620 [debug] [Thread-4  ]: Writing runtime sql for node "model.northwind_dbt.fact_order_details"
[0m21:22:10.182717 [debug] [Thread-4  ]: Using snowflake connection "model.northwind_dbt.fact_order_details"
[0m21:22:10.182717 [debug] [Thread-4  ]: On model.northwind_dbt.fact_order_details: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.fact_order_details"} */
-- back compat for old kwarg name
  
  begin;
[0m21:22:10.341773 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.158 seconds
[0m21:22:10.341773 [debug] [Thread-4  ]: Using snowflake connection "model.northwind_dbt.fact_order_details"
[0m21:22:10.341773 [debug] [Thread-4  ]: On model.northwind_dbt.fact_order_details: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.fact_order_details"} */
merge into Project_2.public.fact_order_details as DBT_INTERNAL_DEST
        using Project_2.public.fact_order_details__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.order_id = DBT_INTERNAL_DEST.order_id
                ) and (
                    DBT_INTERNAL_SOURCE.product_id = DBT_INTERNAL_DEST.product_id
                )

    
    when matched then update set
        "ORDER_ID" = DBT_INTERNAL_SOURCE."ORDER_ID","PRODUCT_ID" = DBT_INTERNAL_SOURCE."PRODUCT_ID","CUSTOMER_ID" = DBT_INTERNAL_SOURCE."CUSTOMER_ID","EMPLOYEE_ID" = DBT_INTERNAL_SOURCE."EMPLOYEE_ID","SHIPPER_ID" = DBT_INTERNAL_SOURCE."SHIPPER_ID","ORDER_DATE" = DBT_INTERNAL_SOURCE."ORDER_DATE","TOTAL_REVENUE" = DBT_INTERNAL_SOURCE."TOTAL_REVENUE","AVG_REVENUE" = DBT_INTERNAL_SOURCE."AVG_REVENUE","MAX_REVENUE" = DBT_INTERNAL_SOURCE."MAX_REVENUE","MIN_REVENUE" = DBT_INTERNAL_SOURCE."MIN_REVENUE","LINE_COUNT" = DBT_INTERNAL_SOURCE."LINE_COUNT","REVENUE_RANK" = DBT_INTERNAL_SOURCE."REVENUE_RANK"
    

    when not matched then insert
        ("ORDER_ID", "PRODUCT_ID", "CUSTOMER_ID", "EMPLOYEE_ID", "SHIPPER_ID", "ORDER_DATE", "TOTAL_REVENUE", "AVG_REVENUE", "MAX_REVENUE", "MIN_REVENUE", "LINE_COUNT", "REVENUE_RANK")
    values
        ("ORDER_ID", "PRODUCT_ID", "CUSTOMER_ID", "EMPLOYEE_ID", "SHIPPER_ID", "ORDER_DATE", "TOTAL_REVENUE", "AVG_REVENUE", "MAX_REVENUE", "MIN_REVENUE", "LINE_COUNT", "REVENUE_RANK")

;
[0m21:22:10.530780 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.379 seconds
[0m21:22:10.531339 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bba6c366-abd5-4dc3-bd49-32ef41d87d57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000105693F6250>]}
[0m21:22:10.531339 [info ] [Thread-1  ]: 7 of 13 OK created sql table model public.dim_customers ........................ [[32mSUCCESS 1[0m in 1.47s]
[0m21:22:10.531339 [debug] [Thread-1  ]: Finished running node model.northwind_dbt.dim_customers
[0m21:22:10.743330 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.586 seconds
[0m21:22:10.745646 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bba6c366-abd5-4dc3-bd49-32ef41d87d57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010569400370>]}
[0m21:22:10.748218 [info ] [Thread-2  ]: 8 of 13 OK created sql table model public.dim_employees ........................ [[32mSUCCESS 1[0m in 1.67s]
[0m21:22:10.748218 [debug] [Thread-2  ]: Finished running node model.northwind_dbt.dim_employees
[0m21:22:11.354980 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1.579 seconds
[0m21:22:11.354980 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bba6c366-abd5-4dc3-bd49-32ef41d87d57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001056944E880>]}
[0m21:22:11.354980 [info ] [Thread-3  ]: 9 of 13 OK created sql table model public.dim_products ......................... [[32mSUCCESS 1[0m in 1.61s]
[0m21:22:11.368153 [debug] [Thread-3  ]: Finished running node model.northwind_dbt.dim_products
[0m21:22:11.982849 [debug] [Thread-4  ]: SQL status: SUCCESS 32 in 1.635 seconds
[0m21:22:11.984553 [debug] [Thread-4  ]: Using snowflake connection "model.northwind_dbt.fact_order_details"
[0m21:22:11.985155 [debug] [Thread-4  ]: On model.northwind_dbt.fact_order_details: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.fact_order_details"} */
COMMIT
[0m21:22:12.634182 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.658 seconds
[0m21:22:12.646609 [debug] [Thread-4  ]: Applying DROP to: Project_2.public.fact_order_details__dbt_tmp
[0m21:22:12.646609 [debug] [Thread-4  ]: Using snowflake connection "model.northwind_dbt.fact_order_details"
[0m21:22:12.646609 [debug] [Thread-4  ]: On model.northwind_dbt.fact_order_details: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.fact_order_details"} */
drop view if exists Project_2.public.fact_order_details__dbt_tmp cascade
[0m21:22:12.830362 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.170 seconds
[0m21:22:12.834641 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bba6c366-abd5-4dc3-bd49-32ef41d87d57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000105694F3790>]}
[0m21:22:12.834641 [info ] [Thread-4  ]: 6 of 13 OK created sql incremental model public.fact_order_details ............. [[32mSUCCESS 32[0m in 3.85s]
[0m21:22:12.834641 [debug] [Thread-4  ]: Finished running node model.northwind_dbt.fact_order_details
[0m21:22:12.834641 [debug] [Thread-1  ]: Began running node model.northwind_dbt.obt_orders
[0m21:22:12.834641 [debug] [Thread-2  ]: Began running node model.northwind_dbt.top_customer_revenue
[0m21:22:12.834641 [debug] [Thread-3  ]: Began running node model.northwind_dbt.top_employee_revenue
[0m21:22:12.834641 [debug] [Thread-4  ]: Began running node model.northwind_dbt.top_performing_products
[0m21:22:12.834641 [info ] [Thread-1  ]: 10 of 13 START sql table model public.obt_orders ............................... [RUN]
[0m21:22:12.834641 [info ] [Thread-2  ]: 11 of 13 START sql table model public.top_customer_revenue ..................... [RUN]
[0m21:22:12.844285 [info ] [Thread-3  ]: 12 of 13 START sql table model public.top_employee_revenue ..................... [RUN]
[0m21:22:12.844768 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.northwind_dbt.dim_customers, now model.northwind_dbt.obt_orders)
[0m21:22:12.844768 [info ] [Thread-4  ]: 13 of 13 START sql table model public.top_performing_products .................. [RUN]
[0m21:22:12.844768 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.northwind_dbt.dim_employees, now model.northwind_dbt.top_customer_revenue)
[0m21:22:12.844768 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.northwind_dbt.dim_products, now model.northwind_dbt.top_employee_revenue)
[0m21:22:12.844768 [debug] [Thread-1  ]: Began compiling node model.northwind_dbt.obt_orders
[0m21:22:12.844768 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.northwind_dbt.fact_order_details, now model.northwind_dbt.top_performing_products)
[0m21:22:12.844768 [debug] [Thread-2  ]: Began compiling node model.northwind_dbt.top_customer_revenue
[0m21:22:12.844768 [debug] [Thread-3  ]: Began compiling node model.northwind_dbt.top_employee_revenue
[0m21:22:12.844768 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind_dbt.obt_orders"
[0m21:22:12.844768 [debug] [Thread-4  ]: Began compiling node model.northwind_dbt.top_performing_products
[0m21:22:12.861201 [debug] [Thread-2  ]: Writing injected SQL for node "model.northwind_dbt.top_customer_revenue"
[0m21:22:12.866941 [debug] [Thread-3  ]: Writing injected SQL for node "model.northwind_dbt.top_employee_revenue"
[0m21:22:12.872383 [debug] [Thread-4  ]: Writing injected SQL for node "model.northwind_dbt.top_performing_products"
[0m21:22:12.885660 [debug] [Thread-2  ]: Began executing node model.northwind_dbt.top_customer_revenue
[0m21:22:12.885660 [debug] [Thread-4  ]: Began executing node model.northwind_dbt.top_performing_products
[0m21:22:12.885660 [debug] [Thread-3  ]: Began executing node model.northwind_dbt.top_employee_revenue
[0m21:22:12.885660 [debug] [Thread-1  ]: Began executing node model.northwind_dbt.obt_orders
[0m21:22:12.890444 [debug] [Thread-2  ]: Writing runtime sql for node "model.northwind_dbt.top_customer_revenue"
[0m21:22:12.890444 [debug] [Thread-4  ]: Writing runtime sql for node "model.northwind_dbt.top_performing_products"
[0m21:22:12.890444 [debug] [Thread-3  ]: Writing runtime sql for node "model.northwind_dbt.top_employee_revenue"
[0m21:22:12.901164 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind_dbt.obt_orders"
[0m21:22:12.901164 [debug] [Thread-4  ]: Using snowflake connection "model.northwind_dbt.top_performing_products"
[0m21:22:12.901164 [debug] [Thread-4  ]: On model.northwind_dbt.top_performing_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.top_performing_products"} */
create or replace transient table Project_2.public.top_performing_products
         as
        (

select
  p.product_id,
  p.product_name,
  sum(f.total_revenue) as total_revenue,
  count(distinct f.order_id) as number_of_orders
from Project_2.public.fact_order_details f
join Project_2.public.dim_products p on f.product_id = p.product_id
group by p.product_id, p.product_name
order by total_revenue desc
        );
[0m21:22:12.920124 [debug] [Thread-2  ]: Using snowflake connection "model.northwind_dbt.top_customer_revenue"
[0m21:22:12.920124 [debug] [Thread-1  ]: Using snowflake connection "model.northwind_dbt.obt_orders"
[0m21:22:12.920124 [debug] [Thread-3  ]: Using snowflake connection "model.northwind_dbt.top_employee_revenue"
[0m21:22:12.920124 [debug] [Thread-2  ]: On model.northwind_dbt.top_customer_revenue: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.top_customer_revenue"} */
create or replace transient table Project_2.public.top_customer_revenue
         as
        (

select
  c.customer_id,
  c.company_name as customer_name,
  sum(f.total_revenue) as total_revenue
from Project_2.public.fact_order_details f
join Project_2.public.dim_customers c using (customer_id)
group by c.customer_id, c.company_name
order by total_revenue desc
        );
[0m21:22:12.920124 [debug] [Thread-1  ]: On model.northwind_dbt.obt_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.obt_orders"} */
create or replace transient table Project_2.public.obt_orders
         as
        (select 
    f.order_id,
    f.product_id,
    f.customer_id,
    f.employee_id,
    f.shipper_id,
    f.order_date,
    f.total_revenue,
    f.avg_revenue,
    f.max_revenue,
    f.min_revenue,
    f.line_count,
    f.revenue_rank,

    c.company_name as customer_name,
    p.product_name,
    p.category_name,
    p.supplier_name,
    e.first_name || ' ' || e.last_name as employee_name,
    s.company_name as shipper_name

from Project_2.public.fact_order_details f
left join Project_2.public.dim_customers c on f.customer_id = c.customer_id
left join Project_2.public.dim_products p on f.product_id = p.product_id
left join Project_2.public.dim_employees e on f.employee_id = e.employee_id
left join PROJECT_2.PUBLIC.shippers s on f.shipper_id = s.shipper_id
        );
[0m21:22:12.920124 [debug] [Thread-3  ]: On model.northwind_dbt.top_employee_revenue: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.top_employee_revenue"} */
create or replace transient table Project_2.public.top_employee_revenue
         as
        (

select
  e.employee_key,
  e.first_name || ' ' || e.last_name as employee_name,
  sum(f.total_revenue) as total_revenue
from Project_2.public.fact_order_details f
join Project_2.public.dim_employees e on f.employee_id = e.employee_id
group by e.employee_key, employee_name
order by total_revenue desc
        );
[0m21:22:13.691358 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.777 seconds
[0m21:22:13.703807 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bba6c366-abd5-4dc3-bd49-32ef41d87d57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001056AF949A0>]}
[0m21:22:13.703807 [info ] [Thread-3  ]: 12 of 13 OK created sql table model public.top_employee_revenue ................ [[32mSUCCESS 1[0m in 0.86s]
[0m21:22:13.707506 [debug] [Thread-3  ]: Finished running node model.northwind_dbt.top_employee_revenue
[0m21:22:13.916648 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1.002 seconds
[0m21:22:13.920690 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bba6c366-abd5-4dc3-bd49-32ef41d87d57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001056B044D00>]}
[0m21:22:13.924939 [info ] [Thread-4  ]: 13 of 13 OK created sql table model public.top_performing_products ............. [[32mSUCCESS 1[0m in 1.08s]
[0m21:22:13.924939 [debug] [Thread-4  ]: Finished running node model.northwind_dbt.top_performing_products
[0m21:22:14.196810 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.274 seconds
[0m21:22:14.196810 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bba6c366-abd5-4dc3-bd49-32ef41d87d57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001056AFD17F0>]}
[0m21:22:14.196810 [info ] [Thread-1  ]: 10 of 13 OK created sql table model public.obt_orders .......................... [[32mSUCCESS 1[0m in 1.35s]
[0m21:22:14.196810 [debug] [Thread-1  ]: Finished running node model.northwind_dbt.obt_orders
[0m21:22:14.265821 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.341 seconds
[0m21:22:14.268840 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bba6c366-abd5-4dc3-bd49-32ef41d87d57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001056B02CFD0>]}
[0m21:22:14.268840 [info ] [Thread-2  ]: 11 of 13 OK created sql table model public.top_customer_revenue ................ [[32mSUCCESS 1[0m in 1.42s]
[0m21:22:14.268840 [debug] [Thread-2  ]: Finished running node model.northwind_dbt.top_customer_revenue
[0m21:22:14.268840 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:22:14.268840 [debug] [MainThread]: Connection 'list_Project_2' was left open.
[0m21:22:14.268840 [debug] [MainThread]: On list_Project_2: Close
[0m21:22:14.401626 [debug] [MainThread]: Connection 'list_Project_2_snapshots' was left open.
[0m21:22:14.401626 [debug] [MainThread]: On list_Project_2_snapshots: Close
[0m21:22:14.533614 [debug] [MainThread]: Connection 'list_Project_2_public' was left open.
[0m21:22:14.533614 [debug] [MainThread]: On list_Project_2_public: Close
[0m21:22:14.673124 [debug] [MainThread]: Connection 'model.northwind_dbt.obt_orders' was left open.
[0m21:22:14.673124 [debug] [MainThread]: On model.northwind_dbt.obt_orders: Close
[0m21:22:14.815422 [debug] [MainThread]: Connection 'model.northwind_dbt.top_customer_revenue' was left open.
[0m21:22:14.823744 [debug] [MainThread]: On model.northwind_dbt.top_customer_revenue: Close
[0m21:22:14.942928 [debug] [MainThread]: Connection 'model.northwind_dbt.top_employee_revenue' was left open.
[0m21:22:14.942928 [debug] [MainThread]: On model.northwind_dbt.top_employee_revenue: Close
[0m21:22:15.062044 [debug] [MainThread]: Connection 'model.northwind_dbt.top_performing_products' was left open.
[0m21:22:15.062044 [debug] [MainThread]: On model.northwind_dbt.top_performing_products: Close
[0m21:22:15.206143 [info ] [MainThread]: 
[0m21:22:15.211781 [info ] [MainThread]: Finished running 1 incremental model, 7 table models, 5 view models in 0 hours 0 minutes and 9.13 seconds (9.13s).
[0m21:22:15.215587 [debug] [MainThread]: Command end result
[0m21:22:15.379073 [debug] [MainThread]: Wrote artifact WritableManifest to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\manifest.json
[0m21:22:15.395675 [debug] [MainThread]: Wrote artifact SemanticManifest to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\semantic_manifest.json
[0m21:22:15.410741 [debug] [MainThread]: Wrote artifact RunExecutionResult to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\run_results.json
[0m21:22:15.410741 [info ] [MainThread]: 
[0m21:22:15.410741 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:22:15.410741 [info ] [MainThread]: 
[0m21:22:15.410741 [info ] [MainThread]: Done. PASS=13 WARN=0 ERROR=0 SKIP=0 TOTAL=13
[0m21:22:15.410741 [debug] [MainThread]: Command `dbt run` succeeded at 21:22:15.410741 after 12.43 seconds
[0m21:22:15.410741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001054E27F3A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010568E7E460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001056940FD00>]}
[0m21:22:15.421474 [debug] [MainThread]: Flushing usage events
[0m21:22:16.146100 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:16:59.754356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E90217F2E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9041F5BE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9041F59D0>]}


============================== 22:16:59.770494 | e23b7ef6-708a-421b-830b-dc26b4e351d4 ==============================
[0m22:16:59.770494 [info ] [MainThread]: Running with dbt=1.9.0
[0m22:16:59.770494 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'c:\\Users\\fitzp\\Documents\\Alpaca_Market\\zproject_2\\northwind_psql\\logs', 'fail_fast': 'False', 'profiles_dir': 'c:\\Users\\fitzp\\Documents\\Alpaca_Market\\zproject_2\\northwind_psql', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt docs generate', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:17:02.198684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e23b7ef6-708a-421b-830b-dc26b4e351d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9041D1CA0>]}
[0m22:17:02.251610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e23b7ef6-708a-421b-830b-dc26b4e351d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9024CDA60>]}
[0m22:17:02.251610 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m22:17:02.662324 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m22:17:03.359813 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:17:03.359813 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:17:03.359813 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.northwind_dbt.marts.bi
[0m22:17:03.435453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e23b7ef6-708a-421b-830b-dc26b4e351d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E91D2FC130>]}
[0m22:17:03.505789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e23b7ef6-708a-421b-830b-dc26b4e351d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E91CFD8940>]}
[0m22:17:03.506348 [info ] [MainThread]: Found 13 models, 1 snapshot, 16 data tests, 8 sources, 706 macros
[0m22:17:03.506348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e23b7ef6-708a-421b-830b-dc26b4e351d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E903B38280>]}
[0m22:17:03.508382 [info ] [MainThread]: 
[0m22:17:03.508382 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:17:03.508382 [info ] [MainThread]: 
[0m22:17:03.514731 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:17:03.521623 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_Project_2_snapshots'
[0m22:17:03.521623 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_Project_2_public'
[0m22:17:03.694893 [debug] [ThreadPool]: Using snowflake connection "list_Project_2_snapshots"
[0m22:17:03.694893 [debug] [ThreadPool]: Using snowflake connection "list_Project_2_public"
[0m22:17:03.694893 [debug] [ThreadPool]: On list_Project_2_snapshots: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "connection_name": "list_Project_2_snapshots"} */
show objects in Project_2.snapshots limit 10000;
[0m22:17:03.694893 [debug] [ThreadPool]: On list_Project_2_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "connection_name": "list_Project_2_public"} */
show objects in Project_2.public limit 10000;
[0m22:17:03.694893 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:17:03.705288 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:17:04.445540 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bbb229-020d-03e6-000c-83e7000c00aa
[0m22:17:04.447068 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m22:17:04.449241 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m22:17:04.451197 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m22:17:04.530214 [debug] [ThreadPool]: SQL status: SUCCESS 27 in 0.825 seconds
[0m22:17:04.547507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e23b7ef6-708a-421b-830b-dc26b4e351d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E903B38280>]}
[0m22:17:04.559787 [debug] [Thread-1  ]: Began running node model.northwind_dbt.stg_customers
[0m22:17:04.561529 [debug] [Thread-2  ]: Began running node model.northwind_dbt.stg_employees
[0m22:17:04.563069 [debug] [Thread-3  ]: Began running node model.northwind_dbt.stg_order_details
[0m22:17:04.564776 [debug] [Thread-4  ]: Began running node model.northwind_dbt.stg_orders
[0m22:17:04.567063 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.northwind_dbt.stg_customers'
[0m22:17:04.569878 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.northwind_dbt.stg_employees'
[0m22:17:04.572786 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.northwind_dbt.stg_order_details'
[0m22:17:04.575408 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.northwind_dbt.stg_orders'
[0m22:17:04.578284 [debug] [Thread-1  ]: Began compiling node model.northwind_dbt.stg_customers
[0m22:17:04.580215 [debug] [Thread-2  ]: Began compiling node model.northwind_dbt.stg_employees
[0m22:17:04.583739 [debug] [Thread-3  ]: Began compiling node model.northwind_dbt.stg_order_details
[0m22:17:04.585596 [debug] [Thread-4  ]: Began compiling node model.northwind_dbt.stg_orders
[0m22:17:04.600790 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind_dbt.stg_customers"
[0m22:17:04.603333 [debug] [Thread-2  ]: Writing injected SQL for node "model.northwind_dbt.stg_employees"
[0m22:17:04.613912 [debug] [Thread-3  ]: Writing injected SQL for node "model.northwind_dbt.stg_order_details"
[0m22:17:04.618875 [debug] [Thread-4  ]: Writing injected SQL for node "model.northwind_dbt.stg_orders"
[0m22:17:04.672745 [debug] [Thread-4  ]: Began executing node model.northwind_dbt.stg_orders
[0m22:17:04.674424 [debug] [Thread-4  ]: Finished running node model.northwind_dbt.stg_orders
[0m22:17:04.674967 [debug] [Thread-4  ]: Began running node model.northwind_dbt.stg_products
[0m22:17:04.676452 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.northwind_dbt.stg_orders, now model.northwind_dbt.stg_products)
[0m22:17:04.678000 [debug] [Thread-4  ]: Began compiling node model.northwind_dbt.stg_products
[0m22:17:04.683094 [debug] [Thread-4  ]: Writing injected SQL for node "model.northwind_dbt.stg_products"
[0m22:17:04.684235 [debug] [Thread-3  ]: Began executing node model.northwind_dbt.stg_order_details
[0m22:17:04.686763 [debug] [Thread-3  ]: Finished running node model.northwind_dbt.stg_order_details
[0m22:17:04.687741 [debug] [Thread-3  ]: Began running node model.northwind_dbt.fact_order_details
[0m22:17:04.688743 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.northwind_dbt.stg_order_details, now model.northwind_dbt.fact_order_details)
[0m22:17:04.689749 [debug] [Thread-3  ]: Began compiling node model.northwind_dbt.fact_order_details
[0m22:17:04.706077 [debug] [Thread-3  ]: Writing injected SQL for node "model.northwind_dbt.fact_order_details"
[0m22:17:04.717243 [debug] [Thread-4  ]: Began executing node model.northwind_dbt.stg_products
[0m22:17:04.720188 [debug] [Thread-4  ]: Finished running node model.northwind_dbt.stg_products
[0m22:17:04.722410 [debug] [Thread-3  ]: Began executing node model.northwind_dbt.fact_order_details
[0m22:17:04.723516 [debug] [Thread-4  ]: Began running node model.northwind_dbt.dim_products
[0m22:17:04.725313 [debug] [Thread-3  ]: Finished running node model.northwind_dbt.fact_order_details
[0m22:17:04.727606 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.northwind_dbt.stg_products, now model.northwind_dbt.dim_products)
[0m22:17:04.730452 [debug] [Thread-3  ]: Began running node test.northwind_dbt.not_null_fact_order_details_customer_id.6aaefe4888
[0m22:17:04.731468 [debug] [Thread-4  ]: Began compiling node model.northwind_dbt.dim_products
[0m22:17:04.733491 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.northwind_dbt.fact_order_details, now test.northwind_dbt.not_null_fact_order_details_customer_id.6aaefe4888)
[0m22:17:04.735136 [debug] [Thread-1  ]: Began executing node model.northwind_dbt.stg_customers
[0m22:17:04.736253 [debug] [Thread-2  ]: Began executing node model.northwind_dbt.stg_employees
[0m22:17:04.746245 [debug] [Thread-4  ]: Writing injected SQL for node "model.northwind_dbt.dim_products"
[0m22:17:04.747924 [debug] [Thread-3  ]: Began compiling node test.northwind_dbt.not_null_fact_order_details_customer_id.6aaefe4888
[0m22:17:04.751082 [debug] [Thread-1  ]: Finished running node model.northwind_dbt.stg_customers
[0m22:17:04.754392 [debug] [Thread-2  ]: Finished running node model.northwind_dbt.stg_employees
[0m22:17:04.782219 [debug] [Thread-3  ]: Writing injected SQL for node "test.northwind_dbt.not_null_fact_order_details_customer_id.6aaefe4888"
[0m22:17:04.783222 [debug] [Thread-1  ]: Began running node test.northwind_dbt.not_null_fact_order_details_order_id.8d47c14c82
[0m22:17:04.784928 [debug] [Thread-2  ]: Began running node test.northwind_dbt.not_null_fact_order_details_product_id.85713db7b9
[0m22:17:04.788205 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.northwind_dbt.stg_customers, now test.northwind_dbt.not_null_fact_order_details_order_id.8d47c14c82)
[0m22:17:04.789349 [debug] [Thread-4  ]: Began executing node model.northwind_dbt.dim_products
[0m22:17:04.790478 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.northwind_dbt.stg_employees, now test.northwind_dbt.not_null_fact_order_details_product_id.85713db7b9)
[0m22:17:04.792733 [debug] [Thread-1  ]: Began compiling node test.northwind_dbt.not_null_fact_order_details_order_id.8d47c14c82
[0m22:17:04.794292 [debug] [Thread-4  ]: Finished running node model.northwind_dbt.dim_products
[0m22:17:04.795454 [debug] [Thread-2  ]: Began compiling node test.northwind_dbt.not_null_fact_order_details_product_id.85713db7b9
[0m22:17:04.798230 [debug] [Thread-1  ]: Writing injected SQL for node "test.northwind_dbt.not_null_fact_order_details_order_id.8d47c14c82"
[0m22:17:04.798230 [debug] [Thread-3  ]: Began executing node test.northwind_dbt.not_null_fact_order_details_customer_id.6aaefe4888
[0m22:17:04.798230 [debug] [Thread-4  ]: Began running node model.northwind_dbt.dim_customers
[0m22:17:04.809147 [debug] [Thread-2  ]: Writing injected SQL for node "test.northwind_dbt.not_null_fact_order_details_product_id.85713db7b9"
[0m22:17:04.815699 [debug] [Thread-3  ]: Finished running node test.northwind_dbt.not_null_fact_order_details_customer_id.6aaefe4888
[0m22:17:04.815699 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.northwind_dbt.dim_products, now model.northwind_dbt.dim_customers)
[0m22:17:04.815699 [debug] [Thread-3  ]: Began running node model.northwind_dbt.dim_employees
[0m22:17:04.815699 [debug] [Thread-4  ]: Began compiling node model.northwind_dbt.dim_customers
[0m22:17:04.822320 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.northwind_dbt.not_null_fact_order_details_customer_id.6aaefe4888, now model.northwind_dbt.dim_employees)
[0m22:17:04.830600 [debug] [Thread-4  ]: Writing injected SQL for node "model.northwind_dbt.dim_customers"
[0m22:17:04.831689 [debug] [Thread-3  ]: Began compiling node model.northwind_dbt.dim_employees
[0m22:17:04.840835 [debug] [Thread-2  ]: Began executing node test.northwind_dbt.not_null_fact_order_details_product_id.85713db7b9
[0m22:17:04.841518 [debug] [Thread-1  ]: Began executing node test.northwind_dbt.not_null_fact_order_details_order_id.8d47c14c82
[0m22:17:04.857986 [debug] [Thread-3  ]: Writing injected SQL for node "model.northwind_dbt.dim_employees"
[0m22:17:04.860260 [debug] [Thread-2  ]: Finished running node test.northwind_dbt.not_null_fact_order_details_product_id.85713db7b9
[0m22:17:04.861929 [debug] [Thread-1  ]: Finished running node test.northwind_dbt.not_null_fact_order_details_order_id.8d47c14c82
[0m22:17:04.863771 [debug] [Thread-2  ]: Began running node snapshot.northwind_dbt.employees_snapshot
[0m22:17:04.864893 [debug] [Thread-4  ]: Began executing node model.northwind_dbt.dim_customers
[0m22:17:04.865555 [debug] [Thread-1  ]: Began running node model.northwind_dbt.top_performing_products
[0m22:17:04.866678 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.northwind_dbt.not_null_fact_order_details_product_id.85713db7b9, now snapshot.northwind_dbt.employees_snapshot)
[0m22:17:04.867813 [debug] [Thread-4  ]: Finished running node model.northwind_dbt.dim_customers
[0m22:17:04.867813 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.northwind_dbt.not_null_fact_order_details_order_id.8d47c14c82, now model.northwind_dbt.top_performing_products)
[0m22:17:04.867813 [debug] [Thread-2  ]: Began compiling node snapshot.northwind_dbt.employees_snapshot
[0m22:17:04.867813 [debug] [Thread-4  ]: Began running node test.northwind_dbt.not_null_dim_products_product_id.c8aba288d1
[0m22:17:04.872272 [debug] [Thread-1  ]: Began compiling node model.northwind_dbt.top_performing_products
[0m22:17:04.876363 [debug] [Thread-2  ]: Began executing node snapshot.northwind_dbt.employees_snapshot
[0m22:17:04.878379 [debug] [Thread-3  ]: Began executing node model.northwind_dbt.dim_employees
[0m22:17:04.878379 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.northwind_dbt.dim_customers, now test.northwind_dbt.not_null_dim_products_product_id.c8aba288d1)
[0m22:17:04.878379 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind_dbt.top_performing_products"
[0m22:17:04.888096 [debug] [Thread-2  ]: Finished running node snapshot.northwind_dbt.employees_snapshot
[0m22:17:04.888682 [debug] [Thread-3  ]: Finished running node model.northwind_dbt.dim_employees
[0m22:17:04.888682 [debug] [Thread-4  ]: Began compiling node test.northwind_dbt.not_null_dim_products_product_id.c8aba288d1
[0m22:17:04.888682 [debug] [Thread-2  ]: Began running node test.northwind_dbt.unique_dim_products_product_id.ef7b2a9985
[0m22:17:04.888682 [debug] [Thread-3  ]: Began running node model.northwind_dbt.top_customer_revenue
[0m22:17:04.888682 [debug] [Thread-4  ]: Writing injected SQL for node "test.northwind_dbt.not_null_dim_products_product_id.c8aba288d1"
[0m22:17:04.888682 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly snapshot.northwind_dbt.employees_snapshot, now test.northwind_dbt.unique_dim_products_product_id.ef7b2a9985)
[0m22:17:04.888682 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.northwind_dbt.dim_employees, now model.northwind_dbt.top_customer_revenue)
[0m22:17:04.903956 [debug] [Thread-1  ]: Began executing node model.northwind_dbt.top_performing_products
[0m22:17:04.903956 [debug] [Thread-2  ]: Began compiling node test.northwind_dbt.unique_dim_products_product_id.ef7b2a9985
[0m22:17:04.903956 [debug] [Thread-3  ]: Began compiling node model.northwind_dbt.top_customer_revenue
[0m22:17:04.903956 [debug] [Thread-1  ]: Finished running node model.northwind_dbt.top_performing_products
[0m22:17:04.911348 [debug] [Thread-2  ]: Writing injected SQL for node "test.northwind_dbt.unique_dim_products_product_id.ef7b2a9985"
[0m22:17:04.923115 [debug] [Thread-3  ]: Writing injected SQL for node "model.northwind_dbt.top_customer_revenue"
[0m22:17:04.923115 [debug] [Thread-4  ]: Began executing node test.northwind_dbt.not_null_dim_products_product_id.c8aba288d1
[0m22:17:04.923115 [debug] [Thread-1  ]: Began running node test.northwind_dbt.not_null_dim_customers_customer_id.dd91cd1c8d
[0m22:17:04.923115 [debug] [Thread-4  ]: Finished running node test.northwind_dbt.not_null_dim_products_product_id.c8aba288d1
[0m22:17:04.923115 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.northwind_dbt.top_performing_products, now test.northwind_dbt.not_null_dim_customers_customer_id.dd91cd1c8d)
[0m22:17:04.923115 [debug] [Thread-4  ]: Began running node test.northwind_dbt.unique_dim_customers_customer_id.15c9f1e2fd
[0m22:17:04.923115 [debug] [Thread-1  ]: Began compiling node test.northwind_dbt.not_null_dim_customers_customer_id.dd91cd1c8d
[0m22:17:04.932169 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.northwind_dbt.not_null_dim_products_product_id.c8aba288d1, now test.northwind_dbt.unique_dim_customers_customer_id.15c9f1e2fd)
[0m22:17:04.936375 [debug] [Thread-1  ]: Writing injected SQL for node "test.northwind_dbt.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m22:17:04.936375 [debug] [Thread-4  ]: Began compiling node test.northwind_dbt.unique_dim_customers_customer_id.15c9f1e2fd
[0m22:17:04.936375 [debug] [Thread-4  ]: Writing injected SQL for node "test.northwind_dbt.unique_dim_customers_customer_id.15c9f1e2fd"
[0m22:17:04.936375 [debug] [Thread-2  ]: Began executing node test.northwind_dbt.unique_dim_products_product_id.ef7b2a9985
[0m22:17:04.936375 [debug] [Thread-3  ]: Began executing node model.northwind_dbt.top_customer_revenue
[0m22:17:04.952541 [debug] [Thread-2  ]: Finished running node test.northwind_dbt.unique_dim_products_product_id.ef7b2a9985
[0m22:17:04.953620 [debug] [Thread-3  ]: Finished running node model.northwind_dbt.top_customer_revenue
[0m22:17:04.955288 [debug] [Thread-2  ]: Began running node model.northwind_dbt.obt_orders
[0m22:17:04.956450 [debug] [Thread-3  ]: Began running node model.northwind_dbt.top_employee_revenue
[0m22:17:04.957767 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.northwind_dbt.unique_dim_products_product_id.ef7b2a9985, now model.northwind_dbt.obt_orders)
[0m22:17:04.959399 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.northwind_dbt.top_customer_revenue, now model.northwind_dbt.top_employee_revenue)
[0m22:17:04.961157 [debug] [Thread-2  ]: Began compiling node model.northwind_dbt.obt_orders
[0m22:17:04.962793 [debug] [Thread-3  ]: Began compiling node model.northwind_dbt.top_employee_revenue
[0m22:17:04.967560 [debug] [Thread-2  ]: Writing injected SQL for node "model.northwind_dbt.obt_orders"
[0m22:17:04.967560 [debug] [Thread-3  ]: Writing injected SQL for node "model.northwind_dbt.top_employee_revenue"
[0m22:17:05.031148 [debug] [Thread-1  ]: Began executing node test.northwind_dbt.not_null_dim_customers_customer_id.dd91cd1c8d
[0m22:17:05.031148 [debug] [Thread-4  ]: Began executing node test.northwind_dbt.unique_dim_customers_customer_id.15c9f1e2fd
[0m22:17:05.031148 [debug] [Thread-3  ]: Began executing node model.northwind_dbt.top_employee_revenue
[0m22:17:05.031148 [debug] [Thread-2  ]: Began executing node model.northwind_dbt.obt_orders
[0m22:17:05.031148 [debug] [Thread-1  ]: Finished running node test.northwind_dbt.not_null_dim_customers_customer_id.dd91cd1c8d
[0m22:17:05.031148 [debug] [Thread-4  ]: Finished running node test.northwind_dbt.unique_dim_customers_customer_id.15c9f1e2fd
[0m22:17:05.031148 [debug] [Thread-3  ]: Finished running node model.northwind_dbt.top_employee_revenue
[0m22:17:05.031148 [debug] [Thread-2  ]: Finished running node model.northwind_dbt.obt_orders
[0m22:17:05.031148 [debug] [Thread-1  ]: Began running node test.northwind_dbt.not_null_dim_employees_employee_key.232a183ffe
[0m22:17:05.031148 [debug] [Thread-4  ]: Began running node test.northwind_dbt.unique_dim_employees_employee_key.3824d24782
[0m22:17:05.031148 [debug] [Thread-3  ]: Began running node test.northwind_dbt.not_null_top_performing_products_product_id.919a185ac6
[0m22:17:05.031148 [debug] [Thread-2  ]: Began running node test.northwind_dbt.not_null_top_customer_revenue_customer_id.668bb5e112
[0m22:17:05.031148 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.northwind_dbt.not_null_dim_customers_customer_id.dd91cd1c8d, now test.northwind_dbt.not_null_dim_employees_employee_key.232a183ffe)
[0m22:17:05.031148 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.northwind_dbt.unique_dim_customers_customer_id.15c9f1e2fd, now test.northwind_dbt.unique_dim_employees_employee_key.3824d24782)
[0m22:17:05.046827 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.northwind_dbt.top_employee_revenue, now test.northwind_dbt.not_null_top_performing_products_product_id.919a185ac6)
[0m22:17:05.046827 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.northwind_dbt.obt_orders, now test.northwind_dbt.not_null_top_customer_revenue_customer_id.668bb5e112)
[0m22:17:05.046827 [debug] [Thread-1  ]: Began compiling node test.northwind_dbt.not_null_dim_employees_employee_key.232a183ffe
[0m22:17:05.046827 [debug] [Thread-4  ]: Began compiling node test.northwind_dbt.unique_dim_employees_employee_key.3824d24782
[0m22:17:05.046827 [debug] [Thread-3  ]: Began compiling node test.northwind_dbt.not_null_top_performing_products_product_id.919a185ac6
[0m22:17:05.046827 [debug] [Thread-2  ]: Began compiling node test.northwind_dbt.not_null_top_customer_revenue_customer_id.668bb5e112
[0m22:17:05.054818 [debug] [Thread-1  ]: Writing injected SQL for node "test.northwind_dbt.not_null_dim_employees_employee_key.232a183ffe"
[0m22:17:05.062894 [debug] [Thread-4  ]: Writing injected SQL for node "test.northwind_dbt.unique_dim_employees_employee_key.3824d24782"
[0m22:17:05.062894 [debug] [Thread-3  ]: Writing injected SQL for node "test.northwind_dbt.not_null_top_performing_products_product_id.919a185ac6"
[0m22:17:05.062894 [debug] [Thread-2  ]: Writing injected SQL for node "test.northwind_dbt.not_null_top_customer_revenue_customer_id.668bb5e112"
[0m22:17:05.095788 [debug] [Thread-1  ]: Began executing node test.northwind_dbt.not_null_dim_employees_employee_key.232a183ffe
[0m22:17:05.095788 [debug] [Thread-4  ]: Began executing node test.northwind_dbt.unique_dim_employees_employee_key.3824d24782
[0m22:17:05.095788 [debug] [Thread-2  ]: Began executing node test.northwind_dbt.not_null_top_customer_revenue_customer_id.668bb5e112
[0m22:17:05.095788 [debug] [Thread-3  ]: Began executing node test.northwind_dbt.not_null_top_performing_products_product_id.919a185ac6
[0m22:17:05.095788 [debug] [Thread-1  ]: Finished running node test.northwind_dbt.not_null_dim_employees_employee_key.232a183ffe
[0m22:17:05.095788 [debug] [Thread-4  ]: Finished running node test.northwind_dbt.unique_dim_employees_employee_key.3824d24782
[0m22:17:05.095788 [debug] [Thread-2  ]: Finished running node test.northwind_dbt.not_null_top_customer_revenue_customer_id.668bb5e112
[0m22:17:05.095788 [debug] [Thread-3  ]: Finished running node test.northwind_dbt.not_null_top_performing_products_product_id.919a185ac6
[0m22:17:05.095788 [debug] [Thread-1  ]: Began running node test.northwind_dbt.not_null_top_employee_revenue_employee_key.cb63db6526
[0m22:17:05.095788 [debug] [Thread-4  ]: Began running node test.northwind_dbt.not_null_obt_orders_customer_id.1e3c4ae465
[0m22:17:05.095788 [debug] [Thread-2  ]: Began running node test.northwind_dbt.not_null_obt_orders_order_date.5632203db3
[0m22:17:05.095788 [debug] [Thread-3  ]: Began running node test.northwind_dbt.not_null_obt_orders_order_id.218f605f9c
[0m22:17:05.095788 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.northwind_dbt.not_null_dim_employees_employee_key.232a183ffe, now test.northwind_dbt.not_null_top_employee_revenue_employee_key.cb63db6526)
[0m22:17:05.110831 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.northwind_dbt.unique_dim_employees_employee_key.3824d24782, now test.northwind_dbt.not_null_obt_orders_customer_id.1e3c4ae465)
[0m22:17:05.110831 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.northwind_dbt.not_null_top_customer_revenue_customer_id.668bb5e112, now test.northwind_dbt.not_null_obt_orders_order_date.5632203db3)
[0m22:17:05.110831 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.northwind_dbt.not_null_top_performing_products_product_id.919a185ac6, now test.northwind_dbt.not_null_obt_orders_order_id.218f605f9c)
[0m22:17:05.110831 [debug] [Thread-1  ]: Began compiling node test.northwind_dbt.not_null_top_employee_revenue_employee_key.cb63db6526
[0m22:17:05.110831 [debug] [Thread-4  ]: Began compiling node test.northwind_dbt.not_null_obt_orders_customer_id.1e3c4ae465
[0m22:17:05.110831 [debug] [Thread-2  ]: Began compiling node test.northwind_dbt.not_null_obt_orders_order_date.5632203db3
[0m22:17:05.110831 [debug] [Thread-3  ]: Began compiling node test.northwind_dbt.not_null_obt_orders_order_id.218f605f9c
[0m22:17:05.123557 [debug] [Thread-1  ]: Writing injected SQL for node "test.northwind_dbt.not_null_top_employee_revenue_employee_key.cb63db6526"
[0m22:17:05.127651 [debug] [Thread-4  ]: Writing injected SQL for node "test.northwind_dbt.not_null_obt_orders_customer_id.1e3c4ae465"
[0m22:17:05.127651 [debug] [Thread-2  ]: Writing injected SQL for node "test.northwind_dbt.not_null_obt_orders_order_date.5632203db3"
[0m22:17:05.136958 [debug] [Thread-3  ]: Writing injected SQL for node "test.northwind_dbt.not_null_obt_orders_order_id.218f605f9c"
[0m22:17:05.159754 [debug] [Thread-1  ]: Began executing node test.northwind_dbt.not_null_top_employee_revenue_employee_key.cb63db6526
[0m22:17:05.159754 [debug] [Thread-2  ]: Began executing node test.northwind_dbt.not_null_obt_orders_order_date.5632203db3
[0m22:17:05.159754 [debug] [Thread-4  ]: Began executing node test.northwind_dbt.not_null_obt_orders_customer_id.1e3c4ae465
[0m22:17:05.159754 [debug] [Thread-3  ]: Began executing node test.northwind_dbt.not_null_obt_orders_order_id.218f605f9c
[0m22:17:05.159754 [debug] [Thread-1  ]: Finished running node test.northwind_dbt.not_null_top_employee_revenue_employee_key.cb63db6526
[0m22:17:05.159754 [debug] [Thread-2  ]: Finished running node test.northwind_dbt.not_null_obt_orders_order_date.5632203db3
[0m22:17:05.159754 [debug] [Thread-4  ]: Finished running node test.northwind_dbt.not_null_obt_orders_customer_id.1e3c4ae465
[0m22:17:05.159754 [debug] [Thread-3  ]: Finished running node test.northwind_dbt.not_null_obt_orders_order_id.218f605f9c
[0m22:17:05.159754 [debug] [Thread-1  ]: Began running node test.northwind_dbt.not_null_obt_orders_product_id.caa3082c7f
[0m22:17:05.175057 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.northwind_dbt.not_null_top_employee_revenue_employee_key.cb63db6526, now test.northwind_dbt.not_null_obt_orders_product_id.caa3082c7f)
[0m22:17:05.175057 [debug] [Thread-1  ]: Began compiling node test.northwind_dbt.not_null_obt_orders_product_id.caa3082c7f
[0m22:17:05.175057 [debug] [Thread-1  ]: Writing injected SQL for node "test.northwind_dbt.not_null_obt_orders_product_id.caa3082c7f"
[0m22:17:05.191105 [debug] [Thread-1  ]: Began executing node test.northwind_dbt.not_null_obt_orders_product_id.caa3082c7f
[0m22:17:05.195702 [debug] [Thread-1  ]: Finished running node test.northwind_dbt.not_null_obt_orders_product_id.caa3082c7f
[0m22:17:05.195702 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:17:05.195702 [debug] [MainThread]: Connection 'list_Project_2_snapshots' was left open.
[0m22:17:05.195702 [debug] [MainThread]: On list_Project_2_snapshots: Close
[0m22:17:05.336860 [debug] [MainThread]: Connection 'list_Project_2_public' was left open.
[0m22:17:05.336860 [debug] [MainThread]: On list_Project_2_public: Close
[0m22:17:05.486131 [debug] [MainThread]: Connection 'test.northwind_dbt.not_null_obt_orders_product_id.caa3082c7f' was properly closed.
[0m22:17:05.486131 [debug] [MainThread]: Connection 'test.northwind_dbt.not_null_obt_orders_order_date.5632203db3' was properly closed.
[0m22:17:05.486131 [debug] [MainThread]: Connection 'test.northwind_dbt.not_null_obt_orders_order_id.218f605f9c' was properly closed.
[0m22:17:05.486131 [debug] [MainThread]: Connection 'test.northwind_dbt.not_null_obt_orders_customer_id.1e3c4ae465' was properly closed.
[0m22:17:05.492841 [debug] [MainThread]: Command end result
[0m22:17:05.744700 [debug] [MainThread]: Wrote artifact WritableManifest to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\manifest.json
[0m22:17:05.751039 [debug] [MainThread]: Wrote artifact SemanticManifest to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\semantic_manifest.json
[0m22:17:05.773434 [debug] [MainThread]: Wrote artifact RunExecutionResult to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\run_results.json
[0m22:17:06.556601 [debug] [MainThread]: Acquiring new snowflake connection 'generate_catalog'
[0m22:17:06.557156 [info ] [MainThread]: Building catalog
[0m22:17:06.571112 [debug] [ThreadPool]: Acquiring new snowflake connection 'Project_2.information_schema'
[0m22:17:06.573137 [debug] [ThreadPool]: Acquiring new snowflake connection 'PROJECT_2.information_schema'
[0m22:17:06.597055 [debug] [ThreadPool]: Using snowflake connection "Project_2.information_schema"
[0m22:17:06.605069 [debug] [ThreadPool]: Using snowflake connection "PROJECT_2.information_schema"
[0m22:17:06.606069 [debug] [ThreadPool]: On Project_2.information_schema: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "connection_name": "Project_2.information_schema"} */
with tables as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",
        case
            when is_dynamic = 'YES' and table_type = 'BASE TABLE' THEN 'DYNAMIC TABLE'
            else table_type
        end as "table_type",
        comment as "table_comment",

        -- note: this is the _role_ that owns the table
        table_owner as "table_owner",

        'Clustering Key' as "stats:clustering_key:label",
        clustering_key as "stats:clustering_key:value",
        'The key used to cluster this table' as "stats:clustering_key:description",
        (clustering_key is not null) as "stats:clustering_key:include",

        'Row Count' as "stats:row_count:label",
        row_count as "stats:row_count:value",
        'An approximate count of rows in this table' as "stats:row_count:description",
        (row_count is not null) as "stats:row_count:include",

        'Approximate Size' as "stats:bytes:label",
        bytes as "stats:bytes:value",
        'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
        (bytes is not null) as "stats:bytes:include",

        'Last Modified' as "stats:last_modified:label",
        to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
        'The timestamp for last update/change' as "stats:last_modified:description",
        (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"
    from Project_2.INFORMATION_SCHEMA.tables
            where (
                (
                    
    "table_schema" ilike 'public' and upper("table_schema") = upper('public')

                    and 
    "table_name" ilike 'stg_customers' and upper("table_name") = upper('stg_customers')

                )
             or 
                (
                    
    "table_schema" ilike 'public' and upper("table_schema") = upper('public')

                    and 
    "table_name" ilike 'dim_products' and upper("table_name") = upper('dim_products')

                )
             or 
                (
                    
    "table_schema" ilike 'public' and upper("table_schema") = upper('public')

                    and 
    "table_name" ilike 'fact_order_details' and upper("table_name") = upper('fact_order_details')

                )
             or 
                (
                    
    "table_schema" ilike 'snapshots' and upper("table_schema") = upper('snapshots')

                    and 
    "table_name" ilike 'employees_snapshot' and upper("table_name") = upper('employees_snapshot')

                )
             or 
                (
                    
    "table_schema" ilike 'public' and upper("table_schema") = upper('public')

                    and 
    "table_name" ilike 'stg_employees' and upper("table_name") = upper('stg_employees')

                )
             or 
                (
                    
    "table_schema" ilike 'public' and upper("table_schema") = upper('public')

                    and 
    "table_name" ilike 'stg_products' and upper("table_name") = upper('stg_products')

                )
             or 
                (
                    
    "table_schema" ilike 'public' and upper("table_schema") = upper('public')

                    and 
    "table_name" ilike 'dim_employees' and upper("table_name") = upper('dim_employees')

                )
             or 
                (
                    
    "table_schema" ilike 'public' and upper("table_schema") = upper('public')

                    and 
    "table_name" ilike 'stg_order_details' and upper("table_name") = upper('stg_order_details')

                )
             or 
                (
                    
    "table_schema" ilike 'public' and upper("table_schema") = upper('public')

                    and 
    "table_name" ilike 'top_employee_revenue' and upper("table_name") = upper('top_employee_revenue')

                )
             or 
                (
                    
    "table_schema" ilike 'public' and upper("table_schema") = upper('public')

                    and 
    "table_name" ilike 'obt_orders' and upper("table_name") = upper('obt_orders')

                )
             or 
                (
                    
    "table_schema" ilike 'public' and upper("table_schema") = upper('public')

                    and 
    "table_name" ilike 'top_performing_products' and upper("table_name") = upper('top_performing_products')

                )
             or 
                (
                    
    "table_schema" ilike 'public' and upper("table_schema") = upper('public')

                    and 
    "table_name" ilike 'stg_orders' and upper("table_name") = upper('stg_orders')

                )
             or 
                (
                    
    "table_schema" ilike 'public' and upper("table_schema") = upper('public')

                    and 
    "table_name" ilike 'dim_customers' and upper("table_name") = upper('dim_customers')

                )
             or 
                (
                    
    "table_schema" ilike 'public' and upper("table_schema") = upper('public')

                    and 
    "table_name" ilike 'top_customer_revenue' and upper("table_name") = upper('top_customer_revenue')

                )
            )
        ),
        columns as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",

        column_name as "column_name",
        ordinal_position as "column_index",
        data_type as "column_type",
        comment as "column_comment"
    from Project_2.INFORMATION_SCHEMA.columns
            where (
                (
                    
    "table_schema" ilike 'public' and upper("table_schema") = upper('public')

                    and 
    "table_name" ilike 'stg_customers' and upper("table_name") = upper('stg_customers')

                )
             or 
                (
                    
    "table_schema" ilike 'public' and upper("table_schema") = upper('public')

                    and 
    "table_name" ilike 'dim_products' and upper("table_name") = upper('dim_products')

                )
             or 
                (
                    
    "table_schema" ilike 'public' and upper("table_schema") = upper('public')

                    and 
    "table_name" ilike 'fact_order_details' and upper("table_name") = upper('fact_order_details')

                )
             or 
                (
                    
    "table_schema" ilike 'snapshots' and upper("table_schema") = upper('snapshots')

                    and 
    "table_name" ilike 'employees_snapshot' and upper("table_name") = upper('employees_snapshot')

                )
             or 
                (
                    
    "table_schema" ilike 'public' and upper("table_schema") = upper('public')

                    and 
    "table_name" ilike 'stg_employees' and upper("table_name") = upper('stg_employees')

                )
             or 
                (
                    
    "table_schema" ilike 'public' and upper("table_schema") = upper('public')

                    and 
    "table_name" ilike 'stg_products' and upper("table_name") = upper('stg_products')

                )
             or 
                (
                    
    "table_schema" ilike 'public' and upper("table_schema") = upper('public')

                    and 
    "table_name" ilike 'dim_employees' and upper("table_name") = upper('dim_employees')

                )
             or 
                (
                    
    "table_schema" ilike 'public' and upper("table_schema") = upper('public')

                    and 
    "table_name" ilike 'stg_order_details' and upper("table_name") = upper('stg_order_details')

                )
             or 
                (
                    
    "table_schema" ilike 'public' and upper("table_schema") = upper('public')

                    and 
    "table_name" ilike 'top_employee_revenue' and upper("table_name") = upper('top_employee_revenue')

                )
             or 
                (
                    
    "table_schema" ilike 'public' and upper("table_schema") = upper('public')

                    and 
    "table_name" ilike 'obt_orders' and upper("table_name") = upper('obt_orders')

                )
             or 
                (
                    
    "table_schema" ilike 'public' and upper("table_schema") = upper('public')

                    and 
    "table_name" ilike 'top_performing_products' and upper("table_name") = upper('top_performing_products')

                )
             or 
                (
                    
    "table_schema" ilike 'public' and upper("table_schema") = upper('public')

                    and 
    "table_name" ilike 'stg_orders' and upper("table_name") = upper('stg_orders')

                )
             or 
                (
                    
    "table_schema" ilike 'public' and upper("table_schema") = upper('public')

                    and 
    "table_name" ilike 'dim_customers' and upper("table_name") = upper('dim_customers')

                )
             or 
                (
                    
    "table_schema" ilike 'public' and upper("table_schema") = upper('public')

                    and 
    "table_name" ilike 'top_customer_revenue' and upper("table_name") = upper('top_customer_revenue')

                )
            )
        )
        select *
    from tables
    join columns using ("table_database", "table_schema", "table_name")
    order by "column_index"
[0m22:17:06.607068 [debug] [ThreadPool]: On PROJECT_2.information_schema: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "connection_name": "PROJECT_2.information_schema"} */
with tables as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",
        case
            when is_dynamic = 'YES' and table_type = 'BASE TABLE' THEN 'DYNAMIC TABLE'
            else table_type
        end as "table_type",
        comment as "table_comment",

        -- note: this is the _role_ that owns the table
        table_owner as "table_owner",

        'Clustering Key' as "stats:clustering_key:label",
        clustering_key as "stats:clustering_key:value",
        'The key used to cluster this table' as "stats:clustering_key:description",
        (clustering_key is not null) as "stats:clustering_key:include",

        'Row Count' as "stats:row_count:label",
        row_count as "stats:row_count:value",
        'An approximate count of rows in this table' as "stats:row_count:description",
        (row_count is not null) as "stats:row_count:include",

        'Approximate Size' as "stats:bytes:label",
        bytes as "stats:bytes:value",
        'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
        (bytes is not null) as "stats:bytes:include",

        'Last Modified' as "stats:last_modified:label",
        to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
        'The timestamp for last update/change' as "stats:last_modified:description",
        (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"
    from PROJECT_2.INFORMATION_SCHEMA.tables
            where (
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'products' and upper("table_name") = upper('products')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'categories' and upper("table_name") = upper('categories')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'customers' and upper("table_name") = upper('customers')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'employees' and upper("table_name") = upper('employees')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'shippers' and upper("table_name") = upper('shippers')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'orders' and upper("table_name") = upper('orders')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'suppliers' and upper("table_name") = upper('suppliers')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'order_details' and upper("table_name") = upper('order_details')

                )
            )
        ),
        columns as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",

        column_name as "column_name",
        ordinal_position as "column_index",
        data_type as "column_type",
        comment as "column_comment"
    from PROJECT_2.INFORMATION_SCHEMA.columns
            where (
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'products' and upper("table_name") = upper('products')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'categories' and upper("table_name") = upper('categories')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'customers' and upper("table_name") = upper('customers')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'employees' and upper("table_name") = upper('employees')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'shippers' and upper("table_name") = upper('shippers')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'orders' and upper("table_name") = upper('orders')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'suppliers' and upper("table_name") = upper('suppliers')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'order_details' and upper("table_name") = upper('order_details')

                )
            )
        )
        select *
    from tables
    join columns using ("table_database", "table_schema", "table_name")
    order by "column_index"
[0m22:17:06.608067 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:17:06.610071 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:17:10.437169 [debug] [ThreadPool]: SQL status: SUCCESS 109 in 3.827 seconds
[0m22:17:12.076395 [debug] [ThreadPool]: SQL status: SUCCESS 169 in 5.468 seconds
[0m22:17:13.595849 [debug] [MainThread]: Wrote artifact CatalogArtifact to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\catalog.json
[0m22:17:13.818457 [debug] [MainThread]: Wrote artifact WritableManifest to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\manifest.json
[0m22:17:13.823130 [debug] [MainThread]: Wrote artifact SemanticManifest to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\semantic_manifest.json
[0m22:17:13.823130 [info ] [MainThread]: Catalog written to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\catalog.json
[0m22:17:13.834332 [debug] [MainThread]: Command `dbt docs generate` succeeded at 22:17:13.834332 after 14.17 seconds
[0m22:17:13.834332 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m22:17:13.834332 [debug] [MainThread]: Connection 'Project_2.information_schema' was left open.
[0m22:17:13.834332 [debug] [MainThread]: On Project_2.information_schema: Close
[0m22:17:14.052124 [debug] [MainThread]: Connection 'PROJECT_2.information_schema' was left open.
[0m22:17:14.054132 [debug] [MainThread]: On PROJECT_2.information_schema: Close
[0m22:17:14.246969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E90217F2E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E91DAE1820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E91DABA790>]}
[0m22:17:14.246969 [debug] [MainThread]: Flushing usage events
[0m22:17:16.357306 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:17:22.751257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014CCA31F340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014CCC350100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014CCB7170D0>]}


============================== 22:17:22.761828 | 7fa35c0c-3137-45ac-9dc5-ae73a5c68b5b ==============================
[0m22:17:22.761828 [info ] [MainThread]: Running with dbt=1.9.0
[0m22:17:22.762460 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'c:\\Users\\fitzp\\Documents\\Alpaca_Market\\zproject_2\\northwind_psql\\logs', 'debug': 'False', 'profiles_dir': 'c:\\Users\\fitzp\\Documents\\Alpaca_Market\\zproject_2\\northwind_psql', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt docs serve', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:17:23.728513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7fa35c0c-3137-45ac-9dc5-ae73a5c68b5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014CC9307850>]}
[0m22:17:23.792394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7fa35c0c-3137-45ac-9dc5-ae73a5c68b5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014CCBCD6940>]}
[0m06:06:03.505623 [error] [MainThread]: Encountered an error:

[0m06:06:03.582538 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\fitzp\anaconda3\envs\bootcamp\lib\site-packages\dbt\cli\requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
  File "C:\Users\fitzp\anaconda3\envs\bootcamp\lib\site-packages\dbt\cli\requires.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\fitzp\anaconda3\envs\bootcamp\lib\site-packages\dbt\cli\requires.py", line 235, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\fitzp\anaconda3\envs\bootcamp\lib\site-packages\dbt\cli\requires.py", line 264, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\fitzp\anaconda3\envs\bootcamp\lib\site-packages\dbt\cli\requires.py", line 311, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\fitzp\anaconda3\envs\bootcamp\lib\site-packages\dbt\cli\main.py", line 301, in docs_serve
    results = task.run()
  File "C:\Users\fitzp\anaconda3\envs\bootcamp\lib\site-packages\dbt\task\docs\serve.py", line 29, in run
    httpd.serve_forever()
  File "C:\Users\fitzp\anaconda3\envs\bootcamp\lib\socketserver.py", line 232, in serve_forever
    ready = selector.select(poll_interval)
  File "C:\Users\fitzp\anaconda3\envs\bootcamp\lib\selectors.py", line 324, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
  File "C:\Users\fitzp\anaconda3\envs\bootcamp\lib\selectors.py", line 315, in _select
    r, w, x = select.select(r, w, w, timeout)
KeyboardInterrupt

[0m06:06:03.605266 [debug] [MainThread]: Command `dbt docs serve` failed at 06:06:03.604256 after 28120.96 seconds
[0m06:06:03.617014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014CCA31F340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014CE502DAC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014CE502D730>]}
[0m06:06:03.626603 [debug] [MainThread]: Flushing usage events
[0m06:06:05.297976 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:06:15.781121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025DB7CDF370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025DB9D4DBB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025DB9D4D9A0>]}


============================== 06:06:15.788163 | 67d3235e-b4b7-43af-abf0-b4ba2650ca6a ==============================
[0m06:06:15.788163 [info ] [MainThread]: Running with dbt=1.9.0
[0m06:06:15.789172 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'c:\\Users\\fitzp\\Documents\\Alpaca_Market\\zproject_2\\northwind_psql\\logs', 'profiles_dir': 'c:\\Users\\fitzp\\Documents\\Alpaca_Market\\zproject_2\\northwind_psql', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt docs serve', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:06:18.148375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '67d3235e-b4b7-43af-abf0-b4ba2650ca6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025DB6CC7550>]}
[0m06:06:18.222400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '67d3235e-b4b7-43af-abf0-b4ba2650ca6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025DB9BA84F0>]}
[0m14:04:45.740563 [error] [MainThread]: Encountered an error:

[0m14:04:45.807725 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\fitzp\anaconda3\envs\bootcamp\lib\site-packages\dbt\cli\requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
  File "C:\Users\fitzp\anaconda3\envs\bootcamp\lib\site-packages\dbt\cli\requires.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\fitzp\anaconda3\envs\bootcamp\lib\site-packages\dbt\cli\requires.py", line 235, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\fitzp\anaconda3\envs\bootcamp\lib\site-packages\dbt\cli\requires.py", line 264, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\fitzp\anaconda3\envs\bootcamp\lib\site-packages\dbt\cli\requires.py", line 311, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\fitzp\anaconda3\envs\bootcamp\lib\site-packages\dbt\cli\main.py", line 301, in docs_serve
    results = task.run()
  File "C:\Users\fitzp\anaconda3\envs\bootcamp\lib\site-packages\dbt\task\docs\serve.py", line 29, in run
    httpd.serve_forever()
  File "C:\Users\fitzp\anaconda3\envs\bootcamp\lib\socketserver.py", line 232, in serve_forever
    ready = selector.select(poll_interval)
  File "C:\Users\fitzp\anaconda3\envs\bootcamp\lib\selectors.py", line 324, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
  File "C:\Users\fitzp\anaconda3\envs\bootcamp\lib\selectors.py", line 315, in _select
    r, w, x = select.select(r, w, w, timeout)
KeyboardInterrupt

[0m14:04:45.835855 [debug] [MainThread]: Command `dbt docs serve` failed at 14:04:45.834855 after 28710.19 seconds
[0m14:04:45.844834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025DB7CDF370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025DD29E4AF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025DD29E4760>]}
[0m14:04:45.851816 [debug] [MainThread]: Flushing usage events
[0m14:04:47.452635 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:05:00.568827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029F6734F310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029F693C3AF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029F693C38E0>]}


============================== 14:05:00.568827 | 771aac8b-181d-4860-be4d-d29a29822bea ==============================
[0m14:05:00.568827 [info ] [MainThread]: Running with dbt=1.9.0
[0m14:05:00.568827 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'c:\\Users\\fitzp\\Documents\\Alpaca_Market\\zproject_2\\northwind_psql\\logs', 'profiles_dir': 'c:\\Users\\fitzp\\Documents\\Alpaca_Market\\zproject_2\\northwind_psql', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:00.580302 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'SNOWFLAKE_USERNAME'
[0m14:05:00.581810 [debug] [MainThread]: Command `dbt run` failed at 14:05:00.581810 after 0.10 seconds
[0m14:05:00.582140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029F6734F310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029F68D49700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029F69218520>]}
[0m14:05:00.583152 [debug] [MainThread]: Flushing usage events
[0m14:05:01.228798 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:07:49.178275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFB516F340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFB71E3C40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFB71E3A30>]}


============================== 14:07:49.178275 | 8fff3c27-12a0-4eef-80ae-f3d26c4e7c32 ==============================
[0m14:07:49.178275 [info ] [MainThread]: Running with dbt=1.9.0
[0m14:07:49.194886 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'c:\\Users\\fitzp\\Documents\\Alpaca_Market\\zproject_2\\northwind_psql', 'log_path': 'c:\\Users\\fitzp\\Documents\\Alpaca_Market\\zproject_2\\northwind_psql\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m14:07:49.196115 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'SNOWFLAKE_USER'
[0m14:07:49.204083 [debug] [MainThread]: Command `dbt run` failed at 14:07:49.204083 after 0.13 seconds
[0m14:07:49.206121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFB516F340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFB71629D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFB718B370>]}
[0m14:07:49.206121 [debug] [MainThread]: Flushing usage events
[0m14:07:49.912415 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:09:06.067482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D286D2F3A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D288DA3B20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D288DA3910>]}


============================== 14:09:06.071249 | e8deb12a-5658-42c7-9cf8-81f2b16fbf31 ==============================
[0m14:09:06.071249 [info ] [MainThread]: Running with dbt=1.9.0
[0m14:09:06.071249 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'c:\\Users\\fitzp\\Documents\\Alpaca_Market\\zproject_2\\northwind_psql', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'c:\\Users\\fitzp\\Documents\\Alpaca_Market\\zproject_2\\northwind_psql\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m14:09:06.071249 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'SNOWFLAKE_USERNAME'
[0m14:09:06.083333 [debug] [MainThread]: Command `dbt run` failed at 14:09:06.082864 after 0.12 seconds
[0m14:09:06.084282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D286D2F3A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D288BE1A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D288D22BE0>]}
[0m14:09:06.084282 [debug] [MainThread]: Flushing usage events
[0m14:09:07.143352 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:12:45.131416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF186BF430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF1A745D00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF1A745AF0>]}


============================== 14:12:45.131416 | 63bcfc3c-0b10-4710-9df6-fc3fecf1cf98 ==============================
[0m14:12:45.131416 [info ] [MainThread]: Running with dbt=1.9.0
[0m14:12:45.136293 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'c:\\Users\\fitzp\\Documents\\Alpaca_Market\\zproject_2\\northwind_psql', 'debug': 'False', 'version_check': 'True', 'log_path': 'c:\\Users\\fitzp\\Documents\\Alpaca_Market\\zproject_2\\northwind_psql\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m14:12:47.099630 [error] [MainThread]: Encountered an error:
Runtime Error
  Credentials in profile "northwind_profile", target "dev" invalid: 'account' is a required property
[0m14:12:47.108605 [debug] [MainThread]: Command `dbt run` failed at 14:12:47.108091 after 2.06 seconds
[0m14:12:47.111182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF186BF430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF331CE6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF331B8AC0>]}
[0m14:12:47.112117 [debug] [MainThread]: Flushing usage events
[0m14:12:47.958914 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:13:56.380264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027146390400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027148405BB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000271484059A0>]}


============================== 14:13:56.380264 | 0dee34f4-7d47-4bde-a9b1-a94702012ff0 ==============================
[0m14:13:56.380264 [info ] [MainThread]: Running with dbt=1.9.0
[0m14:13:56.380264 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'c:\\Users\\fitzp\\Documents\\Alpaca_Market\\zproject_2\\northwind_psql', 'log_path': 'c:\\Users\\fitzp\\Documents\\Alpaca_Market\\zproject_2\\northwind_psql\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:13:58.000446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0dee34f4-7d47-4bde-a9b1-a94702012ff0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000271453779A0>]}
[0m14:13:58.080354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0dee34f4-7d47-4bde-a9b1-a94702012ff0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027160EF1E80>]}
[0m14:13:58.080354 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m14:13:58.509866 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m14:13:58.709352 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m14:13:58.715009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0dee34f4-7d47-4bde-a9b1-a94702012ff0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027161241F70>]}
[0m14:14:00.877640 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.northwind_dbt.marts.bi
[0m14:14:00.889056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0dee34f4-7d47-4bde-a9b1-a94702012ff0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002716139A430>]}
[0m14:14:01.190148 [debug] [MainThread]: Wrote artifact WritableManifest to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\manifest.json
[0m14:14:01.190148 [debug] [MainThread]: Wrote artifact SemanticManifest to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\semantic_manifest.json
[0m14:14:01.273569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0dee34f4-7d47-4bde-a9b1-a94702012ff0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002716131AE50>]}
[0m14:14:01.273569 [info ] [MainThread]: Found 13 models, 1 snapshot, 16 data tests, 8 sources, 706 macros
[0m14:14:01.273569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0dee34f4-7d47-4bde-a9b1-a94702012ff0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002716188C760>]}
[0m14:14:01.280138 [info ] [MainThread]: 
[0m14:14:01.283839 [info ] [MainThread]: Concurrency: 12 threads (target='dev')
[0m14:14:01.288841 [info ] [MainThread]: 
[0m14:14:01.292066 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:14:01.302385 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_2'
[0m14:14:01.479409 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_2"
[0m14:14:01.479409 [debug] [ThreadPool]: On list_PROJECT_2: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "connection_name": "list_PROJECT_2"} */
show terse schemas in database PROJECT_2
    limit 10000
[0m14:14:01.479409 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:14:02.504156 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.016 seconds
[0m14:14:02.504156 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_2_PUBLIC'
[0m14:14:02.517744 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_2_PUBLIC"
[0m14:14:02.517744 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_2_snapshots'
[0m14:14:02.517744 [debug] [ThreadPool]: On list_PROJECT_2_PUBLIC: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "connection_name": "list_PROJECT_2_PUBLIC"} */
show objects in PROJECT_2.PUBLIC limit 10000;
[0m14:14:02.520751 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_2_snapshots"
[0m14:14:02.520751 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:14:02.520751 [debug] [ThreadPool]: On list_PROJECT_2_snapshots: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "connection_name": "list_PROJECT_2_snapshots"} */
show objects in PROJECT_2.snapshots limit 10000;
[0m14:14:02.520751 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:14:03.181354 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bbb5e6-020d-0bb1-000c-83e7000c3006
[0m14:14:03.181354 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m14:14:03.181354 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m14:14:03.181354 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m14:14:03.538880 [debug] [ThreadPool]: SQL status: SUCCESS 27 in 1.025 seconds
[0m14:14:03.550516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0dee34f4-7d47-4bde-a9b1-a94702012ff0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027160F15880>]}
[0m14:14:03.554856 [debug] [Thread-1  ]: Began running node model.northwind_dbt.stg_customers
[0m14:14:03.554856 [debug] [Thread-2  ]: Began running node model.northwind_dbt.stg_employees
[0m14:14:03.554856 [debug] [Thread-3  ]: Began running node model.northwind_dbt.stg_order_details
[0m14:14:03.554856 [debug] [Thread-4  ]: Began running node model.northwind_dbt.stg_orders
[0m14:14:03.554856 [debug] [Thread-5  ]: Began running node model.northwind_dbt.stg_products
[0m14:14:03.554856 [info ] [Thread-1  ]: 1 of 13 START sql view model PUBLIC.stg_customers .............................. [RUN]
[0m14:14:03.554856 [info ] [Thread-2  ]: 2 of 13 START sql view model PUBLIC.stg_employees .............................. [RUN]
[0m14:14:03.554856 [info ] [Thread-3  ]: 3 of 13 START sql view model PUBLIC.stg_order_details .......................... [RUN]
[0m14:14:03.554856 [info ] [Thread-4  ]: 4 of 13 START sql view model PUBLIC.stg_orders ................................. [RUN]
[0m14:14:03.554856 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.northwind_dbt.stg_customers'
[0m14:14:03.554856 [info ] [Thread-5  ]: 5 of 13 START sql view model PUBLIC.stg_products ............................... [RUN]
[0m14:14:03.554856 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.northwind_dbt.stg_employees'
[0m14:14:03.554856 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.northwind_dbt.stg_order_details'
[0m14:14:03.554856 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.northwind_dbt.stg_orders'
[0m14:14:03.554856 [debug] [Thread-1  ]: Began compiling node model.northwind_dbt.stg_customers
[0m14:14:03.570526 [debug] [Thread-5  ]: Acquiring new snowflake connection 'model.northwind_dbt.stg_products'
[0m14:14:03.573144 [debug] [Thread-2  ]: Began compiling node model.northwind_dbt.stg_employees
[0m14:14:03.574435 [debug] [Thread-3  ]: Began compiling node model.northwind_dbt.stg_order_details
[0m14:14:03.575966 [debug] [Thread-4  ]: Began compiling node model.northwind_dbt.stg_orders
[0m14:14:03.584627 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind_dbt.stg_customers"
[0m14:14:03.584627 [debug] [Thread-5  ]: Began compiling node model.northwind_dbt.stg_products
[0m14:14:03.589860 [debug] [Thread-2  ]: Writing injected SQL for node "model.northwind_dbt.stg_employees"
[0m14:14:03.594525 [debug] [Thread-3  ]: Writing injected SQL for node "model.northwind_dbt.stg_order_details"
[0m14:14:03.594525 [debug] [Thread-4  ]: Writing injected SQL for node "model.northwind_dbt.stg_orders"
[0m14:14:03.594525 [debug] [Thread-5  ]: Writing injected SQL for node "model.northwind_dbt.stg_products"
[0m14:14:03.669904 [debug] [Thread-2  ]: Began executing node model.northwind_dbt.stg_employees
[0m14:14:03.672822 [debug] [Thread-1  ]: Began executing node model.northwind_dbt.stg_customers
[0m14:14:03.701529 [debug] [Thread-3  ]: Began executing node model.northwind_dbt.stg_order_details
[0m14:14:03.701529 [debug] [Thread-2  ]: Writing runtime sql for node "model.northwind_dbt.stg_employees"
[0m14:14:03.701529 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind_dbt.stg_customers"
[0m14:14:03.701529 [debug] [Thread-3  ]: Writing runtime sql for node "model.northwind_dbt.stg_order_details"
[0m14:14:03.717625 [debug] [Thread-5  ]: Began executing node model.northwind_dbt.stg_products
[0m14:14:03.721925 [debug] [Thread-5  ]: Writing runtime sql for node "model.northwind_dbt.stg_products"
[0m14:14:03.721925 [debug] [Thread-4  ]: Began executing node model.northwind_dbt.stg_orders
[0m14:14:03.721925 [debug] [Thread-4  ]: Writing runtime sql for node "model.northwind_dbt.stg_orders"
[0m14:14:03.750299 [debug] [Thread-2  ]: Using snowflake connection "model.northwind_dbt.stg_employees"
[0m14:14:03.753825 [debug] [Thread-1  ]: Using snowflake connection "model.northwind_dbt.stg_customers"
[0m14:14:03.753825 [debug] [Thread-2  ]: On model.northwind_dbt.stg_employees: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.stg_employees"} */
create or replace   view PROJECT_2.PUBLIC.stg_employees
  
   as (
    select * from PROJECT_2.PUBLIC.employees
  );
[0m14:14:03.753825 [debug] [Thread-1  ]: On model.northwind_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.stg_customers"} */
create or replace   view PROJECT_2.PUBLIC.stg_customers
  
   as (
    select * from PROJECT_2.PUBLIC.customers
  );
[0m14:14:03.753825 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m14:14:03.753825 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m14:14:03.753825 [debug] [Thread-3  ]: Using snowflake connection "model.northwind_dbt.stg_order_details"
[0m14:14:03.753825 [debug] [Thread-4  ]: Using snowflake connection "model.northwind_dbt.stg_orders"
[0m14:14:03.765211 [debug] [Thread-5  ]: Using snowflake connection "model.northwind_dbt.stg_products"
[0m14:14:03.765211 [debug] [Thread-3  ]: On model.northwind_dbt.stg_order_details: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.stg_order_details"} */
create or replace   view PROJECT_2.PUBLIC.stg_order_details
  
   as (
    select * from PROJECT_2.PUBLIC.order_details
  );
[0m14:14:03.765211 [debug] [Thread-4  ]: On model.northwind_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.stg_orders"} */
create or replace   view PROJECT_2.PUBLIC.stg_orders
  
   as (
    select * from PROJECT_2.PUBLIC.orders
  );
[0m14:14:03.765211 [debug] [Thread-5  ]: On model.northwind_dbt.stg_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.stg_products"} */
create or replace   view PROJECT_2.PUBLIC.stg_products
  
   as (
    select * from PROJECT_2.PUBLIC.products
  );
[0m14:14:03.776306 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m14:14:03.776306 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m14:14:03.776306 [debug] [Thread-5  ]: Opening a new connection, currently in state init
[0m14:14:04.829910 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1.055 seconds
[0m14:14:04.845824 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.094 seconds
[0m14:14:04.858193 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0dee34f4-7d47-4bde-a9b1-a94702012ff0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027162FA7FD0>]}
[0m14:14:04.858193 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0dee34f4-7d47-4bde-a9b1-a94702012ff0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027146716940>]}
[0m14:14:04.858193 [info ] [Thread-4  ]: 4 of 13 OK created sql view model PUBLIC.stg_orders ............................ [[32mSUCCESS 1[0m in 1.29s]
[0m14:14:04.861867 [debug] [Thread-4  ]: Finished running node model.northwind_dbt.stg_orders
[0m14:14:04.858193 [info ] [Thread-1  ]: 1 of 13 OK created sql view model PUBLIC.stg_customers ......................... [[32mSUCCESS 1[0m in 1.30s]
[0m14:14:04.861867 [debug] [Thread-1  ]: Finished running node model.northwind_dbt.stg_customers
[0m14:14:04.861867 [debug] [Thread-7  ]: Began running node model.northwind_dbt.dim_customers
[0m14:14:04.861867 [info ] [Thread-7  ]: 6 of 13 START sql table model PUBLIC.dim_customers ............................. [RUN]
[0m14:14:04.861867 [debug] [Thread-7  ]: Acquiring new snowflake connection 'model.northwind_dbt.dim_customers'
[0m14:14:04.861867 [debug] [Thread-7  ]: Began compiling node model.northwind_dbt.dim_customers
[0m14:14:04.872368 [debug] [Thread-7  ]: Writing injected SQL for node "model.northwind_dbt.dim_customers"
[0m14:14:04.877961 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1.103 seconds
[0m14:14:04.879987 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0dee34f4-7d47-4bde-a9b1-a94702012ff0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002716314BFD0>]}
[0m14:14:04.879987 [info ] [Thread-3  ]: 3 of 13 OK created sql view model PUBLIC.stg_order_details ..................... [[32mSUCCESS 1[0m in 1.33s]
[0m14:14:04.879987 [debug] [Thread-3  ]: Finished running node model.northwind_dbt.stg_order_details
[0m14:14:04.888798 [debug] [Thread-5  ]: SQL status: SUCCESS 1 in 1.110 seconds
[0m14:14:04.890112 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.132 seconds
[0m14:14:04.890112 [debug] [Thread-9  ]: Began running node model.northwind_dbt.fact_order_details
[0m14:14:04.890112 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0dee34f4-7d47-4bde-a9b1-a94702012ff0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000271631ED580>]}
[0m14:14:04.890112 [debug] [Thread-7  ]: Began executing node model.northwind_dbt.dim_customers
[0m14:14:04.899485 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0dee34f4-7d47-4bde-a9b1-a94702012ff0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027163121C70>]}
[0m14:14:04.899485 [info ] [Thread-9  ]: 7 of 13 START sql incremental model PUBLIC.fact_order_details .................. [RUN]
[0m14:14:04.899485 [info ] [Thread-5  ]: 5 of 13 OK created sql view model PUBLIC.stg_products .......................... [[32mSUCCESS 1[0m in 1.32s]
[0m14:14:04.926722 [debug] [Thread-7  ]: Writing runtime sql for node "model.northwind_dbt.dim_customers"
[0m14:14:04.926722 [info ] [Thread-2  ]: 2 of 13 OK created sql view model PUBLIC.stg_employees ......................... [[32mSUCCESS 1[0m in 1.34s]
[0m14:14:04.926722 [debug] [Thread-9  ]: Acquiring new snowflake connection 'model.northwind_dbt.fact_order_details'
[0m14:14:04.926722 [debug] [Thread-5  ]: Finished running node model.northwind_dbt.stg_products
[0m14:14:04.932989 [debug] [Thread-2  ]: Finished running node model.northwind_dbt.stg_employees
[0m14:14:04.932989 [debug] [Thread-9  ]: Began compiling node model.northwind_dbt.fact_order_details
[0m14:14:04.932989 [debug] [Thread-11 ]: Began running node model.northwind_dbt.dim_products
[0m14:14:04.932989 [debug] [Thread-6  ]: Began running node model.northwind_dbt.dim_employees
[0m14:14:04.940465 [debug] [Thread-9  ]: Writing injected SQL for node "model.northwind_dbt.fact_order_details"
[0m14:14:04.940465 [info ] [Thread-11 ]: 8 of 13 START sql table model PUBLIC.dim_products .............................. [RUN]
[0m14:14:04.949165 [info ] [Thread-6  ]: 9 of 13 START sql table model PUBLIC.dim_employees ............................. [RUN]
[0m14:14:04.949165 [debug] [Thread-7  ]: Using snowflake connection "model.northwind_dbt.dim_customers"
[0m14:14:04.952252 [debug] [Thread-11 ]: Acquiring new snowflake connection 'model.northwind_dbt.dim_products'
[0m14:14:04.954264 [debug] [Thread-6  ]: Acquiring new snowflake connection 'model.northwind_dbt.dim_employees'
[0m14:14:04.955750 [debug] [Thread-7  ]: On model.northwind_dbt.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.dim_customers"} */
create or replace transient table PROJECT_2.PUBLIC.dim_customers
         as
        (select * from PROJECT_2.PUBLIC.stg_customers
        );
[0m14:14:04.957601 [debug] [Thread-11 ]: Began compiling node model.northwind_dbt.dim_products
[0m14:14:04.957601 [debug] [Thread-6  ]: Began compiling node model.northwind_dbt.dim_employees
[0m14:14:04.957601 [debug] [Thread-7  ]: Opening a new connection, currently in state init
[0m14:14:04.968224 [debug] [Thread-11 ]: Writing injected SQL for node "model.northwind_dbt.dim_products"
[0m14:14:04.968224 [debug] [Thread-9  ]: Began executing node model.northwind_dbt.fact_order_details
[0m14:14:05.055664 [debug] [Thread-6  ]: Writing injected SQL for node "model.northwind_dbt.dim_employees"
[0m14:14:05.089045 [debug] [Thread-9  ]: Using snowflake connection "model.northwind_dbt.fact_order_details"
[0m14:14:05.089045 [debug] [Thread-9  ]: On model.northwind_dbt.fact_order_details: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.fact_order_details"} */
create or replace  temporary view PROJECT_2.PUBLIC.fact_order_details__dbt_tmp
  
   as (
    

with base as (
    select 
        od.order_id,
        od.product_id,
        o.customer_id,
        o.employee_id,
        o.ship_via as shipper_id,
        o.order_date,
        od.unit_price,
        od.quantity,
        od.discount,
        od.unit_price * od.quantity * (1 - od.discount) as revenue
    from PROJECT_2.PUBLIC.stg_order_details od
    join PROJECT_2.PUBLIC.stg_orders o on od.order_id = o.order_id
    
        and o.order_date >= (select max(order_date) from PROJECT_2.PUBLIC.fact_order_details)
    
),
aggregated as (
    select 
        order_id,
        product_id,
        customer_id,
        employee_id,
        shipper_id,
        cast(order_date as date) as order_date,
        sum(revenue) as total_revenue,
        avg(revenue) as avg_revenue,
        max(revenue) as max_revenue,
        min(revenue) as min_revenue,
        count(*) as line_count,
        rank() over (partition by customer_id order by sum(revenue) desc) as revenue_rank
    from base
    group by order_id, product_id, customer_id, employee_id, shipper_id, order_date
)
select * from aggregated
  );
[0m14:14:05.103177 [debug] [Thread-9  ]: Opening a new connection, currently in state init
[0m14:14:05.104857 [debug] [Thread-11 ]: Began executing node model.northwind_dbt.dim_products
[0m14:14:05.112276 [debug] [Thread-11 ]: Writing runtime sql for node "model.northwind_dbt.dim_products"
[0m14:14:05.112276 [debug] [Thread-6  ]: Began executing node model.northwind_dbt.dim_employees
[0m14:14:05.118326 [debug] [Thread-6  ]: Writing runtime sql for node "model.northwind_dbt.dim_employees"
[0m14:14:05.118326 [debug] [Thread-11 ]: Using snowflake connection "model.northwind_dbt.dim_products"
[0m14:14:05.125092 [debug] [Thread-11 ]: On model.northwind_dbt.dim_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.dim_products"} */
create or replace transient table PROJECT_2.PUBLIC.dim_products
         as
        (select 
    p.product_id,
    p.product_name,
    p.supplier_id,
    s.company_name as supplier_name,
    p.category_id,
    c.category_name,
    p.quantity_per_unit,
    p.unit_price,
    p.units_in_stock,
    p.units_on_order,
    p.reorder_level,
    p.discontinued
from PROJECT_2.PUBLIC.stg_products p
left join PROJECT_2.PUBLIC.suppliers s on p.supplier_id = s.supplier_id
left join PROJECT_2.PUBLIC.categories c on p.category_id = c.category_id
        );
[0m14:14:05.125092 [debug] [Thread-11 ]: Opening a new connection, currently in state init
[0m14:14:05.125092 [debug] [Thread-6  ]: Using snowflake connection "model.northwind_dbt.dim_employees"
[0m14:14:05.133541 [debug] [Thread-6  ]: On model.northwind_dbt.dim_employees: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.dim_employees"} */
create or replace transient table PROJECT_2.PUBLIC.dim_employees
         as
        (with source_data as (
    select * from PROJECT_2.PUBLIC.stg_employees
),
scd2 as (
    select 
        md5(cast(coalesce(cast(employee_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as employee_key,
        *,
        current_timestamp as dbt_updated_at
    from source_data
)
select * from scd2
        );
[0m14:14:05.133541 [debug] [Thread-6  ]: Opening a new connection, currently in state init
[0m14:14:05.992255 [debug] [Thread-9  ]: SQL status: SUCCESS 1 in 0.891 seconds
[0m14:14:06.000537 [debug] [Thread-9  ]: Using snowflake connection "model.northwind_dbt.fact_order_details"
[0m14:14:06.002539 [debug] [Thread-9  ]: On model.northwind_dbt.fact_order_details: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.fact_order_details"} */
describe table PROJECT_2.PUBLIC.fact_order_details__dbt_tmp
[0m14:14:06.118698 [debug] [Thread-9  ]: SQL status: SUCCESS 12 in 0.117 seconds
[0m14:14:06.118698 [debug] [Thread-9  ]: Using snowflake connection "model.northwind_dbt.fact_order_details"
[0m14:14:06.127214 [debug] [Thread-9  ]: On model.northwind_dbt.fact_order_details: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.fact_order_details"} */
describe table PROJECT_2.PUBLIC.fact_order_details
[0m14:14:06.213078 [debug] [Thread-9  ]: SQL status: SUCCESS 12 in 0.099 seconds
[0m14:14:06.233016 [debug] [Thread-9  ]: Using snowflake connection "model.northwind_dbt.fact_order_details"
[0m14:14:06.235026 [debug] [Thread-9  ]: On model.northwind_dbt.fact_order_details: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.fact_order_details"} */
describe table "PROJECT_2"."PUBLIC"."FACT_ORDER_DETAILS"
[0m14:14:06.430026 [debug] [Thread-9  ]: SQL status: SUCCESS 12 in 0.196 seconds
[0m14:14:06.459943 [debug] [Thread-9  ]: Writing runtime sql for node "model.northwind_dbt.fact_order_details"
[0m14:14:06.461692 [debug] [Thread-9  ]: Using snowflake connection "model.northwind_dbt.fact_order_details"
[0m14:14:06.461692 [debug] [Thread-9  ]: On model.northwind_dbt.fact_order_details: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.fact_order_details"} */
-- back compat for old kwarg name
  
  begin;
[0m14:14:06.649275 [debug] [Thread-9  ]: SQL status: SUCCESS 1 in 0.173 seconds
[0m14:14:06.650373 [debug] [Thread-9  ]: Using snowflake connection "model.northwind_dbt.fact_order_details"
[0m14:14:06.651549 [debug] [Thread-9  ]: On model.northwind_dbt.fact_order_details: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.fact_order_details"} */
merge into PROJECT_2.PUBLIC.fact_order_details as DBT_INTERNAL_DEST
        using PROJECT_2.PUBLIC.fact_order_details__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.order_id = DBT_INTERNAL_DEST.order_id
                ) and (
                    DBT_INTERNAL_SOURCE.product_id = DBT_INTERNAL_DEST.product_id
                )

    
    when matched then update set
        "ORDER_ID" = DBT_INTERNAL_SOURCE."ORDER_ID","PRODUCT_ID" = DBT_INTERNAL_SOURCE."PRODUCT_ID","CUSTOMER_ID" = DBT_INTERNAL_SOURCE."CUSTOMER_ID","EMPLOYEE_ID" = DBT_INTERNAL_SOURCE."EMPLOYEE_ID","SHIPPER_ID" = DBT_INTERNAL_SOURCE."SHIPPER_ID","ORDER_DATE" = DBT_INTERNAL_SOURCE."ORDER_DATE","TOTAL_REVENUE" = DBT_INTERNAL_SOURCE."TOTAL_REVENUE","AVG_REVENUE" = DBT_INTERNAL_SOURCE."AVG_REVENUE","MAX_REVENUE" = DBT_INTERNAL_SOURCE."MAX_REVENUE","MIN_REVENUE" = DBT_INTERNAL_SOURCE."MIN_REVENUE","LINE_COUNT" = DBT_INTERNAL_SOURCE."LINE_COUNT","REVENUE_RANK" = DBT_INTERNAL_SOURCE."REVENUE_RANK"
    

    when not matched then insert
        ("ORDER_ID", "PRODUCT_ID", "CUSTOMER_ID", "EMPLOYEE_ID", "SHIPPER_ID", "ORDER_DATE", "TOTAL_REVENUE", "AVG_REVENUE", "MAX_REVENUE", "MIN_REVENUE", "LINE_COUNT", "REVENUE_RANK")
    values
        ("ORDER_ID", "PRODUCT_ID", "CUSTOMER_ID", "EMPLOYEE_ID", "SHIPPER_ID", "ORDER_DATE", "TOTAL_REVENUE", "AVG_REVENUE", "MAX_REVENUE", "MIN_REVENUE", "LINE_COUNT", "REVENUE_RANK")

;
[0m14:14:07.505723 [debug] [Thread-11 ]: SQL status: SUCCESS 1 in 2.386 seconds
[0m14:14:07.517037 [debug] [Thread-11 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0dee34f4-7d47-4bde-a9b1-a94702012ff0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000271631E9580>]}
[0m14:14:07.519721 [debug] [Thread-6  ]: SQL status: SUCCESS 1 in 2.385 seconds
[0m14:14:07.520784 [info ] [Thread-11 ]: 8 of 13 OK created sql table model PUBLIC.dim_products ......................... [[32mSUCCESS 1[0m in 2.56s]
[0m14:14:07.524275 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0dee34f4-7d47-4bde-a9b1-a94702012ff0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027162FA7250>]}
[0m14:14:07.525408 [debug] [Thread-11 ]: Finished running node model.northwind_dbt.dim_products
[0m14:14:07.526532 [info ] [Thread-6  ]: 9 of 13 OK created sql table model PUBLIC.dim_employees ........................ [[32mSUCCESS 1[0m in 2.57s]
[0m14:14:07.529197 [debug] [Thread-6  ]: Finished running node model.northwind_dbt.dim_employees
[0m14:14:07.628009 [debug] [Thread-7  ]: SQL status: SUCCESS 1 in 2.668 seconds
[0m14:14:07.632261 [debug] [Thread-7  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0dee34f4-7d47-4bde-a9b1-a94702012ff0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027163206D60>]}
[0m14:14:07.632261 [info ] [Thread-7  ]: 6 of 13 OK created sql table model PUBLIC.dim_customers ........................ [[32mSUCCESS 1[0m in 2.77s]
[0m14:14:07.634265 [debug] [Thread-7  ]: Finished running node model.northwind_dbt.dim_customers
[0m14:14:08.117855 [debug] [Thread-9  ]: SQL status: SUCCESS 32 in 1.467 seconds
[0m14:14:08.117855 [debug] [Thread-9  ]: Using snowflake connection "model.northwind_dbt.fact_order_details"
[0m14:14:08.117855 [debug] [Thread-9  ]: On model.northwind_dbt.fact_order_details: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.fact_order_details"} */
COMMIT
[0m14:14:08.531984 [debug] [Thread-9  ]: SQL status: SUCCESS 1 in 0.409 seconds
[0m14:14:08.541907 [debug] [Thread-9  ]: Applying DROP to: PROJECT_2.PUBLIC.fact_order_details__dbt_tmp
[0m14:14:08.548810 [debug] [Thread-9  ]: Using snowflake connection "model.northwind_dbt.fact_order_details"
[0m14:14:08.550817 [debug] [Thread-9  ]: On model.northwind_dbt.fact_order_details: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.fact_order_details"} */
drop view if exists PROJECT_2.PUBLIC.fact_order_details__dbt_tmp cascade
[0m14:14:08.698585 [debug] [Thread-9  ]: SQL status: SUCCESS 1 in 0.147 seconds
[0m14:14:08.704211 [debug] [Thread-9  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0dee34f4-7d47-4bde-a9b1-a94702012ff0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000271631E9550>]}
[0m14:14:08.704862 [info ] [Thread-9  ]: 7 of 13 OK created sql incremental model PUBLIC.fact_order_details ............. [[32mSUCCESS 32[0m in 3.78s]
[0m14:14:08.706600 [debug] [Thread-9  ]: Finished running node model.northwind_dbt.fact_order_details
[0m14:14:08.707122 [debug] [Thread-1  ]: Began running node model.northwind_dbt.obt_orders
[0m14:14:08.707637 [debug] [Thread-8  ]: Began running node model.northwind_dbt.top_customer_revenue
[0m14:14:08.708149 [debug] [Thread-3  ]: Began running node model.northwind_dbt.top_employee_revenue
[0m14:14:08.708669 [debug] [Thread-10 ]: Began running node model.northwind_dbt.top_performing_products
[0m14:14:08.709201 [info ] [Thread-1  ]: 10 of 13 START sql table model PUBLIC.obt_orders ............................... [RUN]
[0m14:14:08.709784 [info ] [Thread-8  ]: 11 of 13 START sql table model PUBLIC.top_customer_revenue ..................... [RUN]
[0m14:14:08.710831 [info ] [Thread-3  ]: 12 of 13 START sql table model PUBLIC.top_employee_revenue ..................... [RUN]
[0m14:14:08.711355 [info ] [Thread-10 ]: 13 of 13 START sql table model PUBLIC.top_performing_products .................. [RUN]
[0m14:14:08.713242 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.northwind_dbt.stg_customers, now model.northwind_dbt.obt_orders)
[0m14:14:08.714325 [debug] [Thread-8  ]: Acquiring new snowflake connection 'model.northwind_dbt.top_customer_revenue'
[0m14:14:08.715373 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.northwind_dbt.stg_order_details, now model.northwind_dbt.top_employee_revenue)
[0m14:14:08.715939 [debug] [Thread-10 ]: Acquiring new snowflake connection 'model.northwind_dbt.top_performing_products'
[0m14:14:08.716987 [debug] [Thread-1  ]: Began compiling node model.northwind_dbt.obt_orders
[0m14:14:08.717506 [debug] [Thread-8  ]: Began compiling node model.northwind_dbt.top_customer_revenue
[0m14:14:08.718513 [debug] [Thread-3  ]: Began compiling node model.northwind_dbt.top_employee_revenue
[0m14:14:08.719538 [debug] [Thread-10 ]: Began compiling node model.northwind_dbt.top_performing_products
[0m14:14:08.723510 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind_dbt.obt_orders"
[0m14:14:08.727513 [debug] [Thread-8  ]: Writing injected SQL for node "model.northwind_dbt.top_customer_revenue"
[0m14:14:08.731809 [debug] [Thread-3  ]: Writing injected SQL for node "model.northwind_dbt.top_employee_revenue"
[0m14:14:08.736201 [debug] [Thread-10 ]: Writing injected SQL for node "model.northwind_dbt.top_performing_products"
[0m14:14:08.765312 [debug] [Thread-10 ]: Began executing node model.northwind_dbt.top_performing_products
[0m14:14:08.765312 [debug] [Thread-3  ]: Began executing node model.northwind_dbt.top_employee_revenue
[0m14:14:08.765312 [debug] [Thread-1  ]: Began executing node model.northwind_dbt.obt_orders
[0m14:14:08.779375 [debug] [Thread-10 ]: Writing runtime sql for node "model.northwind_dbt.top_performing_products"
[0m14:14:08.783095 [debug] [Thread-3  ]: Writing runtime sql for node "model.northwind_dbt.top_employee_revenue"
[0m14:14:08.785622 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind_dbt.obt_orders"
[0m14:14:08.813544 [debug] [Thread-3  ]: Using snowflake connection "model.northwind_dbt.top_employee_revenue"
[0m14:14:08.813544 [debug] [Thread-8  ]: Began executing node model.northwind_dbt.top_customer_revenue
[0m14:14:08.813544 [debug] [Thread-10 ]: Using snowflake connection "model.northwind_dbt.top_performing_products"
[0m14:14:08.813544 [debug] [Thread-1  ]: Using snowflake connection "model.northwind_dbt.obt_orders"
[0m14:14:08.813544 [debug] [Thread-3  ]: On model.northwind_dbt.top_employee_revenue: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.top_employee_revenue"} */
create or replace transient table PROJECT_2.PUBLIC.top_employee_revenue
         as
        (

select
  e.employee_key,
  e.first_name || ' ' || e.last_name as employee_name,
  sum(f.total_revenue) as total_revenue
from PROJECT_2.PUBLIC.fact_order_details f
join PROJECT_2.PUBLIC.dim_employees e on f.employee_id = e.employee_id
group by e.employee_key, employee_name
order by total_revenue desc
        );
[0m14:14:08.813544 [debug] [Thread-8  ]: Writing runtime sql for node "model.northwind_dbt.top_customer_revenue"
[0m14:14:08.813544 [debug] [Thread-10 ]: On model.northwind_dbt.top_performing_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.top_performing_products"} */
create or replace transient table PROJECT_2.PUBLIC.top_performing_products
         as
        (

select
  p.product_id,
  p.product_name,
  sum(f.total_revenue) as total_revenue,
  count(distinct f.order_id) as number_of_orders
from PROJECT_2.PUBLIC.fact_order_details f
join PROJECT_2.PUBLIC.dim_products p on f.product_id = p.product_id
group by p.product_id, p.product_name
order by total_revenue desc
        );
[0m14:14:08.829611 [debug] [Thread-1  ]: On model.northwind_dbt.obt_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.obt_orders"} */
create or replace transient table PROJECT_2.PUBLIC.obt_orders
         as
        (select 
    f.order_id,
    f.product_id,
    f.customer_id,
    f.employee_id,
    f.shipper_id,
    f.order_date,
    f.total_revenue,
    f.avg_revenue,
    f.max_revenue,
    f.min_revenue,
    f.line_count,
    f.revenue_rank,

    c.company_name as customer_name,
    p.product_name,
    p.category_name,
    p.supplier_name,
    e.first_name || ' ' || e.last_name as employee_name,
    s.company_name as shipper_name

from PROJECT_2.PUBLIC.fact_order_details f
left join PROJECT_2.PUBLIC.dim_customers c on f.customer_id = c.customer_id
left join PROJECT_2.PUBLIC.dim_products p on f.product_id = p.product_id
left join PROJECT_2.PUBLIC.dim_employees e on f.employee_id = e.employee_id
left join PROJECT_2.PUBLIC.shippers s on f.shipper_id = s.shipper_id
        );
[0m14:14:08.830343 [debug] [Thread-10 ]: Opening a new connection, currently in state init
[0m14:14:08.845256 [debug] [Thread-8  ]: Using snowflake connection "model.northwind_dbt.top_customer_revenue"
[0m14:14:08.845256 [debug] [Thread-8  ]: On model.northwind_dbt.top_customer_revenue: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.top_customer_revenue"} */
create or replace transient table PROJECT_2.PUBLIC.top_customer_revenue
         as
        (

select
  c.customer_id,
  c.company_name as customer_name,
  sum(f.total_revenue) as total_revenue
from PROJECT_2.PUBLIC.fact_order_details f
join PROJECT_2.PUBLIC.dim_customers c using (customer_id)
group by c.customer_id, c.company_name
order by total_revenue desc
        );
[0m14:14:08.845256 [debug] [Thread-8  ]: Opening a new connection, currently in state init
[0m14:14:10.457975 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.625 seconds
[0m14:14:10.462001 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0dee34f4-7d47-4bde-a9b1-a94702012ff0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027146716940>]}
[0m14:14:10.464012 [info ] [Thread-1  ]: 10 of 13 OK created sql table model PUBLIC.obt_orders .......................... [[32mSUCCESS 1[0m in 1.75s]
[0m14:14:10.464012 [debug] [Thread-1  ]: Finished running node model.northwind_dbt.obt_orders
[0m14:14:10.513861 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1.685 seconds
[0m14:14:10.518845 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0dee34f4-7d47-4bde-a9b1-a94702012ff0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000271615B1F10>]}
[0m14:14:10.518845 [info ] [Thread-3  ]: 12 of 13 OK created sql table model PUBLIC.top_employee_revenue ................ [[32mSUCCESS 1[0m in 1.80s]
[0m14:14:10.520857 [debug] [Thread-3  ]: Finished running node model.northwind_dbt.top_employee_revenue
[0m14:14:10.586606 [debug] [Thread-10 ]: SQL status: SUCCESS 1 in 1.755 seconds
[0m14:14:10.589615 [debug] [Thread-10 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0dee34f4-7d47-4bde-a9b1-a94702012ff0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000271612EEEB0>]}
[0m14:14:10.590615 [info ] [Thread-10 ]: 13 of 13 OK created sql table model PUBLIC.top_performing_products ............. [[32mSUCCESS 1[0m in 1.87s]
[0m14:14:10.592614 [debug] [Thread-10 ]: Finished running node model.northwind_dbt.top_performing_products
[0m14:14:10.854436 [debug] [Thread-8  ]: SQL status: SUCCESS 1 in 2.009 seconds
[0m14:14:10.859295 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0dee34f4-7d47-4bde-a9b1-a94702012ff0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000271618EF220>]}
[0m14:14:10.859295 [info ] [Thread-8  ]: 11 of 13 OK created sql table model PUBLIC.top_customer_revenue ................ [[32mSUCCESS 1[0m in 2.14s]
[0m14:14:10.861356 [debug] [Thread-8  ]: Finished running node model.northwind_dbt.top_customer_revenue
[0m14:14:10.862364 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:14:10.862364 [debug] [MainThread]: Connection 'list_PROJECT_2' was left open.
[0m14:14:10.862364 [debug] [MainThread]: On list_PROJECT_2: Close
[0m14:14:11.028504 [debug] [MainThread]: Connection 'list_PROJECT_2_PUBLIC' was left open.
[0m14:14:11.030513 [debug] [MainThread]: On list_PROJECT_2_PUBLIC: Close
[0m14:14:11.157518 [debug] [MainThread]: Connection 'list_PROJECT_2_snapshots' was left open.
[0m14:14:11.159028 [debug] [MainThread]: On list_PROJECT_2_snapshots: Close
[0m14:14:11.314518 [debug] [MainThread]: Connection 'model.northwind_dbt.obt_orders' was left open.
[0m14:14:11.316536 [debug] [MainThread]: On model.northwind_dbt.obt_orders: Close
[0m14:14:11.451656 [debug] [MainThread]: Connection 'model.northwind_dbt.stg_employees' was left open.
[0m14:14:11.454266 [debug] [MainThread]: On model.northwind_dbt.stg_employees: Close
[0m14:14:11.770446 [debug] [MainThread]: Connection 'model.northwind_dbt.top_employee_revenue' was left open.
[0m14:14:11.772467 [debug] [MainThread]: On model.northwind_dbt.top_employee_revenue: Close
[0m14:14:11.888878 [debug] [MainThread]: Connection 'model.northwind_dbt.stg_orders' was left open.
[0m14:14:11.888878 [debug] [MainThread]: On model.northwind_dbt.stg_orders: Close
[0m14:14:12.019706 [debug] [MainThread]: Connection 'model.northwind_dbt.stg_products' was left open.
[0m14:14:12.021716 [debug] [MainThread]: On model.northwind_dbt.stg_products: Close
[0m14:14:12.142920 [debug] [MainThread]: Connection 'model.northwind_dbt.dim_customers' was left open.
[0m14:14:12.142920 [debug] [MainThread]: On model.northwind_dbt.dim_customers: Close
[0m14:14:12.267336 [debug] [MainThread]: Connection 'model.northwind_dbt.fact_order_details' was left open.
[0m14:14:12.267336 [debug] [MainThread]: On model.northwind_dbt.fact_order_details: Close
[0m14:14:12.439231 [debug] [MainThread]: Connection 'model.northwind_dbt.dim_products' was left open.
[0m14:14:12.451969 [debug] [MainThread]: On model.northwind_dbt.dim_products: Close
[0m14:14:12.570357 [debug] [MainThread]: Connection 'model.northwind_dbt.dim_employees' was left open.
[0m14:14:12.578699 [debug] [MainThread]: On model.northwind_dbt.dim_employees: Close
[0m14:14:12.929301 [debug] [MainThread]: Connection 'model.northwind_dbt.top_customer_revenue' was left open.
[0m14:14:12.933003 [debug] [MainThread]: On model.northwind_dbt.top_customer_revenue: Close
[0m14:14:13.063745 [debug] [MainThread]: Connection 'model.northwind_dbt.top_performing_products' was left open.
[0m14:14:13.063745 [debug] [MainThread]: On model.northwind_dbt.top_performing_products: Close
[0m14:14:13.208347 [info ] [MainThread]: 
[0m14:14:13.210355 [info ] [MainThread]: Finished running 1 incremental model, 7 table models, 5 view models in 0 hours 0 minutes and 11.92 seconds (11.92s).
[0m14:14:13.212363 [debug] [MainThread]: Command end result
[0m14:14:13.394702 [debug] [MainThread]: Wrote artifact WritableManifest to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\manifest.json
[0m14:14:13.405365 [debug] [MainThread]: Wrote artifact SemanticManifest to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\semantic_manifest.json
[0m14:14:13.422085 [debug] [MainThread]: Wrote artifact RunExecutionResult to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\run_results.json
[0m14:14:13.422085 [info ] [MainThread]: 
[0m14:14:13.422085 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:14:13.422085 [info ] [MainThread]: 
[0m14:14:13.422085 [info ] [MainThread]: Done. PASS=13 WARN=0 ERROR=0 SKIP=0 TOTAL=13
[0m14:14:13.422085 [debug] [MainThread]: Command `dbt run` succeeded at 14:14:13.422085 after 17.16 seconds
[0m14:14:13.429018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027146390400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000271467137F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000271466DD280>]}
[0m14:14:13.429018 [debug] [MainThread]: Flushing usage events
[0m14:14:14.261465 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:26:32.956851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EB0370340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EB23D0670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EB23D0E20>]}


============================== 14:26:32.959877 | 6dc62f3c-e493-40ed-9fa9-f31b673a2b84 ==============================
[0m14:26:32.959877 [info ] [MainThread]: Running with dbt=1.9.0
[0m14:26:32.959877 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'c:\\Users\\fitzp\\Documents\\Alpaca_Market\\zproject_2\\northwind_psql', 'log_path': 'c:\\Users\\fitzp\\Documents\\Alpaca_Market\\zproject_2\\northwind_psql\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:26:34.396582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6dc62f3c-e493-40ed-9fa9-f31b673a2b84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EAF357850>]}
[0m14:26:34.492947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6dc62f3c-e493-40ed-9fa9-f31b673a2b84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EB23B10A0>]}
[0m14:26:34.494946 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m14:26:34.903292 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m14:26:35.399717 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:26:35.399717 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:26:35.414953 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.northwind_dbt.marts.bi
[0m14:26:35.481376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6dc62f3c-e493-40ed-9fa9-f31b673a2b84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017ECB503130>]}
[0m14:26:35.733456 [debug] [MainThread]: Wrote artifact WritableManifest to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\manifest.json
[0m14:26:35.740136 [debug] [MainThread]: Wrote artifact SemanticManifest to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\semantic_manifest.json
[0m14:26:35.787858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6dc62f3c-e493-40ed-9fa9-f31b673a2b84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017ECB6EFAC0>]}
[0m14:26:35.787858 [info ] [MainThread]: Found 13 models, 1 snapshot, 16 data tests, 8 sources, 706 macros
[0m14:26:35.787858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6dc62f3c-e493-40ed-9fa9-f31b673a2b84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017ECB52B820>]}
[0m14:26:35.787858 [info ] [MainThread]: 
[0m14:26:35.787858 [info ] [MainThread]: Concurrency: 12 threads (target='dev')
[0m14:26:35.803277 [info ] [MainThread]: 
[0m14:26:35.803277 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:26:35.813096 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_2_snapshots'
[0m14:26:35.813096 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_2_PUBLIC'
[0m14:26:35.895045 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_2_snapshots"
[0m14:26:35.895045 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_2_PUBLIC"
[0m14:26:35.895045 [debug] [ThreadPool]: On list_PROJECT_2_snapshots: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "connection_name": "list_PROJECT_2_snapshots"} */
show objects in PROJECT_2.snapshots limit 10000;
[0m14:26:35.895045 [debug] [ThreadPool]: On list_PROJECT_2_PUBLIC: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "connection_name": "list_PROJECT_2_PUBLIC"} */
show objects in PROJECT_2.PUBLIC limit 10000;
[0m14:26:35.895045 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:26:35.895045 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:26:36.888623 [debug] [ThreadPool]: SQL status: SUCCESS 27 in 0.982 seconds
[0m14:26:36.939291 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bbb5f2-020d-05f9-000c-83e7000b9146
[0m14:26:36.939291 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m14:26:36.939291 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m14:26:36.939291 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m14:26:36.942889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6dc62f3c-e493-40ed-9fa9-f31b673a2b84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017ECB6EFCA0>]}
[0m14:26:36.942889 [debug] [Thread-1  ]: Began running node test.northwind_dbt.not_null_dim_customers_customer_id.dd91cd1c8d
[0m14:26:36.951670 [debug] [Thread-3  ]: Began running node test.northwind_dbt.not_null_dim_products_product_id.c8aba288d1
[0m14:26:36.951670 [debug] [Thread-2  ]: Began running node test.northwind_dbt.not_null_dim_employees_employee_key.232a183ffe
[0m14:26:36.951670 [debug] [Thread-4  ]: Began running node test.northwind_dbt.not_null_fact_order_details_customer_id.6aaefe4888
[0m14:26:36.951670 [debug] [Thread-5  ]: Began running node test.northwind_dbt.not_null_fact_order_details_order_id.8d47c14c82
[0m14:26:36.951670 [debug] [Thread-6  ]: Began running node test.northwind_dbt.not_null_fact_order_details_product_id.85713db7b9
[0m14:26:36.951670 [debug] [Thread-7  ]: Began running node test.northwind_dbt.not_null_obt_orders_customer_id.1e3c4ae465
[0m14:26:36.951670 [debug] [Thread-8  ]: Began running node test.northwind_dbt.not_null_obt_orders_order_date.5632203db3
[0m14:26:36.951670 [debug] [Thread-9  ]: Began running node test.northwind_dbt.not_null_obt_orders_order_id.218f605f9c
[0m14:26:36.951670 [info ] [Thread-1  ]: 1 of 16 START test not_null_dim_customers_customer_id .......................... [RUN]
[0m14:26:36.951670 [debug] [Thread-10 ]: Began running node test.northwind_dbt.not_null_obt_orders_product_id.caa3082c7f
[0m14:26:36.951670 [debug] [Thread-11 ]: Began running node test.northwind_dbt.not_null_top_customer_revenue_customer_id.668bb5e112
[0m14:26:36.951670 [debug] [Thread-12 ]: Began running node test.northwind_dbt.not_null_top_employee_revenue_employee_key.cb63db6526
[0m14:26:36.951670 [info ] [Thread-3  ]: 3 of 16 START test not_null_dim_products_product_id ............................ [RUN]
[0m14:26:36.951670 [info ] [Thread-2  ]: 2 of 16 START test not_null_dim_employees_employee_key ......................... [RUN]
[0m14:26:36.951670 [info ] [Thread-4  ]: 4 of 16 START test not_null_fact_order_details_customer_id ..................... [RUN]
[0m14:26:36.951670 [info ] [Thread-5  ]: 5 of 16 START test not_null_fact_order_details_order_id ........................ [RUN]
[0m14:26:36.951670 [info ] [Thread-6  ]: 6 of 16 START test not_null_fact_order_details_product_id ...................... [RUN]
[0m14:26:36.962257 [info ] [Thread-7  ]: 7 of 16 START test not_null_obt_orders_customer_id ............................. [RUN]
[0m14:26:36.962849 [info ] [Thread-8  ]: 8 of 16 START test not_null_obt_orders_order_date .............................. [RUN]
[0m14:26:36.962849 [info ] [Thread-9  ]: 9 of 16 START test not_null_obt_orders_order_id ................................ [RUN]
[0m14:26:36.962849 [debug] [Thread-1  ]: Acquiring new snowflake connection 'test.northwind_dbt.not_null_dim_customers_customer_id.dd91cd1c8d'
[0m14:26:36.962849 [info ] [Thread-10 ]: 10 of 16 START test not_null_obt_orders_product_id ............................. [RUN]
[0m14:26:36.962849 [info ] [Thread-11 ]: 11 of 16 START test not_null_top_customer_revenue_customer_id .................. [RUN]
[0m14:26:36.962849 [debug] [Thread-3  ]: Acquiring new snowflake connection 'test.northwind_dbt.not_null_dim_products_product_id.c8aba288d1'
[0m14:26:36.962849 [info ] [Thread-12 ]: 12 of 16 START test not_null_top_employee_revenue_employee_key ................. [RUN]
[0m14:26:36.962849 [debug] [Thread-2  ]: Acquiring new snowflake connection 'test.northwind_dbt.not_null_dim_employees_employee_key.232a183ffe'
[0m14:26:36.962849 [debug] [Thread-4  ]: Acquiring new snowflake connection 'test.northwind_dbt.not_null_fact_order_details_customer_id.6aaefe4888'
[0m14:26:36.962849 [debug] [Thread-5  ]: Acquiring new snowflake connection 'test.northwind_dbt.not_null_fact_order_details_order_id.8d47c14c82'
[0m14:26:36.962849 [debug] [Thread-6  ]: Acquiring new snowflake connection 'test.northwind_dbt.not_null_fact_order_details_product_id.85713db7b9'
[0m14:26:36.962849 [debug] [Thread-7  ]: Acquiring new snowflake connection 'test.northwind_dbt.not_null_obt_orders_customer_id.1e3c4ae465'
[0m14:26:36.962849 [debug] [Thread-8  ]: Acquiring new snowflake connection 'test.northwind_dbt.not_null_obt_orders_order_date.5632203db3'
[0m14:26:36.962849 [debug] [Thread-9  ]: Acquiring new snowflake connection 'test.northwind_dbt.not_null_obt_orders_order_id.218f605f9c'
[0m14:26:36.977616 [debug] [Thread-1  ]: Began compiling node test.northwind_dbt.not_null_dim_customers_customer_id.dd91cd1c8d
[0m14:26:36.977616 [debug] [Thread-10 ]: Acquiring new snowflake connection 'test.northwind_dbt.not_null_obt_orders_product_id.caa3082c7f'
[0m14:26:36.980532 [debug] [Thread-11 ]: Acquiring new snowflake connection 'test.northwind_dbt.not_null_top_customer_revenue_customer_id.668bb5e112'
[0m14:26:36.980532 [debug] [Thread-3  ]: Began compiling node test.northwind_dbt.not_null_dim_products_product_id.c8aba288d1
[0m14:26:36.980532 [debug] [Thread-12 ]: Acquiring new snowflake connection 'test.northwind_dbt.not_null_top_employee_revenue_employee_key.cb63db6526'
[0m14:26:36.980532 [debug] [Thread-2  ]: Began compiling node test.northwind_dbt.not_null_dim_employees_employee_key.232a183ffe
[0m14:26:36.980532 [debug] [Thread-4  ]: Began compiling node test.northwind_dbt.not_null_fact_order_details_customer_id.6aaefe4888
[0m14:26:36.980532 [debug] [Thread-5  ]: Began compiling node test.northwind_dbt.not_null_fact_order_details_order_id.8d47c14c82
[0m14:26:36.980532 [debug] [Thread-6  ]: Began compiling node test.northwind_dbt.not_null_fact_order_details_product_id.85713db7b9
[0m14:26:36.980532 [debug] [Thread-7  ]: Began compiling node test.northwind_dbt.not_null_obt_orders_customer_id.1e3c4ae465
[0m14:26:36.980532 [debug] [Thread-8  ]: Began compiling node test.northwind_dbt.not_null_obt_orders_order_date.5632203db3
[0m14:26:36.988400 [debug] [Thread-9  ]: Began compiling node test.northwind_dbt.not_null_obt_orders_order_id.218f605f9c
[0m14:26:36.996871 [debug] [Thread-1  ]: Writing injected SQL for node "test.northwind_dbt.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m14:26:36.996871 [debug] [Thread-10 ]: Began compiling node test.northwind_dbt.not_null_obt_orders_product_id.caa3082c7f
[0m14:26:36.996871 [debug] [Thread-11 ]: Began compiling node test.northwind_dbt.not_null_top_customer_revenue_customer_id.668bb5e112
[0m14:26:37.010892 [debug] [Thread-3  ]: Writing injected SQL for node "test.northwind_dbt.not_null_dim_products_product_id.c8aba288d1"
[0m14:26:37.010892 [debug] [Thread-12 ]: Began compiling node test.northwind_dbt.not_null_top_employee_revenue_employee_key.cb63db6526
[0m14:26:37.016839 [debug] [Thread-2  ]: Writing injected SQL for node "test.northwind_dbt.not_null_dim_employees_employee_key.232a183ffe"
[0m14:26:37.020140 [debug] [Thread-4  ]: Writing injected SQL for node "test.northwind_dbt.not_null_fact_order_details_customer_id.6aaefe4888"
[0m14:26:37.027089 [debug] [Thread-5  ]: Writing injected SQL for node "test.northwind_dbt.not_null_fact_order_details_order_id.8d47c14c82"
[0m14:26:37.032554 [debug] [Thread-6  ]: Writing injected SQL for node "test.northwind_dbt.not_null_fact_order_details_product_id.85713db7b9"
[0m14:26:37.032554 [debug] [Thread-7  ]: Writing injected SQL for node "test.northwind_dbt.not_null_obt_orders_customer_id.1e3c4ae465"
[0m14:26:37.042286 [debug] [Thread-8  ]: Writing injected SQL for node "test.northwind_dbt.not_null_obt_orders_order_date.5632203db3"
[0m14:26:37.047530 [debug] [Thread-9  ]: Writing injected SQL for node "test.northwind_dbt.not_null_obt_orders_order_id.218f605f9c"
[0m14:26:37.054528 [debug] [Thread-10 ]: Writing injected SQL for node "test.northwind_dbt.not_null_obt_orders_product_id.caa3082c7f"
[0m14:26:37.059527 [debug] [Thread-11 ]: Writing injected SQL for node "test.northwind_dbt.not_null_top_customer_revenue_customer_id.668bb5e112"
[0m14:26:37.066465 [debug] [Thread-12 ]: Writing injected SQL for node "test.northwind_dbt.not_null_top_employee_revenue_employee_key.cb63db6526"
[0m14:26:37.067470 [debug] [Thread-1  ]: Began executing node test.northwind_dbt.not_null_dim_customers_customer_id.dd91cd1c8d
[0m14:26:37.071467 [debug] [Thread-3  ]: Began executing node test.northwind_dbt.not_null_dim_products_product_id.c8aba288d1
[0m14:26:37.091021 [debug] [Thread-1  ]: Writing runtime sql for node "test.northwind_dbt.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m14:26:37.099439 [debug] [Thread-3  ]: Writing runtime sql for node "test.northwind_dbt.not_null_dim_products_product_id.c8aba288d1"
[0m14:26:37.129286 [debug] [Thread-6  ]: Began executing node test.northwind_dbt.not_null_fact_order_details_product_id.85713db7b9
[0m14:26:37.130812 [debug] [Thread-2  ]: Began executing node test.northwind_dbt.not_null_dim_employees_employee_key.232a183ffe
[0m14:26:37.136842 [debug] [Thread-6  ]: Writing runtime sql for node "test.northwind_dbt.not_null_fact_order_details_product_id.85713db7b9"
[0m14:26:37.139206 [debug] [Thread-2  ]: Writing runtime sql for node "test.northwind_dbt.not_null_dim_employees_employee_key.232a183ffe"
[0m14:26:37.145210 [debug] [Thread-10 ]: Began executing node test.northwind_dbt.not_null_obt_orders_product_id.caa3082c7f
[0m14:26:37.145210 [debug] [Thread-7  ]: Began executing node test.northwind_dbt.not_null_obt_orders_customer_id.1e3c4ae465
[0m14:26:37.145210 [debug] [Thread-12 ]: Began executing node test.northwind_dbt.not_null_top_employee_revenue_employee_key.cb63db6526
[0m14:26:37.145210 [debug] [Thread-11 ]: Began executing node test.northwind_dbt.not_null_top_customer_revenue_customer_id.668bb5e112
[0m14:26:37.145210 [debug] [Thread-10 ]: Writing runtime sql for node "test.northwind_dbt.not_null_obt_orders_product_id.caa3082c7f"
[0m14:26:37.145210 [debug] [Thread-7  ]: Writing runtime sql for node "test.northwind_dbt.not_null_obt_orders_customer_id.1e3c4ae465"
[0m14:26:37.231422 [debug] [Thread-12 ]: Writing runtime sql for node "test.northwind_dbt.not_null_top_employee_revenue_employee_key.cb63db6526"
[0m14:26:37.233554 [debug] [Thread-1  ]: Using snowflake connection "test.northwind_dbt.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m14:26:37.233554 [debug] [Thread-3  ]: Using snowflake connection "test.northwind_dbt.not_null_dim_products_product_id.c8aba288d1"
[0m14:26:37.233554 [debug] [Thread-6  ]: Using snowflake connection "test.northwind_dbt.not_null_fact_order_details_product_id.85713db7b9"
[0m14:26:37.241745 [debug] [Thread-11 ]: Writing runtime sql for node "test.northwind_dbt.not_null_top_customer_revenue_customer_id.668bb5e112"
[0m14:26:37.246258 [debug] [Thread-1  ]: On test.northwind_dbt.not_null_dim_customers_customer_id.dd91cd1c8d: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "test.northwind_dbt.not_null_dim_customers_customer_id.dd91cd1c8d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from PROJECT_2.PUBLIC.dim_customers
where customer_id is null



      
    ) dbt_internal_test
[0m14:26:37.247553 [debug] [Thread-3  ]: On test.northwind_dbt.not_null_dim_products_product_id.c8aba288d1: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "test.northwind_dbt.not_null_dim_products_product_id.c8aba288d1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_id
from PROJECT_2.PUBLIC.dim_products
where product_id is null



      
    ) dbt_internal_test
[0m14:26:37.248556 [debug] [Thread-6  ]: On test.northwind_dbt.not_null_fact_order_details_product_id.85713db7b9: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "test.northwind_dbt.not_null_fact_order_details_product_id.85713db7b9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_id
from PROJECT_2.PUBLIC.fact_order_details
where product_id is null



      
    ) dbt_internal_test
[0m14:26:37.250065 [debug] [Thread-4  ]: Began executing node test.northwind_dbt.not_null_fact_order_details_customer_id.6aaefe4888
[0m14:26:37.252075 [debug] [Thread-9  ]: Began executing node test.northwind_dbt.not_null_obt_orders_order_id.218f605f9c
[0m14:26:37.253074 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m14:26:37.255598 [debug] [Thread-8  ]: Began executing node test.northwind_dbt.not_null_obt_orders_order_date.5632203db3
[0m14:26:37.256601 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m14:26:37.258292 [debug] [Thread-2  ]: Using snowflake connection "test.northwind_dbt.not_null_dim_employees_employee_key.232a183ffe"
[0m14:26:37.259303 [debug] [Thread-5  ]: Began executing node test.northwind_dbt.not_null_fact_order_details_order_id.8d47c14c82
[0m14:26:37.260812 [debug] [Thread-6  ]: Opening a new connection, currently in state init
[0m14:26:37.267545 [debug] [Thread-4  ]: Writing runtime sql for node "test.northwind_dbt.not_null_fact_order_details_customer_id.6aaefe4888"
[0m14:26:37.273714 [debug] [Thread-9  ]: Writing runtime sql for node "test.northwind_dbt.not_null_obt_orders_order_id.218f605f9c"
[0m14:26:37.275882 [debug] [Thread-10 ]: Using snowflake connection "test.northwind_dbt.not_null_obt_orders_product_id.caa3082c7f"
[0m14:26:37.277500 [debug] [Thread-7  ]: Using snowflake connection "test.northwind_dbt.not_null_obt_orders_customer_id.1e3c4ae465"
[0m14:26:37.288360 [debug] [Thread-8  ]: Writing runtime sql for node "test.northwind_dbt.not_null_obt_orders_order_date.5632203db3"
[0m14:26:37.290023 [debug] [Thread-11 ]: Using snowflake connection "test.northwind_dbt.not_null_top_customer_revenue_customer_id.668bb5e112"
[0m14:26:37.292529 [debug] [Thread-12 ]: Using snowflake connection "test.northwind_dbt.not_null_top_employee_revenue_employee_key.cb63db6526"
[0m14:26:37.300830 [debug] [Thread-2  ]: On test.northwind_dbt.not_null_dim_employees_employee_key.232a183ffe: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "test.northwind_dbt.not_null_dim_employees_employee_key.232a183ffe"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select employee_key
from PROJECT_2.PUBLIC.dim_employees
where employee_key is null



      
    ) dbt_internal_test
[0m14:26:37.306788 [debug] [Thread-5  ]: Writing runtime sql for node "test.northwind_dbt.not_null_fact_order_details_order_id.8d47c14c82"
[0m14:26:37.315857 [debug] [Thread-10 ]: On test.northwind_dbt.not_null_obt_orders_product_id.caa3082c7f: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "test.northwind_dbt.not_null_obt_orders_product_id.caa3082c7f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_id
from PROJECT_2.PUBLIC.obt_orders
where product_id is null



      
    ) dbt_internal_test
[0m14:26:37.318039 [debug] [Thread-7  ]: On test.northwind_dbt.not_null_obt_orders_customer_id.1e3c4ae465: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "test.northwind_dbt.not_null_obt_orders_customer_id.1e3c4ae465"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from PROJECT_2.PUBLIC.obt_orders
where customer_id is null



      
    ) dbt_internal_test
[0m14:26:37.321147 [debug] [Thread-11 ]: On test.northwind_dbt.not_null_top_customer_revenue_customer_id.668bb5e112: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "test.northwind_dbt.not_null_top_customer_revenue_customer_id.668bb5e112"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from PROJECT_2.PUBLIC.top_customer_revenue
where customer_id is null



      
    ) dbt_internal_test
[0m14:26:37.323906 [debug] [Thread-12 ]: On test.northwind_dbt.not_null_top_employee_revenue_employee_key.cb63db6526: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "test.northwind_dbt.not_null_top_employee_revenue_employee_key.cb63db6526"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select employee_key
from PROJECT_2.PUBLIC.top_employee_revenue
where employee_key is null



      
    ) dbt_internal_test
[0m14:26:37.326417 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m14:26:37.328801 [debug] [Thread-10 ]: Opening a new connection, currently in state init
[0m14:26:37.331322 [debug] [Thread-7  ]: Opening a new connection, currently in state init
[0m14:26:37.333498 [debug] [Thread-11 ]: Opening a new connection, currently in state init
[0m14:26:37.335716 [debug] [Thread-12 ]: Opening a new connection, currently in state init
[0m14:26:37.351999 [debug] [Thread-8  ]: Using snowflake connection "test.northwind_dbt.not_null_obt_orders_order_date.5632203db3"
[0m14:26:37.354124 [debug] [Thread-4  ]: Using snowflake connection "test.northwind_dbt.not_null_fact_order_details_customer_id.6aaefe4888"
[0m14:26:37.358348 [debug] [Thread-9  ]: Using snowflake connection "test.northwind_dbt.not_null_obt_orders_order_id.218f605f9c"
[0m14:26:37.370423 [debug] [Thread-5  ]: Using snowflake connection "test.northwind_dbt.not_null_fact_order_details_order_id.8d47c14c82"
[0m14:26:37.378108 [debug] [Thread-8  ]: On test.northwind_dbt.not_null_obt_orders_order_date.5632203db3: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "test.northwind_dbt.not_null_obt_orders_order_date.5632203db3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_date
from PROJECT_2.PUBLIC.obt_orders
where order_date is null



      
    ) dbt_internal_test
[0m14:26:37.382970 [debug] [Thread-4  ]: On test.northwind_dbt.not_null_fact_order_details_customer_id.6aaefe4888: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "test.northwind_dbt.not_null_fact_order_details_customer_id.6aaefe4888"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from PROJECT_2.PUBLIC.fact_order_details
where customer_id is null



      
    ) dbt_internal_test
[0m14:26:37.385451 [debug] [Thread-9  ]: On test.northwind_dbt.not_null_obt_orders_order_id.218f605f9c: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "test.northwind_dbt.not_null_obt_orders_order_id.218f605f9c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from PROJECT_2.PUBLIC.obt_orders
where order_id is null



      
    ) dbt_internal_test
[0m14:26:37.387074 [debug] [Thread-5  ]: On test.northwind_dbt.not_null_fact_order_details_order_id.8d47c14c82: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "test.northwind_dbt.not_null_fact_order_details_order_id.8d47c14c82"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from PROJECT_2.PUBLIC.fact_order_details
where order_id is null



      
    ) dbt_internal_test
[0m14:26:37.387074 [debug] [Thread-8  ]: Opening a new connection, currently in state init
[0m14:26:37.389604 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m14:26:37.391617 [debug] [Thread-9  ]: Opening a new connection, currently in state init
[0m14:26:37.396455 [debug] [Thread-5  ]: Opening a new connection, currently in state init
[0m14:26:38.329761 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.941 seconds
[0m14:26:38.329761 [debug] [Thread-5  ]: SQL status: SUCCESS 1 in 0.937 seconds
[0m14:26:38.336794 [info ] [Thread-4  ]: 4 of 16 PASS not_null_fact_order_details_customer_id ........................... [[32mPASS[0m in 1.37s]
[0m14:26:38.336794 [info ] [Thread-5  ]: 5 of 16 PASS not_null_fact_order_details_order_id .............................. [[32mPASS[0m in 1.37s]
[0m14:26:38.356031 [debug] [Thread-7  ]: SQL status: SUCCESS 1 in 1.024 seconds
[0m14:26:38.358035 [debug] [Thread-8  ]: SQL status: SUCCESS 1 in 0.969 seconds
[0m14:26:38.358035 [debug] [Thread-4  ]: Finished running node test.northwind_dbt.not_null_fact_order_details_customer_id.6aaefe4888
[0m14:26:38.358035 [debug] [Thread-5  ]: Finished running node test.northwind_dbt.not_null_fact_order_details_order_id.8d47c14c82
[0m14:26:38.358035 [debug] [Thread-11 ]: SQL status: SUCCESS 1 in 1.032 seconds
[0m14:26:38.358035 [info ] [Thread-7  ]: 7 of 16 PASS not_null_obt_orders_customer_id ................................... [[32mPASS[0m in 1.40s]
[0m14:26:38.377207 [info ] [Thread-8  ]: 8 of 16 PASS not_null_obt_orders_order_date .................................... [[32mPASS[0m in 1.41s]
[0m14:26:38.383431 [debug] [Thread-6  ]: SQL status: SUCCESS 1 in 1.122 seconds
[0m14:26:38.384545 [debug] [Thread-4  ]: Began running node test.northwind_dbt.not_null_top_performing_products_product_id.919a185ac6
[0m14:26:38.384545 [debug] [Thread-12 ]: SQL status: SUCCESS 1 in 1.051 seconds
[0m14:26:38.390455 [debug] [Thread-5  ]: Began running node test.northwind_dbt.unique_dim_customers_customer_id.15c9f1e2fd
[0m14:26:38.390455 [debug] [Thread-9  ]: SQL status: SUCCESS 1 in 1.000 seconds
[0m14:26:38.392473 [info ] [Thread-11 ]: 11 of 16 PASS not_null_top_customer_revenue_customer_id ........................ [[32mPASS[0m in 1.41s]
[0m14:26:38.392473 [debug] [Thread-7  ]: Finished running node test.northwind_dbt.not_null_obt_orders_customer_id.1e3c4ae465
[0m14:26:38.392473 [debug] [Thread-8  ]: Finished running node test.northwind_dbt.not_null_obt_orders_order_date.5632203db3
[0m14:26:38.407915 [info ] [Thread-6  ]: 6 of 16 PASS not_null_fact_order_details_product_id ............................ [[32mPASS[0m in 1.44s]
[0m14:26:38.410213 [info ] [Thread-4  ]: 13 of 16 START test not_null_top_performing_products_product_id ................ [RUN]
[0m14:26:38.414236 [info ] [Thread-12 ]: 12 of 16 PASS not_null_top_employee_revenue_employee_key ....................... [[32mPASS[0m in 1.43s]
[0m14:26:38.414236 [info ] [Thread-5  ]: 14 of 16 START test unique_dim_customers_customer_id ........................... [RUN]
[0m14:26:38.423990 [info ] [Thread-9  ]: 9 of 16 PASS not_null_obt_orders_order_id ...................................... [[32mPASS[0m in 1.46s]
[0m14:26:38.423990 [debug] [Thread-11 ]: Finished running node test.northwind_dbt.not_null_top_customer_revenue_customer_id.668bb5e112
[0m14:26:38.427174 [debug] [Thread-7  ]: Began running node test.northwind_dbt.unique_dim_employees_employee_key.3824d24782
[0m14:26:38.427174 [debug] [Thread-8  ]: Began running node test.northwind_dbt.unique_dim_products_product_id.ef7b2a9985
[0m14:26:38.427174 [debug] [Thread-6  ]: Finished running node test.northwind_dbt.not_null_fact_order_details_product_id.85713db7b9
[0m14:26:38.427174 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.northwind_dbt.not_null_fact_order_details_customer_id.6aaefe4888, now test.northwind_dbt.not_null_top_performing_products_product_id.919a185ac6)
[0m14:26:38.437591 [debug] [Thread-12 ]: Finished running node test.northwind_dbt.not_null_top_employee_revenue_employee_key.cb63db6526
[0m14:26:38.440773 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.187 seconds
[0m14:26:38.441395 [debug] [Thread-5  ]: Re-using an available connection from the pool (formerly test.northwind_dbt.not_null_fact_order_details_order_id.8d47c14c82, now test.northwind_dbt.unique_dim_customers_customer_id.15c9f1e2fd)
[0m14:26:38.441395 [debug] [Thread-9  ]: Finished running node test.northwind_dbt.not_null_obt_orders_order_id.218f605f9c
[0m14:26:38.441395 [info ] [Thread-7  ]: 15 of 16 START test unique_dim_employees_employee_key .......................... [RUN]
[0m14:26:38.441395 [info ] [Thread-8  ]: 16 of 16 START test unique_dim_products_product_id ............................. [RUN]
[0m14:26:38.441395 [debug] [Thread-4  ]: Began compiling node test.northwind_dbt.not_null_top_performing_products_product_id.919a185ac6
[0m14:26:38.457761 [info ] [Thread-1  ]: 1 of 16 PASS not_null_dim_customers_customer_id ................................ [[32mPASS[0m in 1.49s]
[0m14:26:38.457761 [debug] [Thread-5  ]: Began compiling node test.northwind_dbt.unique_dim_customers_customer_id.15c9f1e2fd
[0m14:26:38.457761 [debug] [Thread-7  ]: Re-using an available connection from the pool (formerly test.northwind_dbt.not_null_obt_orders_customer_id.1e3c4ae465, now test.northwind_dbt.unique_dim_employees_employee_key.3824d24782)
[0m14:26:38.457761 [debug] [Thread-8  ]: Re-using an available connection from the pool (formerly test.northwind_dbt.not_null_obt_orders_order_date.5632203db3, now test.northwind_dbt.unique_dim_products_product_id.ef7b2a9985)
[0m14:26:38.474380 [debug] [Thread-4  ]: Writing injected SQL for node "test.northwind_dbt.not_null_top_performing_products_product_id.919a185ac6"
[0m14:26:38.474380 [debug] [Thread-1  ]: Finished running node test.northwind_dbt.not_null_dim_customers_customer_id.dd91cd1c8d
[0m14:26:38.490725 [debug] [Thread-5  ]: Writing injected SQL for node "test.northwind_dbt.unique_dim_customers_customer_id.15c9f1e2fd"
[0m14:26:38.490725 [debug] [Thread-7  ]: Began compiling node test.northwind_dbt.unique_dim_employees_employee_key.3824d24782
[0m14:26:38.490725 [debug] [Thread-8  ]: Began compiling node test.northwind_dbt.unique_dim_products_product_id.ef7b2a9985
[0m14:26:38.512204 [debug] [Thread-7  ]: Writing injected SQL for node "test.northwind_dbt.unique_dim_employees_employee_key.3824d24782"
[0m14:26:38.515746 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.190 seconds
[0m14:26:38.521031 [debug] [Thread-4  ]: Began executing node test.northwind_dbt.not_null_top_performing_products_product_id.919a185ac6
[0m14:26:38.523044 [debug] [Thread-8  ]: Writing injected SQL for node "test.northwind_dbt.unique_dim_products_product_id.ef7b2a9985"
[0m14:26:38.528348 [debug] [Thread-5  ]: Began executing node test.northwind_dbt.unique_dim_customers_customer_id.15c9f1e2fd
[0m14:26:38.534429 [info ] [Thread-2  ]: 2 of 16 PASS not_null_dim_employees_employee_key ............................... [[32mPASS[0m in 1.57s]
[0m14:26:38.544364 [debug] [Thread-4  ]: Writing runtime sql for node "test.northwind_dbt.not_null_top_performing_products_product_id.919a185ac6"
[0m14:26:38.553363 [debug] [Thread-7  ]: Began executing node test.northwind_dbt.unique_dim_employees_employee_key.3824d24782
[0m14:26:38.554367 [debug] [Thread-5  ]: Writing runtime sql for node "test.northwind_dbt.unique_dim_customers_customer_id.15c9f1e2fd"
[0m14:26:38.555894 [debug] [Thread-2  ]: Finished running node test.northwind_dbt.not_null_dim_employees_employee_key.232a183ffe
[0m14:26:38.566100 [debug] [Thread-7  ]: Writing runtime sql for node "test.northwind_dbt.unique_dim_employees_employee_key.3824d24782"
[0m14:26:38.567100 [debug] [Thread-8  ]: Began executing node test.northwind_dbt.unique_dim_products_product_id.ef7b2a9985
[0m14:26:38.572725 [debug] [Thread-8  ]: Writing runtime sql for node "test.northwind_dbt.unique_dim_products_product_id.ef7b2a9985"
[0m14:26:38.572725 [debug] [Thread-4  ]: Using snowflake connection "test.northwind_dbt.not_null_top_performing_products_product_id.919a185ac6"
[0m14:26:38.581044 [debug] [Thread-4  ]: On test.northwind_dbt.not_null_top_performing_products_product_id.919a185ac6: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "test.northwind_dbt.not_null_top_performing_products_product_id.919a185ac6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_id
from PROJECT_2.PUBLIC.top_performing_products
where product_id is null



      
    ) dbt_internal_test
[0m14:26:38.589310 [debug] [Thread-5  ]: Using snowflake connection "test.northwind_dbt.unique_dim_customers_customer_id.15c9f1e2fd"
[0m14:26:38.589310 [debug] [Thread-5  ]: On test.northwind_dbt.unique_dim_customers_customer_id.15c9f1e2fd: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "test.northwind_dbt.unique_dim_customers_customer_id.15c9f1e2fd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from PROJECT_2.PUBLIC.dim_customers
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m14:26:38.598889 [debug] [Thread-7  ]: Using snowflake connection "test.northwind_dbt.unique_dim_employees_employee_key.3824d24782"
[0m14:26:38.600895 [debug] [Thread-7  ]: On test.northwind_dbt.unique_dim_employees_employee_key.3824d24782: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "test.northwind_dbt.unique_dim_employees_employee_key.3824d24782"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    employee_key as unique_field,
    count(*) as n_records

from PROJECT_2.PUBLIC.dim_employees
where employee_key is not null
group by employee_key
having count(*) > 1



      
    ) dbt_internal_test
[0m14:26:38.602899 [debug] [Thread-8  ]: Using snowflake connection "test.northwind_dbt.unique_dim_products_product_id.ef7b2a9985"
[0m14:26:38.604377 [debug] [Thread-8  ]: On test.northwind_dbt.unique_dim_products_product_id.ef7b2a9985: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "test.northwind_dbt.unique_dim_products_product_id.ef7b2a9985"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    product_id as unique_field,
    count(*) as n_records

from PROJECT_2.PUBLIC.dim_products
where product_id is not null
group by product_id
having count(*) > 1



      
    ) dbt_internal_test
[0m14:26:38.750335 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.169 seconds
[0m14:26:38.754953 [info ] [Thread-4  ]: 13 of 16 PASS not_null_top_performing_products_product_id ...................... [[32mPASS[0m in 0.33s]
[0m14:26:38.754953 [debug] [Thread-4  ]: Finished running node test.northwind_dbt.not_null_top_performing_products_product_id.919a185ac6
[0m14:26:38.853097 [debug] [Thread-5  ]: SQL status: SUCCESS 1 in 0.259 seconds
[0m14:26:38.858083 [info ] [Thread-5  ]: 14 of 16 PASS unique_dim_customers_customer_id ................................. [[32mPASS[0m in 0.42s]
[0m14:26:38.859684 [debug] [Thread-5  ]: Finished running node test.northwind_dbt.unique_dim_customers_customer_id.15c9f1e2fd
[0m14:26:38.980904 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1.725 seconds
[0m14:26:38.984960 [info ] [Thread-3  ]: 3 of 16 PASS not_null_dim_products_product_id .................................. [[32mPASS[0m in 2.02s]
[0m14:26:38.986976 [debug] [Thread-3  ]: Finished running node test.northwind_dbt.not_null_dim_products_product_id.c8aba288d1
[0m14:26:39.010282 [debug] [Thread-10 ]: SQL status: SUCCESS 1 in 1.683 seconds
[0m14:26:39.012921 [info ] [Thread-10 ]: 10 of 16 PASS not_null_obt_orders_product_id ................................... [[32mPASS[0m in 2.04s]
[0m14:26:39.012921 [debug] [Thread-10 ]: Finished running node test.northwind_dbt.not_null_obt_orders_product_id.caa3082c7f
[0m14:26:39.095129 [debug] [Thread-7  ]: SQL status: SUCCESS 1 in 0.493 seconds
[0m14:26:39.098125 [info ] [Thread-7  ]: 15 of 16 PASS unique_dim_employees_employee_key ................................ [[32mPASS[0m in 0.64s]
[0m14:26:39.099128 [debug] [Thread-7  ]: Finished running node test.northwind_dbt.unique_dim_employees_employee_key.3824d24782
[0m14:26:39.139981 [debug] [Thread-8  ]: SQL status: SUCCESS 1 in 0.533 seconds
[0m14:26:39.144430 [info ] [Thread-8  ]: 16 of 16 PASS unique_dim_products_product_id ................................... [[32mPASS[0m in 0.69s]
[0m14:26:39.146632 [debug] [Thread-8  ]: Finished running node test.northwind_dbt.unique_dim_products_product_id.ef7b2a9985
[0m14:26:39.149963 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:26:39.149963 [debug] [MainThread]: Connection 'list_PROJECT_2_snapshots' was left open.
[0m14:26:39.149963 [debug] [MainThread]: On list_PROJECT_2_snapshots: Close
[0m14:26:39.281179 [debug] [MainThread]: Connection 'list_PROJECT_2_PUBLIC' was left open.
[0m14:26:39.281179 [debug] [MainThread]: On list_PROJECT_2_PUBLIC: Close
[0m14:26:39.412552 [debug] [MainThread]: Connection 'test.northwind_dbt.not_null_dim_customers_customer_id.dd91cd1c8d' was left open.
[0m14:26:39.414568 [debug] [MainThread]: On test.northwind_dbt.not_null_dim_customers_customer_id.dd91cd1c8d: Close
[0m14:26:39.569674 [debug] [MainThread]: Connection 'test.northwind_dbt.not_null_dim_products_product_id.c8aba288d1' was left open.
[0m14:26:39.569674 [debug] [MainThread]: On test.northwind_dbt.not_null_dim_products_product_id.c8aba288d1: Close
[0m14:26:39.687649 [debug] [MainThread]: Connection 'test.northwind_dbt.not_null_dim_employees_employee_key.232a183ffe' was left open.
[0m14:26:39.687649 [debug] [MainThread]: On test.northwind_dbt.not_null_dim_employees_employee_key.232a183ffe: Close
[0m14:26:39.813335 [debug] [MainThread]: Connection 'test.northwind_dbt.not_null_top_performing_products_product_id.919a185ac6' was left open.
[0m14:26:39.815371 [debug] [MainThread]: On test.northwind_dbt.not_null_top_performing_products_product_id.919a185ac6: Close
[0m14:26:39.980269 [debug] [MainThread]: Connection 'test.northwind_dbt.unique_dim_customers_customer_id.15c9f1e2fd' was left open.
[0m14:26:39.981276 [debug] [MainThread]: On test.northwind_dbt.unique_dim_customers_customer_id.15c9f1e2fd: Close
[0m14:26:40.114695 [debug] [MainThread]: Connection 'test.northwind_dbt.not_null_fact_order_details_product_id.85713db7b9' was left open.
[0m14:26:40.114695 [debug] [MainThread]: On test.northwind_dbt.not_null_fact_order_details_product_id.85713db7b9: Close
[0m14:26:40.258645 [debug] [MainThread]: Connection 'test.northwind_dbt.unique_dim_employees_employee_key.3824d24782' was left open.
[0m14:26:40.259156 [debug] [MainThread]: On test.northwind_dbt.unique_dim_employees_employee_key.3824d24782: Close
[0m14:26:40.382965 [debug] [MainThread]: Connection 'test.northwind_dbt.unique_dim_products_product_id.ef7b2a9985' was left open.
[0m14:26:40.382965 [debug] [MainThread]: On test.northwind_dbt.unique_dim_products_product_id.ef7b2a9985: Close
[0m14:26:40.514987 [debug] [MainThread]: Connection 'test.northwind_dbt.not_null_obt_orders_order_id.218f605f9c' was left open.
[0m14:26:40.514987 [debug] [MainThread]: On test.northwind_dbt.not_null_obt_orders_order_id.218f605f9c: Close
[0m14:26:40.683955 [debug] [MainThread]: Connection 'test.northwind_dbt.not_null_obt_orders_product_id.caa3082c7f' was left open.
[0m14:26:40.683955 [debug] [MainThread]: On test.northwind_dbt.not_null_obt_orders_product_id.caa3082c7f: Close
[0m14:26:40.870769 [debug] [MainThread]: Connection 'test.northwind_dbt.not_null_top_customer_revenue_customer_id.668bb5e112' was left open.
[0m14:26:40.870769 [debug] [MainThread]: On test.northwind_dbt.not_null_top_customer_revenue_customer_id.668bb5e112: Close
[0m14:26:41.000240 [debug] [MainThread]: Connection 'test.northwind_dbt.not_null_top_employee_revenue_employee_key.cb63db6526' was left open.
[0m14:26:41.004073 [debug] [MainThread]: On test.northwind_dbt.not_null_top_employee_revenue_employee_key.cb63db6526: Close
[0m14:26:41.147953 [info ] [MainThread]: 
[0m14:26:41.147953 [info ] [MainThread]: Finished running 16 data tests in 0 hours 0 minutes and 5.34 seconds (5.34s).
[0m14:26:41.147953 [debug] [MainThread]: Command end result
[0m14:26:41.319931 [debug] [MainThread]: Wrote artifact WritableManifest to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\manifest.json
[0m14:26:41.319931 [debug] [MainThread]: Wrote artifact SemanticManifest to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\semantic_manifest.json
[0m14:26:41.350035 [debug] [MainThread]: Wrote artifact RunExecutionResult to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\run_results.json
[0m14:26:41.350678 [info ] [MainThread]: 
[0m14:26:41.350678 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:26:41.350678 [info ] [MainThread]: 
[0m14:26:41.350678 [info ] [MainThread]: Done. PASS=16 WARN=0 ERROR=0 SKIP=0 TOTAL=16
[0m14:26:41.363368 [debug] [MainThread]: Command `dbt test` succeeded at 14:26:41.360298 after 8.49 seconds
[0m14:26:41.365377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EB0370340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EB16A0A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017ECD0F7C40>]}
[0m14:26:41.366375 [debug] [MainThread]: Flushing usage events
[0m14:26:42.237497 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:06:08.839881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024450C313A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024452CB5B20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024452CB5910>]}


============================== 17:06:08.846503 | 9680ea57-2aa2-426b-ba74-55cc2f0a894e ==============================
[0m17:06:08.846503 [info ] [MainThread]: Running with dbt=1.9.0
[0m17:06:08.848481 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'c:\\Users\\fitzp\\Documents\\Alpaca_Market\\zproject_2\\northwind_psql\\logs', 'debug': 'False', 'profiles_dir': 'c:\\Users\\fitzp\\Documents\\Alpaca_Market\\zproject_2\\northwind_psql', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt snapshot', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:06:11.606113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9680ea57-2aa2-426b-ba74-55cc2f0a894e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002444FC075B0>]}
[0m17:06:11.691811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9680ea57-2aa2-426b-ba74-55cc2f0a894e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244525CCC40>]}
[0m17:06:11.695235 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m17:06:12.206525 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m17:06:12.989984 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:06:12.990989 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:06:12.998081 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.northwind_dbt.marts.bi
[0m17:06:13.075921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9680ea57-2aa2-426b-ba74-55cc2f0a894e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002446BDB4130>]}
[0m17:06:13.372543 [debug] [MainThread]: Wrote artifact WritableManifest to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\manifest.json
[0m17:06:13.382027 [debug] [MainThread]: Wrote artifact SemanticManifest to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\semantic_manifest.json
[0m17:06:13.460433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9680ea57-2aa2-426b-ba74-55cc2f0a894e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002446BDDD6A0>]}
[0m17:06:13.461432 [info ] [MainThread]: Found 13 models, 1 snapshot, 16 data tests, 8 sources, 706 macros
[0m17:06:13.462432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9680ea57-2aa2-426b-ba74-55cc2f0a894e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002446BDCE490>]}
[0m17:06:13.464435 [info ] [MainThread]: 
[0m17:06:13.465431 [info ] [MainThread]: Concurrency: 12 threads (target='dev')
[0m17:06:13.466433 [info ] [MainThread]: 
[0m17:06:13.467431 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:06:13.471434 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_2'
[0m17:06:13.710495 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_2"
[0m17:06:13.711497 [debug] [ThreadPool]: On list_PROJECT_2: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "connection_name": "list_PROJECT_2"} */
show terse schemas in database PROJECT_2
    limit 10000
[0m17:06:13.712499 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:06:14.916141 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.203 seconds
[0m17:06:14.917658 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_2, now create_PROJECT_2_snapshots)
[0m17:06:14.920163 [debug] [ThreadPool]: Creating schema "database: "PROJECT_2"
schema: "snapshots"
"
[0m17:06:14.927742 [debug] [ThreadPool]: Using snowflake connection "create_PROJECT_2_snapshots"
[0m17:06:14.928742 [debug] [ThreadPool]: On create_PROJECT_2_snapshots: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "connection_name": "create_PROJECT_2_snapshots"} */
create schema if not exists PROJECT_2.snapshots
[0m17:06:15.083577 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.154 seconds
[0m17:06:15.094838 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_2_PUBLIC'
[0m17:06:15.107333 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_2_snapshots'
[0m17:06:15.111309 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_2_PUBLIC"
[0m17:06:15.117178 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_2_snapshots"
[0m17:06:15.118375 [debug] [ThreadPool]: On list_PROJECT_2_PUBLIC: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "connection_name": "list_PROJECT_2_PUBLIC"} */
show objects in PROJECT_2.PUBLIC limit 10000;
[0m17:06:15.120388 [debug] [ThreadPool]: On list_PROJECT_2_snapshots: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "connection_name": "list_PROJECT_2_snapshots"} */
show objects in PROJECT_2.snapshots limit 10000;
[0m17:06:15.121397 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:06:15.122440 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:06:15.940298 [debug] [ThreadPool]: SQL status: SUCCESS 27 in 0.819 seconds
[0m17:06:16.052402 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.930 seconds
[0m17:06:16.055399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9680ea57-2aa2-426b-ba74-55cc2f0a894e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002444F312970>]}
[0m17:06:16.064402 [debug] [Thread-1  ]: Began running node snapshot.northwind_dbt.employees_snapshot
[0m17:06:16.065401 [info ] [Thread-1  ]: 1 of 1 START snapshot snapshots.employees_snapshot ............................. [RUN]
[0m17:06:16.067796 [debug] [Thread-1  ]: Acquiring new snowflake connection 'snapshot.northwind_dbt.employees_snapshot'
[0m17:06:16.068807 [debug] [Thread-1  ]: Began compiling node snapshot.northwind_dbt.employees_snapshot
[0m17:06:16.077804 [debug] [Thread-1  ]: Began executing node snapshot.northwind_dbt.employees_snapshot
[0m17:06:16.174919 [debug] [Thread-1  ]: Using snowflake connection "snapshot.northwind_dbt.employees_snapshot"
[0m17:06:16.175918 [debug] [Thread-1  ]: On snapshot.northwind_dbt.employees_snapshot: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "snapshot.northwind_dbt.employees_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "snapshot.northwind_dbt.employees_snapshot"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(employee_id as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
        
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
from (
        

select * from PROJECT_2.PUBLIC.stg_employees
    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m17:06:16.176918 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m17:06:17.983694 [debug] [Thread-1  ]: SQL status: SUCCESS 0 in 1.807 seconds
[0m17:06:17.989170 [debug] [Thread-1  ]: Using snowflake connection "snapshot.northwind_dbt.employees_snapshot"
[0m17:06:17.990174 [debug] [Thread-1  ]: On snapshot.northwind_dbt.employees_snapshot: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "snapshot.northwind_dbt.employees_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "snapshot.northwind_dbt.employees_snapshot"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m17:06:18.189357 [debug] [Thread-1  ]: SQL status: SUCCESS 0 in 0.198 seconds
[0m17:06:18.190353 [debug] [Thread-1  ]: Writing runtime sql for node "snapshot.northwind_dbt.employees_snapshot"
[0m17:06:18.198005 [debug] [Thread-1  ]: Using snowflake connection "snapshot.northwind_dbt.employees_snapshot"
[0m17:06:18.199015 [debug] [Thread-1  ]: On snapshot.northwind_dbt.employees_snapshot: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "snapshot.northwind_dbt.employees_snapshot"} */
create or replace transient table PROJECT_2.snapshots.employees_snapshot
         as
        (
    

    select *,
        md5(coalesce(cast(employee_id as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
        
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
from (
        

select * from PROJECT_2.PUBLIC.stg_employees
    ) sbq



        );
[0m17:06:19.929284 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.730 seconds
[0m17:06:19.970954 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9680ea57-2aa2-426b-ba74-55cc2f0a894e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002446C530550>]}
[0m17:06:19.972630 [info ] [Thread-1  ]: 1 of 1 OK snapshotted snapshots.employees_snapshot ............................. [[32mSUCCESS 1[0m in 3.89s]
[0m17:06:19.974212 [debug] [Thread-1  ]: Finished running node snapshot.northwind_dbt.employees_snapshot
[0m17:06:19.977992 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:06:19.979720 [debug] [MainThread]: Connection 'create_PROJECT_2_snapshots' was left open.
[0m17:06:19.980253 [debug] [MainThread]: On create_PROJECT_2_snapshots: Close
[0m17:06:20.107209 [debug] [MainThread]: Connection 'list_PROJECT_2_PUBLIC' was left open.
[0m17:06:20.108110 [debug] [MainThread]: On list_PROJECT_2_PUBLIC: Close
[0m17:06:20.266252 [debug] [MainThread]: Connection 'list_PROJECT_2_snapshots' was left open.
[0m17:06:20.267348 [debug] [MainThread]: On list_PROJECT_2_snapshots: Close
[0m17:06:20.443373 [debug] [MainThread]: Connection 'snapshot.northwind_dbt.employees_snapshot' was left open.
[0m17:06:20.445023 [debug] [MainThread]: On snapshot.northwind_dbt.employees_snapshot: Close
[0m17:06:20.569633 [info ] [MainThread]: 
[0m17:06:20.571146 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 7.10 seconds (7.10s).
[0m17:06:20.574637 [debug] [MainThread]: Command end result
[0m17:06:20.797471 [debug] [MainThread]: Wrote artifact WritableManifest to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\manifest.json
[0m17:06:20.811384 [debug] [MainThread]: Wrote artifact SemanticManifest to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\semantic_manifest.json
[0m17:06:20.834472 [debug] [MainThread]: Wrote artifact RunExecutionResult to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\run_results.json
[0m17:06:20.836324 [info ] [MainThread]: 
[0m17:06:20.838507 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:06:20.840639 [info ] [MainThread]: 
[0m17:06:20.842783 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:06:20.846511 [debug] [MainThread]: Command `dbt snapshot` succeeded at 17:06:20.846511 after 12.13 seconds
[0m17:06:20.849031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024450C313A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024451F86100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002446C4DF8B0>]}
[0m17:06:20.850943 [debug] [MainThread]: Flushing usage events
[0m17:06:22.076391 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:21:38.617268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD7EED03A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD7FF46A60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD7FF46E50>]}


============================== 17:21:38.626260 | 81b54c9e-0430-4360-a9e9-8dc63969ca4b ==============================
[0m17:21:38.626260 [info ] [MainThread]: Running with dbt=1.9.0
[0m17:21:38.628261 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'c:\\Users\\fitzp\\Documents\\Alpaca_Market\\zproject_2\\northwind_psql\\logs', 'version_check': 'True', 'profiles_dir': 'c:\\Users\\fitzp\\Documents\\Alpaca_Market\\zproject_2\\northwind_psql', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt docs generate', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:21:40.717708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '81b54c9e-0430-4360-a9e9-8dc63969ca4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD199ACC40>]}
[0m17:21:40.884406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '81b54c9e-0430-4360-a9e9-8dc63969ca4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD7F89CBB0>]}
[0m17:21:40.887041 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m17:21:41.889103 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m17:21:42.513330 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:21:42.513330 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:21:42.521854 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.northwind_dbt.marts.bi
[0m17:21:42.631722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '81b54c9e-0430-4360-a9e9-8dc63969ca4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD1A04B130>]}
[0m17:21:42.724461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '81b54c9e-0430-4360-a9e9-8dc63969ca4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD19A56790>]}
[0m17:21:42.725465 [info ] [MainThread]: Found 13 models, 1 snapshot, 16 data tests, 8 sources, 706 macros
[0m17:21:42.727462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '81b54c9e-0430-4360-a9e9-8dc63969ca4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD19A56DF0>]}
[0m17:21:42.730464 [info ] [MainThread]: 
[0m17:21:42.732462 [info ] [MainThread]: Concurrency: 12 threads (target='dev')
[0m17:21:42.733464 [info ] [MainThread]: 
[0m17:21:42.735971 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:21:42.749715 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_2_PUBLIC'
[0m17:21:42.751713 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_2_snapshots'
[0m17:21:42.980200 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_2_PUBLIC"
[0m17:21:42.981202 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_2_snapshots"
[0m17:21:42.983202 [debug] [ThreadPool]: On list_PROJECT_2_PUBLIC: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "connection_name": "list_PROJECT_2_PUBLIC"} */
show objects in PROJECT_2.PUBLIC limit 10000;
[0m17:21:42.984200 [debug] [ThreadPool]: On list_PROJECT_2_snapshots: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "connection_name": "list_PROJECT_2_snapshots"} */
show objects in PROJECT_2.snapshots limit 10000;
[0m17:21:42.985721 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:21:42.987722 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:21:43.878904 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.892 seconds
[0m17:21:43.892901 [debug] [ThreadPool]: SQL status: SUCCESS 27 in 0.908 seconds
[0m17:21:43.913782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '81b54c9e-0430-4360-a9e9-8dc63969ca4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD199F2310>]}
[0m17:21:43.926317 [debug] [Thread-1  ]: Began running node model.northwind_dbt.stg_customers
[0m17:21:43.928311 [debug] [Thread-2  ]: Began running node model.northwind_dbt.stg_employees
[0m17:21:43.929311 [debug] [Thread-3  ]: Began running node model.northwind_dbt.stg_order_details
[0m17:21:43.930325 [debug] [Thread-4  ]: Began running node model.northwind_dbt.stg_orders
[0m17:21:43.932316 [debug] [Thread-5  ]: Began running node model.northwind_dbt.stg_products
[0m17:21:43.934308 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.northwind_dbt.stg_customers'
[0m17:21:43.937313 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.northwind_dbt.stg_employees'
[0m17:21:43.939309 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.northwind_dbt.stg_order_details'
[0m17:21:43.942308 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.northwind_dbt.stg_orders'
[0m17:21:43.945306 [debug] [Thread-5  ]: Acquiring new snowflake connection 'model.northwind_dbt.stg_products'
[0m17:21:43.948325 [debug] [Thread-1  ]: Began compiling node model.northwind_dbt.stg_customers
[0m17:21:43.950307 [debug] [Thread-2  ]: Began compiling node model.northwind_dbt.stg_employees
[0m17:21:43.952308 [debug] [Thread-3  ]: Began compiling node model.northwind_dbt.stg_order_details
[0m17:21:43.955306 [debug] [Thread-4  ]: Began compiling node model.northwind_dbt.stg_orders
[0m17:21:43.957309 [debug] [Thread-5  ]: Began compiling node model.northwind_dbt.stg_products
[0m17:21:43.983000 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind_dbt.stg_customers"
[0m17:21:43.993532 [debug] [Thread-2  ]: Writing injected SQL for node "model.northwind_dbt.stg_employees"
[0m17:21:44.002717 [debug] [Thread-3  ]: Writing injected SQL for node "model.northwind_dbt.stg_order_details"
[0m17:21:44.012728 [debug] [Thread-4  ]: Writing injected SQL for node "model.northwind_dbt.stg_orders"
[0m17:21:44.022253 [debug] [Thread-5  ]: Writing injected SQL for node "model.northwind_dbt.stg_products"
[0m17:21:44.082875 [debug] [Thread-3  ]: Began executing node model.northwind_dbt.stg_order_details
[0m17:21:44.086169 [debug] [Thread-1  ]: Began executing node model.northwind_dbt.stg_customers
[0m17:21:44.099098 [debug] [Thread-1  ]: Finished running node model.northwind_dbt.stg_customers
[0m17:21:44.093328 [debug] [Thread-3  ]: Finished running node model.northwind_dbt.stg_order_details
[0m17:21:44.095840 [debug] [Thread-4  ]: Began executing node model.northwind_dbt.stg_orders
[0m17:21:44.114156 [debug] [Thread-4  ]: Finished running node model.northwind_dbt.stg_orders
[0m17:21:44.088179 [debug] [Thread-2  ]: Began executing node model.northwind_dbt.stg_employees
[0m17:21:44.105803 [debug] [Thread-7  ]: Began running node model.northwind_dbt.dim_customers
[0m17:21:44.102396 [debug] [Thread-5  ]: Began executing node model.northwind_dbt.stg_products
[0m17:21:44.117156 [debug] [Thread-9  ]: Began running node model.northwind_dbt.fact_order_details
[0m17:21:44.119153 [debug] [Thread-2  ]: Finished running node model.northwind_dbt.stg_employees
[0m17:21:44.121158 [debug] [Thread-7  ]: Acquiring new snowflake connection 'model.northwind_dbt.dim_customers'
[0m17:21:44.124680 [debug] [Thread-5  ]: Finished running node model.northwind_dbt.stg_products
[0m17:21:44.131450 [debug] [Thread-9  ]: Acquiring new snowflake connection 'model.northwind_dbt.fact_order_details'
[0m17:21:44.141446 [debug] [Thread-9  ]: Began compiling node model.northwind_dbt.fact_order_details
[0m17:21:44.135444 [debug] [Thread-12 ]: Began running node snapshot.northwind_dbt.employees_snapshot
[0m17:21:44.137444 [debug] [Thread-7  ]: Began compiling node model.northwind_dbt.dim_customers
[0m17:21:44.139442 [debug] [Thread-1  ]: Began running node model.northwind_dbt.dim_products
[0m17:21:44.200872 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.northwind_dbt.stg_customers, now model.northwind_dbt.dim_products)
[0m17:21:44.133445 [debug] [Thread-11 ]: Began running node model.northwind_dbt.dim_employees
[0m17:21:44.174307 [debug] [Thread-12 ]: Acquiring new snowflake connection 'snapshot.northwind_dbt.employees_snapshot'
[0m17:21:44.215158 [debug] [Thread-12 ]: Began compiling node snapshot.northwind_dbt.employees_snapshot
[0m17:21:44.201871 [debug] [Thread-1  ]: Began compiling node model.northwind_dbt.dim_products
[0m17:21:44.206871 [debug] [Thread-7  ]: Writing injected SQL for node "model.northwind_dbt.dim_customers"
[0m17:21:44.210881 [debug] [Thread-11 ]: Acquiring new snowflake connection 'model.northwind_dbt.dim_employees'
[0m17:21:44.284565 [debug] [Thread-11 ]: Began compiling node model.northwind_dbt.dim_employees
[0m17:21:44.172301 [debug] [Thread-9  ]: Writing injected SQL for node "model.northwind_dbt.fact_order_details"
[0m17:21:44.240661 [debug] [Thread-12 ]: Began executing node snapshot.northwind_dbt.employees_snapshot
[0m17:21:44.344389 [debug] [Thread-7  ]: Began executing node model.northwind_dbt.dim_customers
[0m17:21:44.373804 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind_dbt.dim_products"
[0m17:21:44.433757 [debug] [Thread-12 ]: Finished running node snapshot.northwind_dbt.employees_snapshot
[0m17:21:44.451764 [debug] [Thread-11 ]: Writing injected SQL for node "model.northwind_dbt.dim_employees"
[0m17:21:44.453772 [debug] [Thread-7  ]: Finished running node model.northwind_dbt.dim_customers
[0m17:21:44.459998 [debug] [Thread-8  ]: Began running node test.northwind_dbt.not_null_dim_customers_customer_id.dd91cd1c8d
[0m17:21:44.460997 [debug] [Thread-4  ]: Began running node test.northwind_dbt.unique_dim_customers_customer_id.15c9f1e2fd
[0m17:21:44.465997 [debug] [Thread-8  ]: Acquiring new snowflake connection 'test.northwind_dbt.not_null_dim_customers_customer_id.dd91cd1c8d'
[0m17:21:44.467997 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.northwind_dbt.stg_orders, now test.northwind_dbt.unique_dim_customers_customer_id.15c9f1e2fd)
[0m17:21:44.470996 [debug] [Thread-8  ]: Began compiling node test.northwind_dbt.not_null_dim_customers_customer_id.dd91cd1c8d
[0m17:21:44.471993 [debug] [Thread-4  ]: Began compiling node test.northwind_dbt.unique_dim_customers_customer_id.15c9f1e2fd
[0m17:21:44.498996 [debug] [Thread-1  ]: Began executing node model.northwind_dbt.dim_products
[0m17:21:44.505997 [debug] [Thread-9  ]: Began executing node model.northwind_dbt.fact_order_details
[0m17:21:44.540564 [debug] [Thread-4  ]: Writing injected SQL for node "test.northwind_dbt.unique_dim_customers_customer_id.15c9f1e2fd"
[0m17:21:44.541574 [debug] [Thread-8  ]: Writing injected SQL for node "test.northwind_dbt.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m17:21:44.544575 [debug] [Thread-1  ]: Finished running node model.northwind_dbt.dim_products
[0m17:21:44.547575 [debug] [Thread-9  ]: Finished running node model.northwind_dbt.fact_order_details
[0m17:21:44.548574 [debug] [Thread-11 ]: Began executing node model.northwind_dbt.dim_employees
[0m17:21:44.552575 [debug] [Thread-2  ]: Began running node test.northwind_dbt.not_null_dim_products_product_id.c8aba288d1
[0m17:21:44.553575 [debug] [Thread-6  ]: Began running node test.northwind_dbt.unique_dim_products_product_id.ef7b2a9985
[0m17:21:44.555575 [debug] [Thread-3  ]: Began running node model.northwind_dbt.top_customer_revenue
[0m17:21:44.556658 [debug] [Thread-12 ]: Began running node model.northwind_dbt.top_performing_products
[0m17:21:44.557671 [debug] [Thread-7  ]: Began running node test.northwind_dbt.not_null_fact_order_details_customer_id.6aaefe4888
[0m17:21:44.560670 [debug] [Thread-11 ]: Finished running node model.northwind_dbt.dim_employees
[0m17:21:44.561669 [debug] [Thread-10 ]: Began running node test.northwind_dbt.not_null_fact_order_details_order_id.8d47c14c82
[0m17:21:44.562672 [debug] [Thread-1  ]: Began running node test.northwind_dbt.not_null_fact_order_details_product_id.85713db7b9
[0m17:21:44.564672 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.northwind_dbt.stg_employees, now test.northwind_dbt.not_null_dim_products_product_id.c8aba288d1)
[0m17:21:44.567669 [debug] [Thread-6  ]: Acquiring new snowflake connection 'test.northwind_dbt.unique_dim_products_product_id.ef7b2a9985'
[0m17:21:44.568672 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.northwind_dbt.stg_order_details, now model.northwind_dbt.top_customer_revenue)
[0m17:21:44.570672 [debug] [Thread-12 ]: Re-using an available connection from the pool (formerly snapshot.northwind_dbt.employees_snapshot, now model.northwind_dbt.top_performing_products)
[0m17:21:44.571672 [debug] [Thread-4  ]: Began executing node test.northwind_dbt.unique_dim_customers_customer_id.15c9f1e2fd
[0m17:21:44.573670 [debug] [Thread-7  ]: Re-using an available connection from the pool (formerly model.northwind_dbt.dim_customers, now test.northwind_dbt.not_null_fact_order_details_customer_id.6aaefe4888)
[0m17:21:44.574669 [debug] [Thread-8  ]: Began executing node test.northwind_dbt.not_null_dim_customers_customer_id.dd91cd1c8d
[0m17:21:44.576101 [debug] [Thread-9  ]: Began running node model.northwind_dbt.obt_orders
[0m17:21:44.579481 [debug] [Thread-10 ]: Acquiring new snowflake connection 'test.northwind_dbt.not_null_fact_order_details_order_id.8d47c14c82'
[0m17:21:44.580495 [debug] [Thread-5  ]: Began running node model.northwind_dbt.top_employee_revenue
[0m17:21:44.582492 [debug] [Thread-11 ]: Began running node test.northwind_dbt.not_null_dim_employees_employee_key.232a183ffe
[0m17:21:44.583494 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.northwind_dbt.dim_products, now test.northwind_dbt.not_null_fact_order_details_product_id.85713db7b9)
[0m17:21:44.585497 [debug] [Thread-2  ]: Began compiling node test.northwind_dbt.not_null_dim_products_product_id.c8aba288d1
[0m17:21:44.586496 [debug] [Thread-6  ]: Began compiling node test.northwind_dbt.unique_dim_products_product_id.ef7b2a9985
[0m17:21:44.588493 [debug] [Thread-3  ]: Began compiling node model.northwind_dbt.top_customer_revenue
[0m17:21:44.589494 [debug] [Thread-12 ]: Began compiling node model.northwind_dbt.top_performing_products
[0m17:21:44.591496 [debug] [Thread-4  ]: Finished running node test.northwind_dbt.unique_dim_customers_customer_id.15c9f1e2fd
[0m17:21:44.593492 [debug] [Thread-7  ]: Began compiling node test.northwind_dbt.not_null_fact_order_details_customer_id.6aaefe4888
[0m17:21:44.595848 [debug] [Thread-8  ]: Finished running node test.northwind_dbt.not_null_dim_customers_customer_id.dd91cd1c8d
[0m17:21:44.597870 [debug] [Thread-9  ]: Re-using an available connection from the pool (formerly model.northwind_dbt.fact_order_details, now model.northwind_dbt.obt_orders)
[0m17:21:44.600139 [debug] [Thread-10 ]: Began compiling node test.northwind_dbt.not_null_fact_order_details_order_id.8d47c14c82
[0m17:21:44.601586 [debug] [Thread-5  ]: Re-using an available connection from the pool (formerly model.northwind_dbt.stg_products, now model.northwind_dbt.top_employee_revenue)
[0m17:21:44.605293 [debug] [Thread-11 ]: Re-using an available connection from the pool (formerly model.northwind_dbt.dim_employees, now test.northwind_dbt.not_null_dim_employees_employee_key.232a183ffe)
[0m17:21:44.607294 [debug] [Thread-1  ]: Began compiling node test.northwind_dbt.not_null_fact_order_details_product_id.85713db7b9
[0m17:21:44.621304 [debug] [Thread-2  ]: Writing injected SQL for node "test.northwind_dbt.not_null_dim_products_product_id.c8aba288d1"
[0m17:21:44.632852 [debug] [Thread-6  ]: Writing injected SQL for node "test.northwind_dbt.unique_dim_products_product_id.ef7b2a9985"
[0m17:21:44.642470 [debug] [Thread-3  ]: Writing injected SQL for node "model.northwind_dbt.top_customer_revenue"
[0m17:21:44.655229 [debug] [Thread-12 ]: Writing injected SQL for node "model.northwind_dbt.top_performing_products"
[0m17:21:44.656230 [debug] [Thread-4  ]: Began running node test.northwind_dbt.unique_dim_employees_employee_key.3824d24782
[0m17:21:44.670674 [debug] [Thread-7  ]: Writing injected SQL for node "test.northwind_dbt.not_null_fact_order_details_customer_id.6aaefe4888"
[0m17:21:44.672676 [debug] [Thread-9  ]: Began compiling node model.northwind_dbt.obt_orders
[0m17:21:44.684674 [debug] [Thread-10 ]: Writing injected SQL for node "test.northwind_dbt.not_null_fact_order_details_order_id.8d47c14c82"
[0m17:21:44.686674 [debug] [Thread-5  ]: Began compiling node model.northwind_dbt.top_employee_revenue
[0m17:21:44.687674 [debug] [Thread-11 ]: Began compiling node test.northwind_dbt.not_null_dim_employees_employee_key.232a183ffe
[0m17:21:44.700677 [debug] [Thread-1  ]: Writing injected SQL for node "test.northwind_dbt.not_null_fact_order_details_product_id.85713db7b9"
[0m17:21:44.705674 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.northwind_dbt.unique_dim_customers_customer_id.15c9f1e2fd, now test.northwind_dbt.unique_dim_employees_employee_key.3824d24782)
[0m17:21:44.722701 [debug] [Thread-9  ]: Writing injected SQL for node "model.northwind_dbt.obt_orders"
[0m17:21:44.735743 [debug] [Thread-5  ]: Writing injected SQL for node "model.northwind_dbt.top_employee_revenue"
[0m17:21:44.738041 [debug] [Thread-2  ]: Began executing node test.northwind_dbt.not_null_dim_products_product_id.c8aba288d1
[0m17:21:44.744150 [debug] [Thread-6  ]: Began executing node test.northwind_dbt.unique_dim_products_product_id.ef7b2a9985
[0m17:21:44.746320 [debug] [Thread-3  ]: Began executing node model.northwind_dbt.top_customer_revenue
[0m17:21:44.747320 [debug] [Thread-12 ]: Began executing node model.northwind_dbt.top_performing_products
[0m17:21:44.751397 [debug] [Thread-11 ]: Writing injected SQL for node "test.northwind_dbt.not_null_dim_employees_employee_key.232a183ffe"
[0m17:21:44.752398 [debug] [Thread-10 ]: Began executing node test.northwind_dbt.not_null_fact_order_details_order_id.8d47c14c82
[0m17:21:44.754394 [debug] [Thread-4  ]: Began compiling node test.northwind_dbt.unique_dim_employees_employee_key.3824d24782
[0m17:21:44.755395 [debug] [Thread-7  ]: Began executing node test.northwind_dbt.not_null_fact_order_details_customer_id.6aaefe4888
[0m17:21:44.762710 [debug] [Thread-2  ]: Finished running node test.northwind_dbt.not_null_dim_products_product_id.c8aba288d1
[0m17:21:44.765712 [debug] [Thread-6  ]: Finished running node test.northwind_dbt.unique_dim_products_product_id.ef7b2a9985
[0m17:21:44.767831 [debug] [Thread-3  ]: Finished running node model.northwind_dbt.top_customer_revenue
[0m17:21:44.770832 [debug] [Thread-12 ]: Finished running node model.northwind_dbt.top_performing_products
[0m17:21:44.774835 [debug] [Thread-10 ]: Finished running node test.northwind_dbt.not_null_fact_order_details_order_id.8d47c14c82
[0m17:21:44.775833 [debug] [Thread-1  ]: Began executing node test.northwind_dbt.not_null_fact_order_details_product_id.85713db7b9
[0m17:21:44.776832 [debug] [Thread-9  ]: Began executing node model.northwind_dbt.obt_orders
[0m17:21:44.777832 [debug] [Thread-5  ]: Began executing node model.northwind_dbt.top_employee_revenue
[0m17:21:44.790838 [debug] [Thread-4  ]: Writing injected SQL for node "test.northwind_dbt.unique_dim_employees_employee_key.3824d24782"
[0m17:21:44.794355 [debug] [Thread-7  ]: Finished running node test.northwind_dbt.not_null_fact_order_details_customer_id.6aaefe4888
[0m17:21:44.795370 [debug] [Thread-11 ]: Began executing node test.northwind_dbt.not_null_dim_employees_employee_key.232a183ffe
[0m17:21:44.800368 [debug] [Thread-8  ]: Began running node test.northwind_dbt.not_null_top_customer_revenue_customer_id.668bb5e112
[0m17:21:44.801380 [debug] [Thread-6  ]: Began running node test.northwind_dbt.not_null_top_performing_products_product_id.919a185ac6
[0m17:21:44.806730 [debug] [Thread-1  ]: Finished running node test.northwind_dbt.not_null_fact_order_details_product_id.85713db7b9
[0m17:21:44.811433 [debug] [Thread-9  ]: Finished running node model.northwind_dbt.obt_orders
[0m17:21:44.815867 [debug] [Thread-5  ]: Finished running node model.northwind_dbt.top_employee_revenue
[0m17:21:44.820401 [debug] [Thread-11 ]: Finished running node test.northwind_dbt.not_null_dim_employees_employee_key.232a183ffe
[0m17:21:44.822906 [debug] [Thread-8  ]: Re-using an available connection from the pool (formerly test.northwind_dbt.not_null_dim_customers_customer_id.dd91cd1c8d, now test.northwind_dbt.not_null_top_customer_revenue_customer_id.668bb5e112)
[0m17:21:44.825622 [debug] [Thread-6  ]: Re-using an available connection from the pool (formerly test.northwind_dbt.unique_dim_products_product_id.ef7b2a9985, now test.northwind_dbt.not_null_top_performing_products_product_id.919a185ac6)
[0m17:21:44.830105 [debug] [Thread-2  ]: Began running node test.northwind_dbt.not_null_obt_orders_customer_id.1e3c4ae465
[0m17:21:44.832108 [debug] [Thread-12 ]: Began running node test.northwind_dbt.not_null_obt_orders_order_date.5632203db3
[0m17:21:44.833125 [debug] [Thread-4  ]: Began executing node test.northwind_dbt.unique_dim_employees_employee_key.3824d24782
[0m17:21:44.834136 [debug] [Thread-3  ]: Began running node test.northwind_dbt.not_null_obt_orders_order_id.218f605f9c
[0m17:21:44.835141 [debug] [Thread-10 ]: Began running node test.northwind_dbt.not_null_obt_orders_product_id.caa3082c7f
[0m17:21:44.837153 [debug] [Thread-1  ]: Began running node test.northwind_dbt.not_null_top_employee_revenue_employee_key.cb63db6526
[0m17:21:44.839851 [debug] [Thread-8  ]: Began compiling node test.northwind_dbt.not_null_top_customer_revenue_customer_id.668bb5e112
[0m17:21:44.841851 [debug] [Thread-6  ]: Began compiling node test.northwind_dbt.not_null_top_performing_products_product_id.919a185ac6
[0m17:21:44.843849 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.northwind_dbt.not_null_dim_products_product_id.c8aba288d1, now test.northwind_dbt.not_null_obt_orders_customer_id.1e3c4ae465)
[0m17:21:44.845850 [debug] [Thread-12 ]: Re-using an available connection from the pool (formerly model.northwind_dbt.top_performing_products, now test.northwind_dbt.not_null_obt_orders_order_date.5632203db3)
[0m17:21:44.848844 [debug] [Thread-4  ]: Finished running node test.northwind_dbt.unique_dim_employees_employee_key.3824d24782
[0m17:21:44.851314 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.northwind_dbt.top_customer_revenue, now test.northwind_dbt.not_null_obt_orders_order_id.218f605f9c)
[0m17:21:44.854331 [debug] [Thread-10 ]: Re-using an available connection from the pool (formerly test.northwind_dbt.not_null_fact_order_details_order_id.8d47c14c82, now test.northwind_dbt.not_null_obt_orders_product_id.caa3082c7f)
[0m17:21:44.857321 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.northwind_dbt.not_null_fact_order_details_product_id.85713db7b9, now test.northwind_dbt.not_null_top_employee_revenue_employee_key.cb63db6526)
[0m17:21:44.871336 [debug] [Thread-8  ]: Writing injected SQL for node "test.northwind_dbt.not_null_top_customer_revenue_customer_id.668bb5e112"
[0m17:21:44.890683 [debug] [Thread-6  ]: Writing injected SQL for node "test.northwind_dbt.not_null_top_performing_products_product_id.919a185ac6"
[0m17:21:44.892667 [debug] [Thread-2  ]: Began compiling node test.northwind_dbt.not_null_obt_orders_customer_id.1e3c4ae465
[0m17:21:44.896024 [debug] [Thread-12 ]: Began compiling node test.northwind_dbt.not_null_obt_orders_order_date.5632203db3
[0m17:21:44.899033 [debug] [Thread-3  ]: Began compiling node test.northwind_dbt.not_null_obt_orders_order_id.218f605f9c
[0m17:21:44.901039 [debug] [Thread-10 ]: Began compiling node test.northwind_dbt.not_null_obt_orders_product_id.caa3082c7f
[0m17:21:44.903331 [debug] [Thread-1  ]: Began compiling node test.northwind_dbt.not_null_top_employee_revenue_employee_key.cb63db6526
[0m17:21:44.921770 [debug] [Thread-2  ]: Writing injected SQL for node "test.northwind_dbt.not_null_obt_orders_customer_id.1e3c4ae465"
[0m17:21:44.929869 [debug] [Thread-8  ]: Began executing node test.northwind_dbt.not_null_top_customer_revenue_customer_id.668bb5e112
[0m17:21:44.939184 [debug] [Thread-12 ]: Writing injected SQL for node "test.northwind_dbt.not_null_obt_orders_order_date.5632203db3"
[0m17:21:44.954713 [debug] [Thread-3  ]: Writing injected SQL for node "test.northwind_dbt.not_null_obt_orders_order_id.218f605f9c"
[0m17:21:44.968712 [debug] [Thread-10 ]: Writing injected SQL for node "test.northwind_dbt.not_null_obt_orders_product_id.caa3082c7f"
[0m17:21:44.969710 [debug] [Thread-6  ]: Began executing node test.northwind_dbt.not_null_top_performing_products_product_id.919a185ac6
[0m17:21:44.986667 [debug] [Thread-1  ]: Writing injected SQL for node "test.northwind_dbt.not_null_top_employee_revenue_employee_key.cb63db6526"
[0m17:21:44.990656 [debug] [Thread-8  ]: Finished running node test.northwind_dbt.not_null_top_customer_revenue_customer_id.668bb5e112
[0m17:21:45.000090 [debug] [Thread-6  ]: Finished running node test.northwind_dbt.not_null_top_performing_products_product_id.919a185ac6
[0m17:21:45.017430 [debug] [Thread-12 ]: Began executing node test.northwind_dbt.not_null_obt_orders_order_date.5632203db3
[0m17:21:45.023938 [debug] [Thread-2  ]: Began executing node test.northwind_dbt.not_null_obt_orders_customer_id.1e3c4ae465
[0m17:21:45.027953 [debug] [Thread-3  ]: Began executing node test.northwind_dbt.not_null_obt_orders_order_id.218f605f9c
[0m17:21:45.029947 [debug] [Thread-1  ]: Began executing node test.northwind_dbt.not_null_top_employee_revenue_employee_key.cb63db6526
[0m17:21:45.032465 [debug] [Thread-10 ]: Began executing node test.northwind_dbt.not_null_obt_orders_product_id.caa3082c7f
[0m17:21:45.034018 [debug] [Thread-12 ]: Finished running node test.northwind_dbt.not_null_obt_orders_order_date.5632203db3
[0m17:21:45.041030 [debug] [Thread-2  ]: Finished running node test.northwind_dbt.not_null_obt_orders_customer_id.1e3c4ae465
[0m17:21:45.045963 [debug] [Thread-3  ]: Finished running node test.northwind_dbt.not_null_obt_orders_order_id.218f605f9c
[0m17:21:45.048984 [debug] [Thread-1  ]: Finished running node test.northwind_dbt.not_null_top_employee_revenue_employee_key.cb63db6526
[0m17:21:45.055501 [debug] [Thread-10 ]: Finished running node test.northwind_dbt.not_null_obt_orders_product_id.caa3082c7f
[0m17:21:45.066239 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:21:45.070174 [debug] [MainThread]: Connection 'list_PROJECT_2_PUBLIC' was left open.
[0m17:21:45.072450 [debug] [MainThread]: On list_PROJECT_2_PUBLIC: Close
[0m17:21:45.242282 [debug] [MainThread]: Connection 'list_PROJECT_2_snapshots' was left open.
[0m17:21:45.245292 [debug] [MainThread]: On list_PROJECT_2_snapshots: Close
[0m17:21:45.461519 [debug] [MainThread]: Connection 'test.northwind_dbt.not_null_top_employee_revenue_employee_key.cb63db6526' was properly closed.
[0m17:21:45.465519 [debug] [MainThread]: Connection 'test.northwind_dbt.not_null_obt_orders_customer_id.1e3c4ae465' was properly closed.
[0m17:21:45.467521 [debug] [MainThread]: Connection 'test.northwind_dbt.not_null_obt_orders_order_id.218f605f9c' was properly closed.
[0m17:21:45.468523 [debug] [MainThread]: Connection 'test.northwind_dbt.unique_dim_employees_employee_key.3824d24782' was properly closed.
[0m17:21:45.470523 [debug] [MainThread]: Connection 'model.northwind_dbt.top_employee_revenue' was properly closed.
[0m17:21:45.472520 [debug] [MainThread]: Connection 'test.northwind_dbt.not_null_fact_order_details_customer_id.6aaefe4888' was properly closed.
[0m17:21:45.476517 [debug] [MainThread]: Connection 'model.northwind_dbt.obt_orders' was properly closed.
[0m17:21:45.483576 [debug] [MainThread]: Connection 'test.northwind_dbt.not_null_obt_orders_order_date.5632203db3' was properly closed.
[0m17:21:45.487575 [debug] [MainThread]: Connection 'test.northwind_dbt.not_null_dim_employees_employee_key.232a183ffe' was properly closed.
[0m17:21:45.491794 [debug] [MainThread]: Connection 'test.northwind_dbt.not_null_top_customer_revenue_customer_id.668bb5e112' was properly closed.
[0m17:21:45.497287 [debug] [MainThread]: Connection 'test.northwind_dbt.not_null_top_performing_products_product_id.919a185ac6' was properly closed.
[0m17:21:45.498284 [debug] [MainThread]: Connection 'test.northwind_dbt.not_null_obt_orders_product_id.caa3082c7f' was properly closed.
[0m17:21:45.514562 [debug] [MainThread]: Command end result
[0m17:21:46.104623 [debug] [MainThread]: Wrote artifact WritableManifest to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\manifest.json
[0m17:21:46.117494 [debug] [MainThread]: Wrote artifact SemanticManifest to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\semantic_manifest.json
[0m17:21:46.158096 [debug] [MainThread]: Wrote artifact RunExecutionResult to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\run_results.json
[0m17:21:47.032665 [debug] [MainThread]: Acquiring new snowflake connection 'generate_catalog'
[0m17:21:47.038691 [info ] [MainThread]: Building catalog
[0m17:21:47.095526 [debug] [ThreadPool]: Acquiring new snowflake connection 'PROJECT_2.information_schema'
[0m17:21:47.169580 [debug] [ThreadPool]: Using snowflake connection "PROJECT_2.information_schema"
[0m17:21:47.173593 [debug] [ThreadPool]: On PROJECT_2.information_schema: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "connection_name": "PROJECT_2.information_schema"} */
with tables as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",
        case
            when is_dynamic = 'YES' and table_type = 'BASE TABLE' THEN 'DYNAMIC TABLE'
            else table_type
        end as "table_type",
        comment as "table_comment",

        -- note: this is the _role_ that owns the table
        table_owner as "table_owner",

        'Clustering Key' as "stats:clustering_key:label",
        clustering_key as "stats:clustering_key:value",
        'The key used to cluster this table' as "stats:clustering_key:description",
        (clustering_key is not null) as "stats:clustering_key:include",

        'Row Count' as "stats:row_count:label",
        row_count as "stats:row_count:value",
        'An approximate count of rows in this table' as "stats:row_count:description",
        (row_count is not null) as "stats:row_count:include",

        'Approximate Size' as "stats:bytes:label",
        bytes as "stats:bytes:value",
        'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
        (bytes is not null) as "stats:bytes:include",

        'Last Modified' as "stats:last_modified:label",
        to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
        'The timestamp for last update/change' as "stats:last_modified:description",
        (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"
    from PROJECT_2.INFORMATION_SCHEMA.tables
            where (
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'customers' and upper("table_name") = upper('customers')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'top_employee_revenue' and upper("table_name") = upper('top_employee_revenue')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'orders' and upper("table_name") = upper('orders')

                )
             or 
                (
                    
    "table_schema" ilike 'snapshots' and upper("table_schema") = upper('snapshots')

                    and 
    "table_name" ilike 'employees_snapshot' and upper("table_name") = upper('employees_snapshot')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'categories' and upper("table_name") = upper('categories')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'stg_products' and upper("table_name") = upper('stg_products')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'top_performing_products' and upper("table_name") = upper('top_performing_products')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'stg_orders' and upper("table_name") = upper('stg_orders')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'employees' and upper("table_name") = upper('employees')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'suppliers' and upper("table_name") = upper('suppliers')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'stg_employees' and upper("table_name") = upper('stg_employees')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'dim_products' and upper("table_name") = upper('dim_products')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'top_customer_revenue' and upper("table_name") = upper('top_customer_revenue')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'order_details' and upper("table_name") = upper('order_details')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'fact_order_details' and upper("table_name") = upper('fact_order_details')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'products' and upper("table_name") = upper('products')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'obt_orders' and upper("table_name") = upper('obt_orders')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'dim_employees' and upper("table_name") = upper('dim_employees')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'shippers' and upper("table_name") = upper('shippers')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'dim_customers' and upper("table_name") = upper('dim_customers')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'stg_order_details' and upper("table_name") = upper('stg_order_details')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'stg_customers' and upper("table_name") = upper('stg_customers')

                )
            )
        ),
        columns as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",

        column_name as "column_name",
        ordinal_position as "column_index",
        data_type as "column_type",
        comment as "column_comment"
    from PROJECT_2.INFORMATION_SCHEMA.columns
            where (
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'customers' and upper("table_name") = upper('customers')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'top_employee_revenue' and upper("table_name") = upper('top_employee_revenue')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'orders' and upper("table_name") = upper('orders')

                )
             or 
                (
                    
    "table_schema" ilike 'snapshots' and upper("table_schema") = upper('snapshots')

                    and 
    "table_name" ilike 'employees_snapshot' and upper("table_name") = upper('employees_snapshot')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'categories' and upper("table_name") = upper('categories')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'stg_products' and upper("table_name") = upper('stg_products')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'top_performing_products' and upper("table_name") = upper('top_performing_products')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'stg_orders' and upper("table_name") = upper('stg_orders')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'employees' and upper("table_name") = upper('employees')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'suppliers' and upper("table_name") = upper('suppliers')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'stg_employees' and upper("table_name") = upper('stg_employees')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'dim_products' and upper("table_name") = upper('dim_products')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'top_customer_revenue' and upper("table_name") = upper('top_customer_revenue')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'order_details' and upper("table_name") = upper('order_details')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'fact_order_details' and upper("table_name") = upper('fact_order_details')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'products' and upper("table_name") = upper('products')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'obt_orders' and upper("table_name") = upper('obt_orders')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'dim_employees' and upper("table_name") = upper('dim_employees')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'shippers' and upper("table_name") = upper('shippers')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'dim_customers' and upper("table_name") = upper('dim_customers')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'stg_order_details' and upper("table_name") = upper('stg_order_details')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'stg_customers' and upper("table_name") = upper('stg_customers')

                )
            )
        )
        select *
    from tables
    join columns using ("table_database", "table_schema", "table_name")
    order by "column_index"
[0m17:21:47.178574 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:21:54.411052 [debug] [ThreadPool]: SQL status: SUCCESS 304 in 7.233 seconds
[0m17:21:54.949681 [debug] [MainThread]: Wrote artifact CatalogArtifact to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\catalog.json
[0m17:21:55.115137 [debug] [MainThread]: Wrote artifact WritableManifest to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\manifest.json
[0m17:21:55.125880 [debug] [MainThread]: Wrote artifact SemanticManifest to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\semantic_manifest.json
[0m17:21:55.128999 [info ] [MainThread]: Catalog written to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\catalog.json
[0m17:21:55.132994 [debug] [MainThread]: Command `dbt docs generate` succeeded at 17:21:55.131981 after 16.77 seconds
[0m17:21:55.134993 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m17:21:55.140690 [debug] [MainThread]: Connection 'PROJECT_2.information_schema' was left open.
[0m17:21:55.141691 [debug] [MainThread]: On PROJECT_2.information_schema: Close
[0m17:21:55.262848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD7EED03A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD1A85DAF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD1A85DCD0>]}
[0m17:21:55.264858 [debug] [MainThread]: Flushing usage events
[0m17:21:56.273088 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:22:02.500916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B110DF400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B1315ED60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B1315EB50>]}


============================== 17:22:02.507566 | 4a7e67aa-fc7a-4940-9dc8-da52e73b5018 ==============================
[0m17:22:02.507566 [info ] [MainThread]: Running with dbt=1.9.0
[0m17:22:02.509575 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'c:\\Users\\fitzp\\Documents\\Alpaca_Market\\zproject_2\\northwind_psql', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'c:\\Users\\fitzp\\Documents\\Alpaca_Market\\zproject_2\\northwind_psql\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt docs serve', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:22:03.904828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4a7e67aa-fc7a-4940-9dc8-da52e73b5018', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B2BC24D30>]}
[0m17:22:03.989068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4a7e67aa-fc7a-4940-9dc8-da52e73b5018', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B12A7A910>]}
[0m17:36:50.504777 [error] [MainThread]: Encountered an error:

[0m17:36:50.528724 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\fitzp\anaconda3\envs\bootcamp\lib\site-packages\dbt\cli\requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
  File "C:\Users\fitzp\anaconda3\envs\bootcamp\lib\site-packages\dbt\cli\requires.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\fitzp\anaconda3\envs\bootcamp\lib\site-packages\dbt\cli\requires.py", line 235, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\fitzp\anaconda3\envs\bootcamp\lib\site-packages\dbt\cli\requires.py", line 264, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\fitzp\anaconda3\envs\bootcamp\lib\site-packages\dbt\cli\requires.py", line 311, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\fitzp\anaconda3\envs\bootcamp\lib\site-packages\dbt\cli\main.py", line 301, in docs_serve
    results = task.run()
  File "C:\Users\fitzp\anaconda3\envs\bootcamp\lib\site-packages\dbt\task\docs\serve.py", line 29, in run
    httpd.serve_forever()
  File "C:\Users\fitzp\anaconda3\envs\bootcamp\lib\socketserver.py", line 232, in serve_forever
    ready = selector.select(poll_interval)
  File "C:\Users\fitzp\anaconda3\envs\bootcamp\lib\selectors.py", line 324, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
  File "C:\Users\fitzp\anaconda3\envs\bootcamp\lib\selectors.py", line 315, in _select
    r, w, x = select.select(r, w, w, timeout)
KeyboardInterrupt

[0m17:36:50.537241 [debug] [MainThread]: Command `dbt docs serve` failed at 17:36:50.535239 after 888.16 seconds
[0m17:36:50.540782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B110DF400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B2BE04B80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B2BE047F0>]}
[0m17:36:50.542824 [debug] [MainThread]: Flushing usage events
[0m17:36:51.421056 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:37:04.405973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281AC2AF400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281AD5CD400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281AE30A7C0>]}


============================== 17:37:04.412908 | 4e388f5d-19c1-46e4-9ac9-e480b8cbf3fd ==============================
[0m17:37:04.412908 [info ] [MainThread]: Running with dbt=1.9.0
[0m17:37:04.414968 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'c:\\Users\\fitzp\\Documents\\Alpaca_Market\\zproject_2\\northwind_psql\\logs', 'version_check': 'True', 'profiles_dir': 'c:\\Users\\fitzp\\Documents\\Alpaca_Market\\zproject_2\\northwind_psql', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt test', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:37:06.091055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4e388f5d-19c1-46e4-9ac9-e480b8cbf3fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281C6DAE2E0>]}
[0m17:37:06.155766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4e388f5d-19c1-46e4-9ac9-e480b8cbf3fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281C6EE6A60>]}
[0m17:37:06.157746 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m17:37:06.835507 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m17:37:07.689689 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m17:37:07.691691 [debug] [MainThread]: Partial parsing: added file: northwind_dbt://snapshots\customers_snapshot.sql
[0m17:37:08.100763 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.northwind_dbt.marts.bi
[0m17:37:08.121195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4e388f5d-19c1-46e4-9ac9-e480b8cbf3fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281C759D130>]}
[0m17:37:08.411035 [debug] [MainThread]: Wrote artifact WritableManifest to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\manifest.json
[0m17:37:08.419176 [debug] [MainThread]: Wrote artifact SemanticManifest to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\semantic_manifest.json
[0m17:37:08.504234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4e388f5d-19c1-46e4-9ac9-e480b8cbf3fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281C7628670>]}
[0m17:37:08.505245 [info ] [MainThread]: Found 13 models, 2 snapshots, 16 data tests, 8 sources, 706 macros
[0m17:37:08.506675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4e388f5d-19c1-46e4-9ac9-e480b8cbf3fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281C746B9D0>]}
[0m17:37:08.509959 [info ] [MainThread]: 
[0m17:37:08.511563 [info ] [MainThread]: Concurrency: 12 threads (target='dev')
[0m17:37:08.513572 [info ] [MainThread]: 
[0m17:37:08.515851 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:37:08.526867 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_2_snapshots'
[0m17:37:08.527877 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_2_PUBLIC'
[0m17:37:08.697894 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_2_snapshots"
[0m17:37:08.698895 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_2_PUBLIC"
[0m17:37:08.698895 [debug] [ThreadPool]: On list_PROJECT_2_snapshots: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "connection_name": "list_PROJECT_2_snapshots"} */
show objects in PROJECT_2.snapshots limit 10000;
[0m17:37:08.700733 [debug] [ThreadPool]: On list_PROJECT_2_PUBLIC: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "connection_name": "list_PROJECT_2_PUBLIC"} */
show objects in PROJECT_2.PUBLIC limit 10000;
[0m17:37:08.701244 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:37:08.702281 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:37:09.488632 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.787 seconds
[0m17:37:09.530785 [debug] [ThreadPool]: SQL status: SUCCESS 27 in 0.828 seconds
[0m17:37:09.540198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4e388f5d-19c1-46e4-9ac9-e480b8cbf3fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281C76289A0>]}
[0m17:37:09.547963 [debug] [Thread-1  ]: Began running node test.northwind_dbt.not_null_dim_customers_customer_id.dd91cd1c8d
[0m17:37:09.548973 [debug] [Thread-2  ]: Began running node test.northwind_dbt.not_null_dim_employees_employee_key.232a183ffe
[0m17:37:09.550119 [debug] [Thread-3  ]: Began running node test.northwind_dbt.not_null_dim_products_product_id.c8aba288d1
[0m17:37:09.551128 [debug] [Thread-4  ]: Began running node test.northwind_dbt.not_null_fact_order_details_customer_id.6aaefe4888
[0m17:37:09.552181 [debug] [Thread-5  ]: Began running node test.northwind_dbt.not_null_fact_order_details_order_id.8d47c14c82
[0m17:37:09.552181 [debug] [Thread-6  ]: Began running node test.northwind_dbt.not_null_fact_order_details_product_id.85713db7b9
[0m17:37:09.554198 [debug] [Thread-7  ]: Began running node test.northwind_dbt.not_null_obt_orders_customer_id.1e3c4ae465
[0m17:37:09.552181 [info ] [Thread-1  ]: 1 of 16 START test not_null_dim_customers_customer_id .......................... [RUN]
[0m17:37:09.555208 [debug] [Thread-8  ]: Began running node test.northwind_dbt.not_null_obt_orders_order_date.5632203db3
[0m17:37:09.556207 [debug] [Thread-9  ]: Began running node test.northwind_dbt.not_null_obt_orders_order_id.218f605f9c
[0m17:37:09.557224 [debug] [Thread-10 ]: Began running node test.northwind_dbt.not_null_obt_orders_product_id.caa3082c7f
[0m17:37:09.559207 [debug] [Thread-11 ]: Began running node test.northwind_dbt.not_null_top_customer_revenue_customer_id.668bb5e112
[0m17:37:09.557224 [info ] [Thread-2  ]: 2 of 16 START test not_null_dim_employees_employee_key ......................... [RUN]
[0m17:37:09.560304 [debug] [Thread-12 ]: Began running node test.northwind_dbt.not_null_top_employee_revenue_employee_key.cb63db6526
[0m17:37:09.558208 [info ] [Thread-3  ]: 3 of 16 START test not_null_dim_products_product_id ............................ [RUN]
[0m17:37:09.583365 [debug] [Thread-3  ]: Acquiring new snowflake connection 'test.northwind_dbt.not_null_dim_products_product_id.c8aba288d1'
[0m17:37:09.562315 [info ] [Thread-5  ]: 5 of 16 START test not_null_fact_order_details_order_id ........................ [RUN]
[0m17:37:09.567407 [debug] [Thread-1  ]: Acquiring new snowflake connection 'test.northwind_dbt.not_null_dim_customers_customer_id.dd91cd1c8d'
[0m17:37:09.561312 [info ] [Thread-4  ]: 4 of 16 START test not_null_fact_order_details_customer_id ..................... [RUN]
[0m17:37:09.566399 [info ] [Thread-7  ]: 7 of 16 START test not_null_obt_orders_customer_id ............................. [RUN]
[0m17:37:09.571884 [info ] [Thread-8  ]: 8 of 16 START test not_null_obt_orders_order_date .............................. [RUN]
[0m17:37:09.577893 [debug] [Thread-2  ]: Acquiring new snowflake connection 'test.northwind_dbt.not_null_dim_employees_employee_key.232a183ffe'
[0m17:37:09.573894 [info ] [Thread-9  ]: 9 of 16 START test not_null_obt_orders_order_id ................................ [RUN]
[0m17:37:09.575892 [info ] [Thread-10 ]: 10 of 16 START test not_null_obt_orders_product_id ............................. [RUN]
[0m17:37:09.563314 [info ] [Thread-6  ]: 6 of 16 START test not_null_fact_order_details_product_id ...................... [RUN]
[0m17:37:09.588371 [debug] [Thread-3  ]: Began compiling node test.northwind_dbt.not_null_dim_products_product_id.c8aba288d1
[0m17:37:09.581356 [info ] [Thread-12 ]: 12 of 16 START test not_null_top_employee_revenue_employee_key ................. [RUN]
[0m17:37:09.590809 [debug] [Thread-5  ]: Acquiring new snowflake connection 'test.northwind_dbt.not_null_fact_order_details_order_id.8d47c14c82'
[0m17:37:09.576892 [info ] [Thread-11 ]: 11 of 16 START test not_null_top_customer_revenue_customer_id .................. [RUN]
[0m17:37:09.591820 [debug] [Thread-1  ]: Began compiling node test.northwind_dbt.not_null_dim_customers_customer_id.dd91cd1c8d
[0m17:37:09.592822 [debug] [Thread-4  ]: Acquiring new snowflake connection 'test.northwind_dbt.not_null_fact_order_details_customer_id.6aaefe4888'
[0m17:37:09.594819 [debug] [Thread-7  ]: Acquiring new snowflake connection 'test.northwind_dbt.not_null_obt_orders_customer_id.1e3c4ae465'
[0m17:37:09.595818 [debug] [Thread-8  ]: Acquiring new snowflake connection 'test.northwind_dbt.not_null_obt_orders_order_date.5632203db3'
[0m17:37:09.596820 [debug] [Thread-2  ]: Began compiling node test.northwind_dbt.not_null_dim_employees_employee_key.232a183ffe
[0m17:37:09.597826 [debug] [Thread-9  ]: Acquiring new snowflake connection 'test.northwind_dbt.not_null_obt_orders_order_id.218f605f9c'
[0m17:37:09.599247 [debug] [Thread-10 ]: Acquiring new snowflake connection 'test.northwind_dbt.not_null_obt_orders_product_id.caa3082c7f'
[0m17:37:09.600257 [debug] [Thread-6  ]: Acquiring new snowflake connection 'test.northwind_dbt.not_null_fact_order_details_product_id.85713db7b9'
[0m17:37:09.628649 [debug] [Thread-3  ]: Writing injected SQL for node "test.northwind_dbt.not_null_dim_products_product_id.c8aba288d1"
[0m17:37:09.630650 [debug] [Thread-12 ]: Acquiring new snowflake connection 'test.northwind_dbt.not_null_top_employee_revenue_employee_key.cb63db6526'
[0m17:37:09.632651 [debug] [Thread-5  ]: Began compiling node test.northwind_dbt.not_null_fact_order_details_order_id.8d47c14c82
[0m17:37:09.633655 [debug] [Thread-11 ]: Acquiring new snowflake connection 'test.northwind_dbt.not_null_top_customer_revenue_customer_id.668bb5e112'
[0m17:37:09.640158 [debug] [Thread-1  ]: Writing injected SQL for node "test.northwind_dbt.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m17:37:09.641567 [debug] [Thread-4  ]: Began compiling node test.northwind_dbt.not_null_fact_order_details_customer_id.6aaefe4888
[0m17:37:09.642577 [debug] [Thread-7  ]: Began compiling node test.northwind_dbt.not_null_obt_orders_customer_id.1e3c4ae465
[0m17:37:09.644578 [debug] [Thread-8  ]: Began compiling node test.northwind_dbt.not_null_obt_orders_order_date.5632203db3
[0m17:37:09.654473 [debug] [Thread-2  ]: Writing injected SQL for node "test.northwind_dbt.not_null_dim_employees_employee_key.232a183ffe"
[0m17:37:09.655917 [debug] [Thread-9  ]: Began compiling node test.northwind_dbt.not_null_obt_orders_order_id.218f605f9c
[0m17:37:09.656926 [debug] [Thread-10 ]: Began compiling node test.northwind_dbt.not_null_obt_orders_product_id.caa3082c7f
[0m17:37:09.657926 [debug] [Thread-6  ]: Began compiling node test.northwind_dbt.not_null_fact_order_details_product_id.85713db7b9
[0m17:37:09.658929 [debug] [Thread-12 ]: Began compiling node test.northwind_dbt.not_null_top_employee_revenue_employee_key.cb63db6526
[0m17:37:09.667240 [debug] [Thread-5  ]: Writing injected SQL for node "test.northwind_dbt.not_null_fact_order_details_order_id.8d47c14c82"
[0m17:37:09.668269 [debug] [Thread-11 ]: Began compiling node test.northwind_dbt.not_null_top_customer_revenue_customer_id.668bb5e112
[0m17:37:09.677623 [debug] [Thread-4  ]: Writing injected SQL for node "test.northwind_dbt.not_null_fact_order_details_customer_id.6aaefe4888"
[0m17:37:09.678622 [debug] [Thread-3  ]: Began executing node test.northwind_dbt.not_null_dim_products_product_id.c8aba288d1
[0m17:37:09.686628 [debug] [Thread-7  ]: Writing injected SQL for node "test.northwind_dbt.not_null_obt_orders_customer_id.1e3c4ae465"
[0m17:37:09.687629 [debug] [Thread-1  ]: Began executing node test.northwind_dbt.not_null_dim_customers_customer_id.dd91cd1c8d
[0m17:37:09.695858 [debug] [Thread-8  ]: Writing injected SQL for node "test.northwind_dbt.not_null_obt_orders_order_date.5632203db3"
[0m17:37:09.777659 [debug] [Thread-9  ]: Writing injected SQL for node "test.northwind_dbt.not_null_obt_orders_order_id.218f605f9c"
[0m17:37:09.783895 [debug] [Thread-2  ]: Began executing node test.northwind_dbt.not_null_dim_employees_employee_key.232a183ffe
[0m17:37:09.784893 [debug] [Thread-10 ]: Writing injected SQL for node "test.northwind_dbt.not_null_obt_orders_product_id.caa3082c7f"
[0m17:37:09.789896 [debug] [Thread-6  ]: Writing injected SQL for node "test.northwind_dbt.not_null_fact_order_details_product_id.85713db7b9"
[0m17:37:09.794896 [debug] [Thread-12 ]: Writing injected SQL for node "test.northwind_dbt.not_null_top_employee_revenue_employee_key.cb63db6526"
[0m17:37:09.800895 [debug] [Thread-11 ]: Writing injected SQL for node "test.northwind_dbt.not_null_top_customer_revenue_customer_id.668bb5e112"
[0m17:37:09.829698 [debug] [Thread-3  ]: Writing runtime sql for node "test.northwind_dbt.not_null_dim_products_product_id.c8aba288d1"
[0m17:37:09.836288 [debug] [Thread-1  ]: Writing runtime sql for node "test.northwind_dbt.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m17:37:09.837285 [debug] [Thread-4  ]: Began executing node test.northwind_dbt.not_null_fact_order_details_customer_id.6aaefe4888
[0m17:37:09.837285 [debug] [Thread-5  ]: Began executing node test.northwind_dbt.not_null_fact_order_details_order_id.8d47c14c82
[0m17:37:09.844992 [debug] [Thread-2  ]: Writing runtime sql for node "test.northwind_dbt.not_null_dim_employees_employee_key.232a183ffe"
[0m17:37:09.845998 [debug] [Thread-7  ]: Began executing node test.northwind_dbt.not_null_obt_orders_customer_id.1e3c4ae465
[0m17:37:09.855526 [debug] [Thread-4  ]: Writing runtime sql for node "test.northwind_dbt.not_null_fact_order_details_customer_id.6aaefe4888"
[0m17:37:09.856583 [debug] [Thread-9  ]: Began executing node test.northwind_dbt.not_null_obt_orders_order_id.218f605f9c
[0m17:37:09.856583 [debug] [Thread-8  ]: Began executing node test.northwind_dbt.not_null_obt_orders_order_date.5632203db3
[0m17:37:09.865125 [debug] [Thread-5  ]: Writing runtime sql for node "test.northwind_dbt.not_null_fact_order_details_order_id.8d47c14c82"
[0m17:37:09.871583 [debug] [Thread-7  ]: Writing runtime sql for node "test.northwind_dbt.not_null_obt_orders_customer_id.1e3c4ae465"
[0m17:37:09.879278 [debug] [Thread-9  ]: Writing runtime sql for node "test.northwind_dbt.not_null_obt_orders_order_id.218f605f9c"
[0m17:37:09.880280 [debug] [Thread-10 ]: Began executing node test.northwind_dbt.not_null_obt_orders_product_id.caa3082c7f
[0m17:37:09.881338 [debug] [Thread-11 ]: Began executing node test.northwind_dbt.not_null_top_customer_revenue_customer_id.668bb5e112
[0m17:37:09.882349 [debug] [Thread-6  ]: Began executing node test.northwind_dbt.not_null_fact_order_details_product_id.85713db7b9
[0m17:37:09.887955 [debug] [Thread-8  ]: Writing runtime sql for node "test.northwind_dbt.not_null_obt_orders_order_date.5632203db3"
[0m17:37:09.888954 [debug] [Thread-3  ]: Using snowflake connection "test.northwind_dbt.not_null_dim_products_product_id.c8aba288d1"
[0m17:37:09.888954 [debug] [Thread-12 ]: Began executing node test.northwind_dbt.not_null_top_employee_revenue_employee_key.cb63db6526
[0m17:37:09.890496 [debug] [Thread-1  ]: Using snowflake connection "test.northwind_dbt.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m17:37:09.897844 [debug] [Thread-10 ]: Writing runtime sql for node "test.northwind_dbt.not_null_obt_orders_product_id.caa3082c7f"
[0m17:37:09.899177 [debug] [Thread-4  ]: Using snowflake connection "test.northwind_dbt.not_null_fact_order_details_customer_id.6aaefe4888"
[0m17:37:09.900188 [debug] [Thread-2  ]: Using snowflake connection "test.northwind_dbt.not_null_dim_employees_employee_key.232a183ffe"
[0m17:37:09.906615 [debug] [Thread-11 ]: Writing runtime sql for node "test.northwind_dbt.not_null_top_customer_revenue_customer_id.668bb5e112"
[0m17:37:09.912643 [debug] [Thread-6  ]: Writing runtime sql for node "test.northwind_dbt.not_null_fact_order_details_product_id.85713db7b9"
[0m17:37:09.913642 [debug] [Thread-7  ]: Using snowflake connection "test.northwind_dbt.not_null_obt_orders_customer_id.1e3c4ae465"
[0m17:37:09.914747 [debug] [Thread-5  ]: Using snowflake connection "test.northwind_dbt.not_null_fact_order_details_order_id.8d47c14c82"
[0m17:37:09.915759 [debug] [Thread-9  ]: Using snowflake connection "test.northwind_dbt.not_null_obt_orders_order_id.218f605f9c"
[0m17:37:09.917764 [debug] [Thread-3  ]: On test.northwind_dbt.not_null_dim_products_product_id.c8aba288d1: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "test.northwind_dbt.not_null_dim_products_product_id.c8aba288d1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_id
from PROJECT_2.PUBLIC.dim_products
where product_id is null



      
    ) dbt_internal_test
[0m17:37:09.923071 [debug] [Thread-12 ]: Writing runtime sql for node "test.northwind_dbt.not_null_top_employee_revenue_employee_key.cb63db6526"
[0m17:37:09.924774 [debug] [Thread-1  ]: On test.northwind_dbt.not_null_dim_customers_customer_id.dd91cd1c8d: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "test.northwind_dbt.not_null_dim_customers_customer_id.dd91cd1c8d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from PROJECT_2.PUBLIC.dim_customers
where customer_id is null



      
    ) dbt_internal_test
[0m17:37:09.925789 [debug] [Thread-4  ]: On test.northwind_dbt.not_null_fact_order_details_customer_id.6aaefe4888: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "test.northwind_dbt.not_null_fact_order_details_customer_id.6aaefe4888"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from PROJECT_2.PUBLIC.fact_order_details
where customer_id is null



      
    ) dbt_internal_test
[0m17:37:09.927784 [debug] [Thread-8  ]: Using snowflake connection "test.northwind_dbt.not_null_obt_orders_order_date.5632203db3"
[0m17:37:09.928786 [debug] [Thread-2  ]: On test.northwind_dbt.not_null_dim_employees_employee_key.232a183ffe: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "test.northwind_dbt.not_null_dim_employees_employee_key.232a183ffe"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select employee_key
from PROJECT_2.PUBLIC.dim_employees
where employee_key is null



      
    ) dbt_internal_test
[0m17:37:09.930784 [debug] [Thread-7  ]: On test.northwind_dbt.not_null_obt_orders_customer_id.1e3c4ae465: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "test.northwind_dbt.not_null_obt_orders_customer_id.1e3c4ae465"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from PROJECT_2.PUBLIC.obt_orders
where customer_id is null



      
    ) dbt_internal_test
[0m17:37:09.931783 [debug] [Thread-5  ]: On test.northwind_dbt.not_null_fact_order_details_order_id.8d47c14c82: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "test.northwind_dbt.not_null_fact_order_details_order_id.8d47c14c82"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from PROJECT_2.PUBLIC.fact_order_details
where order_id is null



      
    ) dbt_internal_test
[0m17:37:09.933161 [debug] [Thread-9  ]: On test.northwind_dbt.not_null_obt_orders_order_id.218f605f9c: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "test.northwind_dbt.not_null_obt_orders_order_id.218f605f9c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from PROJECT_2.PUBLIC.obt_orders
where order_id is null



      
    ) dbt_internal_test
[0m17:37:09.933161 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m17:37:09.935480 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m17:37:09.936477 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m17:37:09.937478 [debug] [Thread-8  ]: On test.northwind_dbt.not_null_obt_orders_order_date.5632203db3: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "test.northwind_dbt.not_null_obt_orders_order_date.5632203db3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_date
from PROJECT_2.PUBLIC.obt_orders
where order_date is null



      
    ) dbt_internal_test
[0m17:37:09.939495 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m17:37:09.940888 [debug] [Thread-7  ]: Opening a new connection, currently in state init
[0m17:37:09.941901 [debug] [Thread-5  ]: Opening a new connection, currently in state init
[0m17:37:09.943090 [debug] [Thread-9  ]: Opening a new connection, currently in state init
[0m17:37:09.949104 [debug] [Thread-6  ]: Using snowflake connection "test.northwind_dbt.not_null_fact_order_details_product_id.85713db7b9"
[0m17:37:09.950102 [debug] [Thread-10 ]: Using snowflake connection "test.northwind_dbt.not_null_obt_orders_product_id.caa3082c7f"
[0m17:37:09.954656 [debug] [Thread-11 ]: Using snowflake connection "test.northwind_dbt.not_null_top_customer_revenue_customer_id.668bb5e112"
[0m17:37:09.956669 [debug] [Thread-12 ]: Using snowflake connection "test.northwind_dbt.not_null_top_employee_revenue_employee_key.cb63db6526"
[0m17:37:09.960666 [debug] [Thread-8  ]: Opening a new connection, currently in state init
[0m17:37:09.974450 [debug] [Thread-6  ]: On test.northwind_dbt.not_null_fact_order_details_product_id.85713db7b9: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "test.northwind_dbt.not_null_fact_order_details_product_id.85713db7b9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_id
from PROJECT_2.PUBLIC.fact_order_details
where product_id is null



      
    ) dbt_internal_test
[0m17:37:09.975843 [debug] [Thread-10 ]: On test.northwind_dbt.not_null_obt_orders_product_id.caa3082c7f: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "test.northwind_dbt.not_null_obt_orders_product_id.caa3082c7f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_id
from PROJECT_2.PUBLIC.obt_orders
where product_id is null



      
    ) dbt_internal_test
[0m17:37:09.978185 [debug] [Thread-11 ]: On test.northwind_dbt.not_null_top_customer_revenue_customer_id.668bb5e112: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "test.northwind_dbt.not_null_top_customer_revenue_customer_id.668bb5e112"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from PROJECT_2.PUBLIC.top_customer_revenue
where customer_id is null



      
    ) dbt_internal_test
[0m17:37:09.979185 [debug] [Thread-12 ]: On test.northwind_dbt.not_null_top_employee_revenue_employee_key.cb63db6526: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "test.northwind_dbt.not_null_top_employee_revenue_employee_key.cb63db6526"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select employee_key
from PROJECT_2.PUBLIC.top_employee_revenue
where employee_key is null



      
    ) dbt_internal_test
[0m17:37:09.982190 [debug] [Thread-6  ]: Opening a new connection, currently in state init
[0m17:37:09.985185 [debug] [Thread-10 ]: Opening a new connection, currently in state init
[0m17:37:09.987183 [debug] [Thread-11 ]: Opening a new connection, currently in state init
[0m17:37:09.988186 [debug] [Thread-12 ]: Opening a new connection, currently in state init
[0m17:37:10.403941 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.471 seconds
[0m17:37:10.424791 [info ] [Thread-3  ]: 3 of 16 PASS not_null_dim_products_product_id .................................. [[32mPASS[0m in 0.84s]
[0m17:37:10.430700 [debug] [Thread-7  ]: SQL status: SUCCESS 1 in 0.491 seconds
[0m17:37:10.433701 [debug] [Thread-3  ]: Finished running node test.northwind_dbt.not_null_dim_products_product_id.c8aba288d1
[0m17:37:10.440712 [debug] [Thread-3  ]: Began running node test.northwind_dbt.not_null_top_performing_products_product_id.919a185ac6
[0m17:37:10.437702 [info ] [Thread-7  ]: 7 of 16 PASS not_null_obt_orders_customer_id ................................... [[32mPASS[0m in 0.84s]
[0m17:37:10.446160 [info ] [Thread-3  ]: 13 of 16 START test not_null_top_performing_products_product_id ................ [RUN]
[0m17:37:10.454547 [debug] [Thread-7  ]: Finished running node test.northwind_dbt.not_null_obt_orders_customer_id.1e3c4ae465
[0m17:37:10.455554 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.northwind_dbt.not_null_dim_products_product_id.c8aba288d1, now test.northwind_dbt.not_null_top_performing_products_product_id.919a185ac6)
[0m17:37:10.457793 [debug] [Thread-7  ]: Began running node test.northwind_dbt.unique_dim_customers_customer_id.15c9f1e2fd
[0m17:37:10.460793 [debug] [Thread-3  ]: Began compiling node test.northwind_dbt.not_null_top_performing_products_product_id.919a185ac6
[0m17:37:10.461795 [info ] [Thread-7  ]: 14 of 16 START test unique_dim_customers_customer_id ........................... [RUN]
[0m17:37:10.474250 [debug] [Thread-3  ]: Writing injected SQL for node "test.northwind_dbt.not_null_top_performing_products_product_id.919a185ac6"
[0m17:37:10.477234 [debug] [Thread-7  ]: Re-using an available connection from the pool (formerly test.northwind_dbt.not_null_obt_orders_customer_id.1e3c4ae465, now test.northwind_dbt.unique_dim_customers_customer_id.15c9f1e2fd)
[0m17:37:10.480237 [debug] [Thread-7  ]: Began compiling node test.northwind_dbt.unique_dim_customers_customer_id.15c9f1e2fd
[0m17:37:10.490184 [debug] [Thread-7  ]: Writing injected SQL for node "test.northwind_dbt.unique_dim_customers_customer_id.15c9f1e2fd"
[0m17:37:10.495232 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.556 seconds
[0m17:37:10.496720 [debug] [Thread-3  ]: Began executing node test.northwind_dbt.not_null_top_performing_products_product_id.919a185ac6
[0m17:37:10.498728 [debug] [Thread-9  ]: SQL status: SUCCESS 1 in 0.555 seconds
[0m17:37:10.502261 [info ] [Thread-2  ]: 2 of 16 PASS not_null_dim_employees_employee_key ............................... [[32mPASS[0m in 0.92s]
[0m17:37:10.508259 [debug] [Thread-3  ]: Writing runtime sql for node "test.northwind_dbt.not_null_top_performing_products_product_id.919a185ac6"
[0m17:37:10.509260 [debug] [Thread-7  ]: Began executing node test.northwind_dbt.unique_dim_customers_customer_id.15c9f1e2fd
[0m17:37:10.515442 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.579 seconds
[0m17:37:10.514444 [info ] [Thread-9  ]: 9 of 16 PASS not_null_obt_orders_order_id ...................................... [[32mPASS[0m in 0.92s]
[0m17:37:10.517784 [debug] [Thread-5  ]: SQL status: SUCCESS 1 in 0.576 seconds
[0m17:37:10.518800 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.583 seconds
[0m17:37:10.520799 [debug] [Thread-11 ]: SQL status: SUCCESS 1 in 0.533 seconds
[0m17:37:10.521796 [debug] [Thread-2  ]: Finished running node test.northwind_dbt.not_null_dim_employees_employee_key.232a183ffe
[0m17:37:10.527564 [debug] [Thread-7  ]: Writing runtime sql for node "test.northwind_dbt.unique_dim_customers_customer_id.15c9f1e2fd"
[0m17:37:10.530566 [info ] [Thread-4  ]: 4 of 16 PASS not_null_fact_order_details_customer_id ........................... [[32mPASS[0m in 0.94s]
[0m17:37:10.532566 [debug] [Thread-9  ]: Finished running node test.northwind_dbt.not_null_obt_orders_order_id.218f605f9c
[0m17:37:10.536643 [info ] [Thread-5  ]: 5 of 16 PASS not_null_fact_order_details_order_id .............................. [[32mPASS[0m in 0.95s]
[0m17:37:10.541657 [debug] [Thread-3  ]: Using snowflake connection "test.northwind_dbt.not_null_top_performing_products_product_id.919a185ac6"
[0m17:37:10.539638 [info ] [Thread-1  ]: 1 of 16 PASS not_null_dim_customers_customer_id ................................ [[32mPASS[0m in 0.97s]
[0m17:37:10.545654 [info ] [Thread-11 ]: 11 of 16 PASS not_null_top_customer_revenue_customer_id ........................ [[32mPASS[0m in 0.91s]
[0m17:37:10.547724 [debug] [Thread-2  ]: Began running node test.northwind_dbt.unique_dim_employees_employee_key.3824d24782
[0m17:37:10.549208 [debug] [Thread-4  ]: Finished running node test.northwind_dbt.not_null_fact_order_details_customer_id.6aaefe4888
[0m17:37:10.551218 [debug] [Thread-9  ]: Began running node test.northwind_dbt.unique_dim_products_product_id.ef7b2a9985
[0m17:37:10.553221 [debug] [Thread-5  ]: Finished running node test.northwind_dbt.not_null_fact_order_details_order_id.8d47c14c82
[0m17:37:10.553221 [debug] [Thread-3  ]: On test.northwind_dbt.not_null_top_performing_products_product_id.919a185ac6: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "test.northwind_dbt.not_null_top_performing_products_product_id.919a185ac6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_id
from PROJECT_2.PUBLIC.top_performing_products
where product_id is null



      
    ) dbt_internal_test
[0m17:37:10.555989 [debug] [Thread-1  ]: Finished running node test.northwind_dbt.not_null_dim_customers_customer_id.dd91cd1c8d
[0m17:37:10.558473 [debug] [Thread-11 ]: Finished running node test.northwind_dbt.not_null_top_customer_revenue_customer_id.668bb5e112
[0m17:37:10.559468 [info ] [Thread-2  ]: 15 of 16 START test unique_dim_employees_employee_key .......................... [RUN]
[0m17:37:10.560468 [info ] [Thread-9  ]: 16 of 16 START test unique_dim_products_product_id ............................. [RUN]
[0m17:37:10.562470 [debug] [Thread-7  ]: Using snowflake connection "test.northwind_dbt.unique_dim_customers_customer_id.15c9f1e2fd"
[0m17:37:10.568470 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.northwind_dbt.not_null_dim_employees_employee_key.232a183ffe, now test.northwind_dbt.unique_dim_employees_employee_key.3824d24782)
[0m17:37:10.570467 [debug] [Thread-9  ]: Re-using an available connection from the pool (formerly test.northwind_dbt.not_null_obt_orders_order_id.218f605f9c, now test.northwind_dbt.unique_dim_products_product_id.ef7b2a9985)
[0m17:37:10.572467 [debug] [Thread-7  ]: On test.northwind_dbt.unique_dim_customers_customer_id.15c9f1e2fd: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "test.northwind_dbt.unique_dim_customers_customer_id.15c9f1e2fd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from PROJECT_2.PUBLIC.dim_customers
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:37:10.573469 [debug] [Thread-2  ]: Began compiling node test.northwind_dbt.unique_dim_employees_employee_key.3824d24782
[0m17:37:10.574474 [debug] [Thread-9  ]: Began compiling node test.northwind_dbt.unique_dim_products_product_id.ef7b2a9985
[0m17:37:10.581469 [debug] [Thread-2  ]: Writing injected SQL for node "test.northwind_dbt.unique_dim_employees_employee_key.3824d24782"
[0m17:37:10.591859 [debug] [Thread-9  ]: Writing injected SQL for node "test.northwind_dbt.unique_dim_products_product_id.ef7b2a9985"
[0m17:37:10.593870 [debug] [Thread-12 ]: SQL status: SUCCESS 1 in 0.605 seconds
[0m17:37:10.598873 [info ] [Thread-12 ]: 12 of 16 PASS not_null_top_employee_revenue_employee_key ....................... [[32mPASS[0m in 0.97s]
[0m17:37:10.600875 [debug] [Thread-12 ]: Finished running node test.northwind_dbt.not_null_top_employee_revenue_employee_key.cb63db6526
[0m17:37:10.607567 [debug] [Thread-8  ]: SQL status: SUCCESS 1 in 0.647 seconds
[0m17:37:10.611352 [debug] [Thread-9  ]: Began executing node test.northwind_dbt.unique_dim_products_product_id.ef7b2a9985
[0m17:37:10.612347 [debug] [Thread-2  ]: Began executing node test.northwind_dbt.unique_dim_employees_employee_key.3824d24782
[0m17:37:10.611352 [info ] [Thread-8  ]: 8 of 16 PASS not_null_obt_orders_order_date .................................... [[32mPASS[0m in 1.02s]
[0m17:37:10.619521 [debug] [Thread-9  ]: Writing runtime sql for node "test.northwind_dbt.unique_dim_products_product_id.ef7b2a9985"
[0m17:37:10.626335 [debug] [Thread-2  ]: Writing runtime sql for node "test.northwind_dbt.unique_dim_employees_employee_key.3824d24782"
[0m17:37:10.627337 [debug] [Thread-8  ]: Finished running node test.northwind_dbt.not_null_obt_orders_order_date.5632203db3
[0m17:37:10.645044 [debug] [Thread-9  ]: Using snowflake connection "test.northwind_dbt.unique_dim_products_product_id.ef7b2a9985"
[0m17:37:10.646042 [debug] [Thread-2  ]: Using snowflake connection "test.northwind_dbt.unique_dim_employees_employee_key.3824d24782"
[0m17:37:10.647041 [debug] [Thread-9  ]: On test.northwind_dbt.unique_dim_products_product_id.ef7b2a9985: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "test.northwind_dbt.unique_dim_products_product_id.ef7b2a9985"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    product_id as unique_field,
    count(*) as n_records

from PROJECT_2.PUBLIC.dim_products
where product_id is not null
group by product_id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:37:10.648042 [debug] [Thread-2  ]: On test.northwind_dbt.unique_dim_employees_employee_key.3824d24782: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "test.northwind_dbt.unique_dim_employees_employee_key.3824d24782"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    employee_key as unique_field,
    count(*) as n_records

from PROJECT_2.PUBLIC.dim_employees
where employee_key is not null
group by employee_key
having count(*) > 1



      
    ) dbt_internal_test
[0m17:37:10.657327 [debug] [Thread-6  ]: SQL status: SUCCESS 1 in 0.675 seconds
[0m17:37:10.658328 [debug] [Thread-10 ]: SQL status: SUCCESS 1 in 0.673 seconds
[0m17:37:10.661329 [info ] [Thread-6  ]: 6 of 16 PASS not_null_fact_order_details_product_id ............................ [[32mPASS[0m in 1.06s]
[0m17:37:10.666552 [info ] [Thread-10 ]: 10 of 16 PASS not_null_obt_orders_product_id ................................... [[32mPASS[0m in 1.07s]
[0m17:37:10.668558 [debug] [Thread-6  ]: Finished running node test.northwind_dbt.not_null_fact_order_details_product_id.85713db7b9
[0m17:37:10.670671 [debug] [Thread-10 ]: Finished running node test.northwind_dbt.not_null_obt_orders_product_id.caa3082c7f
[0m17:37:10.690684 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.126 seconds
[0m17:37:10.693684 [info ] [Thread-3  ]: 13 of 16 PASS not_null_top_performing_products_product_id ...................... [[32mPASS[0m in 0.24s]
[0m17:37:10.695683 [debug] [Thread-3  ]: Finished running node test.northwind_dbt.not_null_top_performing_products_product_id.919a185ac6
[0m17:37:10.715060 [debug] [Thread-7  ]: SQL status: SUCCESS 1 in 0.139 seconds
[0m17:37:10.719063 [info ] [Thread-7  ]: 14 of 16 PASS unique_dim_customers_customer_id ................................. [[32mPASS[0m in 0.24s]
[0m17:37:10.721062 [debug] [Thread-7  ]: Finished running node test.northwind_dbt.unique_dim_customers_customer_id.15c9f1e2fd
[0m17:37:10.790976 [debug] [Thread-9  ]: SQL status: SUCCESS 1 in 0.142 seconds
[0m17:37:10.794968 [info ] [Thread-9  ]: 16 of 16 PASS unique_dim_products_product_id ................................... [[32mPASS[0m in 0.22s]
[0m17:37:10.796964 [debug] [Thread-9  ]: Finished running node test.northwind_dbt.unique_dim_products_product_id.ef7b2a9985
[0m17:37:10.846171 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.195 seconds
[0m17:37:10.850518 [info ] [Thread-2  ]: 15 of 16 PASS unique_dim_employees_employee_key ................................ [[32mPASS[0m in 0.28s]
[0m17:37:10.851974 [debug] [Thread-2  ]: Finished running node test.northwind_dbt.unique_dim_employees_employee_key.3824d24782
[0m17:37:10.855491 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:37:10.855491 [debug] [MainThread]: Connection 'list_PROJECT_2_snapshots' was left open.
[0m17:37:10.856787 [debug] [MainThread]: On list_PROJECT_2_snapshots: Close
[0m17:37:10.995433 [debug] [MainThread]: Connection 'list_PROJECT_2_PUBLIC' was left open.
[0m17:37:10.996440 [debug] [MainThread]: On list_PROJECT_2_PUBLIC: Close
[0m17:37:11.143649 [debug] [MainThread]: Connection 'test.northwind_dbt.not_null_dim_customers_customer_id.dd91cd1c8d' was left open.
[0m17:37:11.144641 [debug] [MainThread]: On test.northwind_dbt.not_null_dim_customers_customer_id.dd91cd1c8d: Close
[0m17:37:11.264736 [debug] [MainThread]: Connection 'test.northwind_dbt.unique_dim_employees_employee_key.3824d24782' was left open.
[0m17:37:11.265741 [debug] [MainThread]: On test.northwind_dbt.unique_dim_employees_employee_key.3824d24782: Close
[0m17:37:11.382534 [debug] [MainThread]: Connection 'test.northwind_dbt.not_null_top_performing_products_product_id.919a185ac6' was left open.
[0m17:37:11.383534 [debug] [MainThread]: On test.northwind_dbt.not_null_top_performing_products_product_id.919a185ac6: Close
[0m17:37:11.545129 [debug] [MainThread]: Connection 'test.northwind_dbt.not_null_fact_order_details_order_id.8d47c14c82' was left open.
[0m17:37:11.547131 [debug] [MainThread]: On test.northwind_dbt.not_null_fact_order_details_order_id.8d47c14c82: Close
[0m17:37:11.725909 [debug] [MainThread]: Connection 'test.northwind_dbt.not_null_fact_order_details_customer_id.6aaefe4888' was left open.
[0m17:37:11.727028 [debug] [MainThread]: On test.northwind_dbt.not_null_fact_order_details_customer_id.6aaefe4888: Close
[0m17:37:11.898503 [debug] [MainThread]: Connection 'test.northwind_dbt.unique_dim_customers_customer_id.15c9f1e2fd' was left open.
[0m17:37:11.899922 [debug] [MainThread]: On test.northwind_dbt.unique_dim_customers_customer_id.15c9f1e2fd: Close
[0m17:37:12.603567 [debug] [MainThread]: Connection 'test.northwind_dbt.not_null_obt_orders_order_date.5632203db3' was left open.
[0m17:37:12.604951 [debug] [MainThread]: On test.northwind_dbt.not_null_obt_orders_order_date.5632203db3: Close
[0m17:37:12.736205 [debug] [MainThread]: Connection 'test.northwind_dbt.unique_dim_products_product_id.ef7b2a9985' was left open.
[0m17:37:12.737291 [debug] [MainThread]: On test.northwind_dbt.unique_dim_products_product_id.ef7b2a9985: Close
[0m17:37:12.869172 [debug] [MainThread]: Connection 'test.northwind_dbt.not_null_obt_orders_product_id.caa3082c7f' was left open.
[0m17:37:12.870116 [debug] [MainThread]: On test.northwind_dbt.not_null_obt_orders_product_id.caa3082c7f: Close
[0m17:37:13.015391 [debug] [MainThread]: Connection 'test.northwind_dbt.not_null_fact_order_details_product_id.85713db7b9' was left open.
[0m17:37:13.016685 [debug] [MainThread]: On test.northwind_dbt.not_null_fact_order_details_product_id.85713db7b9: Close
[0m17:37:13.138406 [debug] [MainThread]: Connection 'test.northwind_dbt.not_null_top_employee_revenue_employee_key.cb63db6526' was left open.
[0m17:37:13.139456 [debug] [MainThread]: On test.northwind_dbt.not_null_top_employee_revenue_employee_key.cb63db6526: Close
[0m17:37:13.306437 [debug] [MainThread]: Connection 'test.northwind_dbt.not_null_top_customer_revenue_customer_id.668bb5e112' was left open.
[0m17:37:13.308405 [debug] [MainThread]: On test.northwind_dbt.not_null_top_customer_revenue_customer_id.668bb5e112: Close
[0m17:37:13.445289 [info ] [MainThread]: 
[0m17:37:13.447628 [info ] [MainThread]: Finished running 16 data tests in 0 hours 0 minutes and 4.93 seconds (4.93s).
[0m17:37:13.452086 [debug] [MainThread]: Command end result
[0m17:37:13.629351 [debug] [MainThread]: Wrote artifact WritableManifest to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\manifest.json
[0m17:37:13.636902 [debug] [MainThread]: Wrote artifact SemanticManifest to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\semantic_manifest.json
[0m17:37:13.660902 [debug] [MainThread]: Wrote artifact RunExecutionResult to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\run_results.json
[0m17:37:13.661908 [info ] [MainThread]: 
[0m17:37:13.662900 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:37:13.663899 [info ] [MainThread]: 
[0m17:37:13.664902 [info ] [MainThread]: Done. PASS=16 WARN=0 ERROR=0 SKIP=0 TOTAL=16
[0m17:37:13.666898 [debug] [MainThread]: Command `dbt test` succeeded at 17:37:13.666898 after 9.41 seconds
[0m17:37:13.667900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281AC2AF400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281AD6027F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281C6DDBDC0>]}
[0m17:37:13.668900 [debug] [MainThread]: Flushing usage events
[0m17:37:14.614029 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:38:08.967990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A73D84F3D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A73F8C5CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A73F8C5AC0>]}


============================== 17:38:08.975109 | 9aa0b600-25cf-4d71-bf62-2c58c2433ab7 ==============================
[0m17:38:08.975109 [info ] [MainThread]: Running with dbt=1.9.0
[0m17:38:08.976507 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'c:\\Users\\fitzp\\Documents\\Alpaca_Market\\zproject_2\\northwind_psql\\logs', 'profiles_dir': 'c:\\Users\\fitzp\\Documents\\Alpaca_Market\\zproject_2\\northwind_psql', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:38:10.517186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9aa0b600-25cf-4d71-bf62-2c58c2433ab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A73F894A30>]}
[0m17:38:10.617226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9aa0b600-25cf-4d71-bf62-2c58c2433ab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A7583B0C40>]}
[0m17:38:10.620229 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m17:38:11.380038 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m17:38:12.120439 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:38:12.121450 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:38:12.132793 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.northwind_dbt.marts.bi
[0m17:38:12.236598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9aa0b600-25cf-4d71-bf62-2c58c2433ab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A7589D3130>]}
[0m17:38:12.543413 [debug] [MainThread]: Wrote artifact WritableManifest to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\manifest.json
[0m17:38:12.554527 [debug] [MainThread]: Wrote artifact SemanticManifest to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\semantic_manifest.json
[0m17:38:12.615489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9aa0b600-25cf-4d71-bf62-2c58c2433ab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A7589BB3A0>]}
[0m17:38:12.617530 [info ] [MainThread]: Found 13 models, 2 snapshots, 16 data tests, 8 sources, 706 macros
[0m17:38:12.619541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9aa0b600-25cf-4d71-bf62-2c58c2433ab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A7589956D0>]}
[0m17:38:12.624432 [info ] [MainThread]: 
[0m17:38:12.626936 [info ] [MainThread]: Concurrency: 12 threads (target='dev')
[0m17:38:12.631601 [info ] [MainThread]: 
[0m17:38:12.634290 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:38:12.647921 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_2'
[0m17:38:12.815368 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_2"
[0m17:38:12.816374 [debug] [ThreadPool]: On list_PROJECT_2: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "connection_name": "list_PROJECT_2"} */
show terse schemas in database PROJECT_2
    limit 10000
[0m17:38:12.818364 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:38:13.565956 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.748 seconds
[0m17:38:13.584709 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_2_PUBLIC'
[0m17:38:13.601339 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_2_snapshots'
[0m17:38:13.605373 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_2_PUBLIC"
[0m17:38:13.609373 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_2_snapshots"
[0m17:38:13.610373 [debug] [ThreadPool]: On list_PROJECT_2_PUBLIC: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "connection_name": "list_PROJECT_2_PUBLIC"} */
show objects in PROJECT_2.PUBLIC limit 10000;
[0m17:38:13.610373 [debug] [ThreadPool]: On list_PROJECT_2_snapshots: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "connection_name": "list_PROJECT_2_snapshots"} */
show objects in PROJECT_2.snapshots limit 10000;
[0m17:38:13.612580 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:38:13.612580 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:38:14.098099 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.485 seconds
[0m17:38:14.141584 [debug] [ThreadPool]: SQL status: SUCCESS 27 in 0.530 seconds
[0m17:38:14.154245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9aa0b600-25cf-4d71-bf62-2c58c2433ab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A758376F10>]}
[0m17:38:14.163245 [debug] [Thread-1  ]: Began running node model.northwind_dbt.stg_customers
[0m17:38:14.165772 [debug] [Thread-2  ]: Began running node model.northwind_dbt.stg_employees
[0m17:38:14.166766 [debug] [Thread-3  ]: Began running node model.northwind_dbt.stg_order_details
[0m17:38:14.166766 [debug] [Thread-4  ]: Began running node model.northwind_dbt.stg_orders
[0m17:38:14.167765 [debug] [Thread-5  ]: Began running node model.northwind_dbt.stg_products
[0m17:38:14.168765 [info ] [Thread-1  ]: 1 of 13 START sql view model PUBLIC.stg_customers .............................. [RUN]
[0m17:38:14.171764 [info ] [Thread-2  ]: 2 of 13 START sql view model PUBLIC.stg_employees .............................. [RUN]
[0m17:38:14.180408 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.northwind_dbt.stg_employees'
[0m17:38:14.182408 [debug] [Thread-2  ]: Began compiling node model.northwind_dbt.stg_employees
[0m17:38:14.172766 [info ] [Thread-3  ]: 3 of 13 START sql view model PUBLIC.stg_order_details .......................... [RUN]
[0m17:38:14.201928 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.northwind_dbt.stg_order_details'
[0m17:38:14.202931 [debug] [Thread-3  ]: Began compiling node model.northwind_dbt.stg_order_details
[0m17:38:14.213978 [debug] [Thread-3  ]: Writing injected SQL for node "model.northwind_dbt.stg_order_details"
[0m17:38:14.198929 [debug] [Thread-2  ]: Writing injected SQL for node "model.northwind_dbt.stg_employees"
[0m17:38:14.177409 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.northwind_dbt.stg_customers'
[0m17:38:14.174410 [info ] [Thread-4  ]: 4 of 13 START sql view model PUBLIC.stg_orders ................................. [RUN]
[0m17:38:14.217977 [debug] [Thread-1  ]: Began compiling node model.northwind_dbt.stg_customers
[0m17:38:14.220487 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.northwind_dbt.stg_orders'
[0m17:38:14.176409 [info ] [Thread-5  ]: 5 of 13 START sql view model PUBLIC.stg_products ............................... [RUN]
[0m17:38:14.228501 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind_dbt.stg_customers"
[0m17:38:14.229498 [debug] [Thread-4  ]: Began compiling node model.northwind_dbt.stg_orders
[0m17:38:14.232007 [debug] [Thread-5  ]: Acquiring new snowflake connection 'model.northwind_dbt.stg_products'
[0m17:38:14.239546 [debug] [Thread-4  ]: Writing injected SQL for node "model.northwind_dbt.stg_orders"
[0m17:38:14.240545 [debug] [Thread-5  ]: Began compiling node model.northwind_dbt.stg_products
[0m17:38:14.249523 [debug] [Thread-5  ]: Writing injected SQL for node "model.northwind_dbt.stg_products"
[0m17:38:14.328117 [debug] [Thread-1  ]: Began executing node model.northwind_dbt.stg_customers
[0m17:38:14.329114 [debug] [Thread-2  ]: Began executing node model.northwind_dbt.stg_employees
[0m17:38:14.330114 [debug] [Thread-3  ]: Began executing node model.northwind_dbt.stg_order_details
[0m17:38:14.330114 [debug] [Thread-4  ]: Began executing node model.northwind_dbt.stg_orders
[0m17:38:14.346201 [debug] [Thread-5  ]: Began executing node model.northwind_dbt.stg_products
[0m17:38:14.373921 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind_dbt.stg_customers"
[0m17:38:14.380429 [debug] [Thread-2  ]: Writing runtime sql for node "model.northwind_dbt.stg_employees"
[0m17:38:14.388437 [debug] [Thread-3  ]: Writing runtime sql for node "model.northwind_dbt.stg_order_details"
[0m17:38:14.395438 [debug] [Thread-4  ]: Writing runtime sql for node "model.northwind_dbt.stg_orders"
[0m17:38:14.401439 [debug] [Thread-5  ]: Writing runtime sql for node "model.northwind_dbt.stg_products"
[0m17:38:14.423060 [debug] [Thread-1  ]: Using snowflake connection "model.northwind_dbt.stg_customers"
[0m17:38:14.424071 [debug] [Thread-1  ]: On model.northwind_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.stg_customers"} */
create or replace   view PROJECT_2.PUBLIC.stg_customers
  
   as (
    select * from PROJECT_2.PUBLIC.customers
  );
[0m17:38:14.426499 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m17:38:14.436305 [debug] [Thread-5  ]: Using snowflake connection "model.northwind_dbt.stg_products"
[0m17:38:14.438298 [debug] [Thread-4  ]: Using snowflake connection "model.northwind_dbt.stg_orders"
[0m17:38:14.439298 [debug] [Thread-3  ]: Using snowflake connection "model.northwind_dbt.stg_order_details"
[0m17:38:14.440303 [debug] [Thread-2  ]: Using snowflake connection "model.northwind_dbt.stg_employees"
[0m17:38:14.441303 [debug] [Thread-5  ]: On model.northwind_dbt.stg_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.stg_products"} */
create or replace   view PROJECT_2.PUBLIC.stg_products
  
   as (
    select * from PROJECT_2.PUBLIC.products
  );
[0m17:38:14.442301 [debug] [Thread-4  ]: On model.northwind_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.stg_orders"} */
create or replace   view PROJECT_2.PUBLIC.stg_orders
  
   as (
    select * from PROJECT_2.PUBLIC.orders
  );
[0m17:38:14.443809 [debug] [Thread-3  ]: On model.northwind_dbt.stg_order_details: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.stg_order_details"} */
create or replace   view PROJECT_2.PUBLIC.stg_order_details
  
   as (
    select * from PROJECT_2.PUBLIC.order_details
  );
[0m17:38:14.444820 [debug] [Thread-2  ]: On model.northwind_dbt.stg_employees: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.stg_employees"} */
create or replace   view PROJECT_2.PUBLIC.stg_employees
  
   as (
    select * from PROJECT_2.PUBLIC.employees
  );
[0m17:38:14.445823 [debug] [Thread-5  ]: Opening a new connection, currently in state init
[0m17:38:14.446825 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m17:38:14.447821 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m17:38:14.448822 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m17:38:15.304283 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.856 seconds
[0m17:38:15.343806 [debug] [Thread-5  ]: SQL status: SUCCESS 1 in 0.897 seconds
[0m17:38:15.345134 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.919 seconds
[0m17:38:15.349543 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9aa0b600-25cf-4d71-bf62-2c58c2433ab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A75910DBE0>]}
[0m17:38:15.350050 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9aa0b600-25cf-4d71-bf62-2c58c2433ab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A75910D7F0>]}
[0m17:38:15.355059 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9aa0b600-25cf-4d71-bf62-2c58c2433ab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A7590DBE50>]}
[0m17:38:15.356456 [info ] [Thread-3  ]: 3 of 13 OK created sql view model PUBLIC.stg_order_details ..................... [[32mSUCCESS 1[0m in 1.14s]
[0m17:38:15.358976 [info ] [Thread-5  ]: 5 of 13 OK created sql view model PUBLIC.stg_products .......................... [[32mSUCCESS 1[0m in 1.12s]
[0m17:38:15.359988 [info ] [Thread-1  ]: 1 of 13 OK created sql view model PUBLIC.stg_customers ......................... [[32mSUCCESS 1[0m in 1.18s]
[0m17:38:15.361988 [debug] [Thread-3  ]: Finished running node model.northwind_dbt.stg_order_details
[0m17:38:15.362987 [debug] [Thread-5  ]: Finished running node model.northwind_dbt.stg_products
[0m17:38:15.364993 [debug] [Thread-1  ]: Finished running node model.northwind_dbt.stg_customers
[0m17:38:15.367356 [debug] [Thread-7  ]: Began running node model.northwind_dbt.dim_products
[0m17:38:15.368989 [debug] [Thread-9  ]: Began running node model.northwind_dbt.dim_customers
[0m17:38:15.372090 [info ] [Thread-7  ]: 6 of 13 START sql table model PUBLIC.dim_products .............................. [RUN]
[0m17:38:15.375539 [info ] [Thread-9  ]: 7 of 13 START sql table model PUBLIC.dim_customers ............................. [RUN]
[0m17:38:15.377047 [debug] [Thread-7  ]: Acquiring new snowflake connection 'model.northwind_dbt.dim_products'
[0m17:38:15.378054 [debug] [Thread-9  ]: Acquiring new snowflake connection 'model.northwind_dbt.dim_customers'
[0m17:38:15.381056 [debug] [Thread-7  ]: Began compiling node model.northwind_dbt.dim_products
[0m17:38:15.382054 [debug] [Thread-9  ]: Began compiling node model.northwind_dbt.dim_customers
[0m17:38:15.391076 [debug] [Thread-7  ]: Writing injected SQL for node "model.northwind_dbt.dim_products"
[0m17:38:15.398800 [debug] [Thread-9  ]: Writing injected SQL for node "model.northwind_dbt.dim_customers"
[0m17:38:15.415625 [debug] [Thread-9  ]: Began executing node model.northwind_dbt.dim_customers
[0m17:38:15.417723 [debug] [Thread-7  ]: Began executing node model.northwind_dbt.dim_products
[0m17:38:15.452810 [debug] [Thread-9  ]: Writing runtime sql for node "model.northwind_dbt.dim_customers"
[0m17:38:15.457426 [debug] [Thread-7  ]: Writing runtime sql for node "model.northwind_dbt.dim_products"
[0m17:38:15.473328 [debug] [Thread-7  ]: Using snowflake connection "model.northwind_dbt.dim_products"
[0m17:38:15.474340 [debug] [Thread-9  ]: Using snowflake connection "model.northwind_dbt.dim_customers"
[0m17:38:15.475340 [debug] [Thread-7  ]: On model.northwind_dbt.dim_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.dim_products"} */
create or replace transient table PROJECT_2.PUBLIC.dim_products
         as
        (select 
    p.product_id,
    p.product_name,
    p.supplier_id,
    s.company_name as supplier_name,
    p.category_id,
    c.category_name,
    p.quantity_per_unit,
    p.unit_price,
    p.units_in_stock,
    p.units_on_order,
    p.reorder_level,
    p.discontinued
from PROJECT_2.PUBLIC.stg_products p
left join PROJECT_2.PUBLIC.suppliers s on p.supplier_id = s.supplier_id
left join PROJECT_2.PUBLIC.categories c on p.category_id = c.category_id
        );
[0m17:38:15.476160 [debug] [Thread-9  ]: On model.northwind_dbt.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.dim_customers"} */
create or replace transient table PROJECT_2.PUBLIC.dim_customers
         as
        (select * from PROJECT_2.PUBLIC.stg_customers
        );
[0m17:38:15.477169 [debug] [Thread-7  ]: Opening a new connection, currently in state init
[0m17:38:15.478170 [debug] [Thread-9  ]: Opening a new connection, currently in state init
[0m17:38:15.510889 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.061 seconds
[0m17:38:15.515410 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9aa0b600-25cf-4d71-bf62-2c58c2433ab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A75A26EFD0>]}
[0m17:38:15.516409 [info ] [Thread-2  ]: 2 of 13 OK created sql view model PUBLIC.stg_employees ......................... [[32mSUCCESS 1[0m in 1.34s]
[0m17:38:15.520408 [debug] [Thread-2  ]: Finished running node model.northwind_dbt.stg_employees
[0m17:38:15.521408 [debug] [Thread-11 ]: Began running node model.northwind_dbt.dim_employees
[0m17:38:15.522409 [info ] [Thread-11 ]: 8 of 13 START sql table model PUBLIC.dim_employees ............................. [RUN]
[0m17:38:15.526925 [debug] [Thread-11 ]: Acquiring new snowflake connection 'model.northwind_dbt.dim_employees'
[0m17:38:15.528925 [debug] [Thread-11 ]: Began compiling node model.northwind_dbt.dim_employees
[0m17:38:15.558366 [debug] [Thread-11 ]: Writing injected SQL for node "model.northwind_dbt.dim_employees"
[0m17:38:15.578146 [debug] [Thread-11 ]: Began executing node model.northwind_dbt.dim_employees
[0m17:38:15.585667 [debug] [Thread-11 ]: Writing runtime sql for node "model.northwind_dbt.dim_employees"
[0m17:38:15.598375 [debug] [Thread-11 ]: Using snowflake connection "model.northwind_dbt.dim_employees"
[0m17:38:15.607890 [debug] [Thread-11 ]: On model.northwind_dbt.dim_employees: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.dim_employees"} */
create or replace transient table PROJECT_2.PUBLIC.dim_employees
         as
        (with source_data as (
    select * from PROJECT_2.PUBLIC.stg_employees
),
scd2 as (
    select 
        md5(cast(coalesce(cast(employee_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as employee_key,
        *,
        current_timestamp as dbt_updated_at
    from source_data
)
select * from scd2
        );
[0m17:38:15.609891 [debug] [Thread-11 ]: Opening a new connection, currently in state init
[0m17:38:15.975084 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1.528 seconds
[0m17:38:15.980928 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9aa0b600-25cf-4d71-bf62-2c58c2433ab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A7591DDFD0>]}
[0m17:38:15.981928 [info ] [Thread-4  ]: 4 of 13 OK created sql view model PUBLIC.stg_orders ............................ [[32mSUCCESS 1[0m in 1.76s]
[0m17:38:15.984442 [debug] [Thread-4  ]: Finished running node model.northwind_dbt.stg_orders
[0m17:38:15.985844 [debug] [Thread-6  ]: Began running node model.northwind_dbt.fact_order_details
[0m17:38:15.986853 [info ] [Thread-6  ]: 9 of 13 START sql incremental model PUBLIC.fact_order_details .................. [RUN]
[0m17:38:15.987851 [debug] [Thread-6  ]: Acquiring new snowflake connection 'model.northwind_dbt.fact_order_details'
[0m17:38:15.988852 [debug] [Thread-6  ]: Began compiling node model.northwind_dbt.fact_order_details
[0m17:38:16.005101 [debug] [Thread-6  ]: Writing injected SQL for node "model.northwind_dbt.fact_order_details"
[0m17:38:16.018389 [debug] [Thread-6  ]: Began executing node model.northwind_dbt.fact_order_details
[0m17:38:16.078976 [debug] [Thread-6  ]: Using snowflake connection "model.northwind_dbt.fact_order_details"
[0m17:38:16.079977 [debug] [Thread-6  ]: On model.northwind_dbt.fact_order_details: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.fact_order_details"} */
create or replace  temporary view PROJECT_2.PUBLIC.fact_order_details__dbt_tmp
  
   as (
    

with base as (
    select 
        od.order_id,
        od.product_id,
        o.customer_id,
        o.employee_id,
        o.ship_via as shipper_id,
        o.order_date,
        od.unit_price,
        od.quantity,
        od.discount,
        od.unit_price * od.quantity * (1 - od.discount) as revenue
    from PROJECT_2.PUBLIC.stg_order_details od
    join PROJECT_2.PUBLIC.stg_orders o on od.order_id = o.order_id
    
        and o.order_date >= (select max(order_date) from PROJECT_2.PUBLIC.fact_order_details)
    
),
aggregated as (
    select 
        order_id,
        product_id,
        customer_id,
        employee_id,
        shipper_id,
        cast(order_date as date) as order_date,
        sum(revenue) as total_revenue,
        avg(revenue) as avg_revenue,
        max(revenue) as max_revenue,
        min(revenue) as min_revenue,
        count(*) as line_count,
        rank() over (partition by customer_id order by sum(revenue) desc) as revenue_rank
    from base
    group by order_id, product_id, customer_id, employee_id, shipper_id, order_date
)
select * from aggregated
  );
[0m17:38:16.080976 [debug] [Thread-6  ]: Opening a new connection, currently in state init
[0m17:38:16.942180 [debug] [Thread-6  ]: SQL status: SUCCESS 1 in 0.862 seconds
[0m17:38:16.960916 [debug] [Thread-6  ]: Using snowflake connection "model.northwind_dbt.fact_order_details"
[0m17:38:16.961915 [debug] [Thread-6  ]: On model.northwind_dbt.fact_order_details: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.fact_order_details"} */
describe table PROJECT_2.PUBLIC.fact_order_details__dbt_tmp
[0m17:38:17.065019 [debug] [Thread-6  ]: SQL status: SUCCESS 12 in 0.102 seconds
[0m17:38:17.072393 [debug] [Thread-6  ]: Using snowflake connection "model.northwind_dbt.fact_order_details"
[0m17:38:17.073436 [debug] [Thread-6  ]: On model.northwind_dbt.fact_order_details: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.fact_order_details"} */
describe table PROJECT_2.PUBLIC.fact_order_details
[0m17:38:17.116625 [debug] [Thread-11 ]: SQL status: SUCCESS 1 in 1.506 seconds
[0m17:38:17.120625 [debug] [Thread-11 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9aa0b600-25cf-4d71-bf62-2c58c2433ab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A7590EA880>]}
[0m17:38:17.122627 [info ] [Thread-11 ]: 8 of 13 OK created sql table model PUBLIC.dim_employees ........................ [[32mSUCCESS 1[0m in 1.59s]
[0m17:38:17.124642 [debug] [Thread-11 ]: Finished running node model.northwind_dbt.dim_employees
[0m17:38:17.162337 [debug] [Thread-6  ]: SQL status: SUCCESS 12 in 0.088 seconds
[0m17:38:17.175200 [debug] [Thread-6  ]: Using snowflake connection "model.northwind_dbt.fact_order_details"
[0m17:38:17.176200 [debug] [Thread-6  ]: On model.northwind_dbt.fact_order_details: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.fact_order_details"} */
describe table "PROJECT_2"."PUBLIC"."FACT_ORDER_DETAILS"
[0m17:38:17.259828 [debug] [Thread-9  ]: SQL status: SUCCESS 1 in 1.781 seconds
[0m17:38:17.263493 [debug] [Thread-9  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9aa0b600-25cf-4d71-bf62-2c58c2433ab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A7591EBCA0>]}
[0m17:38:17.265501 [info ] [Thread-9  ]: 7 of 13 OK created sql table model PUBLIC.dim_customers ........................ [[32mSUCCESS 1[0m in 1.89s]
[0m17:38:17.266500 [debug] [Thread-9  ]: Finished running node model.northwind_dbt.dim_customers
[0m17:38:17.330510 [debug] [Thread-7  ]: SQL status: SUCCESS 1 in 1.853 seconds
[0m17:38:17.331507 [debug] [Thread-6  ]: SQL status: SUCCESS 12 in 0.155 seconds
[0m17:38:17.337027 [debug] [Thread-7  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9aa0b600-25cf-4d71-bf62-2c58c2433ab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A75A251C40>]}
[0m17:38:17.374067 [debug] [Thread-6  ]: Writing runtime sql for node "model.northwind_dbt.fact_order_details"
[0m17:38:17.375068 [info ] [Thread-7  ]: 6 of 13 OK created sql table model PUBLIC.dim_products ......................... [[32mSUCCESS 1[0m in 1.96s]
[0m17:38:17.378593 [debug] [Thread-7  ]: Finished running node model.northwind_dbt.dim_products
[0m17:38:17.390560 [debug] [Thread-6  ]: Using snowflake connection "model.northwind_dbt.fact_order_details"
[0m17:38:17.391559 [debug] [Thread-6  ]: On model.northwind_dbt.fact_order_details: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.fact_order_details"} */
-- back compat for old kwarg name
  
  begin;
[0m17:38:17.549218 [debug] [Thread-6  ]: SQL status: SUCCESS 1 in 0.156 seconds
[0m17:38:17.550216 [debug] [Thread-6  ]: Using snowflake connection "model.northwind_dbt.fact_order_details"
[0m17:38:17.552216 [debug] [Thread-6  ]: On model.northwind_dbt.fact_order_details: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.fact_order_details"} */
merge into PROJECT_2.PUBLIC.fact_order_details as DBT_INTERNAL_DEST
        using PROJECT_2.PUBLIC.fact_order_details__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.order_id = DBT_INTERNAL_DEST.order_id
                ) and (
                    DBT_INTERNAL_SOURCE.product_id = DBT_INTERNAL_DEST.product_id
                )

    
    when matched then update set
        "ORDER_ID" = DBT_INTERNAL_SOURCE."ORDER_ID","PRODUCT_ID" = DBT_INTERNAL_SOURCE."PRODUCT_ID","CUSTOMER_ID" = DBT_INTERNAL_SOURCE."CUSTOMER_ID","EMPLOYEE_ID" = DBT_INTERNAL_SOURCE."EMPLOYEE_ID","SHIPPER_ID" = DBT_INTERNAL_SOURCE."SHIPPER_ID","ORDER_DATE" = DBT_INTERNAL_SOURCE."ORDER_DATE","TOTAL_REVENUE" = DBT_INTERNAL_SOURCE."TOTAL_REVENUE","AVG_REVENUE" = DBT_INTERNAL_SOURCE."AVG_REVENUE","MAX_REVENUE" = DBT_INTERNAL_SOURCE."MAX_REVENUE","MIN_REVENUE" = DBT_INTERNAL_SOURCE."MIN_REVENUE","LINE_COUNT" = DBT_INTERNAL_SOURCE."LINE_COUNT","REVENUE_RANK" = DBT_INTERNAL_SOURCE."REVENUE_RANK"
    

    when not matched then insert
        ("ORDER_ID", "PRODUCT_ID", "CUSTOMER_ID", "EMPLOYEE_ID", "SHIPPER_ID", "ORDER_DATE", "TOTAL_REVENUE", "AVG_REVENUE", "MAX_REVENUE", "MIN_REVENUE", "LINE_COUNT", "REVENUE_RANK")
    values
        ("ORDER_ID", "PRODUCT_ID", "CUSTOMER_ID", "EMPLOYEE_ID", "SHIPPER_ID", "ORDER_DATE", "TOTAL_REVENUE", "AVG_REVENUE", "MAX_REVENUE", "MIN_REVENUE", "LINE_COUNT", "REVENUE_RANK")

;
[0m17:38:18.992382 [debug] [Thread-6  ]: SQL status: SUCCESS 32 in 1.439 seconds
[0m17:38:18.993378 [debug] [Thread-6  ]: Using snowflake connection "model.northwind_dbt.fact_order_details"
[0m17:38:18.994387 [debug] [Thread-6  ]: On model.northwind_dbt.fact_order_details: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.fact_order_details"} */
COMMIT
[0m17:38:19.504365 [debug] [Thread-6  ]: SQL status: SUCCESS 1 in 0.508 seconds
[0m17:38:19.518480 [debug] [Thread-6  ]: Applying DROP to: PROJECT_2.PUBLIC.fact_order_details__dbt_tmp
[0m17:38:19.532615 [debug] [Thread-6  ]: Using snowflake connection "model.northwind_dbt.fact_order_details"
[0m17:38:19.535125 [debug] [Thread-6  ]: On model.northwind_dbt.fact_order_details: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.fact_order_details"} */
drop view if exists PROJECT_2.PUBLIC.fact_order_details__dbt_tmp cascade
[0m17:38:19.656636 [debug] [Thread-6  ]: SQL status: SUCCESS 1 in 0.121 seconds
[0m17:38:19.662160 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9aa0b600-25cf-4d71-bf62-2c58c2433ab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A758A042E0>]}
[0m17:38:19.664170 [info ] [Thread-6  ]: 9 of 13 OK created sql incremental model PUBLIC.fact_order_details ............. [[32mSUCCESS 32[0m in 3.67s]
[0m17:38:19.666173 [debug] [Thread-6  ]: Finished running node model.northwind_dbt.fact_order_details
[0m17:38:19.669168 [debug] [Thread-5  ]: Began running node model.northwind_dbt.obt_orders
[0m17:38:19.670422 [debug] [Thread-1  ]: Began running node model.northwind_dbt.top_customer_revenue
[0m17:38:19.671431 [debug] [Thread-8  ]: Began running node model.northwind_dbt.top_employee_revenue
[0m17:38:19.672434 [debug] [Thread-10 ]: Began running node model.northwind_dbt.top_performing_products
[0m17:38:19.674465 [info ] [Thread-5  ]: 10 of 13 START sql table model PUBLIC.obt_orders ............................... [RUN]
[0m17:38:19.675977 [info ] [Thread-1  ]: 11 of 13 START sql table model PUBLIC.top_customer_revenue ..................... [RUN]
[0m17:38:19.678519 [info ] [Thread-8  ]: 12 of 13 START sql table model PUBLIC.top_employee_revenue ..................... [RUN]
[0m17:38:19.686142 [debug] [Thread-5  ]: Re-using an available connection from the pool (formerly model.northwind_dbt.stg_products, now model.northwind_dbt.obt_orders)
[0m17:38:19.681557 [info ] [Thread-10 ]: 13 of 13 START sql table model PUBLIC.top_performing_products .................. [RUN]
[0m17:38:19.688335 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.northwind_dbt.stg_customers, now model.northwind_dbt.top_customer_revenue)
[0m17:38:19.690336 [debug] [Thread-8  ]: Acquiring new snowflake connection 'model.northwind_dbt.top_employee_revenue'
[0m17:38:19.691333 [debug] [Thread-5  ]: Began compiling node model.northwind_dbt.obt_orders
[0m17:38:19.693334 [debug] [Thread-10 ]: Acquiring new snowflake connection 'model.northwind_dbt.top_performing_products'
[0m17:38:19.695845 [debug] [Thread-1  ]: Began compiling node model.northwind_dbt.top_customer_revenue
[0m17:38:19.697854 [debug] [Thread-8  ]: Began compiling node model.northwind_dbt.top_employee_revenue
[0m17:38:19.706854 [debug] [Thread-5  ]: Writing injected SQL for node "model.northwind_dbt.obt_orders"
[0m17:38:19.708856 [debug] [Thread-10 ]: Began compiling node model.northwind_dbt.top_performing_products
[0m17:38:19.718372 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind_dbt.top_customer_revenue"
[0m17:38:19.724880 [debug] [Thread-8  ]: Writing injected SQL for node "model.northwind_dbt.top_employee_revenue"
[0m17:38:19.733253 [debug] [Thread-10 ]: Writing injected SQL for node "model.northwind_dbt.top_performing_products"
[0m17:38:19.752451 [debug] [Thread-5  ]: Began executing node model.northwind_dbt.obt_orders
[0m17:38:19.762488 [debug] [Thread-5  ]: Writing runtime sql for node "model.northwind_dbt.obt_orders"
[0m17:38:19.769724 [debug] [Thread-1  ]: Began executing node model.northwind_dbt.top_customer_revenue
[0m17:38:19.770728 [debug] [Thread-8  ]: Began executing node model.northwind_dbt.top_employee_revenue
[0m17:38:19.777256 [debug] [Thread-10 ]: Began executing node model.northwind_dbt.top_performing_products
[0m17:38:19.780256 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind_dbt.top_customer_revenue"
[0m17:38:19.788254 [debug] [Thread-8  ]: Writing runtime sql for node "model.northwind_dbt.top_employee_revenue"
[0m17:38:19.791251 [debug] [Thread-5  ]: Using snowflake connection "model.northwind_dbt.obt_orders"
[0m17:38:19.801831 [debug] [Thread-10 ]: Writing runtime sql for node "model.northwind_dbt.top_performing_products"
[0m17:38:19.805129 [debug] [Thread-5  ]: On model.northwind_dbt.obt_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.obt_orders"} */
create or replace transient table PROJECT_2.PUBLIC.obt_orders
         as
        (select 
    f.order_id,
    f.product_id,
    f.customer_id,
    f.employee_id,
    f.shipper_id,
    f.order_date,
    f.total_revenue,
    f.avg_revenue,
    f.max_revenue,
    f.min_revenue,
    f.line_count,
    f.revenue_rank,

    c.company_name as customer_name,
    p.product_name,
    p.category_name,
    p.supplier_name,
    e.first_name || ' ' || e.last_name as employee_name,
    s.company_name as shipper_name

from PROJECT_2.PUBLIC.fact_order_details f
left join PROJECT_2.PUBLIC.dim_customers c on f.customer_id = c.customer_id
left join PROJECT_2.PUBLIC.dim_products p on f.product_id = p.product_id
left join PROJECT_2.PUBLIC.dim_employees e on f.employee_id = e.employee_id
left join PROJECT_2.PUBLIC.shippers s on f.shipper_id = s.shipper_id
        );
[0m17:38:19.824178 [debug] [Thread-1  ]: Using snowflake connection "model.northwind_dbt.top_customer_revenue"
[0m17:38:19.826178 [debug] [Thread-1  ]: On model.northwind_dbt.top_customer_revenue: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.top_customer_revenue"} */
create or replace transient table PROJECT_2.PUBLIC.top_customer_revenue
         as
        (

select
  c.customer_id,
  c.company_name as customer_name,
  sum(f.total_revenue) as total_revenue
from PROJECT_2.PUBLIC.fact_order_details f
join PROJECT_2.PUBLIC.dim_customers c using (customer_id)
group by c.customer_id, c.company_name
order by total_revenue desc
        );
[0m17:38:19.829178 [debug] [Thread-8  ]: Using snowflake connection "model.northwind_dbt.top_employee_revenue"
[0m17:38:19.835330 [debug] [Thread-10 ]: Using snowflake connection "model.northwind_dbt.top_performing_products"
[0m17:38:19.836342 [debug] [Thread-8  ]: On model.northwind_dbt.top_employee_revenue: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.top_employee_revenue"} */
create or replace transient table PROJECT_2.PUBLIC.top_employee_revenue
         as
        (

select
  e.employee_key,
  e.first_name || ' ' || e.last_name as employee_name,
  sum(f.total_revenue) as total_revenue
from PROJECT_2.PUBLIC.fact_order_details f
join PROJECT_2.PUBLIC.dim_employees e on f.employee_id = e.employee_id
group by e.employee_key, employee_name
order by total_revenue desc
        );
[0m17:38:19.840344 [debug] [Thread-10 ]: On model.northwind_dbt.top_performing_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.top_performing_products"} */
create or replace transient table PROJECT_2.PUBLIC.top_performing_products
         as
        (

select
  p.product_id,
  p.product_name,
  sum(f.total_revenue) as total_revenue,
  count(distinct f.order_id) as number_of_orders
from PROJECT_2.PUBLIC.fact_order_details f
join PROJECT_2.PUBLIC.dim_products p on f.product_id = p.product_id
group by p.product_id, p.product_name
order by total_revenue desc
        );
[0m17:38:19.843342 [debug] [Thread-8  ]: Opening a new connection, currently in state init
[0m17:38:19.845857 [debug] [Thread-10 ]: Opening a new connection, currently in state init
[0m17:38:20.936661 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.109 seconds
[0m17:38:20.941193 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9aa0b600-25cf-4d71-bf62-2c58c2433ab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A75914CB20>]}
[0m17:38:20.943195 [info ] [Thread-1  ]: 11 of 13 OK created sql table model PUBLIC.top_customer_revenue ................ [[32mSUCCESS 1[0m in 1.25s]
[0m17:38:20.945198 [debug] [Thread-1  ]: Finished running node model.northwind_dbt.top_customer_revenue
[0m17:38:20.993256 [debug] [Thread-5  ]: SQL status: SUCCESS 1 in 1.186 seconds
[0m17:38:20.998256 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9aa0b600-25cf-4d71-bf62-2c58c2433ab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A75A335A60>]}
[0m17:38:21.000257 [info ] [Thread-5  ]: 10 of 13 OK created sql table model PUBLIC.obt_orders .......................... [[32mSUCCESS 1[0m in 1.31s]
[0m17:38:21.002835 [debug] [Thread-5  ]: Finished running node model.northwind_dbt.obt_orders
[0m17:38:21.119419 [debug] [Thread-8  ]: SQL status: SUCCESS 1 in 1.276 seconds
[0m17:38:21.123109 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9aa0b600-25cf-4d71-bf62-2c58c2433ab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A7591F4B20>]}
[0m17:38:21.124109 [info ] [Thread-8  ]: 12 of 13 OK created sql table model PUBLIC.top_employee_revenue ................ [[32mSUCCESS 1[0m in 1.43s]
[0m17:38:21.126109 [debug] [Thread-10 ]: SQL status: SUCCESS 1 in 1.280 seconds
[0m17:38:21.127109 [debug] [Thread-8  ]: Finished running node model.northwind_dbt.top_employee_revenue
[0m17:38:21.130625 [debug] [Thread-10 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9aa0b600-25cf-4d71-bf62-2c58c2433ab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A75A33A3D0>]}
[0m17:38:21.132625 [info ] [Thread-10 ]: 13 of 13 OK created sql table model PUBLIC.top_performing_products ............. [[32mSUCCESS 1[0m in 1.44s]
[0m17:38:21.133623 [debug] [Thread-10 ]: Finished running node model.northwind_dbt.top_performing_products
[0m17:38:21.138139 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:38:21.139138 [debug] [MainThread]: Connection 'list_PROJECT_2' was left open.
[0m17:38:21.140148 [debug] [MainThread]: On list_PROJECT_2: Close
[0m17:38:21.289949 [debug] [MainThread]: Connection 'list_PROJECT_2_PUBLIC' was left open.
[0m17:38:21.290477 [debug] [MainThread]: On list_PROJECT_2_PUBLIC: Close
[0m17:38:21.454740 [debug] [MainThread]: Connection 'list_PROJECT_2_snapshots' was left open.
[0m17:38:21.455330 [debug] [MainThread]: On list_PROJECT_2_snapshots: Close
[0m17:38:21.567416 [debug] [MainThread]: Connection 'model.northwind_dbt.top_customer_revenue' was left open.
[0m17:38:21.568425 [debug] [MainThread]: On model.northwind_dbt.top_customer_revenue: Close
[0m17:38:21.688594 [debug] [MainThread]: Connection 'model.northwind_dbt.stg_employees' was left open.
[0m17:38:21.689652 [debug] [MainThread]: On model.northwind_dbt.stg_employees: Close
[0m17:38:21.823993 [debug] [MainThread]: Connection 'model.northwind_dbt.stg_order_details' was left open.
[0m17:38:21.825001 [debug] [MainThread]: On model.northwind_dbt.stg_order_details: Close
[0m17:38:21.943749 [debug] [MainThread]: Connection 'model.northwind_dbt.stg_orders' was left open.
[0m17:38:21.945257 [debug] [MainThread]: On model.northwind_dbt.stg_orders: Close
[0m17:38:22.062719 [debug] [MainThread]: Connection 'model.northwind_dbt.obt_orders' was left open.
[0m17:38:22.063717 [debug] [MainThread]: On model.northwind_dbt.obt_orders: Close
[0m17:38:22.188526 [debug] [MainThread]: Connection 'model.northwind_dbt.dim_products' was left open.
[0m17:38:22.189524 [debug] [MainThread]: On model.northwind_dbt.dim_products: Close
[0m17:38:22.308150 [debug] [MainThread]: Connection 'model.northwind_dbt.dim_customers' was left open.
[0m17:38:22.309149 [debug] [MainThread]: On model.northwind_dbt.dim_customers: Close
[0m17:38:22.436772 [debug] [MainThread]: Connection 'model.northwind_dbt.dim_employees' was left open.
[0m17:38:22.436772 [debug] [MainThread]: On model.northwind_dbt.dim_employees: Close
[0m17:38:22.556887 [debug] [MainThread]: Connection 'model.northwind_dbt.fact_order_details' was left open.
[0m17:38:22.557898 [debug] [MainThread]: On model.northwind_dbt.fact_order_details: Close
[0m17:38:22.677414 [debug] [MainThread]: Connection 'model.northwind_dbt.top_employee_revenue' was left open.
[0m17:38:22.678415 [debug] [MainThread]: On model.northwind_dbt.top_employee_revenue: Close
[0m17:38:22.797899 [debug] [MainThread]: Connection 'model.northwind_dbt.top_performing_products' was left open.
[0m17:38:22.798908 [debug] [MainThread]: On model.northwind_dbt.top_performing_products: Close
[0m17:38:22.944683 [info ] [MainThread]: 
[0m17:38:22.946197 [info ] [MainThread]: Finished running 1 incremental model, 7 table models, 5 view models in 0 hours 0 minutes and 10.31 seconds (10.31s).
[0m17:38:22.950770 [debug] [MainThread]: Command end result
[0m17:38:23.118436 [debug] [MainThread]: Wrote artifact WritableManifest to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\manifest.json
[0m17:38:23.126954 [debug] [MainThread]: Wrote artifact SemanticManifest to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\semantic_manifest.json
[0m17:38:23.149499 [debug] [MainThread]: Wrote artifact RunExecutionResult to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\run_results.json
[0m17:38:23.150507 [info ] [MainThread]: 
[0m17:38:23.153361 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:38:23.154444 [info ] [MainThread]: 
[0m17:38:23.156265 [info ] [MainThread]: Done. PASS=13 WARN=0 ERROR=0 SKIP=0 TOTAL=13
[0m17:38:23.158949 [debug] [MainThread]: Command `dbt run` succeeded at 17:38:23.158413 after 14.34 seconds
[0m17:38:23.160047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A73D84F3D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A7583B0C40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A73F856B50>]}
[0m17:38:23.161107 [debug] [MainThread]: Flushing usage events
[0m17:38:25.030342 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:40:13.027000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A85036F400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8523E5BB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8523E59A0>]}


============================== 17:40:13.034691 | 2bba4152-eb62-4f4e-9d0c-a6def3027f32 ==============================
[0m17:40:13.034691 [info ] [MainThread]: Running with dbt=1.9.0
[0m17:40:13.036442 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'c:\\Users\\fitzp\\Documents\\Alpaca_Market\\zproject_2\\northwind_psql', 'debug': 'False', 'warn_error': 'None', 'log_path': 'c:\\Users\\fitzp\\Documents\\Alpaca_Market\\zproject_2\\northwind_psql\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt snapshot', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:40:14.845821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2bba4152-eb62-4f4e-9d0c-a6def3027f32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A84F3579A0>]}
[0m17:40:14.923265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2bba4152-eb62-4f4e-9d0c-a6def3027f32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A86AED0E80>]}
[0m17:40:14.925229 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m17:40:15.485433 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m17:40:16.116965 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:40:16.119969 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:40:16.133270 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.northwind_dbt.marts.bi
[0m17:40:16.221449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2bba4152-eb62-4f4e-9d0c-a6def3027f32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A86B4F4130>]}
[0m17:40:16.506877 [debug] [MainThread]: Wrote artifact WritableManifest to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\manifest.json
[0m17:40:16.513883 [debug] [MainThread]: Wrote artifact SemanticManifest to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\semantic_manifest.json
[0m17:40:16.573263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2bba4152-eb62-4f4e-9d0c-a6def3027f32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A852398460>]}
[0m17:40:16.575266 [info ] [MainThread]: Found 13 models, 2 snapshots, 16 data tests, 8 sources, 706 macros
[0m17:40:16.577271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2bba4152-eb62-4f4e-9d0c-a6def3027f32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A852376940>]}
[0m17:40:16.580309 [info ] [MainThread]: 
[0m17:40:16.581266 [info ] [MainThread]: Concurrency: 12 threads (target='dev')
[0m17:40:16.583264 [info ] [MainThread]: 
[0m17:40:16.587273 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:40:16.596699 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_2'
[0m17:40:16.758900 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_2"
[0m17:40:16.759901 [debug] [ThreadPool]: On list_PROJECT_2: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "connection_name": "list_PROJECT_2"} */
show terse schemas in database PROJECT_2
    limit 10000
[0m17:40:16.759901 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:40:17.896752 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.137 seconds
[0m17:40:17.902681 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_2_PUBLIC'
[0m17:40:17.916972 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_2_snapshots'
[0m17:40:17.922004 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_2_PUBLIC"
[0m17:40:17.927001 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_2_snapshots"
[0m17:40:17.928001 [debug] [ThreadPool]: On list_PROJECT_2_PUBLIC: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "connection_name": "list_PROJECT_2_PUBLIC"} */
show objects in PROJECT_2.PUBLIC limit 10000;
[0m17:40:17.929005 [debug] [ThreadPool]: On list_PROJECT_2_snapshots: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "connection_name": "list_PROJECT_2_snapshots"} */
show objects in PROJECT_2.snapshots limit 10000;
[0m17:40:17.930002 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:40:17.931009 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:40:18.492740 [debug] [ThreadPool]: SQL status: SUCCESS 27 in 0.563 seconds
[0m17:40:18.495310 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.564 seconds
[0m17:40:18.514581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2bba4152-eb62-4f4e-9d0c-a6def3027f32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A84F262850>]}
[0m17:40:18.531675 [debug] [Thread-1  ]: Began running node snapshot.northwind_dbt.customers_snapshot
[0m17:40:18.533007 [debug] [Thread-2  ]: Began running node snapshot.northwind_dbt.employees_snapshot
[0m17:40:18.535184 [info ] [Thread-1  ]: 1 of 2 START snapshot snapshots.customers_snapshot ............................. [RUN]
[0m17:40:18.537930 [info ] [Thread-2  ]: 2 of 2 START snapshot snapshots.employees_snapshot ............................. [RUN]
[0m17:40:18.539711 [debug] [Thread-1  ]: Acquiring new snowflake connection 'snapshot.northwind_dbt.customers_snapshot'
[0m17:40:18.541306 [debug] [Thread-2  ]: Acquiring new snowflake connection 'snapshot.northwind_dbt.employees_snapshot'
[0m17:40:18.542887 [debug] [Thread-1  ]: Began compiling node snapshot.northwind_dbt.customers_snapshot
[0m17:40:18.543982 [debug] [Thread-2  ]: Began compiling node snapshot.northwind_dbt.employees_snapshot
[0m17:40:18.555298 [debug] [Thread-1  ]: Began executing node snapshot.northwind_dbt.customers_snapshot
[0m17:40:18.564881 [debug] [Thread-2  ]: Began executing node snapshot.northwind_dbt.employees_snapshot
[0m17:40:18.719893 [debug] [Thread-2  ]: Using snowflake connection "snapshot.northwind_dbt.employees_snapshot"
[0m17:40:18.751209 [debug] [Thread-1  ]: Using snowflake connection "snapshot.northwind_dbt.customers_snapshot"
[0m17:40:18.752211 [debug] [Thread-2  ]: On snapshot.northwind_dbt.employees_snapshot: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "snapshot.northwind_dbt.employees_snapshot"} */
select * from (
        select first_name, last_name, title, region, address from (
                

select * from PROJECT_2.PUBLIC.stg_employees
            ) subq
    ) as __dbt_sbq
    where false
    limit 0
[0m17:40:18.753210 [debug] [Thread-1  ]: On snapshot.northwind_dbt.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "snapshot.northwind_dbt.customers_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "snapshot.northwind_dbt.customers_snapshot"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(customer_id as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
        
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
from (
        

select * from PROJECT_2.PUBLIC.stg_customers
    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m17:40:18.755208 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m17:40:18.756735 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m17:40:19.264680 [debug] [Thread-2  ]: SQL status: SUCCESS 0 in 0.509 seconds
[0m17:40:19.279846 [debug] [Thread-2  ]: Using snowflake connection "snapshot.northwind_dbt.employees_snapshot"
[0m17:40:19.280995 [debug] [Thread-2  ]: On snapshot.northwind_dbt.employees_snapshot: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "snapshot.northwind_dbt.employees_snapshot"} */
describe table "PROJECT_2"."SNAPSHOTS"."EMPLOYEES_SNAPSHOT"
[0m17:40:19.380979 [debug] [Thread-2  ]: SQL status: SUCCESS 26 in 0.099 seconds
[0m17:40:19.390981 [debug] [Thread-2  ]: Using snowflake connection "snapshot.northwind_dbt.employees_snapshot"
[0m17:40:19.391982 [debug] [Thread-2  ]: On snapshot.northwind_dbt.employees_snapshot: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "snapshot.northwind_dbt.employees_snapshot"} */
describe table "PROJECT_2"."SNAPSHOTS"."EMPLOYEES_SNAPSHOT"
[0m17:40:19.435006 [debug] [Thread-1  ]: SQL status: SUCCESS 0 in 0.679 seconds
[0m17:40:19.443017 [debug] [Thread-1  ]: Using snowflake connection "snapshot.northwind_dbt.customers_snapshot"
[0m17:40:19.444015 [debug] [Thread-1  ]: On snapshot.northwind_dbt.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "snapshot.northwind_dbt.customers_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "snapshot.northwind_dbt.customers_snapshot"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m17:40:19.485034 [debug] [Thread-2  ]: SQL status: SUCCESS 26 in 0.092 seconds
[0m17:40:19.550169 [debug] [Thread-2  ]: Using snowflake connection "snapshot.northwind_dbt.employees_snapshot"
[0m17:40:19.553169 [debug] [Thread-1  ]: SQL status: SUCCESS 0 in 0.108 seconds
[0m17:40:19.554169 [debug] [Thread-2  ]: On snapshot.northwind_dbt.employees_snapshot: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "snapshot.northwind_dbt.employees_snapshot"} */
create or replace temporary table "PROJECT_2"."SNAPSHOTS"."EMPLOYEES_SNAPSHOT__dbt_tmp"
         as
        (
    
    with snapshot_query as (

        

select * from PROJECT_2.PUBLIC.stg_employees

    ),

    snapshotted_data as (

        select *, 
    
        employee_id as dbt_unique_key
    

        from "PROJECT_2"."SNAPSHOTS"."EMPLOYEES_SNAPSHOT"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        employee_id as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
,
            md5(coalesce(cast(employee_id as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        employee_id as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data."FIRST_NAME" != source_data."FIRST_NAME"
        or
        (
            ((snapshotted_data."FIRST_NAME" is null) and not (source_data."FIRST_NAME" is null))
            or
            ((not snapshotted_data."FIRST_NAME" is null) and (source_data."FIRST_NAME" is null))
        ) or snapshotted_data."LAST_NAME" != source_data."LAST_NAME"
        or
        (
            ((snapshotted_data."LAST_NAME" is null) and not (source_data."LAST_NAME" is null))
            or
            ((not snapshotted_data."LAST_NAME" is null) and (source_data."LAST_NAME" is null))
        ) or snapshotted_data."TITLE" != source_data."TITLE"
        or
        (
            ((snapshotted_data."TITLE" is null) and not (source_data."TITLE" is null))
            or
            ((not snapshotted_data."TITLE" is null) and (source_data."TITLE" is null))
        ) or snapshotted_data."REGION" != source_data."REGION"
        or
        (
            ((snapshotted_data."REGION" is null) and not (source_data."REGION" is null))
            or
            ((not snapshotted_data."REGION" is null) and (source_data."REGION" is null))
        ) or snapshotted_data."ADDRESS" != source_data."ADDRESS"
        or
        (
            ((snapshotted_data."ADDRESS" is null) and not (source_data."ADDRESS" is null))
            or
            ((not snapshotted_data."ADDRESS" is null) and (source_data."ADDRESS" is null))
        )))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."FIRST_NAME" != source_data."FIRST_NAME"
        or
        (
            ((snapshotted_data."FIRST_NAME" is null) and not (source_data."FIRST_NAME" is null))
            or
            ((not snapshotted_data."FIRST_NAME" is null) and (source_data."FIRST_NAME" is null))
        ) or snapshotted_data."LAST_NAME" != source_data."LAST_NAME"
        or
        (
            ((snapshotted_data."LAST_NAME" is null) and not (source_data."LAST_NAME" is null))
            or
            ((not snapshotted_data."LAST_NAME" is null) and (source_data."LAST_NAME" is null))
        ) or snapshotted_data."TITLE" != source_data."TITLE"
        or
        (
            ((snapshotted_data."TITLE" is null) and not (source_data."TITLE" is null))
            or
            ((not snapshotted_data."TITLE" is null) and (source_data."TITLE" is null))
        ) or snapshotted_data."REGION" != source_data."REGION"
        or
        (
            ((snapshotted_data."REGION" is null) and not (source_data."REGION" is null))
            or
            ((not snapshotted_data."REGION" is null) and (source_data."REGION" is null))
        ) or snapshotted_data."ADDRESS" != source_data."ADDRESS"
        or
        (
            ((snapshotted_data."ADDRESS" is null) and not (source_data."ADDRESS" is null))
            or
            ((not snapshotted_data."ADDRESS" is null) and (source_data."ADDRESS" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

        );
[0m17:40:19.556171 [debug] [Thread-1  ]: Writing runtime sql for node "snapshot.northwind_dbt.customers_snapshot"
[0m17:40:19.568650 [debug] [Thread-1  ]: Using snowflake connection "snapshot.northwind_dbt.customers_snapshot"
[0m17:40:19.569649 [debug] [Thread-1  ]: On snapshot.northwind_dbt.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "snapshot.northwind_dbt.customers_snapshot"} */
create or replace transient table PROJECT_2.snapshots.customers_snapshot
         as
        (
    

    select *,
        md5(coalesce(cast(customer_id as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
        
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
from (
        

select * from PROJECT_2.PUBLIC.stg_customers
    ) sbq



        );
[0m17:40:20.492348 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.921 seconds
[0m17:40:20.516459 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2bba4152-eb62-4f4e-9d0c-a6def3027f32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A84E9449A0>]}
[0m17:40:20.517770 [info ] [Thread-1  ]: 1 of 2 OK snapshotted snapshots.customers_snapshot ............................. [[32mSUCCESS 1[0m in 1.98s]
[0m17:40:20.519704 [debug] [Thread-1  ]: Finished running node snapshot.northwind_dbt.customers_snapshot
[0m17:40:20.639148 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.082 seconds
[0m17:40:20.642925 [debug] [Thread-2  ]: Using snowflake connection "snapshot.northwind_dbt.employees_snapshot"
[0m17:40:20.643940 [debug] [Thread-2  ]: On snapshot.northwind_dbt.employees_snapshot: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "snapshot.northwind_dbt.employees_snapshot"} */
describe table "PROJECT_2"."SNAPSHOTS"."EMPLOYEES_SNAPSHOT__dbt_tmp"
[0m17:40:20.759351 [debug] [Thread-2  ]: SQL status: SUCCESS 28 in 0.114 seconds
[0m17:40:20.767359 [debug] [Thread-2  ]: Using snowflake connection "snapshot.northwind_dbt.employees_snapshot"
[0m17:40:20.768360 [debug] [Thread-2  ]: On snapshot.northwind_dbt.employees_snapshot: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "snapshot.northwind_dbt.employees_snapshot"} */
describe table "PROJECT_2"."SNAPSHOTS"."EMPLOYEES_SNAPSHOT"
[0m17:40:20.872039 [debug] [Thread-2  ]: SQL status: SUCCESS 26 in 0.103 seconds
[0m17:40:20.878596 [debug] [Thread-2  ]: Using snowflake connection "snapshot.northwind_dbt.employees_snapshot"
[0m17:40:20.879596 [debug] [Thread-2  ]: On snapshot.northwind_dbt.employees_snapshot: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "snapshot.northwind_dbt.employees_snapshot"} */
describe table "PROJECT_2"."SNAPSHOTS"."EMPLOYEES_SNAPSHOT__dbt_tmp"
[0m17:40:20.960130 [debug] [Thread-2  ]: SQL status: SUCCESS 28 in 0.079 seconds
[0m17:40:20.967681 [debug] [Thread-2  ]: Using snowflake connection "snapshot.northwind_dbt.employees_snapshot"
[0m17:40:20.968786 [debug] [Thread-2  ]: On snapshot.northwind_dbt.employees_snapshot: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "snapshot.northwind_dbt.employees_snapshot"} */
describe table "PROJECT_2"."SNAPSHOTS"."EMPLOYEES_SNAPSHOT"
[0m17:40:21.080902 [debug] [Thread-2  ]: SQL status: SUCCESS 26 in 0.111 seconds
[0m17:40:21.095231 [debug] [Thread-2  ]: Using snowflake connection "snapshot.northwind_dbt.employees_snapshot"
[0m17:40:21.096225 [debug] [Thread-2  ]: On snapshot.northwind_dbt.employees_snapshot: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "snapshot.northwind_dbt.employees_snapshot"} */
describe table "PROJECT_2"."SNAPSHOTS"."EMPLOYEES_SNAPSHOT__dbt_tmp"
[0m17:40:21.359117 [debug] [Thread-2  ]: SQL status: SUCCESS 28 in 0.262 seconds
[0m17:40:21.384581 [debug] [Thread-2  ]: Using snowflake connection "snapshot.northwind_dbt.employees_snapshot"
[0m17:40:21.386595 [debug] [Thread-2  ]: On snapshot.northwind_dbt.employees_snapshot: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "snapshot.northwind_dbt.employees_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "snapshot.northwind_dbt.employees_snapshot"} */
select * from (
        
    
    with snapshot_query as (

        

select * from PROJECT_2.PUBLIC.stg_employees

    ),

    snapshotted_data as (

        select *, 
    
        employee_id as dbt_unique_key
    

        from "PROJECT_2"."SNAPSHOTS"."EMPLOYEES_SNAPSHOT"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        employee_id as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
,
            md5(coalesce(cast(employee_id as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        employee_id as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data."FIRST_NAME" != source_data."FIRST_NAME"
        or
        (
            ((snapshotted_data."FIRST_NAME" is null) and not (source_data."FIRST_NAME" is null))
            or
            ((not snapshotted_data."FIRST_NAME" is null) and (source_data."FIRST_NAME" is null))
        ) or snapshotted_data."LAST_NAME" != source_data."LAST_NAME"
        or
        (
            ((snapshotted_data."LAST_NAME" is null) and not (source_data."LAST_NAME" is null))
            or
            ((not snapshotted_data."LAST_NAME" is null) and (source_data."LAST_NAME" is null))
        ) or snapshotted_data."TITLE" != source_data."TITLE"
        or
        (
            ((snapshotted_data."TITLE" is null) and not (source_data."TITLE" is null))
            or
            ((not snapshotted_data."TITLE" is null) and (source_data."TITLE" is null))
        ) or snapshotted_data."REGION" != source_data."REGION"
        or
        (
            ((snapshotted_data."REGION" is null) and not (source_data."REGION" is null))
            or
            ((not snapshotted_data."REGION" is null) and (source_data."REGION" is null))
        ) or snapshotted_data."ADDRESS" != source_data."ADDRESS"
        or
        (
            ((snapshotted_data."ADDRESS" is null) and not (source_data."ADDRESS" is null))
            or
            ((not snapshotted_data."ADDRESS" is null) and (source_data."ADDRESS" is null))
        )))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."FIRST_NAME" != source_data."FIRST_NAME"
        or
        (
            ((snapshotted_data."FIRST_NAME" is null) and not (source_data."FIRST_NAME" is null))
            or
            ((not snapshotted_data."FIRST_NAME" is null) and (source_data."FIRST_NAME" is null))
        ) or snapshotted_data."LAST_NAME" != source_data."LAST_NAME"
        or
        (
            ((snapshotted_data."LAST_NAME" is null) and not (source_data."LAST_NAME" is null))
            or
            ((not snapshotted_data."LAST_NAME" is null) and (source_data."LAST_NAME" is null))
        ) or snapshotted_data."TITLE" != source_data."TITLE"
        or
        (
            ((snapshotted_data."TITLE" is null) and not (source_data."TITLE" is null))
            or
            ((not snapshotted_data."TITLE" is null) and (source_data."TITLE" is null))
        ) or snapshotted_data."REGION" != source_data."REGION"
        or
        (
            ((snapshotted_data."REGION" is null) and not (source_data."REGION" is null))
            or
            ((not snapshotted_data."REGION" is null) and (source_data."REGION" is null))
        ) or snapshotted_data."ADDRESS" != source_data."ADDRESS"
        or
        (
            ((snapshotted_data."ADDRESS" is null) and not (source_data."ADDRESS" is null))
            or
            ((not snapshotted_data."ADDRESS" is null) and (source_data."ADDRESS" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0
[0m17:40:21.666492 [debug] [Thread-2  ]: SQL status: SUCCESS 0 in 0.278 seconds
[0m17:40:21.669482 [debug] [Thread-2  ]: Using snowflake connection "snapshot.northwind_dbt.employees_snapshot"
[0m17:40:21.672005 [debug] [Thread-2  ]: On snapshot.northwind_dbt.employees_snapshot: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "snapshot.northwind_dbt.employees_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "snapshot.northwind_dbt.employees_snapshot"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m17:40:21.798130 [debug] [Thread-2  ]: SQL status: SUCCESS 0 in 0.125 seconds
[0m17:40:21.800138 [debug] [Thread-2  ]: Writing runtime sql for node "snapshot.northwind_dbt.employees_snapshot"
[0m17:40:21.817167 [debug] [Thread-2  ]: Using snowflake connection "snapshot.northwind_dbt.employees_snapshot"
[0m17:40:21.818165 [debug] [Thread-2  ]: On snapshot.northwind_dbt.employees_snapshot: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "snapshot.northwind_dbt.employees_snapshot"} */
BEGIN
[0m17:40:21.972206 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.153 seconds
[0m17:40:21.973633 [debug] [Thread-2  ]: Using snowflake connection "snapshot.northwind_dbt.employees_snapshot"
[0m17:40:21.974641 [debug] [Thread-2  ]: On snapshot.northwind_dbt.employees_snapshot: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "snapshot.northwind_dbt.employees_snapshot"} */
merge into "PROJECT_2"."SNAPSHOTS"."EMPLOYEES_SNAPSHOT" as DBT_INTERNAL_DEST
    using "PROJECT_2"."SNAPSHOTS"."EMPLOYEES_SNAPSHOT__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("_AIRBYTE_RAW_ID", "_AIRBYTE_EXTRACTED_AT", "_AIRBYTE_META", "_AIRBYTE_GENERATION_ID", "CITY", "NOTES", "PHOTO", "TITLE", "REGION", "ADDRESS", "COUNTRY", "EXTENSION", "HIRE_DATE", "LAST_NAME", "BIRTH_DATE", "FIRST_NAME", "HOME_PHONE", "PHOTO_PATH", "REPORTS_TO", "EMPLOYEE_ID", "POSTAL_CODE", "TITLE_OF_COURTESY", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("_AIRBYTE_RAW_ID", "_AIRBYTE_EXTRACTED_AT", "_AIRBYTE_META", "_AIRBYTE_GENERATION_ID", "CITY", "NOTES", "PHOTO", "TITLE", "REGION", "ADDRESS", "COUNTRY", "EXTENSION", "HIRE_DATE", "LAST_NAME", "BIRTH_DATE", "FIRST_NAME", "HOME_PHONE", "PHOTO_PATH", "REPORTS_TO", "EMPLOYEE_ID", "POSTAL_CODE", "TITLE_OF_COURTESY", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m17:40:22.589000 [debug] [Thread-2  ]: SQL status: SUCCESS 0 in 0.613 seconds
[0m17:40:22.590004 [debug] [Thread-2  ]: Using snowflake connection "snapshot.northwind_dbt.employees_snapshot"
[0m17:40:22.591819 [debug] [Thread-2  ]: On snapshot.northwind_dbt.employees_snapshot: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "snapshot.northwind_dbt.employees_snapshot"} */
COMMIT
[0m17:40:23.098356 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.505 seconds
[0m17:40:23.104361 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2bba4152-eb62-4f4e-9d0c-a6def3027f32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A86BCACFA0>]}
[0m17:40:23.105359 [info ] [Thread-2  ]: 2 of 2 OK snapshotted snapshots.employees_snapshot ............................. [[32mSUCCESS 0[0m in 4.56s]
[0m17:40:23.106359 [debug] [Thread-2  ]: Finished running node snapshot.northwind_dbt.employees_snapshot
[0m17:40:23.110359 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:40:23.110359 [debug] [MainThread]: Connection 'list_PROJECT_2' was left open.
[0m17:40:23.111361 [debug] [MainThread]: On list_PROJECT_2: Close
[0m17:40:23.237959 [debug] [MainThread]: Connection 'list_PROJECT_2_PUBLIC' was left open.
[0m17:40:23.239960 [debug] [MainThread]: On list_PROJECT_2_PUBLIC: Close
[0m17:40:23.381373 [debug] [MainThread]: Connection 'list_PROJECT_2_snapshots' was left open.
[0m17:40:23.382368 [debug] [MainThread]: On list_PROJECT_2_snapshots: Close
[0m17:40:23.555598 [debug] [MainThread]: Connection 'snapshot.northwind_dbt.customers_snapshot' was left open.
[0m17:40:23.556617 [debug] [MainThread]: On snapshot.northwind_dbt.customers_snapshot: Close
[0m17:40:23.811119 [debug] [MainThread]: Connection 'snapshot.northwind_dbt.employees_snapshot' was left open.
[0m17:40:23.813104 [debug] [MainThread]: On snapshot.northwind_dbt.employees_snapshot: Close
[0m17:40:24.088677 [info ] [MainThread]: 
[0m17:40:24.089675 [info ] [MainThread]: Finished running 2 snapshots in 0 hours 0 minutes and 7.50 seconds (7.50s).
[0m17:40:24.093020 [debug] [MainThread]: Command end result
[0m17:40:24.291739 [debug] [MainThread]: Wrote artifact WritableManifest to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\manifest.json
[0m17:40:24.306326 [debug] [MainThread]: Wrote artifact SemanticManifest to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\semantic_manifest.json
[0m17:40:24.325738 [debug] [MainThread]: Wrote artifact RunExecutionResult to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\run_results.json
[0m17:40:24.328943 [info ] [MainThread]: 
[0m17:40:24.331058 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:40:24.333482 [info ] [MainThread]: 
[0m17:40:24.335938 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m17:40:24.340063 [debug] [MainThread]: Command `dbt snapshot` succeeded at 17:40:24.340063 after 11.43 seconds
[0m17:40:24.343776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A85036F400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8516C37F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A86AF3EDC0>]}
[0m17:40:24.344794 [debug] [MainThread]: Flushing usage events
[0m17:40:25.831734 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:58:15.867116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A316A713A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A318ADB5E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A318ADB640>]}


============================== 21:58:15.871152 | 16053ade-9c93-42e3-b8b5-e28589a15900 ==============================
[0m21:58:15.871152 [info ] [MainThread]: Running with dbt=1.9.0
[0m21:58:15.872116 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'c:\\Users\\fitzp\\Documents\\Alpaca_Market\\zproject_2\\northwind_psql', 'log_path': 'c:\\Users\\fitzp\\Documents\\Alpaca_Market\\zproject_2\\northwind_psql\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt docs generate', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:58:17.770911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '16053ade-9c93-42e3-b8b5-e28589a15900', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3315E8C10>]}
[0m21:58:17.827510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '16053ade-9c93-42e3-b8b5-e28589a15900', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A318AC6AC0>]}
[0m21:58:17.830515 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m21:58:18.178971 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m21:58:18.784639 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:58:18.785645 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:58:18.792678 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.northwind_dbt.marts.bi
[0m21:58:18.856695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '16053ade-9c93-42e3-b8b5-e28589a15900', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A331BFBEE0>]}
[0m21:58:18.905457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '16053ade-9c93-42e3-b8b5-e28589a15900', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A331BFB760>]}
[0m21:58:18.906442 [info ] [MainThread]: Found 13 models, 2 snapshots, 16 data tests, 8 sources, 706 macros
[0m21:58:18.907440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '16053ade-9c93-42e3-b8b5-e28589a15900', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A331BFB790>]}
[0m21:58:18.909631 [info ] [MainThread]: 
[0m21:58:18.911631 [info ] [MainThread]: Concurrency: 12 threads (target='dev')
[0m21:58:18.912625 [info ] [MainThread]: 
[0m21:58:18.913629 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:58:18.922012 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_2_snapshots'
[0m21:58:18.923013 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_2_PUBLIC'
[0m21:58:19.023726 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_2_snapshots"
[0m21:58:19.024738 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_2_PUBLIC"
[0m21:58:19.025737 [debug] [ThreadPool]: On list_PROJECT_2_snapshots: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "connection_name": "list_PROJECT_2_snapshots"} */
show objects in PROJECT_2.snapshots limit 10000;
[0m21:58:19.025737 [debug] [ThreadPool]: On list_PROJECT_2_PUBLIC: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "connection_name": "list_PROJECT_2_PUBLIC"} */
show objects in PROJECT_2.PUBLIC limit 10000;
[0m21:58:19.026776 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:58:19.026776 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:58:22.059317 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 3.033 seconds
[0m21:58:22.099829 [debug] [ThreadPool]: SQL status: SUCCESS 27 in 3.072 seconds
[0m21:58:22.106992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '16053ade-9c93-42e3-b8b5-e28589a15900', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A331BFB550>]}
[0m21:58:22.114960 [debug] [Thread-1  ]: Began running node model.northwind_dbt.stg_customers
[0m21:58:22.115961 [debug] [Thread-2  ]: Began running node model.northwind_dbt.stg_employees
[0m21:58:22.116959 [debug] [Thread-3  ]: Began running node model.northwind_dbt.stg_order_details
[0m21:58:22.116959 [debug] [Thread-4  ]: Began running node model.northwind_dbt.stg_orders
[0m21:58:22.117962 [debug] [Thread-5  ]: Began running node model.northwind_dbt.stg_products
[0m21:58:22.117962 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.northwind_dbt.stg_customers'
[0m21:58:22.118969 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.northwind_dbt.stg_employees'
[0m21:58:22.119961 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.northwind_dbt.stg_order_details'
[0m21:58:22.120956 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.northwind_dbt.stg_orders'
[0m21:58:22.121964 [debug] [Thread-5  ]: Acquiring new snowflake connection 'model.northwind_dbt.stg_products'
[0m21:58:22.122956 [debug] [Thread-1  ]: Began compiling node model.northwind_dbt.stg_customers
[0m21:58:22.123957 [debug] [Thread-2  ]: Began compiling node model.northwind_dbt.stg_employees
[0m21:58:22.123957 [debug] [Thread-3  ]: Began compiling node model.northwind_dbt.stg_order_details
[0m21:58:22.124959 [debug] [Thread-4  ]: Began compiling node model.northwind_dbt.stg_orders
[0m21:58:22.125980 [debug] [Thread-5  ]: Began compiling node model.northwind_dbt.stg_products
[0m21:58:22.134086 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind_dbt.stg_customers"
[0m21:58:22.138084 [debug] [Thread-2  ]: Writing injected SQL for node "model.northwind_dbt.stg_employees"
[0m21:58:22.142095 [debug] [Thread-3  ]: Writing injected SQL for node "model.northwind_dbt.stg_order_details"
[0m21:58:22.145084 [debug] [Thread-4  ]: Writing injected SQL for node "model.northwind_dbt.stg_orders"
[0m21:58:22.149619 [debug] [Thread-5  ]: Writing injected SQL for node "model.northwind_dbt.stg_products"
[0m21:58:22.183106 [debug] [Thread-3  ]: Began executing node model.northwind_dbt.stg_order_details
[0m21:58:22.184094 [debug] [Thread-5  ]: Began executing node model.northwind_dbt.stg_products
[0m21:58:22.185149 [debug] [Thread-4  ]: Began executing node model.northwind_dbt.stg_orders
[0m21:58:22.185149 [debug] [Thread-2  ]: Began executing node model.northwind_dbt.stg_employees
[0m21:58:22.186139 [debug] [Thread-1  ]: Began executing node model.northwind_dbt.stg_customers
[0m21:58:22.187139 [debug] [Thread-3  ]: Finished running node model.northwind_dbt.stg_order_details
[0m21:58:22.188167 [debug] [Thread-5  ]: Finished running node model.northwind_dbt.stg_products
[0m21:58:22.189135 [debug] [Thread-4  ]: Finished running node model.northwind_dbt.stg_orders
[0m21:58:22.190154 [debug] [Thread-2  ]: Finished running node model.northwind_dbt.stg_employees
[0m21:58:22.191090 [debug] [Thread-1  ]: Finished running node model.northwind_dbt.stg_customers
[0m21:58:22.192657 [debug] [Thread-7  ]: Began running node model.northwind_dbt.dim_products
[0m21:58:22.192986 [debug] [Thread-9  ]: Began running node model.northwind_dbt.fact_order_details
[0m21:58:22.194302 [debug] [Thread-11 ]: Began running node model.northwind_dbt.dim_employees
[0m21:58:22.194302 [debug] [Thread-12 ]: Began running node snapshot.northwind_dbt.employees_snapshot
[0m21:58:22.195315 [debug] [Thread-3  ]: Began running node model.northwind_dbt.dim_customers
[0m21:58:22.195315 [debug] [Thread-5  ]: Began running node snapshot.northwind_dbt.customers_snapshot
[0m21:58:22.196316 [debug] [Thread-7  ]: Acquiring new snowflake connection 'model.northwind_dbt.dim_products'
[0m21:58:22.196316 [debug] [Thread-9  ]: Acquiring new snowflake connection 'model.northwind_dbt.fact_order_details'
[0m21:58:22.197311 [debug] [Thread-11 ]: Acquiring new snowflake connection 'model.northwind_dbt.dim_employees'
[0m21:58:22.198316 [debug] [Thread-12 ]: Acquiring new snowflake connection 'snapshot.northwind_dbt.employees_snapshot'
[0m21:58:22.198316 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.northwind_dbt.stg_order_details, now model.northwind_dbt.dim_customers)
[0m21:58:22.199315 [debug] [Thread-5  ]: Re-using an available connection from the pool (formerly model.northwind_dbt.stg_products, now snapshot.northwind_dbt.customers_snapshot)
[0m21:58:22.200321 [debug] [Thread-7  ]: Began compiling node model.northwind_dbt.dim_products
[0m21:58:22.200321 [debug] [Thread-9  ]: Began compiling node model.northwind_dbt.fact_order_details
[0m21:58:22.201319 [debug] [Thread-11 ]: Began compiling node model.northwind_dbt.dim_employees
[0m21:58:22.203326 [debug] [Thread-12 ]: Began compiling node snapshot.northwind_dbt.employees_snapshot
[0m21:58:22.204322 [debug] [Thread-3  ]: Began compiling node model.northwind_dbt.dim_customers
[0m21:58:22.205527 [debug] [Thread-5  ]: Began compiling node snapshot.northwind_dbt.customers_snapshot
[0m21:58:22.209733 [debug] [Thread-7  ]: Writing injected SQL for node "model.northwind_dbt.dim_products"
[0m21:58:22.217860 [debug] [Thread-9  ]: Writing injected SQL for node "model.northwind_dbt.fact_order_details"
[0m21:58:22.232261 [debug] [Thread-11 ]: Writing injected SQL for node "model.northwind_dbt.dim_employees"
[0m21:58:22.236306 [debug] [Thread-12 ]: Began executing node snapshot.northwind_dbt.employees_snapshot
[0m21:58:22.239312 [debug] [Thread-3  ]: Writing injected SQL for node "model.northwind_dbt.dim_customers"
[0m21:58:22.244910 [debug] [Thread-5  ]: Began executing node snapshot.northwind_dbt.customers_snapshot
[0m21:58:22.247422 [debug] [Thread-12 ]: Finished running node snapshot.northwind_dbt.employees_snapshot
[0m21:58:22.249438 [debug] [Thread-5  ]: Finished running node snapshot.northwind_dbt.customers_snapshot
[0m21:58:22.271345 [debug] [Thread-7  ]: Began executing node model.northwind_dbt.dim_products
[0m21:58:22.272408 [debug] [Thread-9  ]: Began executing node model.northwind_dbt.fact_order_details
[0m21:58:22.274449 [debug] [Thread-7  ]: Finished running node model.northwind_dbt.dim_products
[0m21:58:22.275463 [debug] [Thread-9  ]: Finished running node model.northwind_dbt.fact_order_details
[0m21:58:22.276984 [debug] [Thread-11 ]: Began executing node model.northwind_dbt.dim_employees
[0m21:58:22.276984 [debug] [Thread-4  ]: Began running node test.northwind_dbt.not_null_dim_products_product_id.c8aba288d1
[0m21:58:22.278501 [debug] [Thread-10 ]: Began running node test.northwind_dbt.unique_dim_products_product_id.ef7b2a9985
[0m21:58:22.278501 [debug] [Thread-3  ]: Began executing node model.northwind_dbt.dim_customers
[0m21:58:22.279832 [debug] [Thread-6  ]: Began running node model.northwind_dbt.top_performing_products
[0m21:58:22.281424 [debug] [Thread-11 ]: Finished running node model.northwind_dbt.dim_employees
[0m21:58:22.281991 [debug] [Thread-1  ]: Began running node test.northwind_dbt.not_null_fact_order_details_customer_id.6aaefe4888
[0m21:58:22.282560 [debug] [Thread-8  ]: Began running node test.northwind_dbt.not_null_fact_order_details_order_id.8d47c14c82
[0m21:58:22.283118 [debug] [Thread-12 ]: Began running node test.northwind_dbt.not_null_fact_order_details_product_id.85713db7b9
[0m21:58:22.283721 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.northwind_dbt.stg_orders, now test.northwind_dbt.not_null_dim_products_product_id.c8aba288d1)
[0m21:58:22.284325 [debug] [Thread-10 ]: Acquiring new snowflake connection 'test.northwind_dbt.unique_dim_products_product_id.ef7b2a9985'
[0m21:58:22.285554 [debug] [Thread-3  ]: Finished running node model.northwind_dbt.dim_customers
[0m21:58:22.286173 [debug] [Thread-6  ]: Acquiring new snowflake connection 'model.northwind_dbt.top_performing_products'
[0m21:58:22.287459 [debug] [Thread-7  ]: Began running node model.northwind_dbt.top_employee_revenue
[0m21:58:22.288085 [debug] [Thread-2  ]: Began running node test.northwind_dbt.not_null_dim_employees_employee_key.232a183ffe
[0m21:58:22.288635 [debug] [Thread-9  ]: Began running node test.northwind_dbt.unique_dim_employees_employee_key.3824d24782
[0m21:58:22.289200 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.northwind_dbt.stg_customers, now test.northwind_dbt.not_null_fact_order_details_customer_id.6aaefe4888)
[0m21:58:22.290305 [debug] [Thread-8  ]: Acquiring new snowflake connection 'test.northwind_dbt.not_null_fact_order_details_order_id.8d47c14c82'
[0m21:58:22.290867 [debug] [Thread-12 ]: Re-using an available connection from the pool (formerly snapshot.northwind_dbt.employees_snapshot, now test.northwind_dbt.not_null_fact_order_details_product_id.85713db7b9)
[0m21:58:22.291453 [debug] [Thread-4  ]: Began compiling node test.northwind_dbt.not_null_dim_products_product_id.c8aba288d1
[0m21:58:22.292022 [debug] [Thread-10 ]: Began compiling node test.northwind_dbt.unique_dim_products_product_id.ef7b2a9985
[0m21:58:22.293042 [debug] [Thread-11 ]: Began running node model.northwind_dbt.obt_orders
[0m21:58:22.293042 [debug] [Thread-5  ]: Began running node model.northwind_dbt.top_customer_revenue
[0m21:58:22.294040 [debug] [Thread-3  ]: Began running node test.northwind_dbt.not_null_dim_customers_customer_id.dd91cd1c8d
[0m21:58:22.294040 [debug] [Thread-6  ]: Began compiling node model.northwind_dbt.top_performing_products
[0m21:58:22.296043 [debug] [Thread-7  ]: Re-using an available connection from the pool (formerly model.northwind_dbt.dim_products, now model.northwind_dbt.top_employee_revenue)
[0m21:58:22.296043 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.northwind_dbt.stg_employees, now test.northwind_dbt.not_null_dim_employees_employee_key.232a183ffe)
[0m21:58:22.297039 [debug] [Thread-9  ]: Re-using an available connection from the pool (formerly model.northwind_dbt.fact_order_details, now test.northwind_dbt.unique_dim_employees_employee_key.3824d24782)
[0m21:58:22.298038 [debug] [Thread-1  ]: Began compiling node test.northwind_dbt.not_null_fact_order_details_customer_id.6aaefe4888
[0m21:58:22.299038 [debug] [Thread-8  ]: Began compiling node test.northwind_dbt.not_null_fact_order_details_order_id.8d47c14c82
[0m21:58:22.299038 [debug] [Thread-12 ]: Began compiling node test.northwind_dbt.not_null_fact_order_details_product_id.85713db7b9
[0m21:58:22.311033 [debug] [Thread-4  ]: Writing injected SQL for node "test.northwind_dbt.not_null_dim_products_product_id.c8aba288d1"
[0m21:58:22.318052 [debug] [Thread-10 ]: Writing injected SQL for node "test.northwind_dbt.unique_dim_products_product_id.ef7b2a9985"
[0m21:58:22.319037 [debug] [Thread-11 ]: Re-using an available connection from the pool (formerly model.northwind_dbt.dim_employees, now model.northwind_dbt.obt_orders)
[0m21:58:22.320034 [debug] [Thread-5  ]: Re-using an available connection from the pool (formerly snapshot.northwind_dbt.customers_snapshot, now model.northwind_dbt.top_customer_revenue)
[0m21:58:22.321036 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.northwind_dbt.dim_customers, now test.northwind_dbt.not_null_dim_customers_customer_id.dd91cd1c8d)
[0m21:58:22.325035 [debug] [Thread-6  ]: Writing injected SQL for node "model.northwind_dbt.top_performing_products"
[0m21:58:22.326036 [debug] [Thread-7  ]: Began compiling node model.northwind_dbt.top_employee_revenue
[0m21:58:22.327037 [debug] [Thread-2  ]: Began compiling node test.northwind_dbt.not_null_dim_employees_employee_key.232a183ffe
[0m21:58:22.327037 [debug] [Thread-9  ]: Began compiling node test.northwind_dbt.unique_dim_employees_employee_key.3824d24782
[0m21:58:22.332036 [debug] [Thread-1  ]: Writing injected SQL for node "test.northwind_dbt.not_null_fact_order_details_customer_id.6aaefe4888"
[0m21:58:22.337051 [debug] [Thread-8  ]: Writing injected SQL for node "test.northwind_dbt.not_null_fact_order_details_order_id.8d47c14c82"
[0m21:58:22.344048 [debug] [Thread-12 ]: Writing injected SQL for node "test.northwind_dbt.not_null_fact_order_details_product_id.85713db7b9"
[0m21:58:22.347915 [debug] [Thread-11 ]: Began compiling node model.northwind_dbt.obt_orders
[0m21:58:22.350240 [debug] [Thread-5  ]: Began compiling node model.northwind_dbt.top_customer_revenue
[0m21:58:22.351579 [debug] [Thread-3  ]: Began compiling node test.northwind_dbt.not_null_dim_customers_customer_id.dd91cd1c8d
[0m21:58:22.359569 [debug] [Thread-7  ]: Writing injected SQL for node "model.northwind_dbt.top_employee_revenue"
[0m21:58:22.366508 [debug] [Thread-2  ]: Writing injected SQL for node "test.northwind_dbt.not_null_dim_employees_employee_key.232a183ffe"
[0m21:58:22.367070 [debug] [Thread-10 ]: Began executing node test.northwind_dbt.unique_dim_products_product_id.ef7b2a9985
[0m21:58:22.367621 [debug] [Thread-4  ]: Began executing node test.northwind_dbt.not_null_dim_products_product_id.c8aba288d1
[0m21:58:22.373003 [debug] [Thread-9  ]: Writing injected SQL for node "test.northwind_dbt.unique_dim_employees_employee_key.3824d24782"
[0m21:58:22.380927 [debug] [Thread-6  ]: Began executing node model.northwind_dbt.top_performing_products
[0m21:58:22.381894 [debug] [Thread-11 ]: Writing injected SQL for node "model.northwind_dbt.obt_orders"
[0m21:58:22.388574 [debug] [Thread-5  ]: Writing injected SQL for node "model.northwind_dbt.top_customer_revenue"
[0m21:58:22.398723 [debug] [Thread-3  ]: Writing injected SQL for node "test.northwind_dbt.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m21:58:22.399402 [debug] [Thread-1  ]: Began executing node test.northwind_dbt.not_null_fact_order_details_customer_id.6aaefe4888
[0m21:58:22.399969 [debug] [Thread-12 ]: Began executing node test.northwind_dbt.not_null_fact_order_details_product_id.85713db7b9
[0m21:58:22.403855 [debug] [Thread-10 ]: Finished running node test.northwind_dbt.unique_dim_products_product_id.ef7b2a9985
[0m21:58:22.404969 [debug] [Thread-8  ]: Began executing node test.northwind_dbt.not_null_fact_order_details_order_id.8d47c14c82
[0m21:58:22.405525 [debug] [Thread-4  ]: Finished running node test.northwind_dbt.not_null_dim_products_product_id.c8aba288d1
[0m21:58:22.408520 [debug] [Thread-6  ]: Finished running node model.northwind_dbt.top_performing_products
[0m21:58:22.412534 [debug] [Thread-1  ]: Finished running node test.northwind_dbt.not_null_fact_order_details_customer_id.6aaefe4888
[0m21:58:22.413536 [debug] [Thread-12 ]: Finished running node test.northwind_dbt.not_null_fact_order_details_product_id.85713db7b9
[0m21:58:22.414536 [debug] [Thread-10 ]: Began running node test.northwind_dbt.unique_dim_customers_customer_id.15c9f1e2fd
[0m21:58:22.416648 [debug] [Thread-8  ]: Finished running node test.northwind_dbt.not_null_fact_order_details_order_id.8d47c14c82
[0m21:58:22.419994 [debug] [Thread-4  ]: Began running node test.northwind_dbt.not_null_top_performing_products_product_id.919a185ac6
[0m21:58:22.422507 [debug] [Thread-10 ]: Re-using an available connection from the pool (formerly test.northwind_dbt.unique_dim_products_product_id.ef7b2a9985, now test.northwind_dbt.unique_dim_customers_customer_id.15c9f1e2fd)
[0m21:58:22.425333 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.northwind_dbt.not_null_dim_products_product_id.c8aba288d1, now test.northwind_dbt.not_null_top_performing_products_product_id.919a185ac6)
[0m21:58:22.427013 [debug] [Thread-10 ]: Began compiling node test.northwind_dbt.unique_dim_customers_customer_id.15c9f1e2fd
[0m21:58:22.428571 [debug] [Thread-4  ]: Began compiling node test.northwind_dbt.not_null_top_performing_products_product_id.919a185ac6
[0m21:58:22.435222 [debug] [Thread-10 ]: Writing injected SQL for node "test.northwind_dbt.unique_dim_customers_customer_id.15c9f1e2fd"
[0m21:58:22.442738 [debug] [Thread-4  ]: Writing injected SQL for node "test.northwind_dbt.not_null_top_performing_products_product_id.919a185ac6"
[0m21:58:22.442738 [debug] [Thread-2  ]: Began executing node test.northwind_dbt.not_null_dim_employees_employee_key.232a183ffe
[0m21:58:22.444111 [debug] [Thread-7  ]: Began executing node model.northwind_dbt.top_employee_revenue
[0m21:58:22.448146 [debug] [Thread-2  ]: Finished running node test.northwind_dbt.not_null_dim_employees_employee_key.232a183ffe
[0m21:58:22.449160 [debug] [Thread-3  ]: Began executing node test.northwind_dbt.not_null_dim_customers_customer_id.dd91cd1c8d
[0m21:58:22.450619 [debug] [Thread-11 ]: Began executing node model.northwind_dbt.obt_orders
[0m21:58:22.451557 [debug] [Thread-9  ]: Began executing node test.northwind_dbt.unique_dim_employees_employee_key.3824d24782
[0m21:58:22.452818 [debug] [Thread-5  ]: Began executing node model.northwind_dbt.top_customer_revenue
[0m21:58:22.454505 [debug] [Thread-7  ]: Finished running node model.northwind_dbt.top_employee_revenue
[0m21:58:22.458743 [debug] [Thread-3  ]: Finished running node test.northwind_dbt.not_null_dim_customers_customer_id.dd91cd1c8d
[0m21:58:22.461003 [debug] [Thread-11 ]: Finished running node model.northwind_dbt.obt_orders
[0m21:58:22.462662 [debug] [Thread-9  ]: Finished running node test.northwind_dbt.unique_dim_employees_employee_key.3824d24782
[0m21:58:22.463842 [debug] [Thread-10 ]: Began executing node test.northwind_dbt.unique_dim_customers_customer_id.15c9f1e2fd
[0m21:58:22.464874 [debug] [Thread-4  ]: Began executing node test.northwind_dbt.not_null_top_performing_products_product_id.919a185ac6
[0m21:58:22.466894 [debug] [Thread-5  ]: Finished running node model.northwind_dbt.top_customer_revenue
[0m21:58:22.468889 [debug] [Thread-6  ]: Began running node test.northwind_dbt.not_null_top_employee_revenue_employee_key.cb63db6526
[0m21:58:22.471890 [debug] [Thread-12 ]: Began running node test.northwind_dbt.not_null_obt_orders_customer_id.1e3c4ae465
[0m21:58:22.472894 [debug] [Thread-8  ]: Began running node test.northwind_dbt.not_null_obt_orders_order_date.5632203db3
[0m21:58:22.473891 [debug] [Thread-2  ]: Began running node test.northwind_dbt.not_null_obt_orders_order_id.218f605f9c
[0m21:58:22.475888 [debug] [Thread-7  ]: Began running node test.northwind_dbt.not_null_obt_orders_product_id.caa3082c7f
[0m21:58:22.477888 [debug] [Thread-10 ]: Finished running node test.northwind_dbt.unique_dim_customers_customer_id.15c9f1e2fd
[0m21:58:22.479890 [debug] [Thread-4  ]: Finished running node test.northwind_dbt.not_null_top_performing_products_product_id.919a185ac6
[0m21:58:22.481889 [debug] [Thread-3  ]: Began running node test.northwind_dbt.not_null_top_customer_revenue_customer_id.668bb5e112
[0m21:58:22.483224 [debug] [Thread-6  ]: Re-using an available connection from the pool (formerly model.northwind_dbt.top_performing_products, now test.northwind_dbt.not_null_top_employee_revenue_employee_key.cb63db6526)
[0m21:58:22.485239 [debug] [Thread-12 ]: Re-using an available connection from the pool (formerly test.northwind_dbt.not_null_fact_order_details_product_id.85713db7b9, now test.northwind_dbt.not_null_obt_orders_customer_id.1e3c4ae465)
[0m21:58:22.487237 [debug] [Thread-8  ]: Re-using an available connection from the pool (formerly test.northwind_dbt.not_null_fact_order_details_order_id.8d47c14c82, now test.northwind_dbt.not_null_obt_orders_order_date.5632203db3)
[0m21:58:22.488236 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.northwind_dbt.not_null_dim_employees_employee_key.232a183ffe, now test.northwind_dbt.not_null_obt_orders_order_id.218f605f9c)
[0m21:58:22.490240 [debug] [Thread-7  ]: Re-using an available connection from the pool (formerly model.northwind_dbt.top_employee_revenue, now test.northwind_dbt.not_null_obt_orders_product_id.caa3082c7f)
[0m21:58:22.493239 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.northwind_dbt.not_null_dim_customers_customer_id.dd91cd1c8d, now test.northwind_dbt.not_null_top_customer_revenue_customer_id.668bb5e112)
[0m21:58:22.494239 [debug] [Thread-6  ]: Began compiling node test.northwind_dbt.not_null_top_employee_revenue_employee_key.cb63db6526
[0m21:58:22.496242 [debug] [Thread-12 ]: Began compiling node test.northwind_dbt.not_null_obt_orders_customer_id.1e3c4ae465
[0m21:58:22.497240 [debug] [Thread-8  ]: Began compiling node test.northwind_dbt.not_null_obt_orders_order_date.5632203db3
[0m21:58:22.499241 [debug] [Thread-2  ]: Began compiling node test.northwind_dbt.not_null_obt_orders_order_id.218f605f9c
[0m21:58:22.500244 [debug] [Thread-7  ]: Began compiling node test.northwind_dbt.not_null_obt_orders_product_id.caa3082c7f
[0m21:58:22.502241 [debug] [Thread-3  ]: Began compiling node test.northwind_dbt.not_null_top_customer_revenue_customer_id.668bb5e112
[0m21:58:22.508243 [debug] [Thread-6  ]: Writing injected SQL for node "test.northwind_dbt.not_null_top_employee_revenue_employee_key.cb63db6526"
[0m21:58:22.515236 [debug] [Thread-12 ]: Writing injected SQL for node "test.northwind_dbt.not_null_obt_orders_customer_id.1e3c4ae465"
[0m21:58:22.521239 [debug] [Thread-8  ]: Writing injected SQL for node "test.northwind_dbt.not_null_obt_orders_order_date.5632203db3"
[0m21:58:22.528549 [debug] [Thread-2  ]: Writing injected SQL for node "test.northwind_dbt.not_null_obt_orders_order_id.218f605f9c"
[0m21:58:22.533569 [debug] [Thread-7  ]: Writing injected SQL for node "test.northwind_dbt.not_null_obt_orders_product_id.caa3082c7f"
[0m21:58:22.539560 [debug] [Thread-3  ]: Writing injected SQL for node "test.northwind_dbt.not_null_top_customer_revenue_customer_id.668bb5e112"
[0m21:58:22.564215 [debug] [Thread-6  ]: Began executing node test.northwind_dbt.not_null_top_employee_revenue_employee_key.cb63db6526
[0m21:58:22.565669 [debug] [Thread-6  ]: Finished running node test.northwind_dbt.not_null_top_employee_revenue_employee_key.cb63db6526
[0m21:58:22.578810 [debug] [Thread-12 ]: Began executing node test.northwind_dbt.not_null_obt_orders_customer_id.1e3c4ae465
[0m21:58:22.579803 [debug] [Thread-2  ]: Began executing node test.northwind_dbt.not_null_obt_orders_order_id.218f605f9c
[0m21:58:22.580804 [debug] [Thread-3  ]: Began executing node test.northwind_dbt.not_null_top_customer_revenue_customer_id.668bb5e112
[0m21:58:22.580804 [debug] [Thread-8  ]: Began executing node test.northwind_dbt.not_null_obt_orders_order_date.5632203db3
[0m21:58:22.581805 [debug] [Thread-7  ]: Began executing node test.northwind_dbt.not_null_obt_orders_product_id.caa3082c7f
[0m21:58:22.583807 [debug] [Thread-12 ]: Finished running node test.northwind_dbt.not_null_obt_orders_customer_id.1e3c4ae465
[0m21:58:22.585977 [debug] [Thread-2  ]: Finished running node test.northwind_dbt.not_null_obt_orders_order_id.218f605f9c
[0m21:58:22.587035 [debug] [Thread-3  ]: Finished running node test.northwind_dbt.not_null_top_customer_revenue_customer_id.668bb5e112
[0m21:58:22.588046 [debug] [Thread-8  ]: Finished running node test.northwind_dbt.not_null_obt_orders_order_date.5632203db3
[0m21:58:22.590045 [debug] [Thread-7  ]: Finished running node test.northwind_dbt.not_null_obt_orders_product_id.caa3082c7f
[0m21:58:22.594732 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:58:22.596748 [debug] [MainThread]: Connection 'list_PROJECT_2_snapshots' was left open.
[0m21:58:22.597742 [debug] [MainThread]: On list_PROJECT_2_snapshots: Close
[0m21:58:22.886520 [debug] [MainThread]: Connection 'list_PROJECT_2_PUBLIC' was left open.
[0m21:58:22.887056 [debug] [MainThread]: On list_PROJECT_2_PUBLIC: Close
[0m21:58:22.993178 [debug] [MainThread]: Connection 'test.northwind_dbt.not_null_fact_order_details_customer_id.6aaefe4888' was properly closed.
[0m21:58:22.995282 [debug] [MainThread]: Connection 'test.northwind_dbt.not_null_obt_orders_order_id.218f605f9c' was properly closed.
[0m21:58:22.995282 [debug] [MainThread]: Connection 'test.northwind_dbt.not_null_top_customer_revenue_customer_id.668bb5e112' was properly closed.
[0m21:58:22.996751 [debug] [MainThread]: Connection 'test.northwind_dbt.not_null_top_performing_products_product_id.919a185ac6' was properly closed.
[0m21:58:22.997828 [debug] [MainThread]: Connection 'model.northwind_dbt.top_customer_revenue' was properly closed.
[0m21:58:22.998832 [debug] [MainThread]: Connection 'test.northwind_dbt.not_null_obt_orders_product_id.caa3082c7f' was properly closed.
[0m21:58:22.999821 [debug] [MainThread]: Connection 'test.northwind_dbt.unique_dim_employees_employee_key.3824d24782' was properly closed.
[0m21:58:23.000851 [debug] [MainThread]: Connection 'model.northwind_dbt.obt_orders' was properly closed.
[0m21:58:23.001839 [debug] [MainThread]: Connection 'test.northwind_dbt.not_null_obt_orders_customer_id.1e3c4ae465' was properly closed.
[0m21:58:23.002779 [debug] [MainThread]: Connection 'test.northwind_dbt.unique_dim_customers_customer_id.15c9f1e2fd' was properly closed.
[0m21:58:23.003444 [debug] [MainThread]: Connection 'test.northwind_dbt.not_null_top_employee_revenue_employee_key.cb63db6526' was properly closed.
[0m21:58:23.004917 [debug] [MainThread]: Connection 'test.northwind_dbt.not_null_obt_orders_order_date.5632203db3' was properly closed.
[0m21:58:23.011331 [debug] [MainThread]: Command end result
[0m21:58:23.288139 [debug] [MainThread]: Wrote artifact WritableManifest to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\manifest.json
[0m21:58:23.302765 [debug] [MainThread]: Wrote artifact SemanticManifest to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\semantic_manifest.json
[0m21:58:23.337852 [debug] [MainThread]: Wrote artifact RunExecutionResult to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\run_results.json
[0m21:58:24.161828 [debug] [MainThread]: Acquiring new snowflake connection 'generate_catalog'
[0m21:58:24.162822 [info ] [MainThread]: Building catalog
[0m21:58:24.175897 [debug] [ThreadPool]: Acquiring new snowflake connection 'PROJECT_2.information_schema'
[0m21:58:24.265760 [debug] [ThreadPool]: Using snowflake connection "PROJECT_2.information_schema"
[0m21:58:24.267760 [debug] [ThreadPool]: On PROJECT_2.information_schema: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "connection_name": "PROJECT_2.information_schema"} */
with tables as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",
        case
            when is_dynamic = 'YES' and table_type = 'BASE TABLE' THEN 'DYNAMIC TABLE'
            else table_type
        end as "table_type",
        comment as "table_comment",

        -- note: this is the _role_ that owns the table
        table_owner as "table_owner",

        'Clustering Key' as "stats:clustering_key:label",
        clustering_key as "stats:clustering_key:value",
        'The key used to cluster this table' as "stats:clustering_key:description",
        (clustering_key is not null) as "stats:clustering_key:include",

        'Row Count' as "stats:row_count:label",
        row_count as "stats:row_count:value",
        'An approximate count of rows in this table' as "stats:row_count:description",
        (row_count is not null) as "stats:row_count:include",

        'Approximate Size' as "stats:bytes:label",
        bytes as "stats:bytes:value",
        'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
        (bytes is not null) as "stats:bytes:include",

        'Last Modified' as "stats:last_modified:label",
        to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
        'The timestamp for last update/change' as "stats:last_modified:description",
        (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"
    from PROJECT_2.INFORMATION_SCHEMA.tables
            where (
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'stg_order_details' and upper("table_name") = upper('stg_order_details')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'shippers' and upper("table_name") = upper('shippers')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'products' and upper("table_name") = upper('products')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'stg_products' and upper("table_name") = upper('stg_products')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'employees' and upper("table_name") = upper('employees')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'customers' and upper("table_name") = upper('customers')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'top_customer_revenue' and upper("table_name") = upper('top_customer_revenue')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'categories' and upper("table_name") = upper('categories')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'stg_employees' and upper("table_name") = upper('stg_employees')

                )
             or 
                (
                    
    "table_schema" ilike 'snapshots' and upper("table_schema") = upper('snapshots')

                    and 
    "table_name" ilike 'employees_snapshot' and upper("table_name") = upper('employees_snapshot')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'order_details' and upper("table_name") = upper('order_details')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'obt_orders' and upper("table_name") = upper('obt_orders')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'top_employee_revenue' and upper("table_name") = upper('top_employee_revenue')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'top_performing_products' and upper("table_name") = upper('top_performing_products')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'stg_customers' and upper("table_name") = upper('stg_customers')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'dim_employees' and upper("table_name") = upper('dim_employees')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'orders' and upper("table_name") = upper('orders')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'dim_products' and upper("table_name") = upper('dim_products')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'suppliers' and upper("table_name") = upper('suppliers')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'stg_orders' and upper("table_name") = upper('stg_orders')

                )
             or 
                (
                    
    "table_schema" ilike 'snapshots' and upper("table_schema") = upper('snapshots')

                    and 
    "table_name" ilike 'customers_snapshot' and upper("table_name") = upper('customers_snapshot')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'dim_customers' and upper("table_name") = upper('dim_customers')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'fact_order_details' and upper("table_name") = upper('fact_order_details')

                )
            )
        ),
        columns as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",

        column_name as "column_name",
        ordinal_position as "column_index",
        data_type as "column_type",
        comment as "column_comment"
    from PROJECT_2.INFORMATION_SCHEMA.columns
            where (
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'stg_order_details' and upper("table_name") = upper('stg_order_details')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'shippers' and upper("table_name") = upper('shippers')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'products' and upper("table_name") = upper('products')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'stg_products' and upper("table_name") = upper('stg_products')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'employees' and upper("table_name") = upper('employees')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'customers' and upper("table_name") = upper('customers')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'top_customer_revenue' and upper("table_name") = upper('top_customer_revenue')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'categories' and upper("table_name") = upper('categories')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'stg_employees' and upper("table_name") = upper('stg_employees')

                )
             or 
                (
                    
    "table_schema" ilike 'snapshots' and upper("table_schema") = upper('snapshots')

                    and 
    "table_name" ilike 'employees_snapshot' and upper("table_name") = upper('employees_snapshot')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'order_details' and upper("table_name") = upper('order_details')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'obt_orders' and upper("table_name") = upper('obt_orders')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'top_employee_revenue' and upper("table_name") = upper('top_employee_revenue')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'top_performing_products' and upper("table_name") = upper('top_performing_products')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'stg_customers' and upper("table_name") = upper('stg_customers')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'dim_employees' and upper("table_name") = upper('dim_employees')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'orders' and upper("table_name") = upper('orders')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'dim_products' and upper("table_name") = upper('dim_products')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'suppliers' and upper("table_name") = upper('suppliers')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'stg_orders' and upper("table_name") = upper('stg_orders')

                )
             or 
                (
                    
    "table_schema" ilike 'snapshots' and upper("table_schema") = upper('snapshots')

                    and 
    "table_name" ilike 'customers_snapshot' and upper("table_name") = upper('customers_snapshot')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'dim_customers' and upper("table_name") = upper('dim_customers')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'fact_order_details' and upper("table_name") = upper('fact_order_details')

                )
            )
        )
        select *
    from tables
    join columns using ("table_database", "table_schema", "table_name")
    order by "column_index"
[0m21:58:24.268761 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:58:32.798708 [debug] [ThreadPool]: SQL status: SUCCESS 323 in 8.530 seconds
[0m21:58:33.943372 [debug] [MainThread]: Wrote artifact CatalogArtifact to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\catalog.json
[0m21:58:34.122503 [debug] [MainThread]: Wrote artifact WritableManifest to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\manifest.json
[0m21:58:34.128522 [debug] [MainThread]: Wrote artifact SemanticManifest to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\semantic_manifest.json
[0m21:58:34.129504 [info ] [MainThread]: Catalog written to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\catalog.json
[0m21:58:34.131502 [debug] [MainThread]: Command `dbt docs generate` succeeded at 21:58:34.131502 after 18.35 seconds
[0m21:58:34.132519 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m21:58:34.133501 [debug] [MainThread]: Connection 'PROJECT_2.information_schema' was left open.
[0m21:58:34.133501 [debug] [MainThread]: On PROJECT_2.information_schema: Close
[0m21:58:34.353497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A316A713A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3322C9160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A333443D90>]}
[0m21:58:34.354498 [debug] [MainThread]: Flushing usage events
[0m21:58:35.091166 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:58:43.465908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002658FAE13A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026591B4EBB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026591B4E9A0>]}


============================== 21:58:43.469435 | eee23b11-4569-4886-a3fa-f95781d70003 ==============================
[0m21:58:43.469435 [info ] [MainThread]: Running with dbt=1.9.0
[0m21:58:43.471442 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'c:\\Users\\fitzp\\Documents\\Alpaca_Market\\zproject_2\\northwind_psql', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'c:\\Users\\fitzp\\Documents\\Alpaca_Market\\zproject_2\\northwind_psql\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt docs serve', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:58:44.426138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eee23b11-4569-4886-a3fa-f95781d70003', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000265AA607400>]}
[0m21:58:44.490949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eee23b11-4569-4886-a3fa-f95781d70003', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000265914D6490>]}
[0m08:53:50.574232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3DEDCF3A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3E0E2A5E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3E0E2A640>]}


============================== 08:53:50.591317 | 3ff76d34-90cf-4725-b186-bb17eef474c7 ==============================
[0m08:53:50.591317 [info ] [MainThread]: Running with dbt=1.9.0
[0m08:53:50.593068 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'c:\\Users\\fitzp\\Documents\\Alpaca_Market\\zproject_2\\northwind_psql', 'debug': 'False', 'version_check': 'True', 'log_path': 'c:\\Users\\fitzp\\Documents\\Alpaca_Market\\zproject_2\\northwind_psql\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs generate', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:53:50.604147 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'SNOWFLAKE_ACCOUNT'
[0m08:53:50.609026 [debug] [MainThread]: Command `dbt docs generate` failed at 08:53:50.609026 after 0.18 seconds
[0m08:53:50.610589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3DEDCF3A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3E0DE7250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3E0DC1E20>]}
[0m08:53:50.611278 [debug] [MainThread]: Flushing usage events
[0m08:53:51.879502 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:54:05.302061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D6F3EF370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D7145DBB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D7145D9A0>]}


============================== 08:54:05.308815 | da0ea604-cbd5-4cf9-a98b-81e744b5b65e ==============================
[0m08:54:05.308815 [info ] [MainThread]: Running with dbt=1.9.0
[0m08:54:05.308815 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'c:\\Users\\fitzp\\Documents\\Alpaca_Market\\zproject_2\\northwind_psql\\logs', 'profiles_dir': 'c:\\Users\\fitzp\\Documents\\Alpaca_Market\\zproject_2\\northwind_psql', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt docs serve', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:54:05.316464 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'SNOWFLAKE_ACCOUNT'
[0m08:54:05.320748 [debug] [MainThread]: Command `dbt docs serve` failed at 08:54:05.320748 after 0.11 seconds
[0m08:54:05.320748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D6F3EF370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D70E07F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D713F6E50>]}
[0m08:54:05.322757 [debug] [MainThread]: Flushing usage events
[0m08:54:06.256408 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:54:37.279429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000115A271F370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000115A478DBB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000115A478D9A0>]}


============================== 08:54:37.279429 | 924a4423-5bc2-457b-8bf1-7f703a1ed316 ==============================
[0m08:54:37.279429 [info ] [MainThread]: Running with dbt=1.9.0
[0m08:54:37.279429 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'c:\\Users\\fitzp\\Documents\\Alpaca_Market\\zproject_2\\northwind_psql', 'log_path': 'c:\\Users\\fitzp\\Documents\\Alpaca_Market\\zproject_2\\northwind_psql\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs serve', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:54:37.294804 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'SNOWFLAKE_ACCOUNT'
[0m08:54:37.297895 [debug] [MainThread]: Command `dbt docs serve` failed at 08:54:37.297406 after 0.13 seconds
[0m08:54:37.297895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000115A271F370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000115A4137F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000115A4726E50>]}
[0m08:54:37.297895 [debug] [MainThread]: Flushing usage events
[0m08:54:38.113904 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:55:23.914429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBD83CF400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBDA43ED30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBDA43EB20>]}


============================== 08:55:23.916169 | 9ed7a8b7-9f94-4694-9eeb-8bfaa6f76560 ==============================
[0m08:55:23.916169 [info ] [MainThread]: Running with dbt=1.9.0
[0m08:55:23.916169 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'c:\\Users\\fitzp\\Documents\\Alpaca_Market\\zproject_2\\northwind_psql', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'c:\\Users\\fitzp\\Documents\\Alpaca_Market\\zproject_2\\northwind_psql\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt docs serve', 'send_anonymous_usage_stats': 'True'}
[0m08:55:23.916169 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'SNOWFLAKE_ACCOUNT'
[0m08:55:23.930273 [debug] [MainThread]: Command `dbt docs serve` failed at 08:55:23.929634 after 0.11 seconds
[0m08:55:23.930931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBD83CF400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBDA3FCE20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBDA3FCFD0>]}
[0m08:55:23.932420 [debug] [MainThread]: Flushing usage events
[0m08:55:24.772570 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:57:38.335331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002189268F310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218946FDC70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218946FDA60>]}


============================== 08:57:38.344629 | d03da708-bae5-4111-8548-c32546bf0a11 ==============================
[0m08:57:38.344629 [info ] [MainThread]: Running with dbt=1.9.0
[0m08:57:38.347140 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'c:\\Users\\fitzp\\Documents\\Alpaca_Market\\zproject_2\\northwind_psql\\logs', 'profiles_dir': 'c:\\Users\\fitzp\\Documents\\Alpaca_Market\\zproject_2\\northwind_psql', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt docs serve', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m08:57:38.350640 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'SNOWFLAKE_ACCOUNT'
[0m08:57:38.357456 [debug] [MainThread]: Command `dbt docs serve` failed at 08:57:38.357456 after 0.15 seconds
[0m08:57:38.358821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002189268F310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218946FD3A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218946FD100>]}
[0m08:57:38.358821 [debug] [MainThread]: Flushing usage events
[0m08:57:39.345179 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:58:15.284007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017944FFF370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017947083B20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017947083910>]}


============================== 08:58:15.289771 | 2e29496c-5e55-496d-b505-6e678868218d ==============================
[0m08:58:15.289771 [info ] [MainThread]: Running with dbt=1.9.0
[0m08:58:15.290581 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'c:\\Users\\fitzp\\Documents\\Alpaca_Market\\zproject_2\\northwind_psql', 'version_check': 'True', 'debug': 'False', 'log_path': 'c:\\Users\\fitzp\\Documents\\Alpaca_Market\\zproject_2\\northwind_psql\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m08:58:15.296552 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'SNOWFLAKE_ACCOUNT'
[0m08:58:15.296552 [debug] [MainThread]: Command `dbt run` failed at 08:58:15.296552 after 0.10 seconds
[0m08:58:15.299765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017944FFF370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017947083340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179470838E0>]}
[0m08:58:15.300171 [debug] [MainThread]: Flushing usage events
[0m08:58:16.123784 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:00:36.367191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000266CD131370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000266CF1A3C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000266CF1A3A00>]}


============================== 09:00:36.373222 | e3e67f07-cd75-4d21-ae28-72482ff4eecc ==============================
[0m09:00:36.373222 [info ] [MainThread]: Running with dbt=1.9.0
[0m09:00:36.375231 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'c:\\Users\\fitzp\\Documents\\Alpaca_Market\\zproject_2\\northwind_psql', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'c:\\Users\\fitzp\\Documents\\Alpaca_Market\\zproject_2\\northwind_psql\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m09:00:43.464623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e3e67f07-cd75-4d21-ae28-72482ff4eecc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000266CF175520>]}
[0m09:00:43.538094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e3e67f07-cd75-4d21-ae28-72482ff4eecc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000266E7C88550>]}
[0m09:00:43.538094 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m09:00:44.121944 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m09:00:47.106322 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:00:47.106322 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:00:47.106322 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.northwind_dbt.marts.bi
[0m09:00:47.206433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e3e67f07-cd75-4d21-ae28-72482ff4eecc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000266E8298130>]}
[0m09:00:47.472463 [debug] [MainThread]: Wrote artifact WritableManifest to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\manifest.json
[0m09:00:47.478667 [debug] [MainThread]: Wrote artifact SemanticManifest to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\semantic_manifest.json
[0m09:00:47.735614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e3e67f07-cd75-4d21-ae28-72482ff4eecc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000266E82BE610>]}
[0m09:00:47.738894 [info ] [MainThread]: Found 13 models, 2 snapshots, 16 data tests, 8 sources, 706 macros
[0m09:00:47.738894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e3e67f07-cd75-4d21-ae28-72482ff4eecc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000266E827C670>]}
[0m09:00:47.741219 [info ] [MainThread]: 
[0m09:00:47.741219 [info ] [MainThread]: Concurrency: 12 threads (target='dev')
[0m09:00:47.744742 [info ] [MainThread]: 
[0m09:00:47.746170 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m09:00:47.751146 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_2'
[0m09:00:50.895860 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_2"
[0m09:00:50.897871 [debug] [ThreadPool]: On list_PROJECT_2: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "connection_name": "list_PROJECT_2"} */
show terse schemas in database PROJECT_2
    limit 10000
[0m09:00:50.897871 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:00:52.033891 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.134 seconds
[0m09:00:52.039806 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_2_PUBLIC'
[0m09:00:52.041844 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_2_snapshots'
[0m09:00:52.074200 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_2_PUBLIC"
[0m09:00:52.086517 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_2_snapshots"
[0m09:00:52.088605 [debug] [ThreadPool]: On list_PROJECT_2_PUBLIC: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "connection_name": "list_PROJECT_2_PUBLIC"} */
show objects in PROJECT_2.PUBLIC limit 10000;
[0m09:00:52.089116 [debug] [ThreadPool]: On list_PROJECT_2_snapshots: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "connection_name": "list_PROJECT_2_snapshots"} */
show objects in PROJECT_2.snapshots limit 10000;
[0m09:00:52.090925 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:00:52.092932 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:00:52.546240 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.453 seconds
[0m09:00:52.804316 [debug] [ThreadPool]: SQL status: SUCCESS 27 in 0.713 seconds
[0m09:00:52.810792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e3e67f07-cd75-4d21-ae28-72482ff4eecc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000266CC013DF0>]}
[0m09:00:52.830758 [debug] [Thread-1  ]: Began running node model.northwind_dbt.stg_customers
[0m09:00:52.831901 [debug] [Thread-2  ]: Began running node model.northwind_dbt.stg_employees
[0m09:00:52.832480 [debug] [Thread-3  ]: Began running node model.northwind_dbt.stg_order_details
[0m09:00:52.833566 [debug] [Thread-4  ]: Began running node model.northwind_dbt.stg_orders
[0m09:00:52.834102 [debug] [Thread-5  ]: Began running node model.northwind_dbt.stg_products
[0m09:00:52.834686 [info ] [Thread-1  ]: 1 of 13 START sql view model PUBLIC.stg_customers .............................. [RUN]
[0m09:00:52.836698 [info ] [Thread-2  ]: 2 of 13 START sql view model PUBLIC.stg_employees .............................. [RUN]
[0m09:00:52.836698 [info ] [Thread-3  ]: 3 of 13 START sql view model PUBLIC.stg_order_details .......................... [RUN]
[0m09:00:52.839341 [info ] [Thread-4  ]: 4 of 13 START sql view model PUBLIC.stg_orders ................................. [RUN]
[0m09:00:52.839862 [info ] [Thread-5  ]: 5 of 13 START sql view model PUBLIC.stg_products ............................... [RUN]
[0m09:00:52.842928 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.northwind_dbt.stg_customers'
[0m09:00:52.844767 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.northwind_dbt.stg_employees'
[0m09:00:52.844767 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.northwind_dbt.stg_order_details'
[0m09:00:52.846809 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.northwind_dbt.stg_orders'
[0m09:00:52.849694 [debug] [Thread-5  ]: Acquiring new snowflake connection 'model.northwind_dbt.stg_products'
[0m09:00:52.849694 [debug] [Thread-1  ]: Began compiling node model.northwind_dbt.stg_customers
[0m09:00:52.849694 [debug] [Thread-2  ]: Began compiling node model.northwind_dbt.stg_employees
[0m09:00:52.849694 [debug] [Thread-3  ]: Began compiling node model.northwind_dbt.stg_order_details
[0m09:00:52.854618 [debug] [Thread-4  ]: Began compiling node model.northwind_dbt.stg_orders
[0m09:00:52.854618 [debug] [Thread-5  ]: Began compiling node model.northwind_dbt.stg_products
[0m09:00:52.869803 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind_dbt.stg_customers"
[0m09:00:52.869803 [debug] [Thread-2  ]: Writing injected SQL for node "model.northwind_dbt.stg_employees"
[0m09:00:52.879381 [debug] [Thread-3  ]: Writing injected SQL for node "model.northwind_dbt.stg_order_details"
[0m09:00:52.885233 [debug] [Thread-4  ]: Writing injected SQL for node "model.northwind_dbt.stg_orders"
[0m09:00:52.885233 [debug] [Thread-5  ]: Writing injected SQL for node "model.northwind_dbt.stg_products"
[0m09:00:52.935245 [debug] [Thread-1  ]: Began executing node model.northwind_dbt.stg_customers
[0m09:00:52.937254 [debug] [Thread-4  ]: Began executing node model.northwind_dbt.stg_orders
[0m09:00:52.937254 [debug] [Thread-3  ]: Began executing node model.northwind_dbt.stg_order_details
[0m09:00:52.937254 [debug] [Thread-5  ]: Began executing node model.northwind_dbt.stg_products
[0m09:00:52.937254 [debug] [Thread-2  ]: Began executing node model.northwind_dbt.stg_employees
[0m09:00:52.982375 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind_dbt.stg_customers"
[0m09:00:52.990802 [debug] [Thread-4  ]: Writing runtime sql for node "model.northwind_dbt.stg_orders"
[0m09:00:52.997120 [debug] [Thread-3  ]: Writing runtime sql for node "model.northwind_dbt.stg_order_details"
[0m09:00:53.004123 [debug] [Thread-5  ]: Writing runtime sql for node "model.northwind_dbt.stg_products"
[0m09:00:53.011681 [debug] [Thread-2  ]: Writing runtime sql for node "model.northwind_dbt.stg_employees"
[0m09:00:53.034218 [debug] [Thread-4  ]: Using snowflake connection "model.northwind_dbt.stg_orders"
[0m09:00:53.034831 [debug] [Thread-4  ]: On model.northwind_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.stg_orders"} */
create or replace   view PROJECT_2.PUBLIC.stg_orders
  
   as (
    select * from PROJECT_2.PUBLIC.orders
  );
[0m09:00:53.034831 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m09:00:53.040439 [debug] [Thread-3  ]: Using snowflake connection "model.northwind_dbt.stg_order_details"
[0m09:00:53.042446 [debug] [Thread-3  ]: On model.northwind_dbt.stg_order_details: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.stg_order_details"} */
create or replace   view PROJECT_2.PUBLIC.stg_order_details
  
   as (
    select * from PROJECT_2.PUBLIC.order_details
  );
[0m09:00:53.042446 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m09:00:53.044464 [debug] [Thread-2  ]: Using snowflake connection "model.northwind_dbt.stg_employees"
[0m09:00:53.046212 [debug] [Thread-1  ]: Using snowflake connection "model.northwind_dbt.stg_customers"
[0m09:00:53.046212 [debug] [Thread-5  ]: Using snowflake connection "model.northwind_dbt.stg_products"
[0m09:00:53.048219 [debug] [Thread-2  ]: On model.northwind_dbt.stg_employees: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.stg_employees"} */
create or replace   view PROJECT_2.PUBLIC.stg_employees
  
   as (
    select * from PROJECT_2.PUBLIC.employees
  );
[0m09:00:53.048219 [debug] [Thread-1  ]: On model.northwind_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.stg_customers"} */
create or replace   view PROJECT_2.PUBLIC.stg_customers
  
   as (
    select * from PROJECT_2.PUBLIC.customers
  );
[0m09:00:53.048219 [debug] [Thread-5  ]: On model.northwind_dbt.stg_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.stg_products"} */
create or replace   view PROJECT_2.PUBLIC.stg_products
  
   as (
    select * from PROJECT_2.PUBLIC.products
  );
[0m09:00:53.048219 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m09:00:53.048219 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m09:00:53.048219 [debug] [Thread-5  ]: Opening a new connection, currently in state init
[0m09:00:54.339684 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1.298 seconds
[0m09:00:54.371351 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3e67f07-cd75-4d21-ae28-72482ff4eecc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000266E8A09DC0>]}
[0m09:00:54.374221 [info ] [Thread-3  ]: 3 of 13 OK created sql view model PUBLIC.stg_order_details ..................... [[32mSUCCESS 1[0m in 1.52s]
[0m09:00:54.374221 [debug] [Thread-3  ]: Finished running node model.northwind_dbt.stg_order_details
[0m09:00:54.547414 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.499 seconds
[0m09:00:54.547414 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1.517 seconds
[0m09:00:54.556372 [debug] [Thread-5  ]: SQL status: SUCCESS 1 in 1.502 seconds
[0m09:00:54.556372 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3e67f07-cd75-4d21-ae28-72482ff4eecc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000266E8AD7F40>]}
[0m09:00:54.556372 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3e67f07-cd75-4d21-ae28-72482ff4eecc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000266E8A48F10>]}
[0m09:00:54.568564 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3e67f07-cd75-4d21-ae28-72482ff4eecc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000266E8A09A60>]}
[0m09:00:54.570207 [info ] [Thread-2  ]: 2 of 13 OK created sql view model PUBLIC.stg_employees ......................... [[32mSUCCESS 1[0m in 1.71s]
[0m09:00:54.571233 [info ] [Thread-4  ]: 4 of 13 OK created sql view model PUBLIC.stg_orders ............................ [[32mSUCCESS 1[0m in 1.71s]
[0m09:00:54.572264 [info ] [Thread-5  ]: 5 of 13 OK created sql view model PUBLIC.stg_products .......................... [[32mSUCCESS 1[0m in 1.72s]
[0m09:00:54.573292 [debug] [Thread-2  ]: Finished running node model.northwind_dbt.stg_employees
[0m09:00:54.574325 [debug] [Thread-4  ]: Finished running node model.northwind_dbt.stg_orders
[0m09:00:54.575689 [debug] [Thread-5  ]: Finished running node model.northwind_dbt.stg_products
[0m09:00:54.575689 [debug] [Thread-7  ]: Began running node model.northwind_dbt.dim_employees
[0m09:00:54.578285 [debug] [Thread-9  ]: Began running node model.northwind_dbt.fact_order_details
[0m09:00:54.579283 [debug] [Thread-11 ]: Began running node model.northwind_dbt.dim_products
[0m09:00:54.580572 [info ] [Thread-7  ]: 6 of 13 START sql table model PUBLIC.dim_employees ............................. [RUN]
[0m09:00:54.581336 [info ] [Thread-9  ]: 7 of 13 START sql incremental model PUBLIC.fact_order_details .................. [RUN]
[0m09:00:54.583421 [info ] [Thread-11 ]: 8 of 13 START sql table model PUBLIC.dim_products .............................. [RUN]
[0m09:00:54.584342 [debug] [Thread-7  ]: Acquiring new snowflake connection 'model.northwind_dbt.dim_employees'
[0m09:00:54.584342 [debug] [Thread-9  ]: Acquiring new snowflake connection 'model.northwind_dbt.fact_order_details'
[0m09:00:54.584342 [debug] [Thread-11 ]: Acquiring new snowflake connection 'model.northwind_dbt.dim_products'
[0m09:00:54.584342 [debug] [Thread-7  ]: Began compiling node model.northwind_dbt.dim_employees
[0m09:00:54.584342 [debug] [Thread-9  ]: Began compiling node model.northwind_dbt.fact_order_details
[0m09:00:54.584342 [debug] [Thread-11 ]: Began compiling node model.northwind_dbt.dim_products
[0m09:00:54.601820 [debug] [Thread-7  ]: Writing injected SQL for node "model.northwind_dbt.dim_employees"
[0m09:00:54.622321 [debug] [Thread-11 ]: Writing injected SQL for node "model.northwind_dbt.dim_products"
[0m09:00:54.627974 [debug] [Thread-9  ]: Writing injected SQL for node "model.northwind_dbt.fact_order_details"
[0m09:00:54.650923 [debug] [Thread-11 ]: Began executing node model.northwind_dbt.dim_products
[0m09:00:54.650923 [debug] [Thread-7  ]: Began executing node model.northwind_dbt.dim_employees
[0m09:00:54.652931 [debug] [Thread-9  ]: Began executing node model.northwind_dbt.fact_order_details
[0m09:00:54.679846 [debug] [Thread-11 ]: Writing runtime sql for node "model.northwind_dbt.dim_products"
[0m09:00:54.682807 [debug] [Thread-7  ]: Writing runtime sql for node "model.northwind_dbt.dim_employees"
[0m09:00:54.703850 [debug] [Thread-9  ]: Using snowflake connection "model.northwind_dbt.fact_order_details"
[0m09:00:54.719927 [debug] [Thread-9  ]: On model.northwind_dbt.fact_order_details: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.fact_order_details"} */
create or replace  temporary view PROJECT_2.PUBLIC.fact_order_details__dbt_tmp
  
   as (
    

with base as (
    select 
        od.order_id,
        od.product_id,
        o.customer_id,
        o.employee_id,
        o.ship_via as shipper_id,
        o.order_date,
        od.unit_price,
        od.quantity,
        od.discount,
        od.unit_price * od.quantity * (1 - od.discount) as revenue
    from PROJECT_2.PUBLIC.stg_order_details od
    join PROJECT_2.PUBLIC.stg_orders o on od.order_id = o.order_id
    
        and o.order_date >= (select max(order_date) from PROJECT_2.PUBLIC.fact_order_details)
    
),
aggregated as (
    select 
        order_id,
        product_id,
        customer_id,
        employee_id,
        shipper_id,
        cast(order_date as date) as order_date,
        sum(revenue) as total_revenue,
        avg(revenue) as avg_revenue,
        max(revenue) as max_revenue,
        min(revenue) as min_revenue,
        count(*) as line_count,
        rank() over (partition by customer_id order by sum(revenue) desc) as revenue_rank
    from base
    group by order_id, product_id, customer_id, employee_id, shipper_id, order_date
)
select * from aggregated
  );
[0m09:00:54.719927 [debug] [Thread-9  ]: Opening a new connection, currently in state init
[0m09:00:54.799379 [debug] [Thread-11 ]: Using snowflake connection "model.northwind_dbt.dim_products"
[0m09:00:54.734809 [debug] [Thread-7  ]: Using snowflake connection "model.northwind_dbt.dim_employees"
[0m09:00:54.799379 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.757 seconds
[0m09:00:54.799379 [debug] [Thread-11 ]: On model.northwind_dbt.dim_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.dim_products"} */
create or replace transient table PROJECT_2.PUBLIC.dim_products
         as
        (select 
    p.product_id,
    p.product_name,
    p.supplier_id,
    s.company_name as supplier_name,
    p.category_id,
    c.category_name,
    p.quantity_per_unit,
    p.unit_price,
    p.units_in_stock,
    p.units_on_order,
    p.reorder_level,
    p.discontinued
from PROJECT_2.PUBLIC.stg_products p
left join PROJECT_2.PUBLIC.suppliers s on p.supplier_id = s.supplier_id
left join PROJECT_2.PUBLIC.categories c on p.category_id = c.category_id
        );
[0m09:00:54.799379 [debug] [Thread-7  ]: On model.northwind_dbt.dim_employees: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.dim_employees"} */
create or replace transient table PROJECT_2.PUBLIC.dim_employees
         as
        (with source_data as (
    select * from PROJECT_2.PUBLIC.stg_employees
),
scd2 as (
    select 
        md5(cast(coalesce(cast(employee_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as employee_key,
        *,
        current_timestamp as dbt_updated_at
    from source_data
)
select * from scd2
        );
[0m09:00:54.815364 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3e67f07-cd75-4d21-ae28-72482ff4eecc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000266E8AF8160>]}
[0m09:00:54.815364 [debug] [Thread-11 ]: Opening a new connection, currently in state init
[0m09:00:54.815364 [debug] [Thread-7  ]: Opening a new connection, currently in state init
[0m09:00:54.815364 [info ] [Thread-1  ]: 1 of 13 OK created sql view model PUBLIC.stg_customers ......................... [[32mSUCCESS 1[0m in 1.97s]
[0m09:00:54.827000 [debug] [Thread-1  ]: Finished running node model.northwind_dbt.stg_customers
[0m09:00:54.827000 [debug] [Thread-6  ]: Began running node model.northwind_dbt.dim_customers
[0m09:00:54.827000 [info ] [Thread-6  ]: 9 of 13 START sql table model PUBLIC.dim_customers ............................. [RUN]
[0m09:00:54.832086 [debug] [Thread-6  ]: Acquiring new snowflake connection 'model.northwind_dbt.dim_customers'
[0m09:00:54.833804 [debug] [Thread-6  ]: Began compiling node model.northwind_dbt.dim_customers
[0m09:00:54.837546 [debug] [Thread-6  ]: Writing injected SQL for node "model.northwind_dbt.dim_customers"
[0m09:00:54.862642 [debug] [Thread-6  ]: Began executing node model.northwind_dbt.dim_customers
[0m09:00:54.867785 [debug] [Thread-6  ]: Writing runtime sql for node "model.northwind_dbt.dim_customers"
[0m09:00:54.890028 [debug] [Thread-6  ]: Using snowflake connection "model.northwind_dbt.dim_customers"
[0m09:00:54.892761 [debug] [Thread-6  ]: On model.northwind_dbt.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.dim_customers"} */
create or replace transient table PROJECT_2.PUBLIC.dim_customers
         as
        (select * from PROJECT_2.PUBLIC.stg_customers
        );
[0m09:00:54.892761 [debug] [Thread-6  ]: Opening a new connection, currently in state init
[0m09:00:55.771030 [debug] [Thread-9  ]: SQL status: SUCCESS 1 in 1.052 seconds
[0m09:00:55.787823 [debug] [Thread-9  ]: Using snowflake connection "model.northwind_dbt.fact_order_details"
[0m09:00:55.787823 [debug] [Thread-9  ]: On model.northwind_dbt.fact_order_details: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.fact_order_details"} */
describe table PROJECT_2.PUBLIC.fact_order_details__dbt_tmp
[0m09:00:56.082305 [debug] [Thread-9  ]: SQL status: SUCCESS 12 in 0.291 seconds
[0m09:00:56.086330 [debug] [Thread-9  ]: Using snowflake connection "model.northwind_dbt.fact_order_details"
[0m09:00:56.086330 [debug] [Thread-9  ]: On model.northwind_dbt.fact_order_details: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.fact_order_details"} */
describe table PROJECT_2.PUBLIC.fact_order_details
[0m09:00:56.213869 [debug] [Thread-9  ]: SQL status: SUCCESS 12 in 0.120 seconds
[0m09:00:56.228288 [debug] [Thread-9  ]: Using snowflake connection "model.northwind_dbt.fact_order_details"
[0m09:00:56.229383 [debug] [Thread-9  ]: On model.northwind_dbt.fact_order_details: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.fact_order_details"} */
describe table "PROJECT_2"."PUBLIC"."FACT_ORDER_DETAILS"
[0m09:00:56.345047 [debug] [Thread-9  ]: SQL status: SUCCESS 12 in 0.117 seconds
[0m09:00:56.369301 [debug] [Thread-9  ]: Writing runtime sql for node "model.northwind_dbt.fact_order_details"
[0m09:00:56.396606 [debug] [Thread-9  ]: Using snowflake connection "model.northwind_dbt.fact_order_details"
[0m09:00:56.399607 [debug] [Thread-9  ]: On model.northwind_dbt.fact_order_details: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.fact_order_details"} */
-- back compat for old kwarg name
  
  begin;
[0m09:00:56.634253 [debug] [Thread-9  ]: SQL status: SUCCESS 1 in 0.233 seconds
[0m09:00:56.636276 [debug] [Thread-9  ]: Using snowflake connection "model.northwind_dbt.fact_order_details"
[0m09:00:56.638786 [debug] [Thread-9  ]: On model.northwind_dbt.fact_order_details: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.fact_order_details"} */
merge into PROJECT_2.PUBLIC.fact_order_details as DBT_INTERNAL_DEST
        using PROJECT_2.PUBLIC.fact_order_details__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.order_id = DBT_INTERNAL_DEST.order_id
                ) and (
                    DBT_INTERNAL_SOURCE.product_id = DBT_INTERNAL_DEST.product_id
                )

    
    when matched then update set
        "ORDER_ID" = DBT_INTERNAL_SOURCE."ORDER_ID","PRODUCT_ID" = DBT_INTERNAL_SOURCE."PRODUCT_ID","CUSTOMER_ID" = DBT_INTERNAL_SOURCE."CUSTOMER_ID","EMPLOYEE_ID" = DBT_INTERNAL_SOURCE."EMPLOYEE_ID","SHIPPER_ID" = DBT_INTERNAL_SOURCE."SHIPPER_ID","ORDER_DATE" = DBT_INTERNAL_SOURCE."ORDER_DATE","TOTAL_REVENUE" = DBT_INTERNAL_SOURCE."TOTAL_REVENUE","AVG_REVENUE" = DBT_INTERNAL_SOURCE."AVG_REVENUE","MAX_REVENUE" = DBT_INTERNAL_SOURCE."MAX_REVENUE","MIN_REVENUE" = DBT_INTERNAL_SOURCE."MIN_REVENUE","LINE_COUNT" = DBT_INTERNAL_SOURCE."LINE_COUNT","REVENUE_RANK" = DBT_INTERNAL_SOURCE."REVENUE_RANK"
    

    when not matched then insert
        ("ORDER_ID", "PRODUCT_ID", "CUSTOMER_ID", "EMPLOYEE_ID", "SHIPPER_ID", "ORDER_DATE", "TOTAL_REVENUE", "AVG_REVENUE", "MAX_REVENUE", "MIN_REVENUE", "LINE_COUNT", "REVENUE_RANK")
    values
        ("ORDER_ID", "PRODUCT_ID", "CUSTOMER_ID", "EMPLOYEE_ID", "SHIPPER_ID", "ORDER_DATE", "TOTAL_REVENUE", "AVG_REVENUE", "MAX_REVENUE", "MIN_REVENUE", "LINE_COUNT", "REVENUE_RANK")

;
[0m09:00:57.097316 [debug] [Thread-6  ]: SQL status: SUCCESS 1 in 2.210 seconds
[0m09:00:57.097316 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3e67f07-cd75-4d21-ae28-72482ff4eecc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000266E8A9A0D0>]}
[0m09:00:57.097316 [info ] [Thread-6  ]: 9 of 13 OK created sql table model PUBLIC.dim_customers ........................ [[32mSUCCESS 1[0m in 2.27s]
[0m09:00:57.113076 [debug] [Thread-6  ]: Finished running node model.northwind_dbt.dim_customers
[0m09:00:57.817734 [debug] [Thread-11 ]: SQL status: SUCCESS 1 in 3.006 seconds
[0m09:00:57.817734 [debug] [Thread-11 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3e67f07-cd75-4d21-ae28-72482ff4eecc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000266E9B73A90>]}
[0m09:00:57.817734 [info ] [Thread-11 ]: 8 of 13 OK created sql table model PUBLIC.dim_products ......................... [[32mSUCCESS 1[0m in 3.23s]
[0m09:00:57.833411 [debug] [Thread-11 ]: Finished running node model.northwind_dbt.dim_products
[0m09:00:58.027713 [debug] [Thread-7  ]: SQL status: SUCCESS 1 in 3.208 seconds
[0m09:00:58.033248 [debug] [Thread-7  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3e67f07-cd75-4d21-ae28-72482ff4eecc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000266E8A24130>]}
[0m09:00:58.033248 [info ] [Thread-7  ]: 6 of 13 OK created sql table model PUBLIC.dim_employees ........................ [[32mSUCCESS 1[0m in 3.45s]
[0m09:00:58.033248 [debug] [Thread-7  ]: Finished running node model.northwind_dbt.dim_employees
[0m09:00:58.844833 [debug] [Thread-9  ]: SQL status: SUCCESS 32 in 2.208 seconds
[0m09:00:58.844833 [debug] [Thread-9  ]: Using snowflake connection "model.northwind_dbt.fact_order_details"
[0m09:00:58.852086 [debug] [Thread-9  ]: On model.northwind_dbt.fact_order_details: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.fact_order_details"} */
COMMIT
[0m09:00:59.362482 [debug] [Thread-9  ]: SQL status: SUCCESS 1 in 0.508 seconds
[0m09:00:59.376948 [debug] [Thread-9  ]: Applying DROP to: PROJECT_2.PUBLIC.fact_order_details__dbt_tmp
[0m09:00:59.385478 [debug] [Thread-9  ]: Using snowflake connection "model.northwind_dbt.fact_order_details"
[0m09:00:59.387523 [debug] [Thread-9  ]: On model.northwind_dbt.fact_order_details: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.fact_order_details"} */
drop view if exists PROJECT_2.PUBLIC.fact_order_details__dbt_tmp cascade
[0m09:00:59.555378 [debug] [Thread-9  ]: SQL status: SUCCESS 1 in 0.168 seconds
[0m09:00:59.559611 [debug] [Thread-9  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3e67f07-cd75-4d21-ae28-72482ff4eecc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000266E9BC5C40>]}
[0m09:00:59.559611 [info ] [Thread-9  ]: 7 of 13 OK created sql incremental model PUBLIC.fact_order_details ............. [[32mSUCCESS 32[0m in 4.98s]
[0m09:00:59.563623 [debug] [Thread-9  ]: Finished running node model.northwind_dbt.fact_order_details
[0m09:00:59.563623 [debug] [Thread-2  ]: Began running node model.northwind_dbt.obt_orders
[0m09:00:59.566053 [debug] [Thread-8  ]: Began running node model.northwind_dbt.top_customer_revenue
[0m09:00:59.566847 [debug] [Thread-4  ]: Began running node model.northwind_dbt.top_employee_revenue
[0m09:00:59.566847 [debug] [Thread-5  ]: Began running node model.northwind_dbt.top_performing_products
[0m09:00:59.566847 [info ] [Thread-2  ]: 10 of 13 START sql table model PUBLIC.obt_orders ............................... [RUN]
[0m09:00:59.569584 [info ] [Thread-8  ]: 11 of 13 START sql table model PUBLIC.top_customer_revenue ..................... [RUN]
[0m09:00:59.573042 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.northwind_dbt.stg_employees, now model.northwind_dbt.obt_orders)
[0m09:00:59.570509 [info ] [Thread-4  ]: 12 of 13 START sql table model PUBLIC.top_employee_revenue ..................... [RUN]
[0m09:00:59.573042 [info ] [Thread-5  ]: 13 of 13 START sql table model PUBLIC.top_performing_products .................. [RUN]
[0m09:00:59.577181 [debug] [Thread-8  ]: Acquiring new snowflake connection 'model.northwind_dbt.top_customer_revenue'
[0m09:00:59.579190 [debug] [Thread-2  ]: Began compiling node model.northwind_dbt.obt_orders
[0m09:00:59.579190 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.northwind_dbt.stg_orders, now model.northwind_dbt.top_employee_revenue)
[0m09:00:59.580889 [debug] [Thread-5  ]: Re-using an available connection from the pool (formerly model.northwind_dbt.stg_products, now model.northwind_dbt.top_performing_products)
[0m09:00:59.580889 [debug] [Thread-8  ]: Began compiling node model.northwind_dbt.top_customer_revenue
[0m09:00:59.591611 [debug] [Thread-2  ]: Writing injected SQL for node "model.northwind_dbt.obt_orders"
[0m09:00:59.591611 [debug] [Thread-4  ]: Began compiling node model.northwind_dbt.top_employee_revenue
[0m09:00:59.595679 [debug] [Thread-5  ]: Began compiling node model.northwind_dbt.top_performing_products
[0m09:00:59.604153 [debug] [Thread-8  ]: Writing injected SQL for node "model.northwind_dbt.top_customer_revenue"
[0m09:00:59.612211 [debug] [Thread-4  ]: Writing injected SQL for node "model.northwind_dbt.top_employee_revenue"
[0m09:00:59.617990 [debug] [Thread-5  ]: Writing injected SQL for node "model.northwind_dbt.top_performing_products"
[0m09:00:59.638461 [debug] [Thread-2  ]: Began executing node model.northwind_dbt.obt_orders
[0m09:00:59.645642 [debug] [Thread-2  ]: Writing runtime sql for node "model.northwind_dbt.obt_orders"
[0m09:00:59.651385 [debug] [Thread-8  ]: Began executing node model.northwind_dbt.top_customer_revenue
[0m09:00:59.652219 [debug] [Thread-5  ]: Began executing node model.northwind_dbt.top_performing_products
[0m09:00:59.657425 [debug] [Thread-8  ]: Writing runtime sql for node "model.northwind_dbt.top_customer_revenue"
[0m09:00:59.657425 [debug] [Thread-4  ]: Began executing node model.northwind_dbt.top_employee_revenue
[0m09:00:59.664141 [debug] [Thread-5  ]: Writing runtime sql for node "model.northwind_dbt.top_performing_products"
[0m09:00:59.664141 [debug] [Thread-2  ]: Using snowflake connection "model.northwind_dbt.obt_orders"
[0m09:00:59.667442 [debug] [Thread-4  ]: Writing runtime sql for node "model.northwind_dbt.top_employee_revenue"
[0m09:00:59.672299 [debug] [Thread-2  ]: On model.northwind_dbt.obt_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.obt_orders"} */
create or replace transient table PROJECT_2.PUBLIC.obt_orders
         as
        (select 
    f.order_id,
    f.product_id,
    f.customer_id,
    f.employee_id,
    f.shipper_id,
    f.order_date,
    f.total_revenue,
    f.avg_revenue,
    f.max_revenue,
    f.min_revenue,
    f.line_count,
    f.revenue_rank,

    c.company_name as customer_name,
    p.product_name,
    p.category_name,
    p.supplier_name,
    e.first_name || ' ' || e.last_name as employee_name,
    s.company_name as shipper_name

from PROJECT_2.PUBLIC.fact_order_details f
left join PROJECT_2.PUBLIC.dim_customers c on f.customer_id = c.customer_id
left join PROJECT_2.PUBLIC.dim_products p on f.product_id = p.product_id
left join PROJECT_2.PUBLIC.dim_employees e on f.employee_id = e.employee_id
left join PROJECT_2.PUBLIC.shippers s on f.shipper_id = s.shipper_id
        );
[0m09:00:59.683379 [debug] [Thread-8  ]: Using snowflake connection "model.northwind_dbt.top_customer_revenue"
[0m09:00:59.683379 [debug] [Thread-8  ]: On model.northwind_dbt.top_customer_revenue: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.top_customer_revenue"} */
create or replace transient table PROJECT_2.PUBLIC.top_customer_revenue
         as
        (

select
  c.customer_id,
  c.company_name as customer_name,
  sum(f.total_revenue) as total_revenue
from PROJECT_2.PUBLIC.fact_order_details f
join PROJECT_2.PUBLIC.dim_customers c using (customer_id)
group by c.customer_id, c.company_name
order by total_revenue desc
        );
[0m09:00:59.683379 [debug] [Thread-8  ]: Opening a new connection, currently in state init
[0m09:00:59.688947 [debug] [Thread-4  ]: Using snowflake connection "model.northwind_dbt.top_employee_revenue"
[0m09:00:59.688947 [debug] [Thread-5  ]: Using snowflake connection "model.northwind_dbt.top_performing_products"
[0m09:00:59.688947 [debug] [Thread-4  ]: On model.northwind_dbt.top_employee_revenue: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.top_employee_revenue"} */
create or replace transient table PROJECT_2.PUBLIC.top_employee_revenue
         as
        (

select
  e.employee_key,
  e.first_name || ' ' || e.last_name as employee_name,
  sum(f.total_revenue) as total_revenue
from PROJECT_2.PUBLIC.fact_order_details f
join PROJECT_2.PUBLIC.dim_employees e on f.employee_id = e.employee_id
group by e.employee_key, employee_name
order by total_revenue desc
        );
[0m09:00:59.688947 [debug] [Thread-5  ]: On model.northwind_dbt.top_performing_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "node_id": "model.northwind_dbt.top_performing_products"} */
create or replace transient table PROJECT_2.PUBLIC.top_performing_products
         as
        (

select
  p.product_id,
  p.product_name,
  sum(f.total_revenue) as total_revenue,
  count(distinct f.order_id) as number_of_orders
from PROJECT_2.PUBLIC.fact_order_details f
join PROJECT_2.PUBLIC.dim_products p on f.product_id = p.product_id
group by p.product_id, p.product_name
order by total_revenue desc
        );
[0m09:01:01.304862 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1.610 seconds
[0m09:01:01.308572 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.633 seconds
[0m09:01:01.309467 [debug] [Thread-5  ]: SQL status: SUCCESS 1 in 1.613 seconds
[0m09:01:01.311474 [debug] [Thread-8  ]: SQL status: SUCCESS 1 in 1.624 seconds
[0m09:01:01.316199 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3e67f07-cd75-4d21-ae28-72482ff4eecc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000266E9B33AC0>]}
[0m09:01:01.320671 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3e67f07-cd75-4d21-ae28-72482ff4eecc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000266E897EF70>]}
[0m09:01:01.326707 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3e67f07-cd75-4d21-ae28-72482ff4eecc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000266E9B484F0>]}
[0m09:01:01.332232 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3e67f07-cd75-4d21-ae28-72482ff4eecc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000266E9BF9F40>]}
[0m09:01:01.334242 [info ] [Thread-4  ]: 12 of 13 OK created sql table model PUBLIC.top_employee_revenue ................ [[32mSUCCESS 1[0m in 1.74s]
[0m09:01:01.354127 [debug] [Thread-4  ]: Finished running node model.northwind_dbt.top_employee_revenue
[0m09:01:01.336251 [info ] [Thread-2  ]: 10 of 13 OK created sql table model PUBLIC.obt_orders .......................... [[32mSUCCESS 1[0m in 1.75s]
[0m09:01:01.338261 [info ] [Thread-5  ]: 13 of 13 OK created sql table model PUBLIC.top_performing_products ............. [[32mSUCCESS 1[0m in 1.75s]
[0m09:01:01.359002 [debug] [Thread-2  ]: Finished running node model.northwind_dbt.obt_orders
[0m09:01:01.340271 [info ] [Thread-8  ]: 11 of 13 OK created sql table model PUBLIC.top_customer_revenue ................ [[32mSUCCESS 1[0m in 1.76s]
[0m09:01:01.360711 [debug] [Thread-5  ]: Finished running node model.northwind_dbt.top_performing_products
[0m09:01:01.362558 [debug] [Thread-8  ]: Finished running node model.northwind_dbt.top_customer_revenue
[0m09:01:01.369155 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:01:01.370659 [debug] [MainThread]: Connection 'list_PROJECT_2' was left open.
[0m09:01:01.372331 [debug] [MainThread]: On list_PROJECT_2: Close
[0m09:01:01.490242 [debug] [MainThread]: Connection 'list_PROJECT_2_PUBLIC' was left open.
[0m09:01:01.492250 [debug] [MainThread]: On list_PROJECT_2_PUBLIC: Close
[0m09:01:01.669520 [debug] [MainThread]: Connection 'list_PROJECT_2_snapshots' was left open.
[0m09:01:01.670578 [debug] [MainThread]: On list_PROJECT_2_snapshots: Close
[0m09:01:01.877868 [debug] [MainThread]: Connection 'model.northwind_dbt.stg_customers' was left open.
[0m09:01:01.878964 [debug] [MainThread]: On model.northwind_dbt.stg_customers: Close
[0m09:01:02.057122 [debug] [MainThread]: Connection 'model.northwind_dbt.obt_orders' was left open.
[0m09:01:02.058252 [debug] [MainThread]: On model.northwind_dbt.obt_orders: Close
[0m09:01:02.324168 [debug] [MainThread]: Connection 'model.northwind_dbt.stg_order_details' was left open.
[0m09:01:02.325500 [debug] [MainThread]: On model.northwind_dbt.stg_order_details: Close
[0m09:01:02.531772 [debug] [MainThread]: Connection 'model.northwind_dbt.top_employee_revenue' was left open.
[0m09:01:02.532830 [debug] [MainThread]: On model.northwind_dbt.top_employee_revenue: Close
[0m09:01:02.670982 [debug] [MainThread]: Connection 'model.northwind_dbt.top_performing_products' was left open.
[0m09:01:02.670982 [debug] [MainThread]: On model.northwind_dbt.top_performing_products: Close
[0m09:01:03.103164 [debug] [MainThread]: Connection 'model.northwind_dbt.dim_employees' was left open.
[0m09:01:03.104266 [debug] [MainThread]: On model.northwind_dbt.dim_employees: Close
[0m09:01:03.257812 [debug] [MainThread]: Connection 'model.northwind_dbt.fact_order_details' was left open.
[0m09:01:03.259824 [debug] [MainThread]: On model.northwind_dbt.fact_order_details: Close
[0m09:01:03.415520 [debug] [MainThread]: Connection 'model.northwind_dbt.dim_products' was left open.
[0m09:01:03.417535 [debug] [MainThread]: On model.northwind_dbt.dim_products: Close
[0m09:01:03.579201 [debug] [MainThread]: Connection 'model.northwind_dbt.dim_customers' was left open.
[0m09:01:03.579201 [debug] [MainThread]: On model.northwind_dbt.dim_customers: Close
[0m09:01:03.713003 [debug] [MainThread]: Connection 'model.northwind_dbt.top_customer_revenue' was left open.
[0m09:01:03.722001 [debug] [MainThread]: On model.northwind_dbt.top_customer_revenue: Close
[0m09:01:03.929944 [info ] [MainThread]: 
[0m09:01:03.931960 [info ] [MainThread]: Finished running 1 incremental model, 7 table models, 5 view models in 0 hours 0 minutes and 16.18 seconds (16.18s).
[0m09:01:03.931960 [debug] [MainThread]: Command end result
[0m09:01:04.129493 [debug] [MainThread]: Wrote artifact WritableManifest to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\manifest.json
[0m09:01:04.135302 [debug] [MainThread]: Wrote artifact SemanticManifest to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\semantic_manifest.json
[0m09:01:04.161402 [debug] [MainThread]: Wrote artifact RunExecutionResult to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\run_results.json
[0m09:01:04.165043 [info ] [MainThread]: 
[0m09:01:04.166697 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:01:04.168267 [info ] [MainThread]: 
[0m09:01:04.169629 [info ] [MainThread]: Done. PASS=13 WARN=0 ERROR=0 SKIP=0 TOTAL=13
[0m09:01:04.169629 [debug] [MainThread]: Command `dbt run` succeeded at 09:01:04.169629 after 27.92 seconds
[0m09:01:04.173206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000266CD131370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000266CCCF4EE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000266CCCD6580>]}
[0m09:01:04.173206 [debug] [MainThread]: Flushing usage events
[0m09:01:05.068246 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:01:36.236086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A805F0340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A82782070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A82782700>]}


============================== 09:01:36.236086 | b7ee320f-7f79-4aab-bf9c-25e87c93979d ==============================
[0m09:01:36.236086 [info ] [MainThread]: Running with dbt=1.9.0
[0m09:01:36.236086 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'c:\\Users\\fitzp\\Documents\\Alpaca_Market\\zproject_2\\northwind_psql', 'log_path': 'c:\\Users\\fitzp\\Documents\\Alpaca_Market\\zproject_2\\northwind_psql\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt docs generate', 'send_anonymous_usage_stats': 'True'}
[0m09:01:37.376669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b7ee320f-7f79-4aab-bf9c-25e87c93979d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A9B30D160>]}
[0m09:01:37.438330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b7ee320f-7f79-4aab-bf9c-25e87c93979d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A82603580>]}
[0m09:01:37.438330 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m09:01:38.032866 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m09:01:38.664355 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:01:38.664355 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:01:38.664355 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.northwind_dbt.marts.bi
[0m09:01:38.789639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b7ee320f-7f79-4aab-bf9c-25e87c93979d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A9B8B89D0>]}
[0m09:01:38.864260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b7ee320f-7f79-4aab-bf9c-25e87c93979d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A9B8B8790>]}
[0m09:01:38.864260 [info ] [MainThread]: Found 13 models, 2 snapshots, 16 data tests, 8 sources, 706 macros
[0m09:01:38.864260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b7ee320f-7f79-4aab-bf9c-25e87c93979d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A9B8B87C0>]}
[0m09:01:38.871712 [info ] [MainThread]: 
[0m09:01:38.871712 [info ] [MainThread]: Concurrency: 12 threads (target='dev')
[0m09:01:38.871712 [info ] [MainThread]: 
[0m09:01:38.876981 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m09:01:38.877404 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_2_snapshots'
[0m09:01:38.877404 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_2_PUBLIC'
[0m09:01:38.992382 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_2_snapshots"
[0m09:01:39.003572 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_2_PUBLIC"
[0m09:01:39.003572 [debug] [ThreadPool]: On list_PROJECT_2_snapshots: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "connection_name": "list_PROJECT_2_snapshots"} */
show objects in PROJECT_2.snapshots limit 10000;
[0m09:01:39.003572 [debug] [ThreadPool]: On list_PROJECT_2_PUBLIC: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "connection_name": "list_PROJECT_2_PUBLIC"} */
show objects in PROJECT_2.PUBLIC limit 10000;
[0m09:01:39.003572 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:01:39.006757 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:01:39.809785 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.804 seconds
[0m09:01:39.819398 [debug] [ThreadPool]: SQL status: SUCCESS 27 in 0.813 seconds
[0m09:01:39.827348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b7ee320f-7f79-4aab-bf9c-25e87c93979d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A9B8B8520>]}
[0m09:01:39.839164 [debug] [Thread-1  ]: Began running node model.northwind_dbt.stg_customers
[0m09:01:39.839658 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.northwind_dbt.stg_customers'
[0m09:01:39.841673 [debug] [Thread-2  ]: Began running node model.northwind_dbt.stg_employees
[0m09:01:39.841673 [debug] [Thread-3  ]: Began running node model.northwind_dbt.stg_order_details
[0m09:01:39.843686 [debug] [Thread-4  ]: Began running node model.northwind_dbt.stg_orders
[0m09:01:39.844389 [debug] [Thread-5  ]: Began running node model.northwind_dbt.stg_products
[0m09:01:39.844898 [debug] [Thread-1  ]: Began compiling node model.northwind_dbt.stg_customers
[0m09:01:39.844898 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.northwind_dbt.stg_employees'
[0m09:01:39.847124 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.northwind_dbt.stg_order_details'
[0m09:01:39.849264 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.northwind_dbt.stg_orders'
[0m09:01:39.849264 [debug] [Thread-5  ]: Acquiring new snowflake connection 'model.northwind_dbt.stg_products'
[0m09:01:39.861930 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind_dbt.stg_customers"
[0m09:01:39.861930 [debug] [Thread-2  ]: Began compiling node model.northwind_dbt.stg_employees
[0m09:01:39.866486 [debug] [Thread-3  ]: Began compiling node model.northwind_dbt.stg_order_details
[0m09:01:39.869101 [debug] [Thread-4  ]: Began compiling node model.northwind_dbt.stg_orders
[0m09:01:39.869609 [debug] [Thread-5  ]: Began compiling node model.northwind_dbt.stg_products
[0m09:01:39.878747 [debug] [Thread-2  ]: Writing injected SQL for node "model.northwind_dbt.stg_employees"
[0m09:01:39.882013 [debug] [Thread-3  ]: Writing injected SQL for node "model.northwind_dbt.stg_order_details"
[0m09:01:39.882013 [debug] [Thread-1  ]: Began executing node model.northwind_dbt.stg_customers
[0m09:01:39.889135 [debug] [Thread-4  ]: Writing injected SQL for node "model.northwind_dbt.stg_orders"
[0m09:01:39.889672 [debug] [Thread-5  ]: Writing injected SQL for node "model.northwind_dbt.stg_products"
[0m09:01:39.897206 [debug] [Thread-1  ]: Finished running node model.northwind_dbt.stg_customers
[0m09:01:39.900635 [debug] [Thread-7  ]: Began running node model.northwind_dbt.dim_customers
[0m09:01:39.900635 [debug] [Thread-8  ]: Began running node snapshot.northwind_dbt.customers_snapshot
[0m09:01:39.902813 [debug] [Thread-7  ]: Acquiring new snowflake connection 'model.northwind_dbt.dim_customers'
[0m09:01:39.903322 [debug] [Thread-8  ]: Acquiring new snowflake connection 'snapshot.northwind_dbt.customers_snapshot'
[0m09:01:39.905335 [debug] [Thread-7  ]: Began compiling node model.northwind_dbt.dim_customers
[0m09:01:39.906215 [debug] [Thread-8  ]: Began compiling node snapshot.northwind_dbt.customers_snapshot
[0m09:01:39.911745 [debug] [Thread-7  ]: Writing injected SQL for node "model.northwind_dbt.dim_customers"
[0m09:01:39.918480 [debug] [Thread-8  ]: Began executing node snapshot.northwind_dbt.customers_snapshot
[0m09:01:39.918480 [debug] [Thread-4  ]: Began executing node model.northwind_dbt.stg_orders
[0m09:01:39.921135 [debug] [Thread-8  ]: Finished running node snapshot.northwind_dbt.customers_snapshot
[0m09:01:39.922914 [debug] [Thread-4  ]: Finished running node model.northwind_dbt.stg_orders
[0m09:01:39.925593 [debug] [Thread-5  ]: Began executing node model.northwind_dbt.stg_products
[0m09:01:39.925593 [debug] [Thread-2  ]: Began executing node model.northwind_dbt.stg_employees
[0m09:01:39.927257 [debug] [Thread-3  ]: Began executing node model.northwind_dbt.stg_order_details
[0m09:01:39.929175 [debug] [Thread-5  ]: Finished running node model.northwind_dbt.stg_products
[0m09:01:39.931366 [debug] [Thread-2  ]: Finished running node model.northwind_dbt.stg_employees
[0m09:01:39.934057 [debug] [Thread-3  ]: Finished running node model.northwind_dbt.stg_order_details
[0m09:01:39.935473 [debug] [Thread-7  ]: Began executing node model.northwind_dbt.dim_customers
[0m09:01:39.937221 [debug] [Thread-10 ]: Began running node model.northwind_dbt.dim_products
[0m09:01:39.939847 [debug] [Thread-12 ]: Began running node model.northwind_dbt.dim_employees
[0m09:01:39.939847 [debug] [Thread-6  ]: Began running node snapshot.northwind_dbt.employees_snapshot
[0m09:01:39.942080 [debug] [Thread-9  ]: Began running node model.northwind_dbt.fact_order_details
[0m09:01:39.942080 [debug] [Thread-7  ]: Finished running node model.northwind_dbt.dim_customers
[0m09:01:39.944443 [debug] [Thread-10 ]: Acquiring new snowflake connection 'model.northwind_dbt.dim_products'
[0m09:01:39.944443 [debug] [Thread-12 ]: Acquiring new snowflake connection 'model.northwind_dbt.dim_employees'
[0m09:01:39.948411 [debug] [Thread-6  ]: Acquiring new snowflake connection 'snapshot.northwind_dbt.employees_snapshot'
[0m09:01:39.949477 [debug] [Thread-9  ]: Acquiring new snowflake connection 'model.northwind_dbt.fact_order_details'
[0m09:01:39.951114 [debug] [Thread-4  ]: Began running node test.northwind_dbt.not_null_dim_customers_customer_id.dd91cd1c8d
[0m09:01:39.952202 [debug] [Thread-5  ]: Began running node test.northwind_dbt.unique_dim_customers_customer_id.15c9f1e2fd
[0m09:01:39.953074 [debug] [Thread-10 ]: Began compiling node model.northwind_dbt.dim_products
[0m09:01:39.953623 [debug] [Thread-12 ]: Began compiling node model.northwind_dbt.dim_employees
[0m09:01:39.954779 [debug] [Thread-6  ]: Began compiling node snapshot.northwind_dbt.employees_snapshot
[0m09:01:39.955767 [debug] [Thread-9  ]: Began compiling node model.northwind_dbt.fact_order_details
[0m09:01:39.957530 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.northwind_dbt.stg_orders, now test.northwind_dbt.not_null_dim_customers_customer_id.dd91cd1c8d)
[0m09:01:39.959255 [debug] [Thread-5  ]: Re-using an available connection from the pool (formerly model.northwind_dbt.stg_products, now test.northwind_dbt.unique_dim_customers_customer_id.15c9f1e2fd)
[0m09:01:39.963933 [debug] [Thread-10 ]: Writing injected SQL for node "model.northwind_dbt.dim_products"
[0m09:01:39.984532 [debug] [Thread-12 ]: Writing injected SQL for node "model.northwind_dbt.dim_employees"
[0m09:01:39.991056 [debug] [Thread-6  ]: Began executing node snapshot.northwind_dbt.employees_snapshot
[0m09:01:40.005109 [debug] [Thread-9  ]: Writing injected SQL for node "model.northwind_dbt.fact_order_details"
[0m09:01:40.006277 [debug] [Thread-4  ]: Began compiling node test.northwind_dbt.not_null_dim_customers_customer_id.dd91cd1c8d
[0m09:01:40.007391 [debug] [Thread-5  ]: Began compiling node test.northwind_dbt.unique_dim_customers_customer_id.15c9f1e2fd
[0m09:01:40.010202 [debug] [Thread-6  ]: Finished running node snapshot.northwind_dbt.employees_snapshot
[0m09:01:40.031830 [debug] [Thread-4  ]: Writing injected SQL for node "test.northwind_dbt.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m09:01:40.044165 [debug] [Thread-5  ]: Writing injected SQL for node "test.northwind_dbt.unique_dim_customers_customer_id.15c9f1e2fd"
[0m09:01:40.045336 [debug] [Thread-10 ]: Began executing node model.northwind_dbt.dim_products
[0m09:01:40.046396 [debug] [Thread-12 ]: Began executing node model.northwind_dbt.dim_employees
[0m09:01:40.046937 [debug] [Thread-9  ]: Began executing node model.northwind_dbt.fact_order_details
[0m09:01:40.050278 [debug] [Thread-10 ]: Finished running node model.northwind_dbt.dim_products
[0m09:01:40.051381 [debug] [Thread-12 ]: Finished running node model.northwind_dbt.dim_employees
[0m09:01:40.053067 [debug] [Thread-9  ]: Finished running node model.northwind_dbt.fact_order_details
[0m09:01:40.054846 [debug] [Thread-2  ]: Began running node test.northwind_dbt.not_null_dim_products_product_id.c8aba288d1
[0m09:01:40.055353 [debug] [Thread-1  ]: Began running node test.northwind_dbt.unique_dim_products_product_id.ef7b2a9985
[0m09:01:40.057435 [debug] [Thread-8  ]: Began running node test.northwind_dbt.not_null_dim_employees_employee_key.232a183ffe
[0m09:01:40.058128 [debug] [Thread-7  ]: Began running node test.northwind_dbt.unique_dim_employees_employee_key.3824d24782
[0m09:01:40.060170 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.northwind_dbt.stg_employees, now test.northwind_dbt.not_null_dim_products_product_id.c8aba288d1)
[0m09:01:40.060170 [debug] [Thread-6  ]: Began running node model.northwind_dbt.obt_orders
[0m09:01:40.060170 [debug] [Thread-10 ]: Began running node model.northwind_dbt.top_customer_revenue
[0m09:01:40.062179 [debug] [Thread-3  ]: Began running node model.northwind_dbt.top_employee_revenue
[0m09:01:40.062179 [debug] [Thread-5  ]: Began executing node test.northwind_dbt.unique_dim_customers_customer_id.15c9f1e2fd
[0m09:01:40.062179 [debug] [Thread-12 ]: Began running node model.northwind_dbt.top_performing_products
[0m09:01:40.062179 [debug] [Thread-4  ]: Began executing node test.northwind_dbt.not_null_dim_customers_customer_id.dd91cd1c8d
[0m09:01:40.062179 [debug] [Thread-9  ]: Began running node test.northwind_dbt.not_null_fact_order_details_customer_id.6aaefe4888
[0m09:01:40.062179 [debug] [Thread-11 ]: Began running node test.northwind_dbt.not_null_fact_order_details_order_id.8d47c14c82
[0m09:01:40.062179 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.northwind_dbt.stg_customers, now test.northwind_dbt.unique_dim_products_product_id.ef7b2a9985)
[0m09:01:40.062179 [debug] [Thread-8  ]: Re-using an available connection from the pool (formerly snapshot.northwind_dbt.customers_snapshot, now test.northwind_dbt.not_null_dim_employees_employee_key.232a183ffe)
[0m09:01:40.062179 [debug] [Thread-7  ]: Re-using an available connection from the pool (formerly model.northwind_dbt.dim_customers, now test.northwind_dbt.unique_dim_employees_employee_key.3824d24782)
[0m09:01:40.062179 [debug] [Thread-2  ]: Began compiling node test.northwind_dbt.not_null_dim_products_product_id.c8aba288d1
[0m09:01:40.062179 [debug] [Thread-6  ]: Re-using an available connection from the pool (formerly snapshot.northwind_dbt.employees_snapshot, now model.northwind_dbt.obt_orders)
[0m09:01:40.062179 [debug] [Thread-10 ]: Re-using an available connection from the pool (formerly model.northwind_dbt.dim_products, now model.northwind_dbt.top_customer_revenue)
[0m09:01:40.089627 [debug] [Thread-10 ]: Began compiling node model.northwind_dbt.top_customer_revenue
[0m09:01:40.072918 [debug] [Thread-5  ]: Finished running node test.northwind_dbt.unique_dim_customers_customer_id.15c9f1e2fd
[0m09:01:40.072918 [debug] [Thread-12 ]: Re-using an available connection from the pool (formerly model.northwind_dbt.dim_employees, now model.northwind_dbt.top_performing_products)
[0m09:01:40.072918 [debug] [Thread-4  ]: Finished running node test.northwind_dbt.not_null_dim_customers_customer_id.dd91cd1c8d
[0m09:01:40.072918 [debug] [Thread-9  ]: Re-using an available connection from the pool (formerly model.northwind_dbt.fact_order_details, now test.northwind_dbt.not_null_fact_order_details_customer_id.6aaefe4888)
[0m09:01:40.072918 [debug] [Thread-11 ]: Acquiring new snowflake connection 'test.northwind_dbt.not_null_fact_order_details_order_id.8d47c14c82'
[0m09:01:40.079562 [debug] [Thread-1  ]: Began compiling node test.northwind_dbt.unique_dim_products_product_id.ef7b2a9985
[0m09:01:40.079562 [debug] [Thread-8  ]: Began compiling node test.northwind_dbt.not_null_dim_employees_employee_key.232a183ffe
[0m09:01:40.080976 [debug] [Thread-7  ]: Began compiling node test.northwind_dbt.unique_dim_employees_employee_key.3824d24782
[0m09:01:40.080976 [debug] [Thread-2  ]: Writing injected SQL for node "test.northwind_dbt.not_null_dim_products_product_id.c8aba288d1"
[0m09:01:40.087797 [debug] [Thread-6  ]: Began compiling node model.northwind_dbt.obt_orders
[0m09:01:40.072478 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.northwind_dbt.stg_order_details, now model.northwind_dbt.top_employee_revenue)
[0m09:01:40.093018 [debug] [Thread-10 ]: Writing injected SQL for node "model.northwind_dbt.top_customer_revenue"
[0m09:01:40.093018 [debug] [Thread-5  ]: Began running node test.northwind_dbt.not_null_fact_order_details_product_id.85713db7b9
[0m09:01:40.093018 [debug] [Thread-12 ]: Began compiling node model.northwind_dbt.top_performing_products
[0m09:01:40.093018 [debug] [Thread-9  ]: Began compiling node test.northwind_dbt.not_null_fact_order_details_customer_id.6aaefe4888
[0m09:01:40.093018 [debug] [Thread-11 ]: Began compiling node test.northwind_dbt.not_null_fact_order_details_order_id.8d47c14c82
[0m09:01:40.106372 [debug] [Thread-1  ]: Writing injected SQL for node "test.northwind_dbt.unique_dim_products_product_id.ef7b2a9985"
[0m09:01:40.108055 [debug] [Thread-8  ]: Writing injected SQL for node "test.northwind_dbt.not_null_dim_employees_employee_key.232a183ffe"
[0m09:01:40.118610 [debug] [Thread-7  ]: Writing injected SQL for node "test.northwind_dbt.unique_dim_employees_employee_key.3824d24782"
[0m09:01:40.126634 [debug] [Thread-6  ]: Writing injected SQL for node "model.northwind_dbt.obt_orders"
[0m09:01:40.128642 [debug] [Thread-3  ]: Began compiling node model.northwind_dbt.top_employee_revenue
[0m09:01:40.130289 [debug] [Thread-5  ]: Re-using an available connection from the pool (formerly test.northwind_dbt.unique_dim_customers_customer_id.15c9f1e2fd, now test.northwind_dbt.not_null_fact_order_details_product_id.85713db7b9)
[0m09:01:40.135312 [debug] [Thread-2  ]: Began executing node test.northwind_dbt.not_null_dim_products_product_id.c8aba288d1
[0m09:01:40.136676 [debug] [Thread-12 ]: Writing injected SQL for node "model.northwind_dbt.top_performing_products"
[0m09:01:40.147969 [debug] [Thread-9  ]: Writing injected SQL for node "test.northwind_dbt.not_null_fact_order_details_customer_id.6aaefe4888"
[0m09:01:40.147969 [debug] [Thread-10 ]: Began executing node model.northwind_dbt.top_customer_revenue
[0m09:01:40.150969 [debug] [Thread-11 ]: Writing injected SQL for node "test.northwind_dbt.not_null_fact_order_details_order_id.8d47c14c82"
[0m09:01:40.162974 [debug] [Thread-3  ]: Writing injected SQL for node "model.northwind_dbt.top_employee_revenue"
[0m09:01:40.162974 [debug] [Thread-5  ]: Began compiling node test.northwind_dbt.not_null_fact_order_details_product_id.85713db7b9
[0m09:01:40.162974 [debug] [Thread-2  ]: Finished running node test.northwind_dbt.not_null_dim_products_product_id.c8aba288d1
[0m09:01:40.168535 [debug] [Thread-10 ]: Finished running node model.northwind_dbt.top_customer_revenue
[0m09:01:40.178352 [debug] [Thread-5  ]: Writing injected SQL for node "test.northwind_dbt.not_null_fact_order_details_product_id.85713db7b9"
[0m09:01:40.178352 [debug] [Thread-1  ]: Began executing node test.northwind_dbt.unique_dim_products_product_id.ef7b2a9985
[0m09:01:40.178352 [debug] [Thread-6  ]: Began executing node model.northwind_dbt.obt_orders
[0m09:01:40.184868 [debug] [Thread-6  ]: Finished running node model.northwind_dbt.obt_orders
[0m09:01:40.182859 [debug] [Thread-4  ]: Began running node test.northwind_dbt.not_null_top_customer_revenue_customer_id.668bb5e112
[0m09:01:40.184868 [debug] [Thread-1  ]: Finished running node test.northwind_dbt.unique_dim_products_product_id.ef7b2a9985
[0m09:01:40.187563 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.northwind_dbt.not_null_dim_customers_customer_id.dd91cd1c8d, now test.northwind_dbt.not_null_top_customer_revenue_customer_id.668bb5e112)
[0m09:01:40.190239 [debug] [Thread-7  ]: Began executing node test.northwind_dbt.unique_dim_employees_employee_key.3824d24782
[0m09:01:40.190239 [debug] [Thread-10 ]: Began running node test.northwind_dbt.not_null_obt_orders_customer_id.1e3c4ae465
[0m09:01:40.192248 [debug] [Thread-4  ]: Began compiling node test.northwind_dbt.not_null_top_customer_revenue_customer_id.668bb5e112
[0m09:01:40.192248 [debug] [Thread-8  ]: Began executing node test.northwind_dbt.not_null_dim_employees_employee_key.232a183ffe
[0m09:01:40.194304 [debug] [Thread-2  ]: Began running node test.northwind_dbt.not_null_obt_orders_order_date.5632203db3
[0m09:01:40.194304 [debug] [Thread-12 ]: Began executing node model.northwind_dbt.top_performing_products
[0m09:01:40.194304 [debug] [Thread-3  ]: Began executing node model.northwind_dbt.top_employee_revenue
[0m09:01:40.194304 [debug] [Thread-6  ]: Began running node test.northwind_dbt.not_null_obt_orders_order_id.218f605f9c
[0m09:01:40.194304 [debug] [Thread-9  ]: Began executing node test.northwind_dbt.not_null_fact_order_details_customer_id.6aaefe4888
[0m09:01:40.194304 [debug] [Thread-1  ]: Began running node test.northwind_dbt.not_null_obt_orders_product_id.caa3082c7f
[0m09:01:40.194304 [debug] [Thread-7  ]: Finished running node test.northwind_dbt.unique_dim_employees_employee_key.3824d24782
[0m09:01:40.199732 [debug] [Thread-10 ]: Re-using an available connection from the pool (formerly model.northwind_dbt.top_customer_revenue, now test.northwind_dbt.not_null_obt_orders_customer_id.1e3c4ae465)
[0m09:01:40.200314 [debug] [Thread-11 ]: Began executing node test.northwind_dbt.not_null_fact_order_details_order_id.8d47c14c82
[0m09:01:40.201185 [debug] [Thread-5  ]: Began executing node test.northwind_dbt.not_null_fact_order_details_product_id.85713db7b9
[0m09:01:40.209150 [debug] [Thread-4  ]: Writing injected SQL for node "test.northwind_dbt.not_null_top_customer_revenue_customer_id.668bb5e112"
[0m09:01:40.209150 [debug] [Thread-8  ]: Finished running node test.northwind_dbt.not_null_dim_employees_employee_key.232a183ffe
[0m09:01:40.209150 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.northwind_dbt.not_null_dim_products_product_id.c8aba288d1, now test.northwind_dbt.not_null_obt_orders_order_date.5632203db3)
[0m09:01:40.209150 [debug] [Thread-12 ]: Finished running node model.northwind_dbt.top_performing_products
[0m09:01:40.209150 [debug] [Thread-3  ]: Finished running node model.northwind_dbt.top_employee_revenue
[0m09:01:40.215642 [debug] [Thread-6  ]: Re-using an available connection from the pool (formerly model.northwind_dbt.obt_orders, now test.northwind_dbt.not_null_obt_orders_order_id.218f605f9c)
[0m09:01:40.217129 [debug] [Thread-9  ]: Finished running node test.northwind_dbt.not_null_fact_order_details_customer_id.6aaefe4888
[0m09:01:40.217129 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.northwind_dbt.unique_dim_products_product_id.ef7b2a9985, now test.northwind_dbt.not_null_obt_orders_product_id.caa3082c7f)
[0m09:01:40.218666 [debug] [Thread-10 ]: Began compiling node test.northwind_dbt.not_null_obt_orders_customer_id.1e3c4ae465
[0m09:01:40.221512 [debug] [Thread-11 ]: Finished running node test.northwind_dbt.not_null_fact_order_details_order_id.8d47c14c82
[0m09:01:40.222524 [debug] [Thread-5  ]: Finished running node test.northwind_dbt.not_null_fact_order_details_product_id.85713db7b9
[0m09:01:40.224959 [debug] [Thread-2  ]: Began compiling node test.northwind_dbt.not_null_obt_orders_order_date.5632203db3
[0m09:01:40.224959 [debug] [Thread-7  ]: Began running node test.northwind_dbt.not_null_top_performing_products_product_id.919a185ac6
[0m09:01:40.227330 [debug] [Thread-12 ]: Began running node test.northwind_dbt.not_null_top_employee_revenue_employee_key.cb63db6526
[0m09:01:40.228469 [debug] [Thread-6  ]: Began compiling node test.northwind_dbt.not_null_obt_orders_order_id.218f605f9c
[0m09:01:40.230975 [debug] [Thread-1  ]: Began compiling node test.northwind_dbt.not_null_obt_orders_product_id.caa3082c7f
[0m09:01:40.238187 [debug] [Thread-4  ]: Began executing node test.northwind_dbt.not_null_top_customer_revenue_customer_id.668bb5e112
[0m09:01:40.239167 [debug] [Thread-10 ]: Writing injected SQL for node "test.northwind_dbt.not_null_obt_orders_customer_id.1e3c4ae465"
[0m09:01:40.246608 [debug] [Thread-2  ]: Writing injected SQL for node "test.northwind_dbt.not_null_obt_orders_order_date.5632203db3"
[0m09:01:40.246608 [debug] [Thread-7  ]: Re-using an available connection from the pool (formerly test.northwind_dbt.unique_dim_employees_employee_key.3824d24782, now test.northwind_dbt.not_null_top_performing_products_product_id.919a185ac6)
[0m09:01:40.246608 [debug] [Thread-12 ]: Re-using an available connection from the pool (formerly model.northwind_dbt.top_performing_products, now test.northwind_dbt.not_null_top_employee_revenue_employee_key.cb63db6526)
[0m09:01:40.255688 [debug] [Thread-6  ]: Writing injected SQL for node "test.northwind_dbt.not_null_obt_orders_order_id.218f605f9c"
[0m09:01:40.255688 [debug] [Thread-1  ]: Writing injected SQL for node "test.northwind_dbt.not_null_obt_orders_product_id.caa3082c7f"
[0m09:01:40.263112 [debug] [Thread-4  ]: Finished running node test.northwind_dbt.not_null_top_customer_revenue_customer_id.668bb5e112
[0m09:01:40.265719 [debug] [Thread-7  ]: Began compiling node test.northwind_dbt.not_null_top_performing_products_product_id.919a185ac6
[0m09:01:40.265719 [debug] [Thread-12 ]: Began compiling node test.northwind_dbt.not_null_top_employee_revenue_employee_key.cb63db6526
[0m09:01:40.276525 [debug] [Thread-7  ]: Writing injected SQL for node "test.northwind_dbt.not_null_top_performing_products_product_id.919a185ac6"
[0m09:01:40.282430 [debug] [Thread-12 ]: Writing injected SQL for node "test.northwind_dbt.not_null_top_employee_revenue_employee_key.cb63db6526"
[0m09:01:40.286699 [debug] [Thread-6  ]: Began executing node test.northwind_dbt.not_null_obt_orders_order_id.218f605f9c
[0m09:01:40.288715 [debug] [Thread-1  ]: Began executing node test.northwind_dbt.not_null_obt_orders_product_id.caa3082c7f
[0m09:01:40.289524 [debug] [Thread-6  ]: Finished running node test.northwind_dbt.not_null_obt_orders_order_id.218f605f9c
[0m09:01:40.291534 [debug] [Thread-10 ]: Began executing node test.northwind_dbt.not_null_obt_orders_customer_id.1e3c4ae465
[0m09:01:40.291534 [debug] [Thread-2  ]: Began executing node test.northwind_dbt.not_null_obt_orders_order_date.5632203db3
[0m09:01:40.291534 [debug] [Thread-1  ]: Finished running node test.northwind_dbt.not_null_obt_orders_product_id.caa3082c7f
[0m09:01:40.295160 [debug] [Thread-10 ]: Finished running node test.northwind_dbt.not_null_obt_orders_customer_id.1e3c4ae465
[0m09:01:40.297181 [debug] [Thread-2  ]: Finished running node test.northwind_dbt.not_null_obt_orders_order_date.5632203db3
[0m09:01:40.297181 [debug] [Thread-12 ]: Began executing node test.northwind_dbt.not_null_top_employee_revenue_employee_key.cb63db6526
[0m09:01:40.297181 [debug] [Thread-7  ]: Began executing node test.northwind_dbt.not_null_top_performing_products_product_id.919a185ac6
[0m09:01:40.297181 [debug] [Thread-12 ]: Finished running node test.northwind_dbt.not_null_top_employee_revenue_employee_key.cb63db6526
[0m09:01:40.297181 [debug] [Thread-7  ]: Finished running node test.northwind_dbt.not_null_top_performing_products_product_id.919a185ac6
[0m09:01:40.302511 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:01:40.302511 [debug] [MainThread]: Connection 'list_PROJECT_2_snapshots' was left open.
[0m09:01:40.302511 [debug] [MainThread]: On list_PROJECT_2_snapshots: Close
[0m09:01:40.427268 [debug] [MainThread]: Connection 'list_PROJECT_2_PUBLIC' was left open.
[0m09:01:40.429297 [debug] [MainThread]: On list_PROJECT_2_PUBLIC: Close
[0m09:01:40.572185 [debug] [MainThread]: Connection 'test.northwind_dbt.not_null_obt_orders_product_id.caa3082c7f' was properly closed.
[0m09:01:40.572185 [debug] [MainThread]: Connection 'test.northwind_dbt.not_null_obt_orders_order_date.5632203db3' was properly closed.
[0m09:01:40.572185 [debug] [MainThread]: Connection 'model.northwind_dbt.top_employee_revenue' was properly closed.
[0m09:01:40.572185 [debug] [MainThread]: Connection 'test.northwind_dbt.not_null_top_customer_revenue_customer_id.668bb5e112' was properly closed.
[0m09:01:40.572185 [debug] [MainThread]: Connection 'test.northwind_dbt.not_null_fact_order_details_product_id.85713db7b9' was properly closed.
[0m09:01:40.572185 [debug] [MainThread]: Connection 'test.northwind_dbt.not_null_top_performing_products_product_id.919a185ac6' was properly closed.
[0m09:01:40.572185 [debug] [MainThread]: Connection 'test.northwind_dbt.not_null_dim_employees_employee_key.232a183ffe' was properly closed.
[0m09:01:40.572185 [debug] [MainThread]: Connection 'test.northwind_dbt.not_null_obt_orders_customer_id.1e3c4ae465' was properly closed.
[0m09:01:40.588269 [debug] [MainThread]: Connection 'test.northwind_dbt.not_null_top_employee_revenue_employee_key.cb63db6526' was properly closed.
[0m09:01:40.588269 [debug] [MainThread]: Connection 'test.northwind_dbt.not_null_obt_orders_order_id.218f605f9c' was properly closed.
[0m09:01:40.588269 [debug] [MainThread]: Connection 'test.northwind_dbt.not_null_fact_order_details_customer_id.6aaefe4888' was properly closed.
[0m09:01:40.588269 [debug] [MainThread]: Connection 'test.northwind_dbt.not_null_fact_order_details_order_id.8d47c14c82' was properly closed.
[0m09:01:40.588269 [debug] [MainThread]: Command end result
[0m09:01:40.859957 [debug] [MainThread]: Wrote artifact WritableManifest to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\manifest.json
[0m09:01:40.865803 [debug] [MainThread]: Wrote artifact SemanticManifest to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\semantic_manifest.json
[0m09:01:40.894126 [debug] [MainThread]: Wrote artifact RunExecutionResult to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\run_results.json
[0m09:01:42.264900 [debug] [MainThread]: Acquiring new snowflake connection 'generate_catalog'
[0m09:01:42.266550 [info ] [MainThread]: Building catalog
[0m09:01:42.284722 [debug] [ThreadPool]: Acquiring new snowflake connection 'PROJECT_2.information_schema'
[0m09:01:42.310950 [debug] [ThreadPool]: Using snowflake connection "PROJECT_2.information_schema"
[0m09:01:42.312532 [debug] [ThreadPool]: On PROJECT_2.information_schema: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "northwind_profile", "target_name": "dev", "connection_name": "PROJECT_2.information_schema"} */
with tables as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",
        case
            when is_dynamic = 'YES' and table_type = 'BASE TABLE' THEN 'DYNAMIC TABLE'
            else table_type
        end as "table_type",
        comment as "table_comment",

        -- note: this is the _role_ that owns the table
        table_owner as "table_owner",

        'Clustering Key' as "stats:clustering_key:label",
        clustering_key as "stats:clustering_key:value",
        'The key used to cluster this table' as "stats:clustering_key:description",
        (clustering_key is not null) as "stats:clustering_key:include",

        'Row Count' as "stats:row_count:label",
        row_count as "stats:row_count:value",
        'An approximate count of rows in this table' as "stats:row_count:description",
        (row_count is not null) as "stats:row_count:include",

        'Approximate Size' as "stats:bytes:label",
        bytes as "stats:bytes:value",
        'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
        (bytes is not null) as "stats:bytes:include",

        'Last Modified' as "stats:last_modified:label",
        to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
        'The timestamp for last update/change' as "stats:last_modified:description",
        (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"
    from PROJECT_2.INFORMATION_SCHEMA.tables
            where (
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'stg_products' and upper("table_name") = upper('stg_products')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'stg_employees' and upper("table_name") = upper('stg_employees')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'shippers' and upper("table_name") = upper('shippers')

                )
             or 
                (
                    
    "table_schema" ilike 'snapshots' and upper("table_schema") = upper('snapshots')

                    and 
    "table_name" ilike 'employees_snapshot' and upper("table_name") = upper('employees_snapshot')

                )
             or 
                (
                    
    "table_schema" ilike 'snapshots' and upper("table_schema") = upper('snapshots')

                    and 
    "table_name" ilike 'customers_snapshot' and upper("table_name") = upper('customers_snapshot')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'top_employee_revenue' and upper("table_name") = upper('top_employee_revenue')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'stg_customers' and upper("table_name") = upper('stg_customers')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'products' and upper("table_name") = upper('products')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'dim_products' and upper("table_name") = upper('dim_products')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'dim_customers' and upper("table_name") = upper('dim_customers')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'top_customer_revenue' and upper("table_name") = upper('top_customer_revenue')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'fact_order_details' and upper("table_name") = upper('fact_order_details')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'employees' and upper("table_name") = upper('employees')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'top_performing_products' and upper("table_name") = upper('top_performing_products')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'obt_orders' and upper("table_name") = upper('obt_orders')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'dim_employees' and upper("table_name") = upper('dim_employees')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'orders' and upper("table_name") = upper('orders')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'order_details' and upper("table_name") = upper('order_details')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'stg_orders' and upper("table_name") = upper('stg_orders')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'categories' and upper("table_name") = upper('categories')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'suppliers' and upper("table_name") = upper('suppliers')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'stg_order_details' and upper("table_name") = upper('stg_order_details')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'customers' and upper("table_name") = upper('customers')

                )
            )
        ),
        columns as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",

        column_name as "column_name",
        ordinal_position as "column_index",
        data_type as "column_type",
        comment as "column_comment"
    from PROJECT_2.INFORMATION_SCHEMA.columns
            where (
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'stg_products' and upper("table_name") = upper('stg_products')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'stg_employees' and upper("table_name") = upper('stg_employees')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'shippers' and upper("table_name") = upper('shippers')

                )
             or 
                (
                    
    "table_schema" ilike 'snapshots' and upper("table_schema") = upper('snapshots')

                    and 
    "table_name" ilike 'employees_snapshot' and upper("table_name") = upper('employees_snapshot')

                )
             or 
                (
                    
    "table_schema" ilike 'snapshots' and upper("table_schema") = upper('snapshots')

                    and 
    "table_name" ilike 'customers_snapshot' and upper("table_name") = upper('customers_snapshot')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'top_employee_revenue' and upper("table_name") = upper('top_employee_revenue')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'stg_customers' and upper("table_name") = upper('stg_customers')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'products' and upper("table_name") = upper('products')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'dim_products' and upper("table_name") = upper('dim_products')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'dim_customers' and upper("table_name") = upper('dim_customers')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'top_customer_revenue' and upper("table_name") = upper('top_customer_revenue')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'fact_order_details' and upper("table_name") = upper('fact_order_details')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'employees' and upper("table_name") = upper('employees')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'top_performing_products' and upper("table_name") = upper('top_performing_products')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'obt_orders' and upper("table_name") = upper('obt_orders')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'dim_employees' and upper("table_name") = upper('dim_employees')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'orders' and upper("table_name") = upper('orders')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'order_details' and upper("table_name") = upper('order_details')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'stg_orders' and upper("table_name") = upper('stg_orders')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'categories' and upper("table_name") = upper('categories')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'suppliers' and upper("table_name") = upper('suppliers')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'stg_order_details' and upper("table_name") = upper('stg_order_details')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'customers' and upper("table_name") = upper('customers')

                )
            )
        )
        select *
    from tables
    join columns using ("table_database", "table_schema", "table_name")
    order by "column_index"
[0m09:01:42.313579 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:01:51.424350 [debug] [ThreadPool]: SQL status: SUCCESS 323 in 9.110 seconds
[0m09:01:51.959875 [debug] [MainThread]: Wrote artifact CatalogArtifact to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\catalog.json
[0m09:01:52.285186 [debug] [MainThread]: Wrote artifact WritableManifest to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\manifest.json
[0m09:01:52.293853 [debug] [MainThread]: Wrote artifact SemanticManifest to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\semantic_manifest.json
[0m09:01:52.294737 [info ] [MainThread]: Catalog written to c:\Users\fitzp\Documents\Alpaca_Market\zproject_2\northwind_psql\target\catalog.json
[0m09:01:52.299147 [debug] [MainThread]: Command `dbt docs generate` succeeded at 09:01:52.299147 after 16.15 seconds
[0m09:01:52.300741 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m09:01:52.301806 [debug] [MainThread]: Connection 'PROJECT_2.information_schema' was left open.
[0m09:01:52.303390 [debug] [MainThread]: On PROJECT_2.information_schema: Close
[0m09:01:52.445920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A805F0340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A81FA2FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A9C13ABE0>]}
[0m09:01:52.446454 [debug] [MainThread]: Flushing usage events
[0m09:01:53.430901 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:02:03.064071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016F88711310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016F8A78DC40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016F8A78DA30>]}


============================== 09:02:03.070611 | 5c069c33-d7ce-4d15-9339-6b122eef2a52 ==============================
[0m09:02:03.070611 [info ] [MainThread]: Running with dbt=1.9.0
[0m09:02:03.071985 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'c:\\Users\\fitzp\\Documents\\Alpaca_Market\\zproject_2\\northwind_psql\\logs', 'profiles_dir': 'c:\\Users\\fitzp\\Documents\\Alpaca_Market\\zproject_2\\northwind_psql', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt docs serve', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:02:04.283314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5c069c33-d7ce-4d15-9339-6b122eef2a52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016F8A766190>]}
[0m09:02:04.413165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5c069c33-d7ce-4d15-9339-6b122eef2a52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016F8A0C2460>]}
[0m16:57:39.197291 [error] [MainThread]: Encountered an error:

[0m16:57:39.308911 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\fitzp\anaconda3\envs\bootcamp\lib\site-packages\dbt\cli\requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
  File "C:\Users\fitzp\anaconda3\envs\bootcamp\lib\site-packages\dbt\cli\requires.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\fitzp\anaconda3\envs\bootcamp\lib\site-packages\dbt\cli\requires.py", line 235, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\fitzp\anaconda3\envs\bootcamp\lib\site-packages\dbt\cli\requires.py", line 264, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\fitzp\anaconda3\envs\bootcamp\lib\site-packages\dbt\cli\requires.py", line 311, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\fitzp\anaconda3\envs\bootcamp\lib\site-packages\dbt\cli\main.py", line 301, in docs_serve
    results = task.run()
  File "C:\Users\fitzp\anaconda3\envs\bootcamp\lib\site-packages\dbt\task\docs\serve.py", line 29, in run
    httpd.serve_forever()
  File "C:\Users\fitzp\anaconda3\envs\bootcamp\lib\socketserver.py", line 232, in serve_forever
    ready = selector.select(poll_interval)
  File "C:\Users\fitzp\anaconda3\envs\bootcamp\lib\selectors.py", line 324, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
  File "C:\Users\fitzp\anaconda3\envs\bootcamp\lib\selectors.py", line 315, in _select
    r, w, x = select.select(r, w, w, timeout)
KeyboardInterrupt

[0m16:57:39.334253 [debug] [MainThread]: Command `dbt docs serve` failed at 16:57:39.332047 after 28536.39 seconds
[0m16:57:39.417257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016F88711310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FA3437910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FA3437610>]}
[0m16:57:39.437706 [debug] [MainThread]: Flushing usage events
[0m16:57:40.547988 [debug] [MainThread]: An error was encountered while trying to flush usage events
